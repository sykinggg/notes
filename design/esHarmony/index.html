<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>es6 module | 前端 学习</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css">
    <link rel="manifest" href="/notes/manifest.webmanifest" crossorigin="use-credentials">
    <meta name="description" content="君子藏器于身 待时而动 天下有道则见 无道则隐">
    <meta property="og:url" content="/notes/design/esHarmony.html">
    <meta property="og:site_name" content="前端 学习">
    <meta property="og:title" content="es6 module">
    <meta property="og:description" content="es6 module ES Harmony TC39，负责讨论ECMAScript语法和语义定义问题和其未来迭代的标准机构，它是由许多的非常聪明的开发者组成的。这些开发者中的一些人（比如Alex Russell）对Javascript在大规模开发中的用例场景在过去几年一直保持者密切的关注，并且敏锐的意识到了人们对于能够使用其编写更加模块化JS的优良的语言特性">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="en-US">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:alt" content="前端 学习">
    <meta property="article:author" content="sy">
    <meta name="theme-color" content="#46bd87">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <link rel="preload" href="/notes/assets/css/0.styles.672a4c15.css" as="style"><link rel="preload" href="/notes/assets/js/app.ea95c64a.js" as="script"><link rel="preload" href="/notes/assets/js/vendors~layout-Layout.be2c5762.js" as="script"><link rel="preload" href="/notes/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.c13b2ebd.js" as="script"><link rel="preload" href="/notes/assets/js/page-es6module.47b21daf.js" as="script"><link rel="preload" href="/notes/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-Slide.b17ba5cc.js" as="script"><link rel="prefetch" href="/notes/assets/js/594.e745f6b7.js"><link rel="prefetch" href="/notes/assets/js/595.ccf8634a.js"><link rel="prefetch" href="/notes/assets/js/596.89da63d8.js"><link rel="prefetch" href="/notes/assets/js/layout-Blog.b230af33.js"><link rel="prefetch" href="/notes/assets/js/layout-Layout.cb0003cf.js"><link rel="prefetch" href="/notes/assets/js/layout-NotFound.612b2841.js"><link rel="prefetch" href="/notes/assets/js/layout-Slide.64057197.js"><link rel="prefetch" href="/notes/assets/js/mermaid.1acaf644.js"><link rel="prefetch" href="/notes/assets/js/page-$mount.c5b6770f.js"><link rel="prefetch" href="/notes/assets/js/page--0036d571.827be129.js"><link rel="prefetch" href="/notes/assets/js/page--022ad8a1.3f838b49.js"><link rel="prefetch" href="/notes/assets/js/page--049c9a9f.2aa45e9e.js"><link rel="prefetch" href="/notes/assets/js/page--050f4996.8304f340.js"><link rel="prefetch" href="/notes/assets/js/page--05ca34d9.35fcf9e4.js"><link rel="prefetch" href="/notes/assets/js/page--06138101.6a5e622a.js"><link rel="prefetch" href="/notes/assets/js/page--078553ea.ade233d5.js"><link rel="prefetch" href="/notes/assets/js/page--07c5ad21.9a454343.js"><link rel="prefetch" href="/notes/assets/js/page--07f0b7af.479fa34a.js"><link rel="prefetch" href="/notes/assets/js/page--08402fbe.11a4734e.js"><link rel="prefetch" href="/notes/assets/js/page--0a137961.c2be30dd.js"><link rel="prefetch" href="/notes/assets/js/page--0b6292d3.6d069490.js"><link rel="prefetch" href="/notes/assets/js/page--0b81571e.8c8e4105.js"><link rel="prefetch" href="/notes/assets/js/page--0c7d4a27.11938c82.js"><link rel="prefetch" href="/notes/assets/js/page--0d936993.f2783385.js"><link rel="prefetch" href="/notes/assets/js/page--0e573275.b8488de1.js"><link rel="prefetch" href="/notes/assets/js/page--0f2ef575.283e1562.js"><link rel="prefetch" href="/notes/assets/js/page--0fb13921.5ffb6e45.js"><link rel="prefetch" href="/notes/assets/js/page--0fe0372e.2944798f.js"><link rel="prefetch" href="/notes/assets/js/page--10902ffe.c01ef43c.js"><link rel="prefetch" href="/notes/assets/js/page--12bc566b.0591b2fa.js"><link rel="prefetch" href="/notes/assets/js/page--135834a1.423f432e.js"><link rel="prefetch" href="/notes/assets/js/page--15961e72.abebf138.js"><link rel="prefetch" href="/notes/assets/js/page--17036b33.10ebcc27.js"><link rel="prefetch" href="/notes/assets/js/page--172068b9.01ae13f0.js"><link rel="prefetch" href="/notes/assets/js/page--18126b85.df3e8fcc.js"><link rel="prefetch" href="/notes/assets/js/page--19a1b422.a195cb79.js"><link rel="prefetch" href="/notes/assets/js/page--1a00028a.a5af1847.js"><link rel="prefetch" href="/notes/assets/js/page--1c6aa5c2.bb7451d3.js"><link rel="prefetch" href="/notes/assets/js/page--1fece121.385717cc.js"><link rel="prefetch" href="/notes/assets/js/page--201cfbe1.445a0c1d.js"><link rel="prefetch" href="/notes/assets/js/page--2095282b.be13c2e2.js"><link rel="prefetch" href="/notes/assets/js/page--21792c01.2abdd7d4.js"><link rel="prefetch" href="/notes/assets/js/page--226f1079.a856175c.js"><link rel="prefetch" href="/notes/assets/js/page--2518076e.11726d62.js"><link rel="prefetch" href="/notes/assets/js/page--25cb6e5f.335626bc.js"><link rel="prefetch" href="/notes/assets/js/page--2616bc7e.0ee9ba6d.js"><link rel="prefetch" href="/notes/assets/js/page--27a556ad.b3c369bb.js"><link rel="prefetch" href="/notes/assets/js/page--27c21126.54ce3432.js"><link rel="prefetch" href="/notes/assets/js/page--28435cbb.67e4b063.js"><link rel="prefetch" href="/notes/assets/js/page--28c148fe.e10b0f5d.js"><link rel="prefetch" href="/notes/assets/js/page--2ae50662.385d02b0.js"><link rel="prefetch" href="/notes/assets/js/page--2c665981.a9c95168.js"><link rel="prefetch" href="/notes/assets/js/page--2d021821.c613f2b7.js"><link rel="prefetch" href="/notes/assets/js/page--31799879.7b511d30.js"><link rel="prefetch" href="/notes/assets/js/page--33b11326.0f559836.js"><link rel="prefetch" href="/notes/assets/js/page--3477437b.c13895ea.js"><link rel="prefetch" href="/notes/assets/js/page--34ad062f.c06d7503.js"><link rel="prefetch" href="/notes/assets/js/page--357aec57.77be1fff.js"><link rel="prefetch" href="/notes/assets/js/page--35f61a61.72932195.js"><link rel="prefetch" href="/notes/assets/js/page--36897e27.ae2cb64d.js"><link rel="prefetch" href="/notes/assets/js/page--36b30161.724af83c.js"><link rel="prefetch" href="/notes/assets/js/page--377508c1.5cc66b9d.js"><link rel="prefetch" href="/notes/assets/js/page--3779bcfe.52d39d6d.js"><link rel="prefetch" href="/notes/assets/js/page--389d5da5.47d37f9d.js"><link rel="prefetch" href="/notes/assets/js/page--38ef908f.01a792ad.js"><link rel="prefetch" href="/notes/assets/js/page--39c1a916.e0a05cdf.js"><link rel="prefetch" href="/notes/assets/js/page--39e34c63.20286b78.js"><link rel="prefetch" href="/notes/assets/js/page--3bbd34b1.db2868d0.js"><link rel="prefetch" href="/notes/assets/js/page--3d00ca45.5c197c8f.js"><link rel="prefetch" href="/notes/assets/js/page--3d121781.fb1f4d05.js"><link rel="prefetch" href="/notes/assets/js/page--3d5ab373.15981d84.js"><link rel="prefetch" href="/notes/assets/js/page--41d1702a.ca257afb.js"><link rel="prefetch" href="/notes/assets/js/page--427db7c1.67caa326.js"><link rel="prefetch" href="/notes/assets/js/page--4365fcbe.a67bd3b5.js"><link rel="prefetch" href="/notes/assets/js/page--466a516d.2d36f77e.js"><link rel="prefetch" href="/notes/assets/js/page--46f53541.016d3077.js"><link rel="prefetch" href="/notes/assets/js/page--4776c269.fa55c9b1.js"><link rel="prefetch" href="/notes/assets/js/page--4803a967.eb8ffb5a.js"><link rel="prefetch" href="/notes/assets/js/page--48c4e433.a9402d99.js"><link rel="prefetch" href="/notes/assets/js/page--48f9c9d9.a658ba5b.js"><link rel="prefetch" href="/notes/assets/js/page--4a252f57.42f4de6a.js"><link rel="prefetch" href="/notes/assets/js/page--4b35cd6a.815cabfc.js"><link rel="prefetch" href="/notes/assets/js/page--4bd2c839.9c254ad6.js"><link rel="prefetch" href="/notes/assets/js/page--4be1980d.2aa9a6e5.js"><link rel="prefetch" href="/notes/assets/js/page--4c3dfc92.98c2c82d.js"><link rel="prefetch" href="/notes/assets/js/page--4c9b9bf3.eadd2cb2.js"><link rel="prefetch" href="/notes/assets/js/page--4caf2956.9031d8db.js"><link rel="prefetch" href="/notes/assets/js/page--4df59ba1.7da8848b.js"><link rel="prefetch" href="/notes/assets/js/page--4dfb2a67.cfd47f31.js"><link rel="prefetch" href="/notes/assets/js/page--4e2425dd.530ff427.js"><link rel="prefetch" href="/notes/assets/js/page--4eb2620a.6b4b0641.js"><link rel="prefetch" href="/notes/assets/js/page--4fd512b5.125d833c.js"><link rel="prefetch" href="/notes/assets/js/page--4ff1cd2e.909945e4.js"><link rel="prefetch" href="/notes/assets/js/page--505dfb41.f37133ec.js"><link rel="prefetch" href="/notes/assets/js/page--5293e923.7d7bb4c5.js"><link rel="prefetch" href="/notes/assets/js/page--5381ba01.a19f6d31.js"><link rel="prefetch" href="/notes/assets/js/page--550b58e9.150c097d.js"><link rel="prefetch" href="/notes/assets/js/page--564b24b3.6ef748ee.js"><link rel="prefetch" href="/notes/assets/js/page--598867f3.b18b6df9.js"><link rel="prefetch" href="/notes/assets/js/page--5be0cf2e.45929d87.js"><link rel="prefetch" href="/notes/assets/js/page--5c1b876b.742c8d1f.js"><link rel="prefetch" href="/notes/assets/js/page--60c3812d.73dd0227.js"><link rel="prefetch" href="/notes/assets/js/page--6213086b.da216baf.js"><link rel="prefetch" href="/notes/assets/js/page--624c4841.11f99d1c.js"><link rel="prefetch" href="/notes/assets/js/page--6389398f.2a67b985.js"><link rel="prefetch" href="/notes/assets/js/page--6497f0a1.7be614f7.js"><link rel="prefetch" href="/notes/assets/js/page--649d273e.1b9dea3d.js"><link rel="prefetch" href="/notes/assets/js/page--663eaefe.d36d2ab2.js"><link rel="prefetch" href="/notes/assets/js/page--66f10201.a1a7d046.js"><link rel="prefetch" href="/notes/assets/js/page--6877a3e2.a1200e9b.js"><link rel="prefetch" href="/notes/assets/js/page--6afe7ce1.51498eaa.js"><link rel="prefetch" href="/notes/assets/js/page--6cbf38e1.cedab12c.js"><link rel="prefetch" href="/notes/assets/js/page--6ce92f3e.affd65d4.js"><link rel="prefetch" href="/notes/assets/js/page--6e597d21.23f5a8b0.js"><link rel="prefetch" href="/notes/assets/js/page--6e740896.40c2578c.js"><link rel="prefetch" href="/notes/assets/js/page--6f049967.debe6a68.js"><link rel="prefetch" href="/notes/assets/js/page--6ff33237.30b90714.js"><link rel="prefetch" href="/notes/assets/js/page--70f1ad1b.bf70d599.js"><link rel="prefetch" href="/notes/assets/js/page--7458eaaa.311e1ef6.js"><link rel="prefetch" href="/notes/assets/js/page--746db89a.d19f4ba2.js"><link rel="prefetch" href="/notes/assets/js/page--762ae66f.58f7d5dd.js"><link rel="prefetch" href="/notes/assets/js/page--78218936.4b8cdbc0.js"><link rel="prefetch" href="/notes/assets/js/page--7a6b8eb1.45803ac5.js"><link rel="prefetch" href="/notes/assets/js/page--7b0b14b7.252bc2d4.js"><link rel="prefetch" href="/notes/assets/js/page--7b24903e.c8926890.js"><link rel="prefetch" href="/notes/assets/js/page--7c0f4619.79f6e665.js"><link rel="prefetch" href="/notes/assets/js/page--7c62eb01.ab10ad09.js"><link rel="prefetch" href="/notes/assets/js/page--7c8b8781.4a4f852e.js"><link rel="prefetch" href="/notes/assets/js/page--7d3b14f1.efda1c26.js"><link rel="prefetch" href="/notes/assets/js/page--7e94c3bb.0f204597.js"><link rel="prefetch" href="/notes/assets/js/page--7fc7e4a1.d62419af.js"><link rel="prefetch" href="/notes/assets/js/page--82271b92.bee5fa8e.js"><link rel="prefetch" href="/notes/assets/js/page--828e159e.c9f13e84.js"><link rel="prefetch" href="/notes/assets/js/page--8cd36aaa.b2810233.js"><link rel="prefetch" href="/notes/assets/js/page--8e28d8be.87f8f37f.js"><link rel="prefetch" href="/notes/assets/js/page--9009daaa.79ab2330.js"><link rel="prefetch" href="/notes/assets/js/page--9230e83a.2f8f24d7.js"><link rel="prefetch" href="/notes/assets/js/page--9fdba57e.7c3d553b.js"><link rel="prefetch" href="/notes/assets/js/page--a051453e.fdc169dd.js"><link rel="prefetch" href="/notes/assets/js/page--a1c4239e.a191791a.js"><link rel="prefetch" href="/notes/assets/js/page--a8a8c1be.d30fc906.js"><link rel="prefetch" href="/notes/assets/js/page--aabdd1a6.881e185c.js"><link rel="prefetch" href="/notes/assets/js/page--b0ec1952.954cdc0f.js"><link rel="prefetch" href="/notes/assets/js/page--b5901aa6.e4bdd1fb.js"><link rel="prefetch" href="/notes/assets/js/page--c185ca2a.178abb9e.js"><link rel="prefetch" href="/notes/assets/js/page--c4cd30aa.febee61e.js"><link rel="prefetch" href="/notes/assets/js/page--cba59586.f2e51db1.js"><link rel="prefetch" href="/notes/assets/js/page--cc19dc5e.c434f269.js"><link rel="prefetch" href="/notes/assets/js/page--cf39bd12.bc7d3cb3.js"><link rel="prefetch" href="/notes/assets/js/page--d0d30f3e.fcd22ce6.js"><link rel="prefetch" href="/notes/assets/js/page--d206ab7e.b8f9cedb.js"><link rel="prefetch" href="/notes/assets/js/page--d2ed8dae.89cae87f.js"><link rel="prefetch" href="/notes/assets/js/page--d676831e.6c3159a1.js"><link rel="prefetch" href="/notes/assets/js/page--d6d819fe.01bf50d3.js"><link rel="prefetch" href="/notes/assets/js/page--d994fd7e.6a80b924.js"><link rel="prefetch" href="/notes/assets/js/page--dd5a1a16.b5379e4e.js"><link rel="prefetch" href="/notes/assets/js/page--df9ce13a.a9bf6b13.js"><link rel="prefetch" href="/notes/assets/js/page--e0b57efe.5bfeda2b.js"><link rel="prefetch" href="/notes/assets/js/page--eb673c12.3e06d122.js"><link rel="prefetch" href="/notes/assets/js/page--ebf2773e.715bb9a6.js"><link rel="prefetch" href="/notes/assets/js/page--ef64acb6.9f35c09a.js"><link rel="prefetch" href="/notes/assets/js/page--f77f473e.0149cbba.js"><link rel="prefetch" href="/notes/assets/js/page--fb1d49b6.f78721e5.js"><link rel="prefetch" href="/notes/assets/js/page-1、说说你对SPA单页面的理解，它的优缺点分别是什么？.47c46801.js"><link rel="prefetch" href="/notes/assets/js/page-49个CSS知识点.e9e714e5.js"><link rel="prefetch" href="/notes/assets/js/page-@charset.e43c17d3.js"><link rel="prefetch" href="/notes/assets/js/page-@types.236b5295.js"><link rel="prefetch" href="/notes/assets/js/page-@umijsplugin-dva.da02f643.js"><link rel="prefetch" href="/notes/assets/js/page-@umijsplugin-qiankun.5ad19002.js"><link rel="prefetch" href="/notes/assets/js/page-AMD模块.71ab9929.js"><link rel="prefetch" href="/notes/assets/js/page-API.4b264168.js"><link rel="prefetch" href="/notes/assets/js/page-Arrayprototypeflat().ec50ddec.js"><link rel="prefetch" href="/notes/assets/js/page-Barrel.f661fdde.js"><link rel="prefetch" href="/notes/assets/js/page-Bind是有害的.ec278771.js"><link rel="prefetch" href="/notes/assets/js/page-CSSGrid网格布局教程.a72c496b.js"><link rel="prefetch" href="/notes/assets/js/page-CSS选择符.ebd95820.js"><link rel="prefetch" href="/notes/assets/js/page-Canvas和SVG区别.df288f60.js"><link rel="prefetch" href="/notes/assets/js/page-CommonJS.1c663461.js"><link rel="prefetch" href="/notes/assets/js/page-Configuration.812f5460.js"><link rel="prefetch" href="/notes/assets/js/page-Consumer向上找不到Provider的时候怎么办.507c066f.js"><link rel="prefetch" href="/notes/assets/js/page-ContentTypes.2871bf88.js"><link rel="prefetch" href="/notes/assets/js/page-Css单位.c6803f01.js"><link rel="prefetch" href="/notes/assets/js/page-Decorators.55ee6de2.js"><link rel="prefetch" href="/notes/assets/js/page-Diff算法.e8e92f72.js"><link rel="prefetch" href="/notes/assets/js/page-ES10新特性（2019）.8516feb3.js"><link rel="prefetch" href="/notes/assets/js/page-ES6新特性（2015）.d324b4b3.js"><link rel="prefetch" href="/notes/assets/js/page-ES7新特性（2016）.77cbe7d5.js"><link rel="prefetch" href="/notes/assets/js/page-ES8新特性（2017）.179a1341.js"><link rel="prefetch" href="/notes/assets/js/page-ES9新特性（2018）.13057858.js"><link rel="prefetch" href="/notes/assets/js/page-FetchAPI教程.a31b8289.js"><link rel="prefetch" href="/notes/assets/js/page-FileReader.29c0a322.js"><link rel="prefetch" href="/notes/assets/js/page-Flex布局教程：实例篇.35d7ee92.js"><link rel="prefetch" href="/notes/assets/js/page-Flex布局教程：语法篇.3dbd35cf.js"><link rel="prefetch" href="/notes/assets/js/page-Flyweight模式.d5751ff7.js"><link rel="prefetch" href="/notes/assets/js/page-Fragment.b3e85374.js"><link rel="prefetch" href="/notes/assets/js/page-Freshness.3b7fd46e.js"><link rel="prefetch" href="/notes/assets/js/page-Generator.53ad96b1.js"><link rel="prefetch" href="/notes/assets/js/page-Git面试知识点.f82e1262.js"><link rel="prefetch" href="/notes/assets/js/page-HTML5datalist标签.ab60d402.js"><link rel="prefetch" href="/notes/assets/js/page-HTML常用特殊字符.1a3b1662.js"><link rel="prefetch" href="/notes/assets/js/page-Home.59e67adb.js"><link rel="prefetch" href="/notes/assets/js/page-Hybrid.61248296.js"><link rel="prefetch" href="/notes/assets/js/page-ID选择器.603288d4.js"><link rel="prefetch" href="/notes/assets/js/page-ImmutableData.ee044c2c.js"><link rel="prefetch" href="/notes/assets/js/page-JSX和React.ed632fdd.js"><link rel="prefetch" href="/notes/assets/js/page-JavaScript实现双向链表.6876856b.js"><link rel="prefetch" href="/notes/assets/js/page-JavaScript执行机制.a09f428d.js"><link rel="prefetch" href="/notes/assets/js/page-JavaScript设计模式的分类.f9577098.js"><link rel="prefetch" href="/notes/assets/js/page-MVC模式.e9d15b67.js"><link rel="prefetch" href="/notes/assets/js/page-MVP模式.7474466d.js"><link rel="prefetch" href="/notes/assets/js/page-MVVM.4d3ec0b2.js"><link rel="prefetch" href="/notes/assets/js/page-Map.98f82c49.js"><link rel="prefetch" href="/notes/assets/js/page-Mixin模式.b011da8d.js"><link rel="prefetch" href="/notes/assets/js/page-Modulardesign(模块化设计).49f94f75.js"><link rel="prefetch" href="/notes/assets/js/page-Never.8bdbf225.js"><link rel="prefetch" href="/notes/assets/js/page-Objectis（）.9f4bc5ec.js"><link rel="prefetch" href="/notes/assets/js/page-Portals.e72cb571.js"><link rel="prefetch" href="/notes/assets/js/page-Promise.b69d8ff7.js"><link rel="prefetch" href="/notes/assets/js/page-Promise面试题总结.b4292baf.js"><link rel="prefetch" href="/notes/assets/js/page-Props(v2611).594dc602.js"><link rel="prefetch" href="/notes/assets/js/page-Quirks模式是什么？它和Standards模式有什么区别.5b83d967.js"><link rel="prefetch" href="/notes/assets/js/page-React+TypeScript规范.5da411b6.js"><link rel="prefetch" href="/notes/assets/js/page-ReactComponent.f900d188.js"><link rel="prefetch" href="/notes/assets/js/page-ReactJSX.5f9746b3.js"><link rel="prefetch" href="/notes/assets/js/page-React引用传递ForwardingRefs.b06815c2.js"><link rel="prefetch" href="/notes/assets/js/page-React源码解析.8e099470.js"><link rel="prefetch" href="/notes/assets/js/page-React高阶组件(HOC).ad4dd4d3.js"><link rel="prefetch" href="/notes/assets/js/page-ReflectMetadata.ae4e23aa.js"><link rel="prefetch" href="/notes/assets/js/page-Stack.24ab84e7.js"><link rel="prefetch" href="/notes/assets/js/page-StickyFooter，完美的绝对底部.92cf3d2f.js"><link rel="prefetch" href="/notes/assets/js/page-String.a2e6656a.js"><link rel="prefetch" href="/notes/assets/js/page-Suspense组件.62dfe618.js"><link rel="prefetch" href="/notes/assets/js/page-Symbol.8e706f87.js"><link rel="prefetch" href="/notes/assets/js/page-ThisType.81d7e974.js"><link rel="prefetch" href="/notes/assets/js/page-TransformBuildApi.c582ad19.js"><link rel="prefetch" href="/notes/assets/js/page-Truthy.dbbe6c1b.js"><link rel="prefetch" href="/notes/assets/js/page-TypeScript37.3b45d951.js"><link rel="prefetch" href="/notes/assets/js/page-TypeScript38.6e65ae4d.js"><link rel="prefetch" href="/notes/assets/js/page-TypeScript39.4f29bcc9.js"><link rel="prefetch" href="/notes/assets/js/page-TypeScript中的静态构造函数.8d7dab93.js"><link rel="prefetch" href="/notes/assets/js/page-VNode.249a6e0f.js"><link rel="prefetch" href="/notes/assets/js/page-VirtualDOM.cbcce7fc.js"><link rel="prefetch" href="/notes/assets/js/page-Vue-Router.66511663.js"><link rel="prefetch" href="/notes/assets/js/page-VueRouter对象.2e0afe7a.js"><link rel="prefetch" href="/notes/assets/js/page-Vuejs源码构建.24a44eb5.js"><link rel="prefetch" href="/notes/assets/js/page-Vuejs源码目录设计.8a989370.js"><link rel="prefetch" href="/notes/assets/js/page-Vuex.f8f34b66.js"><link rel="prefetch" href="/notes/assets/js/page-Vuex初始化.2e119f72.js"><link rel="prefetch" href="/notes/assets/js/page-Vue事件API.65ecb92d.js"><link rel="prefetch" href="/notes/assets/js/page-Vue实例挂载的实现.87cef7f7.js"><link rel="prefetch" href="/notes/assets/js/page-Vue模板渲染的原理.f2472334.js"><link rel="prefetch" href="/notes/assets/js/page-Webpack.e82bda01.js"><link rel="prefetch" href="/notes/assets/js/page-XMLHttpRequest.c7f7a696.js"><link rel="prefetch" href="/notes/assets/js/page-accesskey.016b135f.js"><link rel="prefetch" href="/notes/assets/js/page-arguments[]函数参数数组.38ec8112.js"><link rel="prefetch" href="/notes/assets/js/page-babel编译原理.d222b833.js"><link rel="prefetch" href="/notes/assets/js/page-before和after中双冒号和单冒号.d168a71b.js"><link rel="prefetch" href="/notes/assets/js/page-beginWork.4040d3a4.js"><link rel="prefetch" href="/notes/assets/js/page-codegen.b91c8d84.js"><link rel="prefetch" href="/notes/assets/js/page-coerceRef.343daae5.js"><link rel="prefetch" href="/notes/assets/js/page-commitAllHostEffects.2a9fea94.js"><link rel="prefetch" href="/notes/assets/js/page-commitAllLifeCycles.24508049.js"><link rel="prefetch" href="/notes/assets/js/page-commitBeforeMutationLifecycles.8c444d0d.js"><link rel="prefetch" href="/notes/assets/js/page-commitDeletion.7d4768a2.js"><link rel="prefetch" href="/notes/assets/js/page-commitPlacement.0ec64095.js"><link rel="prefetch" href="/notes/assets/js/page-commitRoot.e4db2c30.js"><link rel="prefetch" href="/notes/assets/js/page-commitWork.729c3783.js"><link rel="prefetch" href="/notes/assets/js/page-constructor和getInitialState.95bb7deb.js"><link rel="prefetch" href="/notes/assets/js/page-createComponent.7675e13f.js"><link rel="prefetch" href="/notes/assets/js/page-createElement.70460e4b.js"><link rel="prefetch" href="/notes/assets/js/page-css优先级：.5c4b2974.js"><link rel="prefetch" href="/notes/assets/js/page-css兼容性整理.277196cd.js"><link rel="prefetch" href="/notes/assets/js/page-css基础面试.9b00d975.js"><link rel="prefetch" href="/notes/assets/js/page-demo.26d35aa5.js"><link rel="prefetch" href="/notes/assets/js/page-device.2c78b536.js"><link rel="prefetch" href="/notes/assets/js/page-divonClick={handlerClick}单击单击div有什么区别.d048058b.js"><link rel="prefetch" href="/notes/assets/js/page-event.3d47a837.js"><link rel="prefetch" href="/notes/assets/js/page-exportdefault被认为是有害的.eaaddb32.js"><link rel="prefetch" href="/notes/assets/js/page-function.3951de07.js"><link rel="prefetch" href="/notes/assets/js/page-gitrebase.d030428f.js"><link rel="prefetch" href="/notes/assets/js/page-hydrate.c46f2ff3.js"><link rel="prefetch" href="/notes/assets/js/page-infer.1144f558.js"><link rel="prefetch" href="/notes/assets/js/page-inline-block元素间间距.f6d2676a.js"><link rel="prefetch" href="/notes/assets/js/page-invokeGuardedCallback.ac36d9fc.js"><link rel="prefetch" href="/notes/assets/js/page-js奇怪的小问题.9ad1345f.js"><link rel="prefetch" href="/notes/assets/js/page-js异步历史.f3f90990.js"><link rel="prefetch" href="/notes/assets/js/page-js总结.cd6e7dea.js"><link rel="prefetch" href="/notes/assets/js/page-keep-alive.8b71d794.js"><link rel="prefetch" href="/notes/assets/js/page-lazycomponent.4af9a18e.js"><link rel="prefetch" href="/notes/assets/js/page-libdts.d466b929.js"><link rel="prefetch" href="/notes/assets/js/page-loader.553fde6a.js"><link rel="prefetch" href="/notes/assets/js/page-matcher.83db9bbe.js"><link rel="prefetch" href="/notes/assets/js/page-module、export、import分别有什么作用？.58ce141b.js"><link rel="prefetch" href="/notes/assets/js/page-mountIndeterminateComponent.ac0acbda.js"><link rel="prefetch" href="/notes/assets/js/page-mountLazyCompont.b4c03b14.js"><link rel="prefetch" href="/notes/assets/js/page-newVue发生了什么.9299d469.js"><link rel="prefetch" href="/notes/assets/js/page-nextTick.19b0cc00.js"><link rel="prefetch" href="/notes/assets/js/page-optimize.ec7ccca3.js"><link rel="prefetch" href="/notes/assets/js/page-parse.5d3d4583.js"><link rel="prefetch" href="/notes/assets/js/page-patch.d95bf970.js"><link rel="prefetch" href="/notes/assets/js/page-plugin.52cb11e9.js"><link rel="prefetch" href="/notes/assets/js/page-public设置.79c13a86.js"><link rel="prefetch" href="/notes/assets/js/page-react-dom.dcce1f23.js"><link rel="prefetch" href="/notes/assets/js/page-react-hooks.5db847dd.js"><link rel="prefetch" href="/notes/assets/js/page-react-hooks使用.74fa5bbb.js"><link rel="prefetch" href="/notes/assets/js/page-react-hooks原理.51045dbf.js"><link rel="prefetch" href="/notes/assets/js/page-react-redux源码.c05fb943.js"><link rel="prefetch" href="/notes/assets/js/page-readonly.f643736d.js"><link rel="prefetch" href="/notes/assets/js/page-reconcileChildren.e34dcf5d.js"><link rel="prefetch" href="/notes/assets/js/page-reconcileChildrenArray.5d8d4614.js"><link rel="prefetch" href="/notes/assets/js/page-reconcileSingleElement.006fccc1.js"><link rel="prefetch" href="/notes/assets/js/page-redux源码解读.d5292107.js"><link rel="prefetch" href="/notes/assets/js/page-render.9173c4d0.js"><link rel="prefetch" href="/notes/assets/js/page-resolveCurrentlyRenderingFiber.c8a2de9e.js"><link rel="prefetch" href="/notes/assets/js/page-set.793dd071.js"><link rel="prefetch" href="/notes/assets/js/page-setState.04a8be75.js"><link rel="prefetch" href="/notes/assets/js/page-setState执行流程.28a42870.js"><link rel="prefetch" href="/notes/assets/js/page-setState背后的批量更新如何实现.9f40b411.js"><link rel="prefetch" href="/notes/assets/js/page-slot.a4c33b4a.js"><link rel="prefetch" href="/notes/assets/js/page-suspense.5bb51360.js"><link rel="prefetch" href="/notes/assets/js/page-throwException.dd9ad306.js"><link rel="prefetch" href="/notes/assets/js/page-transition-group.cc8a2007.js"><link rel="prefetch" href="/notes/assets/js/page-transition.70ec1817.js"><link rel="prefetch" href="/notes/assets/js/page-tsconfigjson的行为.199d6ab8.js"><link rel="prefetch" href="/notes/assets/js/page-typescript综合面试.2701ab99.js"><link rel="prefetch" href="/notes/assets/js/page-update.da692229.js"><link rel="prefetch" href="/notes/assets/js/page-updateClassComponent.76010391.js"><link rel="prefetch" href="/notes/assets/js/page-updateContextConsumer.8c6a0992.js"><link rel="prefetch" href="/notes/assets/js/page-updateContextProvider.fe4c25d7.js"><link rel="prefetch" href="/notes/assets/js/page-updateForwardRef.96307237.js"><link rel="prefetch" href="/notes/assets/js/page-updateFragment.0a740be6.js"><link rel="prefetch" href="/notes/assets/js/page-updateFunctionalComponent.79d64845.js"><link rel="prefetch" href="/notes/assets/js/page-updateHostComponent.31365a67.js"><link rel="prefetch" href="/notes/assets/js/page-updateHostRoot.ebf38e15.js"><link rel="prefetch" href="/notes/assets/js/page-updateHostText.c2dee5fd.js"><link rel="prefetch" href="/notes/assets/js/page-updateMode.b5a6904b.js"><link rel="prefetch" href="/notes/assets/js/page-updatePortalComponent.4a046730.js"><link rel="prefetch" href="/notes/assets/js/page-updateProfiler.dd0fb555.js"><link rel="prefetch" href="/notes/assets/js/page-updateSuspenseComponent.2ccc794d.js"><link rel="prefetch" href="/notes/assets/js/page-useCallbackuseMemo.b643354a.js"><link rel="prefetch" href="/notes/assets/js/page-useContext.b0b5fc61.js"><link rel="prefetch" href="/notes/assets/js/page-useEffect.cc62efb8.js"><link rel="prefetch" href="/notes/assets/js/page-useState.a042c852.js"><link rel="prefetch" href="/notes/assets/js/page-v-model.6d53b4a2.js"><link rel="prefetch" href="/notes/assets/js/page-vue响应式详解（重学前端-vue篇1）.c6f415e0.js"><link rel="prefetch" href="/notes/assets/js/page-vue的优点.a11346ed.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶1-1期】理解JavaScript中的执行上下文和执行栈.6ae4debf.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶1-2期】JavaScript深入之执行上下文栈和变量对象.5b57464e.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶1-3期】JavaScript深入之内存空间详细图解.72fdb0ad.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶1-4期】JavaScript深入之带走进内存机制.08d244b5.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶1-5期】JavaScript深入之4类常见内存泄漏及如何避免.a53496f6.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶2-1期】深入浅出图解作用域链和闭包.2facb247.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶2-2期】JavaScript深入之从作用域链理解闭包.59e44f0a.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶2-3期】JavaScript深入之闭包面试题解.94ca9f08.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶3-1期】JavaScript深入之史上最全--5种this绑定全面解析.dce34930.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶3-2期】JavaScript深入之重新认识箭头函数的this.b2c3e829.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶3-3期】深度广度解析call和apply原理、使用场景及实现.a25eee53.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶3-4期】深度解析bind原理、使用场景及模拟实现.ac7be76f.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶3-5期】深度解析new原理及模拟实现.1bc96023.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶4-1期】详细解析赋值、浅拷贝和深拷贝的区别.c3bf154e.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶4-2期】Objectassign原理及其实现.85404cb6.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶4-3期】面试题之如何实现一个深拷贝.9caecabb.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶4-4期】Lodash是如何实现深拷贝的.0ed617e4.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶5-1期】重新认识构造函数、原型和原型链.36af95ac.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶5-2期】图解原型链及其继承优缺点.fec1c41d.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶5-3期】深入探究FunctionObject鸡蛋问题.fcd0a05e.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶6-1期】JavaScript高阶函数浅析.9178633f.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶6-2期】深入高阶函数应用之柯里化.c1169439.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶6-3期】Array原型方法源码实现大解密.746795aa.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶7-1期】深入浅出节流函数throttle.bdf1e54a.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶7-2期】深入浅出防抖函数debounce.c68805fc.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶7-3期】Throttle和Debounce在React中的应用.f66451d1.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶7-4期】深入篇阿里P6必会Lodash防抖节流函数实现原理.18709347.js"><link rel="prefetch" href="/notes/assets/js/page-【进阶7-5期】浅出篇7个角度吃透Lodash防抖节流原理.a3e46e8f.js"><link rel="prefetch" href="/notes/assets/js/page-一、Webpack原理.c9aa136a.js"><link rel="prefetch" href="/notes/assets/js/page-一、为什么JavaScript是单线程？.c790815d.js"><link rel="prefetch" href="/notes/assets/js/page-一、概述.7ddc6d0d.js"><link rel="prefetch" href="/notes/assets/js/page-一、简介.de137e9c.js"><link rel="prefetch" href="/notes/assets/js/page-一些不能按预期工作的代码.fdcdd490.js"><link rel="prefetch" href="/notes/assets/js/page-一些常见的Feature需求.a9e5de17.js"><link rel="prefetch" href="/notes/assets/js/page-一些常见的「bug」并不是bug.325a0a5b.js"><link rel="prefetch" href="/notes/assets/js/page-一正确理解react-router.1b2d1052.js"><link rel="prefetch" href="/notes/assets/js/page-严格模式.70042882.js"><link rel="prefetch" href="/notes/assets/js/page-中介者模式.06d0b9c4.js"><link rel="prefetch" href="/notes/assets/js/page-事件模块的注入模式.6c1f5b86.js"><link rel="prefetch" href="/notes/assets/js/page-事件监听句柄.82a7c4c3.js"><link rel="prefetch" href="/notes/assets/js/page-事件绑定.010ec82b.js"><link rel="prefetch" href="/notes/assets/js/page-事件触发.dddca0ff.js"><link rel="prefetch" href="/notes/assets/js/page-从JavaScript迁移.87fbe6e5.js"><link rel="prefetch" href="/notes/assets/js/page-从new一个Vue对象开始.5a79644a.js"><link rel="prefetch" href="/notes/assets/js/page-从入口开始.29ea1851.js"><link rel="prefetch" href="/notes/assets/js/page-代理模式.d7c9dcc3.js"><link rel="prefetch" href="/notes/assets/js/page-代码分割.3ed3fb95.js"><link rel="prefetch" href="/notes/assets/js/page-代码分离.f94b8eda.js"><link rel="prefetch" href="/notes/assets/js/page-传参.394c8078.js"><link rel="prefetch" href="/notes/assets/js/page-伪元素.3103069a.js"><link rel="prefetch" href="/notes/assets/js/page-伪类.403aab2c.js"><link rel="prefetch" href="/notes/assets/js/page-作用.1509e0c3.js"><link rel="prefetch" href="/notes/assets/js/page-依赖收集.e29dc932.js"><link rel="prefetch" href="/notes/assets/js/page-元素选择器.cd4d0e87.js"><link rel="prefetch" href="/notes/assets/js/page-入口起点(entrypoints).05274716.js"><link rel="prefetch" href="/notes/assets/js/page-全局属性：用于任何HTML5元素的属性.759fb381.js"><link rel="prefetch" href="/notes/assets/js/page-关于ReactHooks.6d9bd5ab.js"><link rel="prefetch" href="/notes/assets/js/page-具体使用.6344d135.js"><link rel="prefetch" href="/notes/assets/js/page-写一个方法去掉字符串中的空格.0c884ed5.js"><link rel="prefetch" href="/notes/assets/js/page-减少setter属性的使用.3a68f5b0.js"><link rel="prefetch" href="/notes/assets/js/page-函数.a735c4bf.js"><link rel="prefetch" href="/notes/assets/js/page-函数参数.4f6fdc20.js"><link rel="prefetch" href="/notes/assets/js/page-函数式编程.eed56cc9.js"><link rel="prefetch" href="/notes/assets/js/page-创建event对象.7ae4a636.js"><link rel="prefetch" href="/notes/assets/js/page-创建数组.a43b7238.js"><link rel="prefetch" href="/notes/assets/js/page-动态导入表达式.3528c176.js"><link rel="prefetch" href="/notes/assets/js/page-协变与逆变.fcc6d531.js"><link rel="prefetch" href="/notes/assets/js/page-单例模式.e450e026.js"><link rel="prefetch" href="/notes/assets/js/page-原型模式.97fe86f4.js"><link rel="prefetch" href="/notes/assets/js/page-原理图.ba5a54b7.js"><link rel="prefetch" href="/notes/assets/js/page-发射器.393aff1c.js"><link rel="prefetch" href="/notes/assets/js/page-可能不需要使用派生state.9c52d1dd.js"><link rel="prefetch" href="/notes/assets/js/page-可调用的.ab077058.js"><link rel="prefetch" href="/notes/assets/js/page-合并配置.367219c1.js"><link rel="prefetch" href="/notes/assets/js/page-名义化类型.d70fb338.js"><link rel="prefetch" href="/notes/assets/js/page-后代选择器.3cd74807.js"><link rel="prefetch" href="/notes/assets/js/page-命令模式.61e500ff.js"><link rel="prefetch" href="/notes/assets/js/page-命令行的行为.f5154496.js"><link rel="prefetch" href="/notes/assets/js/page-命名空间.5d06b7b8.js"><link rel="prefetch" href="/notes/assets/js/page-响应式对象.2ee09769.js"><link rel="prefetch" href="/notes/assets/js/page-块格式化上下文.a90901f4.js"><link rel="prefetch" href="/notes/assets/js/page-基于字符串的枚举.b325832f.js"><link rel="prefetch" href="/notes/assets/js/page-基本概念.af7f4d5b.js"><link rel="prefetch" href="/notes/assets/js/page-基础分类.84600d20.js"><link rel="prefetch" href="/notes/assets/js/page-声明空间.0097a713.js"><link rel="prefetch" href="/notes/assets/js/page-外观模式.7284cdf9.js"><link rel="prefetch" href="/notes/assets/js/page-外边距重叠.4564a6f5.js"><link rel="prefetch" href="/notes/assets/js/page-如何关闭表单自动填充.cf874c1f.js"><link rel="prefetch" href="/notes/assets/js/page-子选择器.07984c54.js"><link rel="prefetch" href="/notes/assets/js/page-字面量类型.bf205040.js"><link rel="prefetch" href="/notes/assets/js/page-对象字面量的惰性初始化.18858bb2.js"><link rel="prefetch" href="/notes/assets/js/page-层叠上下文.8c4287f6.js"><link rel="prefetch" href="/notes/assets/js/page-展开语法.902d1d55.js"><link rel="prefetch" href="/notes/assets/js/page-展示长列表.426fe902.js"><link rel="prefetch" href="/notes/assets/js/page-属性选择器.00c2c2b0.js"><link rel="prefetch" href="/notes/assets/js/page-工具类.18452eab.js"><link rel="prefetch" href="/notes/assets/js/page-工厂模式.6ce26a7b.js"><link rel="prefetch" href="/notes/assets/js/page-布局和包含块.7f035818.js"><link rel="prefetch" href="/notes/assets/js/page-常用块级元素：.3572e049.js"><link rel="prefetch" href="/notes/assets/js/page-常见的Error.1facf7ef.js"><link rel="prefetch" href="/notes/assets/js/page-并发模型与事件循环.cbcead05.js"><link rel="prefetch" href="/notes/assets/js/page-建造者模式.911237f8.js"><link rel="prefetch" href="/notes/assets/js/page-开始.d6f65311.js"><link rel="prefetch" href="/notes/assets/js/page-异常处理.d76c4711.js"><link rel="prefetch" href="/notes/assets/js/page-异步组件.75ff975f.js"><link rel="prefetch" href="/notes/assets/js/page-引入.16331999.js"><link rel="prefetch" href="/notes/assets/js/page-引用.c96dfe97.js"><link rel="prefetch" href="/notes/assets/js/page-引用官网.0810e54b.js"><link rel="prefetch" href="/notes/assets/js/page-总结.41a90e36.js"><link rel="prefetch" href="/notes/assets/js/page-惰性初始模式.de74d892.js"><link rel="prefetch" href="/notes/assets/js/page-扩展.9c8f5660.js"><link rel="prefetch" href="/notes/assets/js/page-扫描器.e3ae2c61.js"><link rel="prefetch" href="/notes/assets/js/page-抽象DOM树.f960fde9.js"><link rel="prefetch" href="/notes/assets/js/page-抽象语法树.fe0f9726.js"><link rel="prefetch" href="/notes/assets/js/page-接口.539b2813.js"><link rel="prefetch" href="/notes/assets/js/page-插件.48415e77.js"><link rel="prefetch" href="/notes/assets/js/page-操作DOM.3bf9e1d2.js"><link rel="prefetch" href="/notes/assets/js/page-支持JSX.c19e5df5.js"><link rel="prefetch" href="/notes/assets/js/page-改善antdTable组件的渲染效率.d382b9f8.js"><link rel="prefetch" href="/notes/assets/js/page-数据绑定原理.6bd49f2a.js"><link rel="prefetch" href="/notes/assets/js/page-数据驱动.3fcc4b94.js"><link rel="prefetch" href="/notes/assets/js/page-文档声明区别.909041c2.js"><link rel="prefetch" href="/notes/assets/js/page-新js环境要求.40b6b6ea.js"><link rel="prefetch" href="/notes/assets/js/page-暴露模块模式.fff5aa53.js"><link rel="prefetch" href="/notes/assets/js/page-服务器基础.ab1929e8.js"><link rel="prefetch" href="/notes/assets/js/page-术语表.29e3bac5.js"><link rel="prefetch" href="/notes/assets/js/page-构建切换.10f94d67.js"><link rel="prefetch" href="/notes/assets/js/page-构造器模式.6da13573.js"><link rel="prefetch" href="/notes/assets/js/page-枚举.89fbb366.js"><link rel="prefetch" href="/notes/assets/js/page-柯里化.bf92eba7.js"><link rel="prefetch" href="/notes/assets/js/page-标准的CSS的盒子模型？低版本IE的盒子模型.096f704f.js"><link rel="prefetch" href="/notes/assets/js/page-检查器.407bc52a.js"><link rel="prefetch" href="/notes/assets/js/page-检测变化的注意事项.fe59d269.js"><link rel="prefetch" href="/notes/assets/js/page-概念.321e85ba.js"><link rel="prefetch" href="/notes/assets/js/page-概览.694bc311.js"><link rel="prefetch" href="/notes/assets/js/page-模块.6e782854.js"><link rel="prefetch" href="/notes/assets/js/page-模块化模式.22cb1678.js"><link rel="prefetch" href="/notes/assets/js/page-泛型.d5722dfe.js"><link rel="prefetch" href="/notes/assets/js/page-泛型的实例化类型.b63408a4.js"><link rel="prefetch" href="/notes/assets/js/page-派发更新.07f26b62.js"><link rel="prefetch" href="/notes/assets/js/page-流动的类型.4d21248b.js"><link rel="prefetch" href="/notes/assets/js/page-浏览器输入URL.92bfd115.js"><link rel="prefetch" href="/notes/assets/js/page-深入TypeScript.2d7f1e30.js"><link rel="prefetch" href="/notes/assets/js/page-深入响应式原理.01e3c9e1.js"><link rel="prefetch" href="/notes/assets/js/page-深入源码剖析componentWillXXX为什么UNSAFE.45b8c853.js"><link rel="prefetch" href="/notes/assets/js/page-混合.61f95a23.js"><link rel="prefetch" href="/notes/assets/js/page-状态函数.e416e7de.js"><link rel="prefetch" href="/notes/assets/js/page-环境声明.22addff8.js"><link rel="prefetch" href="/notes/assets/js/page-生命周期.c9e56a06.js"><link rel="prefetch" href="/notes/assets/js/page-用递归算法实现，数组长度为5且元素的随机数在2-32间不重复的值.ba2ba02e.js"><link rel="prefetch" href="/notes/assets/js/page-相邻兄弟选择器.8c52e106.js"><link rel="prefetch" href="/notes/assets/js/page-知识体系.aee6234d.js"><link rel="prefetch" href="/notes/assets/js/page-程序.313ff437.js"><link rel="prefetch" href="/notes/assets/js/page-第10天简要描述下什么是回调函数并写一个例子出来.eb1d24a7.js"><link rel="prefetch" href="/notes/assets/js/page-第11天简要描述下JS有哪些内置的对象.1ccc1b9a.js"><link rel="prefetch" href="/notes/assets/js/page-第12天写一个获取当前url查询字符串中的参数的方法.8fdd21cf.js"><link rel="prefetch" href="/notes/assets/js/page-第13天说说你对javascript的作用域的理解.50a30221.js"><link rel="prefetch" href="/notes/assets/js/page-第14天什么是闭包？优缺点分别是什么？.95a2f41b.js"><link rel="prefetch" href="/notes/assets/js/page-第15天写一个数组去重的方法（支持多维数组）.22812ecd.js"><link rel="prefetch" href="/notes/assets/js/page-第16天返回到顶部的方法有哪些？把其中一个方法出来.1679f641.js"><link rel="prefetch" href="/notes/assets/js/page-第17天typeof('abc')和typeof'abc'都是string,那么typeof是操作符还是函数？.cc7af410.js"><link rel="prefetch" href="/notes/assets/js/page-第18天你理解的usestrict;是什么使用它有什么优缺点？.e2287427.js"><link rel="prefetch" href="/notes/assets/js/page-第19天attribute和property有什么不同？.e4ebdf38.js"><link rel="prefetch" href="/notes/assets/js/page-第1天用递归算法实现，数组长度为5且元素的随机数在2-32间不重复的值.fb26cb76.js"><link rel="prefetch" href="/notes/assets/js/page-第20天写一个验证身份证号的方法.36121ec9.js"><link rel="prefetch" href="/notes/assets/js/page-第21天写一个方法验证是否为中文.7b94428d.js"><link rel="prefetch" href="/notes/assets/js/page-第22天你对new操作符的理解是什么？手动实现一个new方法.7dda0731.js"><link rel="prefetch" href="/notes/assets/js/page-第23天01+02、01+03和0102分别等于多少？并解释下为什么？.65835418.js"><link rel="prefetch" href="/notes/assets/js/page-第24天如何快速让一个数组乱序，写出来.27b22734.js"><link rel="prefetch" href="/notes/assets/js/page-第25天写一个判断设备来源的方法.510f929c.js"><link rel="prefetch" href="/notes/assets/js/page-第26天说说bind、call、apply的区别？并手写实现一个bind的方法.a1732494.js"><link rel="prefetch" href="/notes/assets/js/page-第27天说说你对arguments的理解，它是数组吗？.5de6a730.js"><link rel="prefetch" href="/notes/assets/js/page-第28天解释下这段代码的意思！.03518d0d.js"><link rel="prefetch" href="/notes/assets/js/page-第29天写一个获取数组的最大值、最小值的方法.4af0f34c.js"><link rel="prefetch" href="/notes/assets/js/page-第2天写一个方法去掉字符串中的空格.4c649ca8.js"><link rel="prefetch" href="/notes/assets/js/page-第30天写一个方法判断字符串是否为回文字符串.a1eef47b.js"><link rel="prefetch" href="/notes/assets/js/page-第3天去除字符串中最后一个指定的字符.0718679f.js"><link rel="prefetch" href="/notes/assets/js/page-第4天写一个方法把下划线命名转成大驼峰命名.25e90f42.js"><link rel="prefetch" href="/notes/assets/js/page-第5天写一个把字符串大小写切换的方法.0109beb5.js"><link rel="prefetch" href="/notes/assets/js/page-第6天写一个去除制表符和换行符的方法.31f8072f.js"><link rel="prefetch" href="/notes/assets/js/page-第7天统计某一字符或字符串在另一个字符串中出现的次数.6655c44f.js"><link rel="prefetch" href="/notes/assets/js/page-第8天写一个加密字符串的方法.af709075.js"><link rel="prefetch" href="/notes/assets/js/page-第9天写一个判断数据类型的方法.1cf64427.js"><link rel="prefetch" href="/notes/assets/js/page-第一套js综合基础面试题.fddd3f4d.js"><link rel="prefetch" href="/notes/assets/js/page-第一套webpack综合基础面试题.4ea7b961.js"><link rel="prefetch" href="/notes/assets/js/page-管理资源.603907f9.js"><link rel="prefetch" href="/notes/assets/js/page-类.75ebb26e.js"><link rel="prefetch" href="/notes/assets/js/page-类型保护.8bf6f8e8.js"><link rel="prefetch" href="/notes/assets/js/page-类型兼容性.63778448.js"><link rel="prefetch" href="/notes/assets/js/page-类型守卫.b226cf4b.js"><link rel="prefetch" href="/notes/assets/js/page-类型安全的EventEmitter.754219d7.js"><link rel="prefetch" href="/notes/assets/js/page-类型推断.4ad5abf9.js"><link rel="prefetch" href="/notes/assets/js/page-类型断言.f3a0c7b2.js"><link rel="prefetch" href="/notes/assets/js/page-类型系统的行为.27f7974d.js"><link rel="prefetch" href="/notes/assets/js/page-类是有用的.efa81ec4.js"><link rel="prefetch" href="/notes/assets/js/page-类选择器.ed91ca17.js"><link rel="prefetch" href="/notes/assets/js/page-索引签名.b8256cce.js"><link rel="prefetch" href="/notes/assets/js/page-组件化.01ea3820.js"><link rel="prefetch" href="/notes/assets/js/page-组件卸载前，加在DOM元素的监听事件和定时器要不要手动清除.586dffa2.js"><link rel="prefetch" href="/notes/assets/js/page-组件更新.457b090b.js"><link rel="prefetch" href="/notes/assets/js/page-组件注册.f56b1e40.js"><link rel="prefetch" href="/notes/assets/js/page-组件类.8496fbb4.js"><link rel="prefetch" href="/notes/assets/js/page-组合模式.e51951a6.js"><link rel="prefetch" href="/notes/assets/js/page-绑定器.13f30b1b.js"><link rel="prefetch" href="/notes/assets/js/page-结论.9b0707a5.js"><link rel="prefetch" href="/notes/assets/js/page-编译.1cea8fff.js"><link rel="prefetch" href="/notes/assets/js/page-编译上下文.2b07d890.js"><link rel="prefetch" href="/notes/assets/js/page-编译入口.6473c47a.js"><link rel="prefetch" href="/notes/assets/js/page-网站favicon图标.c7943fe4.js"><link rel="prefetch" href="/notes/assets/js/page-自定义hooks.3ac50c6a.js"><link rel="prefetch" href="/notes/assets/js/page-获取localStorage和sessionStorage当前已存储大小.71800410.js"><link rel="prefetch" href="/notes/assets/js/page-虚拟DOM和DOM-diff.4526ad62.js"><link rel="prefetch" href="/notes/assets/js/page-表单数据.d146cccd.js"><link rel="prefetch" href="/notes/assets/js/page-装饰器.da2175ac.js"><link rel="prefetch" href="/notes/assets/js/page-装饰模式.5a1c304e.js"><link rel="prefetch" href="/notes/assets/js/page-观察者模式.568e4a13.js"><link rel="prefetch" href="/notes/assets/js/page-解析器.302585c5.js"><link rel="prefetch" href="/notes/assets/js/page-解读Errors.0e63f05f.js"><link rel="prefetch" href="/notes/assets/js/page-计算属性VS侦听属性.9d6c4da0.js"><link rel="prefetch" href="/notes/assets/js/page-认识Flow.76c04a37.js"><link rel="prefetch" href="/notes/assets/js/page-评论.db41ddde.js"><link rel="prefetch" href="/notes/assets/js/page-详解箭头函数和普通函数的区别以及箭头函数的注意事项、不适用场景.285c86ae.js"><link rel="prefetch" href="/notes/assets/js/page-说说对SPA单页面的理解，它的优缺点分别是什么？.947a6dcd.js"><link rel="prefetch" href="/notes/assets/js/page-调和的过程.8643eb2d.js"><link rel="prefetch" href="/notes/assets/js/page-调度原理.34782409.js"><link rel="prefetch" href="/notes/assets/js/page-谨慎使用--outFile.96b41432.js"><link rel="prefetch" href="/notes/assets/js/page-超链接target属性.e46e68be.js"><link rel="prefetch" href="/notes/assets/js/page-路径切换.ed0d2904.js"><link rel="prefetch" href="/notes/assets/js/page-路由注册.0c6ee583.js"><link rel="prefetch" href="/notes/assets/js/page-输出(output).2900dc34.js"><link rel="prefetch" href="/notes/assets/js/page-辨析联合类型.fe15f04e.js"><link rel="prefetch" href="/notes/assets/js/page-迭代协议.ca70361c.js"><link rel="prefetch" href="/notes/assets/js/page-迭代器模式.eec927d7.js"><link rel="prefetch" href="/notes/assets/js/page-适配器模式.95228c65.js"><link rel="prefetch" href="/notes/assets/js/page-选择器列表.909c24d6.js"><link rel="prefetch" href="/notes/assets/js/page-通用兄弟选择器.1862b706.js"><link rel="prefetch" href="/notes/assets/js/page-通过标签语义化优化SEO.a026e87f.js"><link rel="prefetch" href="/notes/assets/js/page-通配选择器.0b0615d8.js"><link rel="prefetch" href="/notes/assets/js/page-需求分析.d1940391.js"><link rel="prefetch" href="/notes/assets/js/page-非ReactJSX.bb97dfa2.js"><link rel="prefetch" href="/notes/assets/js/page-项目性能优化.2931b042.js"><link rel="prefetch" href="/notes/assets/js/page-🗿HEAD.e8ba8f72.js"><link rel="prefetch" href="/notes/assets/js/vendors~flowchart.2c54680e.js"><link rel="prefetch" href="/notes/assets/js/vendors~mermaid.caad9366.js"><link rel="prefetch" href="/notes/assets/js/vendors~photo-swipe.2a25800b.js">
    <link rel="stylesheet" href="/notes/assets/css/0.styles.672a4c15.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container has-navbar has-sidebar has-anchor"><header class="navbar"><!----> <div class="content__navbar-start"></div> <button title="Sidebar Button" class="sidebar-button"><span class="icon"></span></button> <a href="/notes/" class="home-link router-link-active"><!----> <!----> <span class="site-name can-hide">前端 学习</span></a> <!----> <div class="content__navbar-center"></div> <div class="links"><button tabindex="-1" aria-hidden="true" class="color-button"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="skin-icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4
        38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32
        51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0
        102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2
        6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4
        0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2
        9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224
        419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4
        470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0
        22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6
        12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128
        505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2
        16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8
        86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4
        80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6
        6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><ul class="themecolor-select"><label for="themecolor-select">Theme Color:</label> <li><span class="default-theme"></span></li> </ul> <div class="darkmode-toggle"><label for="darkmode-toggle" class="desc">Theme Mode:</label> <div class="darkmode-switch"><div class="item day"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon light-icon"><path d="M512 256a42.667 42.667 0 0 0 42.667-42.667V128a42.667 42.667 0 0 0-85.334 0v85.333A42.667 42.667 0 0 0 512 256zm384 213.333h-85.333a42.667 42.667 0 0 0 0 85.334H896a42.667 42.667 0 0 0 0-85.334zM256 512a42.667 42.667 0 0 0-42.667-42.667H128a42.667 42.667 0 0 0 0 85.334h85.333A42.667 42.667 0 0 0 256 512zm9.387-298.667a42.667 42.667 0 0 0-59.307 62.72l61.44 59.307a42.667 42.667 0 0 0 31.147 11.947 42.667 42.667 0 0 0 30.72-13.227 42.667 42.667 0 0 0 0-60.16zm459.946 133.974a42.667 42.667 0 0 0 29.44-11.947l61.44-59.307a42.667 42.667 0 0 0-57.6-62.72l-61.44 60.587a42.667 42.667 0 0 0 0 60.16 42.667 42.667 0 0 0 28.16 13.227zM512 768a42.667 42.667 0 0 0-42.667 42.667V896a42.667 42.667 0 0 0 85.334 0v-85.333A42.667 42.667 0 0 0 512 768zm244.48-79.36a42.667 42.667 0 0 0-59.307 61.44l61.44 60.587a42.667 42.667 0 0 0 29.44 11.946 42.667 42.667 0 0 0 30.72-12.8 42.667 42.667 0 0 0 0-60.586zm-488.96 0-61.44 59.307a42.667 42.667 0 0 0 0 60.586 42.667 42.667 0 0 0 30.72 12.8 42.667 42.667 0 0 0 28.587-10.666l61.44-59.307a42.667 42.667 0 0 0-59.307-61.44zM512 341.333A170.667 170.667 0 1 0 682.667 512 170.667 170.667 0 0 0 512 341.333z" fill="currentColor"></path></svg></div> <div class="item auto active"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon auto-icon"><path d="M460.864 539.072H564.8L510.592 376l-49.728 163.072zM872 362.368V149.504H659.648L510.528 0l-149.12 149.504H149.12v212.928L0 511.872l149.12 149.504v212.928h212.352l149.12 149.504 149.12-149.504h212.352V661.376l149.12-149.504L872 362.368zM614.464 693.12l-31.616-90.624H438.272l-31.616 90.624h-85.888l144.576-407.68h90.368l144.576 407.68h-85.824zm0 0" fill="currentColor"></path></svg></div> <div class="item night"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon dark-icon"><path d="M935.539 630.402c-11.43-11.432-28.674-14.739-43.531-8.354-46.734 20.103-96.363 30.297-147.508 30.297-99.59 0-193.221-38.784-263.64-109.203-108.637-108.637-139.61-270.022-78.908-411.148a39.497 39.497 0 0 0-51.886-51.887c-52.637 22.64-100.017 54.81-140.826 95.616-85.346 85.346-132.346 198.821-132.346 319.52 0 120.7 47.001 234.172 132.347 319.519S408.063 947.11 528.76 947.11c120.7 0 234.172-47.003 319.52-132.351 40.809-40.81 72.978-88.19 95.616-140.826a39.497 39.497 0 0 0-8.356-43.532z" fill="currentColor"></path></svg></div></div> <!----></div></div></div></button> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="js" class="dropdown-title"><span class="title"><!---->
        js
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/notes/mozillajs/baseObject/symbol.html" class="nav-link"><!---->
  mozilla：基本对象
</a></li><li class="dropdown-item"><a href="/notes/jsInterview/baseInterview.html" class="nav-link"><!---->
  基础面试题
</a></li><li class="dropdown-item"><a href="/notes/js/stack/executionStack.html" class="nav-link"><!---->
  js 概念
</a></li><li class="dropdown-item"><a href="/notes/es6/interview1.html" class="nav-link"><!---->
  es6
</a></li><li class="dropdown-item"><a href="/notes/es7/interview1.html" class="nav-link"><!---->
  es7
</a></li><li class="dropdown-item"><a href="/notes/es8/interview1.html" class="nav-link"><!---->
  es8
</a></li><li class="dropdown-item"><a href="/notes/es9/interview1.html" class="nav-link"><!---->
  es9
</a></li><li class="dropdown-item"><a href="/notes/es10/interview1.html" class="nav-link"><!---->
  es10
</a></li><li class="dropdown-item"><a href="/notes/ts/jsx/support.html" class="nav-link"><!---->
  JSX
</a></li><li class="dropdown-item"><a href="/notes/ts/project/inDepthTs.html" class="nav-link"><!---->
  TypeScript 项目
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="css" class="dropdown-title"><span class="title"><!---->
        css
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/notes/mozillaCss/reference/universalSelectors.html" class="nav-link"><!---->
  第 1 期：CSS API
</a></li><li class="dropdown-item"><a href="/notes/css/interview/baseCss.html" class="nav-link"><!---->
  零散记录
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="html" class="dropdown-title"><span class="title"><!---->
        html
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/notes/html/interview/linkImport.html" class="nav-link"><!---->
  零散记录
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="端" class="dropdown-title"><span class="title"><!---->
        端
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/notes/browser/interview/baseInterview.html" class="nav-link"><!---->
  基础浏览器
</a></li><li class="dropdown-item"><a href="/notes/http/interview/baseInterview.html" class="nav-link"><!---->
  基础http
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><span class="title"><!---->
        工具
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/notes/webpack/interview/webpackInterview.html" class="nav-link"><!---->
  webpack
</a></li><li class="dropdown-item"><a href="/notes/esbuild/description.html" class="nav-link"><!---->
  esbuild
</a></li><li class="dropdown-item"><a href="/notes/git/indx.html" class="nav-link"><!---->
  git
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="react" class="dropdown-title"><span class="title"><!---->
        react
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/notes/ILoveDevelop/react/principle/base.html" class="nav-link"><!---->
  react 源码阅读 代码视角
</a></li><li class="dropdown-item"><a href="/notes/react/preparation/idea.html" class="nav-link"><!---->
  react 源码阅读 思想视角
</a></li><li class="dropdown-item"><a href="/notes/umi/interview/pluginDva.html" class="nav-link"><!---->
  umi
</a></li><li class="dropdown-item"><a href="/notes/reactInterview/interview1.html" class="nav-link"><!---->
  整理
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="vue" class="dropdown-title"><span class="title"><!---->
        vue
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/notes/vue/prepare/flow.html" class="nav-link"><!---->
  第 1 期：源码解读-准备工作
</a></li><li class="dropdown-item"><a href="/notes/vue/data-driven/_index.html" class="nav-link"><!---->
  第2期：源码解读-数据驱动
</a></li><li class="dropdown-item"><a href="/notes/vue/components/create-component.html" class="nav-link"><!---->
  第3期：源码解读-组件化
</a></li><li class="dropdown-item"><a href="/notes/vue/reactive/reactive-object.html" class="nav-link"><!---->
  第4期：源码解读-深入响应式原理
</a></li><li class="dropdown-item"><a href="/notes/vue/compile/entrance.html" class="nav-link"><!---->
  第5期：源码解读-编译
</a></li><li class="dropdown-item"><a href="/notes/vue/extend/event.html" class="nav-link"><!---->
  第6期：源码解读-扩展
</a></li><li class="dropdown-item"><a href="/notes/vue/vue-router/install.html" class="nav-link"><!---->
  第7期：源码解读-VueRouter
</a></li><li class="dropdown-item"><a href="/notes/vue/vuex/idex.html" class="nav-link"><!---->
  第8期：源码解读-Vuex
</a></li><li class="dropdown-item"><a href="/notes/vue/interview/baseInterview.html" class="nav-link"><!---->
  第9期：基础面试题
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法&amp;设计" class="dropdown-title"><span class="title"><!---->
        算法&amp;设计
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/notes/algorithm/interview/baseInterview.html" class="nav-link"><!---->
  第 1 期：基础面试题
</a></li><li class="dropdown-item"><a href="/notes/design/overview.html" class="nav-link"><!---->
  设计模式
</a></li></ul></div></div></nav> <!----> <!----> <!----> <div class="content__navbar-end"></div></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!----> <!----> <div class="content__sidebar-top"></div> <nav class="sidebar-nav-links"><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="js" class="dropdown-title"><span class="title"><!---->
      js
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/mozillajs/baseObject/symbol.html" class="nav-link"><!---->
  mozilla：基本对象
</a></li><li class="dropdown-item"><!----> <a href="/notes/jsInterview/baseInterview.html" class="nav-link"><!---->
  基础面试题
</a></li><li class="dropdown-item"><!----> <a href="/notes/js/stack/executionStack.html" class="nav-link"><!---->
  js 概念
</a></li><li class="dropdown-item"><!----> <a href="/notes/es6/interview1.html" class="nav-link"><!---->
  es6
</a></li><li class="dropdown-item"><!----> <a href="/notes/es7/interview1.html" class="nav-link"><!---->
  es7
</a></li><li class="dropdown-item"><!----> <a href="/notes/es8/interview1.html" class="nav-link"><!---->
  es8
</a></li><li class="dropdown-item"><!----> <a href="/notes/es9/interview1.html" class="nav-link"><!---->
  es9
</a></li><li class="dropdown-item"><!----> <a href="/notes/es10/interview1.html" class="nav-link"><!---->
  es10
</a></li><li class="dropdown-item"><!----> <a href="/notes/ts/jsx/support.html" class="nav-link"><!---->
  JSX
</a></li><li class="dropdown-item"><!----> <a href="/notes/ts/project/inDepthTs.html" class="nav-link"><!---->
  TypeScript 项目
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="css" class="dropdown-title"><span class="title"><!---->
      css
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/mozillaCss/reference/universalSelectors.html" class="nav-link"><!---->
  第 1 期：CSS API
</a></li><li class="dropdown-item"><!----> <a href="/notes/css/interview/baseCss.html" class="nav-link"><!---->
  零散记录
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="html" class="dropdown-title"><span class="title"><!---->
      html
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/html/interview/linkImport.html" class="nav-link"><!---->
  零散记录
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="端" class="dropdown-title"><span class="title"><!---->
      端
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/browser/interview/baseInterview.html" class="nav-link"><!---->
  基础浏览器
</a></li><li class="dropdown-item"><!----> <a href="/notes/http/interview/baseInterview.html" class="nav-link"><!---->
  基础http
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><span class="title"><!---->
      工具
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/webpack/interview/webpackInterview.html" class="nav-link"><!---->
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/notes/esbuild/description.html" class="nav-link"><!---->
  esbuild
</a></li><li class="dropdown-item"><!----> <a href="/notes/git/indx.html" class="nav-link"><!---->
  git
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="react" class="dropdown-title"><span class="title"><!---->
      react
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/ILoveDevelop/react/principle/base.html" class="nav-link"><!---->
  react 源码阅读 代码视角
</a></li><li class="dropdown-item"><!----> <a href="/notes/react/preparation/idea.html" class="nav-link"><!---->
  react 源码阅读 思想视角
</a></li><li class="dropdown-item"><!----> <a href="/notes/umi/interview/pluginDva.html" class="nav-link"><!---->
  umi
</a></li><li class="dropdown-item"><!----> <a href="/notes/reactInterview/interview1.html" class="nav-link"><!---->
  整理
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="vue" class="dropdown-title"><span class="title"><!---->
      vue
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/vue/prepare/flow.html" class="nav-link"><!---->
  第 1 期：源码解读-准备工作
</a></li><li class="dropdown-item"><!----> <a href="/notes/vue/data-driven/_index.html" class="nav-link"><!---->
  第2期：源码解读-数据驱动
</a></li><li class="dropdown-item"><!----> <a href="/notes/vue/components/create-component.html" class="nav-link"><!---->
  第3期：源码解读-组件化
</a></li><li class="dropdown-item"><!----> <a href="/notes/vue/reactive/reactive-object.html" class="nav-link"><!---->
  第4期：源码解读-深入响应式原理
</a></li><li class="dropdown-item"><!----> <a href="/notes/vue/compile/entrance.html" class="nav-link"><!---->
  第5期：源码解读-编译
</a></li><li class="dropdown-item"><!----> <a href="/notes/vue/extend/event.html" class="nav-link"><!---->
  第6期：源码解读-扩展
</a></li><li class="dropdown-item"><!----> <a href="/notes/vue/vue-router/install.html" class="nav-link"><!---->
  第7期：源码解读-VueRouter
</a></li><li class="dropdown-item"><!----> <a href="/notes/vue/vuex/idex.html" class="nav-link"><!---->
  第8期：源码解读-Vuex
</a></li><li class="dropdown-item"><!----> <a href="/notes/vue/interview/baseInterview.html" class="nav-link"><!---->
  第9期：基础面试题
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="算法&amp;设计" class="dropdown-title"><span class="title"><!---->
      算法&amp;设计
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/algorithm/interview/baseInterview.html" class="nav-link"><!---->
  第 1 期：基础面试题
</a></li><li class="dropdown-item"><!----> <a href="/notes/design/overview.html" class="nav-link"><!---->
  设计模式
</a></li></ul></div></div> <!----></nav> <!----> <div class="content__sidebar-center"></div> <ul class="sidebar-links"><li><a href="/notes/design/functionalProgramming/" class="sidebar-link">函数式编程</a></li><li><a href="/notes/design/overview/" class="sidebar-link">JavaScript 设计模式的分类</a></li><li><a href="/notes/design/constructor/" class="sidebar-link">构造器模式</a></li><li><a href="/notes/design/module/" class="sidebar-link">模块化模式</a></li><li><a href="/notes/design/exposed/" class="sidebar-link">暴露模块模式</a></li><li><a href="/notes/design/singleton/" class="sidebar-link">单例模式</a></li><li><a href="/notes/design/observer/" class="sidebar-link">观察者模式</a></li><li><a href="/notes/design/intermediary/" class="sidebar-link">中介者模式</a></li><li><a href="/notes/design/prototype/" class="sidebar-link">原型模式</a></li><li><a href="/notes/design/command/" class="sidebar-link">命令模式</a></li><li><a href="/notes/design/exterior/" class="sidebar-link">外观模式</a></li><li><a href="/notes/design/factory/" class="sidebar-link">工厂模式</a></li><li><a href="/notes/design/mixin/" class="sidebar-link">Mixin模式</a></li><li><a href="/notes/design/decoration/" class="sidebar-link">装饰模式</a></li><li><a href="/notes/design/flyweight/" class="sidebar-link">Flyweight模式</a></li><li><a href="/notes/design/mvc/" class="sidebar-link">MVC模式</a></li><li><a href="/notes/design/mvp/" class="sidebar-link">MVP模式</a></li><li><a href="/notes/design/mvvm/" class="sidebar-link">MVVM</a></li><li><a href="/notes/design/combination/" class="sidebar-link">组合模式</a></li><li><a href="/notes/design/adapter/" class="sidebar-link">适配器模式</a></li><li><a href="/notes/design/outward/" class="sidebar-link">外观模式</a></li><li><a href="/notes/design/censorJquery/" class="sidebar-link">观察者模式</a></li><li><a href="/notes/design/iterator/" class="sidebar-link">迭代器模式</a></li><li><a href="/notes/design/lazyInitial/" class="sidebar-link">惰性初始模式</a></li><li><a href="/notes/design/proxy/" class="sidebar-link">代理模式</a></li><li><a href="/notes/design/builder/" class="sidebar-link">建造者模式</a></li><li><a href="/notes/design/amd/" class="sidebar-link">AMD 模块</a></li><li><a href="/notes/design/commonJS/" class="sidebar-link">CommonJS</a></li><li><a href="/notes/design/esHarmony/" aria-current="page" class="active sidebar-link">es6 module</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/design/esHarmony/#es-harmony" class="sidebar-link">ES Harmony</a></li><li class="sidebar-sub-header"><a href="/notes/design/esHarmony/#使用导入和导出的模块" class="sidebar-link">使用导入和导出的模块</a></li><li class="sidebar-sub-header"><a href="/notes/design/esHarmony/#从远程来源加载的模块" class="sidebar-link">从远程来源加载的模块</a></li><li class="sidebar-sub-header"><a href="/notes/design/esHarmony/#模块加载api" class="sidebar-link">模块加载API</a></li><li class="sidebar-sub-header"><a href="/notes/design/esHarmony/#针对服务器的commonjs类似模块" class="sidebar-link">针对服务器的CommonJS类似模块</a></li><li class="sidebar-sub-header"><a href="/notes/design/esHarmony/#带有构造器-get和set方法的类" class="sidebar-link">带有构造器，Get和Set方法的类</a></li><li class="sidebar-sub-header"><a href="/notes/design/esHarmony/#es6-module-相对于-commonjs-的优势" class="sidebar-link">ES6 Module 相对于 CommonJS 的优势</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/design/esHarmony/#_1-加载方式" class="sidebar-link heading3">1 加载方式</a></li><li class="sidebar-sub-header"><a href="/notes/design/esHarmony/#_2-编译优化" class="sidebar-link heading3">2 编译优化</a></li><li class="sidebar-sub-header"><a href="/notes/design/esHarmony/#_3-加载原理-引入性质" class="sidebar-link heading3">3 加载原理 &amp; 引入性质</a></li><li class="sidebar-sub-header"><a href="/notes/design/esHarmony/#_4-模块作用域" class="sidebar-link heading3">4 模块作用域</a></li></ul></li></ul></li></ul> <!----> <div class="content__sidebar-bottom"></div> <!----></aside> <main class="page"><nav class="breadcrumb disable"><!----></nav> <!----> <div class="content__page-top"></div> <div vocab="https://schema.org/" typeof="Article" class="page-title"><h1><!----> <span property="headline">es6 module</span></h1> <div class="page-info"><!----> <!----><!----><span aria-label="Writing Date📅" data-balloon-pos="down" class="time-info"><svg viewBox="0 0 1030 1024" xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 0 1-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 0 1-33.473-33.473V143.657H180.6A134.314 134.314 0 0 0 46.66 277.595v535.756A134.314 134.314 0 0 0 180.6 947.289h669.74a134.36 134.36 0 0 0 133.94-133.938V277.595a134.314 134.314 0 0 0-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 0 1-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 0 1-33.472 33.473z" fill="currentColor"></path></svg> <span property="datePublished">2021-8-24</span></span><!----><!----><span aria-label="Reading Time⌛" data-balloon-pos="down" class="reading-time-info"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon timer-icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z" fill="currentColor"></path></svg> <span>About 22 min</span> <meta property="timeRequired" content="PT22M"></span></div> <!----> <hr></div> <div class="anchor-place-holder"><aside id="anchor"><div class="anchor-wrapper"><ul class="anchor-list"><li class="anchor"><a href="/notes/design/esHarmony/#es-harmony" class="anchor-link heading2"><div>ES Harmony</div></a></li><li class="anchor"><a href="/notes/design/esHarmony/#使用导入和导出的模块" class="anchor-link heading2"><div>使用导入和导出的模块</div></a></li><li class="anchor"><a href="/notes/design/esHarmony/#从远程来源加载的模块" class="anchor-link heading2"><div>从远程来源加载的模块</div></a></li><li class="anchor"><a href="/notes/design/esHarmony/#模块加载api" class="anchor-link heading2"><div>模块加载API</div></a></li><li class="anchor"><a href="/notes/design/esHarmony/#针对服务器的commonjs类似模块" class="anchor-link heading2"><div>针对服务器的CommonJS类似模块</div></a></li><li class="anchor"><a href="/notes/design/esHarmony/#带有构造器-get和set方法的类" class="anchor-link heading2"><div>带有构造器，Get和Set方法的类</div></a></li><li class="anchor"><a href="/notes/design/esHarmony/#es6-module-相对于-commonjs-的优势" class="anchor-link heading2"><div>ES6 Module 相对于 CommonJS 的优势</div></a></li><li class="anchor"><a href="/notes/design/esHarmony/#_1-加载方式" class="anchor-link heading3"><div>1 加载方式</div></a></li><li class="anchor"><a href="/notes/design/esHarmony/#_2-编译优化" class="anchor-link heading3"><div>2 编译优化</div></a></li><li class="anchor"><a href="/notes/design/esHarmony/#_3-加载原理-引入性质" class="anchor-link heading3"><div>3 加载原理 &amp; 引入性质</div></a></li><li class="anchor"><a href="/notes/design/esHarmony/#_4-模块作用域" class="anchor-link heading3"><div>4 模块作用域</div></a></li></ul></div></aside></div> <!----> <div class="content__content-top"></div> <div class="theme-default-content content__default"><h1 id="es6-module"><a href="#es6-module" class="header-anchor">#</a> es6 module</h1> <h2 id="es-harmony"><a href="#es-harmony" class="header-anchor">#</a> ES Harmony</h2> <p>TC39，负责讨论ECMAScript语法和语义定义问题和其未来迭代的标准机构，它是由许多的非常聪明的开发者组成的。这些开发者中的一些人（比如Alex Russell）对Javascript在大规模开发中的用例场景在过去几年一直保持者密切的关注，并且敏锐的意识到了人们对于能够使用其编写更加模块化JS的优良的语言特性的需求。 出于这个原因，目前已经有大量激动人心的，包括在客户端和服务器上都能起作用的弹性模块，一个模块加载器以及更多的对语言的改进提议。</p> <blockquote><p>注意：尽管Harmony仍然处于建设性阶段，也已经可以尝试ES.next的（部分）特性了，而这得感谢Google的Traceur编译器为模块化的Javascript提供的原生支持。为了在短时间内使Traceur启动和运作起来，读一读这份初学指导吧。如果对更深入的了解这个项目感兴趣的话，一个关于它JSConf展示就值得看一看。</p></blockquote> <h2 id="使用导入和导出的模块"><a href="#使用导入和导出的模块" class="header-anchor">#</a> 使用导入和导出的模块</h2> <blockquote><p>已经通读过<code>AMD</code>和<code>CommonJS</code>章节的话，你也许熟悉模块依赖（导入）和模块导出（或者说是允许其它模块使用的公共API/变量）这两个概念。在<code>ES.next</code>中，这些概念已经使用一种同预期没太大不同，而开发者将可以在代码示例中往下看到并且能瞬间抓住的用一个<code>export</code>关键字指定依赖的稍微更简洁的方式，被提供了出来。</p></blockquote> <ul><li><p><code>import</code>声明绑定了一个以本地变量身份导出的模块，而且可能被重命名以避免名称重复或冲突。</p></li> <li><p><code>export</code>声明声明了模块本地绑定的外部可见性，那样其他模块就可能读取到导出但不能修改它们。有趣的是，模块可能导出子模块但不能够导出已经在另外一个地方定义的模块。也可以对导出进行重命名以便它们的外部名称同本地名称有所不同。</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module staff<span class="token punctuation">{</span>
    <span class="token comment">// specify (public) exports that can be consumed by</span>
    <span class="token comment">// other modules</span>
    <span class="token keyword">export</span> <span class="token keyword">var</span> baker <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">bake</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">item</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">&quot;Woo! I just baked &quot;</span> <span class="token operator">+</span> item <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>

module skills<span class="token punctuation">{</span>
    <span class="token keyword">export</span> <span class="token keyword">var</span> specialty <span class="token operator">=</span> <span class="token string">&quot;baking&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">export</span> <span class="token keyword">var</span> experience <span class="token operator">=</span> <span class="token string">&quot;5 years&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

module cakeFactory<span class="token punctuation">{</span>

    <span class="token comment">// specify dependencies</span>
    <span class="token keyword">import</span> baker from staff<span class="token punctuation">;</span>

    <span class="token comment">// import everything with wildcards</span>
    <span class="token keyword">import</span> <span class="token operator">*</span> from skills<span class="token punctuation">;</span>

    <span class="token keyword">export</span> <span class="token keyword">var</span> oven <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">makeCupcake</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">toppings</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
            baker<span class="token punctuation">.</span><span class="token function">bake</span><span class="token punctuation">(</span> <span class="token string">&quot;cupcake&quot;</span><span class="token punctuation">,</span> toppings <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">makeMuffin</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">mSize</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
            baker<span class="token punctuation">.</span><span class="token function">bake</span><span class="token punctuation">(</span> <span class="token string">&quot;muffin&quot;</span><span class="token punctuation">,</span> size <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="从远程来源加载的模块"><a href="#从远程来源加载的模块" class="header-anchor">#</a> 从远程来源加载的模块</h2> <blockquote><p>模块的提案也支持基于远程来源的模块（例如，一个第三方库），这简化了从外部位置载入模块的操作。这里有一个在模块中抽取并使用它的示例：</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>module cakeFactory <span class="token keyword">from</span> <span class="token string">&quot;http://addyosmani.com/factory/cakes.js&quot;</span><span class="token punctuation">;</span>
cakeFactory<span class="token punctuation">.</span>oven<span class="token punctuation">.</span><span class="token function">makeCupcake</span><span class="token punctuation">(</span> <span class="token string">&quot;sprinkles&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
cakeFactory<span class="token punctuation">.</span>oven<span class="token punctuation">.</span><span class="token function">makeMuffin</span><span class="token punctuation">(</span> <span class="token string">&quot;large&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="模块加载api"><a href="#模块加载api" class="header-anchor">#</a> 模块加载API</h2> <blockquote><p>被提出来的模块加载器描述了一个用于在一个被高度控制的环境中加载模块的动态<code>API</code>。加载器上支持的签名包含<code>load(url, moduleInstance, error)</code>用于加载模块，<code>createModule(object, globalModuleReferences)</code>以及其他的操作。</p> <p>这里是另外一个最初定义的在模块中进行动态加载的示例。注意，并不像最近的一个从远程来源拉入一个模块的示例，模块加载器API更加适合于动态环境。</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>Loader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span> <span class="token string">&quot;http://addyosmani.com/factory/cakes.js&quot;</span> <span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">cakeFactory</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
        cakeFactory<span class="token punctuation">.</span>oven<span class="token punctuation">.</span><span class="token function">makeCupcake</span><span class="token punctuation">(</span> <span class="token string">&quot;chocolate&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="针对服务器的commonjs类似模块"><a href="#针对服务器的commonjs类似模块" class="header-anchor">#</a> 针对服务器的CommonJS类似模块</h2> <p>对于那些对服务器环境更加感兴趣的开发者，<code>ES.next</code>提供的模块系统并不仅仅限制只在浏览器中寻找模块。例如在下面，能够看到一个<code>CommonJS</code>类似的模块被提供给在服务器上使用。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// io/File.js</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">open</span><span class="token punctuation">(</span> <span class="token parameter">path</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">close</span><span class="token punctuation">(</span> <span class="token parameter">hnd</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// compiler/LexicalHandler.js</span>
module file <span class="token keyword">from</span> <span class="token string">&quot;io/File&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> open<span class="token punctuation">,</span> close <span class="token punctuation">}</span> from file<span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">scan</span><span class="token punctuation">(</span> <span class="token parameter"><span class="token keyword">in</span></span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> h <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span> <span class="token keyword">in</span> <span class="token punctuation">)</span> <span class="token operator">...</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">finally</span> <span class="token punctuation">{</span> <span class="token function">close</span><span class="token punctuation">(</span> h <span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>module lexer <span class="token keyword">from</span> <span class="token string">&quot;compiler/LexicalHandler&quot;</span><span class="token punctuation">;</span>
module stdlib <span class="token keyword">from</span> <span class="token string">&quot;@std&quot;</span><span class="token punctuation">;</span>

<span class="token comment">//... scan(cmdline[0]) ...</span>
</code></pre></div><h2 id="带有构造器-get和set方法的类"><a href="#带有构造器-get和set方法的类" class="header-anchor">#</a> 带有构造器，Get和Set方法的类</h2> <blockquote><p>类的概念一直都是带有纯粹主义色彩的有争议的问题，而目前相对已经回落到关于Javascript原型性质的问题上来，或者通过使用提供在一个表单中使用类定义能力的框架或者抽象，其具有相同原型行为的语法糖。</p> <p>在Harmony中，为这种语言类已经同构造器和一些（最终）具有某种意义的真正隐晦的东西一起，被提了出来。在下面的示例中，其中的注释提供了用于帮助解释类是如何被构造的问题。</p> <p>通过阅读，人们也许也会意识到这里“function“世界的缺失。这并不是一个笔误：TC39已经做出有目的的尝试，降低在任何事物上对function关键字的滥用，而这其实是希望能够简化编写代码的工作。</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Cake</span><span class="token punctuation">{</span>

    <span class="token comment">// We can define the body of a class&quot; constructor</span>
    <span class="token comment">// function by using the keyword &quot;constructor&quot; followed</span>
    <span class="token comment">// by an argument list of public and private declarations.</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span> <span class="token parameter">name<span class="token punctuation">,</span> toppings<span class="token punctuation">,</span> price<span class="token punctuation">,</span> cakeSize</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">public</span> name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        <span class="token keyword">public</span> cakeSize <span class="token operator">=</span> cakeSize<span class="token punctuation">;</span>
        <span class="token keyword">public</span> toppings <span class="token operator">=</span> toppings<span class="token punctuation">;</span>
        <span class="token keyword">private</span> price <span class="token operator">=</span> price<span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token comment">// As a part of ES.next's efforts to decrease the unnecessary</span>
    <span class="token comment">// use of &quot;function&quot; for everything, you'll notice that it's</span>
    <span class="token comment">// dropped for cases such as the following. Here an identifier</span>
    <span class="token comment">// followed by an argument list and a body defines a new method</span>

    <span class="token function">addTopping</span><span class="token punctuation">(</span> <span class="token parameter">topping</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">public</span><span class="token punctuation">(</span> <span class="token keyword">this</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>toppings<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span> topping <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Getters can be defined by declaring get before</span>
    <span class="token comment">// an identifier/method name and a curly body.</span>
    <span class="token keyword">get</span> <span class="token function">allToppings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">public</span><span class="token punctuation">(</span> <span class="token keyword">this</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>toppings<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">get</span> <span class="token function">qualifiesForDiscount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">private</span><span class="token punctuation">(</span> <span class="token keyword">this</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>price <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Similar to getters, setters can be defined by using</span>
    <span class="token comment">// the &quot;set&quot; keyword before an identifier</span>
    <span class="token keyword">set</span> <span class="token function">cakeSize</span><span class="token punctuation">(</span> <span class="token parameter">cSize</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span> cSize <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span> <span class="token string">&quot;Cake must be a valid size - either small, medium or large&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">public</span><span class="token punctuation">(</span> <span class="token keyword">this</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>cakeSize <span class="token operator">=</span> cSize<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h2 id="es6-module-相对于-commonjs-的优势"><a href="#es6-module-相对于-commonjs-的优势" class="header-anchor">#</a> ES6 Module 相对于 CommonJS 的优势</h2> <p>关于 ES Module 和 CommonJS 的规范以及语法，这里不再详细叙述，如果你还不了解这两者的语法糖，可以查看 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fes6.ruanyifeng.com%2F%23docs%2Fmodule" target="_blank" rel="noopener noreferrer">ECMAScript 6 入门 / Module 语法<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>、<a href="https://link.juejin.cn/?target=https%3A%2F%2Ftc39.es%2Fecma262%2F%23sec-modules" target="_blank" rel="noopener noreferrer">ES Module 标准<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>以及 <a href="https://link.juejin.cn/?target=http%3A%2F%2Fnodejs.cn%2Fapi%2Fmodules.html" target="_blank" rel="noopener noreferrer">Node.js 的 CommonJS 模块<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，两者的主要区别如下所示：</p> <table><thead><tr><th>类型</th> <th>ES Module</th> <th>CommonJS</th></tr></thead> <tbody><tr><td>加载方式</td> <td>编译时</td> <td>运行时</td></tr> <tr><td>引入性质</td> <td>引用 / 只读</td> <td>浅拷贝 / 可读写</td></tr> <tr><td>模块作用域</td> <td>this</td> <td>this / __filename / __dirname...</td></tr></tbody></table> <h3 id="_1-加载方式"><a href="#_1-加载方式" class="header-anchor">#</a> 1 加载方式</h3> <p>加载方式是 ES Module 和 CommonJS 的最主要区别，这使得两者在<strong>编译时</strong>和<strong>运行时</strong>上各有优劣。首先来看一下 ES Module 在加载方式上的特性，如下所示：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// 编译时：VS Code 鼠标 hover 到 b 时可以显示出 b 的类型信息</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> b <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./b'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token comment">// WARNING: 具有逻辑</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">// 编译时：ESLint: Parsing error: 'import' and 'export' may only appear at the top level</span>
   <span class="token comment">// 运行时：SyntaxError: Unexpected token '{'</span>
   <span class="token comment">// TIPS: 这里可以使用 import() 进行动态导入</span>
   <span class="token keyword">import</span> <span class="token punctuation">{</span> b <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./b'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> c <span class="token operator">=</span> <span class="token string">'b'</span><span class="token punctuation">;</span>
<span class="token comment">// WARNING: 含有变量</span>
<span class="token comment">// 编译时：ESLint：Parsing error: Unexpected token `</span>
<span class="token comment">// 运行时：SyntaxError: Unexpected template string</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> d <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>c<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
</code></pre></div><p>CommonJS 相对于 ES Module 在加载方式上的特性如下所示：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// VS Code 鼠标 hover 到 b 时，无法显示出 b 的类型信息</span>
  <span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'./b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> c <span class="token operator">=</span> <span class="token string">'b'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> d <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>c<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>大家可能知道上述语法的差异性，接下来通过理论知识重点讲解一下两者产生差异的主要原因。在<a href="https://juejin.cn/post/6987549240436195364" target="_blank" rel="noopener noreferrer">前端知识点扫盲（一）/ 编译器原理<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>中重点讲解了整个编译器的执行阶段，如下图所示：</p> <p><img src="/notes/assets/design/ee672b39fdae42a1a9318947be3bc39d_tplv-k3u1fbpfcp-watermark.awebp" alt="demo"></p> <p>ES Module 是采用<a href="https://link.juejin.cn/?target=https%3A%2F%2Fexploringjs.com%2Fes6%2Fch_modules.html%23static-module-structure" target="_blank" rel="noopener noreferrer">静态<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>的加载方式，也就是模块中导入导出的依赖关系可以在代码编译时就确定下来。如上图所示，代码在编译的过程中可以做的事情包含词法和语法分析、类型检查以及代码优化等等。因此采用 ES Module 进行代码设计时可以在编译时通过 ESLint 快速定位出模块的词法语法错误以及类型信息等。ES Module 中会产生一些错误的加载方式，是因为这些加载方式含有逻辑和变量的运行时判断，只有在代码的运行时阶段才能确定导入导出的依赖关系，这明显和 ES Module 的加载机制不相符。</p> <p>CommonJS 相对于 ES Module 在加载模块的方式上存在明显差异，是因为 CommonJS 在运行时进行加载方式的动态解析，在运行时阶段才能确定的导入导出关系，因此无法进行静态编译优化和类型检查。​</p> <blockquote><p>温馨提示：注意 import 语法和 import() 的区别，import() 是 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Ftc39%2Fproposal-dynamic-import" target="_blank" rel="noopener noreferrer">tc39 中的一种提案<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，该提案允许你可以使用类似于 import(<code>${path}/foo.js</code>) 的导入语句（估计是借鉴了 CommonJS 可以动态加载模块的特性），因此也允许你在运行时进行条件加载，也就是所谓的<a href="https://link.juejin.cn/?target=https%3A%2F%2Fwebpack.docschina.org%2Fguides%2Flazy-loading%2F" target="_blank" rel="noopener noreferrer">懒加载<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。除此之外，import  和 import() 还存在其他一些重要的区别，大家还是自行谷歌一下。</p></blockquote> <h3 id="_2-编译优化"><a href="#_2-编译优化" class="header-anchor">#</a> 2 编译优化</h3> <p>由于 ES Module 是在编译时就能确定模块之间的依赖关系，因此可以在编译的过程中进行代码优化。例如：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// hello.js </span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// index.js</span>
<span class="token comment">// TIPS: Webpack 编译入口文件</span>
<span class="token comment">// 这里不引入 function b</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> a <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./hello'</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>使用 Webpack 5.47.1 （Webpack Cli 4.7.2）进行代码编译，生成的编译产物如下所示：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>可以发现编译生成的产物没有 function b 的代码，这是在编译阶段对代码进行了优化，移除了未使用的代码（Dead Code），这种优化的术语被叫做 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fwebpack.docschina.org%2Fguides%2Ftree-shaking%2F" target="_blank" rel="noopener noreferrer">Tree Shaking<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <blockquote><p>温馨提示：你可以将应用程序想象成一棵树。绿色表示实际用到的 Source Code（源码）和 Library（库），是树上活的树叶。灰色表示未引用代码，是秋天树上枯萎的树叶。为了除去死去的树叶，你必须摇动这棵树，使它们落下。</p> <p>温馨提示：在 ES Module 中可能会因为代码具有副作用（例如操作原型方法以及添加全局对象的属性等）导致优化失败，如果想深入了解 Tree Shaking 的更多优化注意事项，可以深入阅读<a href="https://juejin.cn/post/6844903549290151949#heading-7" target="_blank" rel="noopener noreferrer">你的 Tree-Shaking 并没什么卵用<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p></blockquote> <p>为了对比 ES Module 的编译优化能力，同样采用 CommonJS 规范进行模块导入：​</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// hello.js</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">a</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span><span class="token function-variable function">b</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// index.js</span>
<span class="token comment">// TIPS: Webpack 编译入口文件</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> a <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'./hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>使用 Webpack 进行代码编译，生成的编译产物如下所示：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token number">418</span><span class="token operator">:</span> <span class="token punctuation">(</span>o<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token punctuation">(</span>n<span class="token punctuation">.</span><span class="token function-variable function">a</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token comment">// function b 的代码并没有被去除</span>
          <span class="token punctuation">(</span>n<span class="token punctuation">.</span><span class="token function-variable function">b</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    n <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">r</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> e <span class="token operator">=</span> n<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token number">0</span> <span class="token operator">!==</span> e<span class="token punctuation">)</span> <span class="token keyword">return</span> e<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
    <span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token punctuation">(</span>n<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> exports<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> o<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> s<span class="token punctuation">.</span>exports<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> o <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">r</span><span class="token punctuation">(</span><span class="token number">418</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>可以发现在 CommonJS 模块中，尽管没有使用 function b，但是代码仍然会被打包编译，正是因为 CommonJS 模块只有在运行时才能进行同步导入，因此无法在编译时确定是否 function b 是一个 Dead Code。</p> <blockquote><p>温馨提示：在 Node.js 环境中一般不需要编译 CommonJS 模块代码，除非你使用了当前 Node 版本所不能兼容的一些新语法特性。</p></blockquote> <p>大家可能会注意到一个新的问题，当我们在制作工具库或者组件库的时候，通常会将库包编译成 ES5 语法，这样尽管 Babel 以及 Webpack 默认会忽略 node_modules 里的模块，我们的项目在编译时引入的这些模块仍然能够做到兼容。在这个过程中，如果你制作的库包体积非常大，你又不提供非常细粒度的按需引入的加载方式，那么你可以编译你的源码使得编译产物可以支持 ES Module 的导入导出模式（注意只支持 ES6 中模块的语法，其他的语法仍然需要被编译成 ES5），当项目真正引入这些库包时可以通过 Tree Shaking 的特性在编译时去除未引入的代码（Dead Code）。</p> <blockquote><p>温馨提示：如果你想了解如何使发布的 Npm 库包支持 Tree Shaking 特性，可以查看 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fdherman%2Fdefense-of-dot-js%2Fblob%2Fmaster%2Fproposal.md%23typical-usage" target="_blank" rel="noopener noreferrer">defense-of-dot-js / Typical Usage<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>、 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fwebpack.js.org%2Fguides%2Fauthor-libraries%2F%23final-steps" target="_blank" rel="noopener noreferrer">Webpack / Final Steps<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>、<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Frollup%2Frollup%2Fwiki%2Fpkg.module" target="_blank" rel="noopener noreferrer">pgk.module<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 以及 <a href="https://link.juejin.cn/?target=https%3A%2F%2Frollupjs.org%2Fguide%2Fen%2F%23tree-shaking" target="_blank" rel="noopener noreferrer">rollup.js / Tree Shaki…<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。
​</p></blockquote> <h3 id="_3-加载原理-引入性质"><a href="#_3-加载原理-引入性质" class="header-anchor">#</a> 3 加载原理 &amp; 引入性质</h3> <blockquote><p>温馨提示：下述理论部分以及图片内容均出自于 2018 年的文章 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fhacks.mozilla.org%2F2018%2F03%2Fes-modules-a-cartoon-deep-dive%2F" target="_blank" rel="noopener noreferrer">ES modules: A cartoon deep-dive<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，如果想要了解更多原理信息可以查看 TC39 的 <a href="https://link.juejin.cn/?target=https%3A%2F%2Ftc39.es%2Fecma262%2F%23sec-modules" target="_blank" rel="noopener noreferrer">16.2 Modules<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p></blockquote> <p><img src="/notes/assets/design/f81e90e1874547b093d9a00b749f271f_tplv-k3u1fbpfcp-watermark.awebp" alt="demo"></p> <p>事实上， ES Module 的加载过程主要分为如下三个阶段：​</p> <ul><li><p>构建（Construction）：主要分为查找、加载（在浏览器中是下载文件，在本地文件系统中是加载文件）、然后把文件解析成 Module Record。</p></li> <li><p>实例化（Instantiation）：给所有的 Module Record 分配内存空间（此刻还没有填充值），并根据导入导出关系确定各自之间的引用关系，确定引用关系的过程称为链接（Linking）。</p></li> <li><p>运行（Evaluation）：运行代码，给内存地址填充运行时的模块数据。</p></li></ul> <blockquote><p>温馨提示：import 的上述三个阶段其实在 import() 中体现的更加直观（尽管 import 已经被多数浏览器支持，但是我们在真正开发和运行的过程中仍然会使用编译后的代码运行，而不是采用浏览器 script 标签的远程地址的动态异步加载方式），而 import() 事实上如果要实现懒加载优化（例如 Vue 里的路由懒加载，更多的是在浏览器的宿主环境而不是 Node.js 环境，这里不展开更多编译后实现方式的细节问题），大概率要完整经历上述三个阶段的异步加载过程，具体再次查看 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Ftc39%2Fproposal-dynamic-import%23proposed-solution" target="_blank" rel="noopener noreferrer">tc39 动态提案<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p><img src="/notes/assets/design/da0d7178b8544e119bf8b5e7af520e72_tplv-k3u1fbpfcp-watermark.awebp" alt="demo"></p> <p>ES Module 模块加载的三个阶段分别需要在编译时和运行时进行（可能有的同学会像我一样好奇实例化阶段到底是在编译时还是运行时进行，根据 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Ftc39%2Fproposal-dynamic-import" target="_blank" rel="noopener noreferrer">tc39 动态加载提案<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>里的描述可以得出你想要的答案：The existing syntactic forms for importing modules are static declarations. They accept a string literal as the module specifier, and introduce bindings into the local scope via a pre-runtime &quot;linking&quot; process.），而 CommonJS 规范中的模块是在运行时同步顺序执行，模块在加载的过程中不会被中断，具体如下图所示：</p> <p><img src="/notes/assets/design/ddfb51ee6b5d41cc933158796f76d6d4_tplv-k3u1fbpfcp-watermark.awebp" alt="demo"></p> <p>上图中 main.js 在运行加载 counter.js 时，会先等待 counter.js 运行完成后才能继续运行代码，因此在 CommonJS 中模块的加载是阻塞式的。CommonJS 采用同步阻塞式加载模块是因为它只需要从本地的文件系统中加载文件，耗费的性能和时间很少，而 ES Module 在浏览器（注意这里说的是浏览器）中运行的时候需要下载文件然后才能进行实例化和运行，如果这个过程是同步进行，那么会影响页面的加载性能。</p> <p>从 ES Module 链接的过程可以发现模块之间的引用关系是内存的地址引用，如下所示：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// hello.js</span>
<span class="token keyword">export</span> <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  a<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// index.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> a <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./hello.js'</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>在 Node （v14.15.4）环境中运行上述代码得到的执行结果是 2，对比一下 CommonJS 规范的执行：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// hello.js</span>
exports<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  exports<span class="token punctuation">.</span>a<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// index.js</span>
<span class="token keyword">let</span> <span class="token punctuation">{</span> a <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'./hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>可以发现打印的结果信息和 ES Module 的结果不一样，这里的执行结果为 1。产生上述差异的根本原因是实例化的方式不同，如下图所示：</p> <p><img src="/notes/assets/design/28b968cb9ce24e51a99896919ae7af21_tplv-k3u1fbpfcp-watermark.awebp" alt="demo"></p> <p>在 ES Module 的导出中 Module Record 会实时跟踪（wire up 在这里理解为链接或者引用的意思）和绑定每一个导出变量对应的内存地址（从上图可以发现值还没有被填充，而 function 则可以在链接阶段进行初始化），导入同样对应的是导出所对应的同一个内存地址，因此对导入变量进行处理其实处理的是同一个引用地址的数据，如下图所示：
​
<img src="/notes/assets/design/9c77a8a446c244c79941166cdb9e2d7d_tplv-k3u1fbpfcp-watermark.awebp" alt="demo"></p> <p>CommonJS 规范在导出时事实上导出的是值拷贝，如下图所示：​</p> <p><img src="/notes/assets/design/708109828ff24a36ba034e8458e81a4d_tplv-k3u1fbpfcp-watermark.awebp" alt="demo"></p> <p>在上述代码执行的过程中先对变量 a 进行值拷贝，因此尽管设置了定时器，变量 a 被引入后打印的信息仍然是 1。需要注意的是这种拷贝是浅拷贝，如下所示：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// hello.js</span>
exports<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token punctuation">{</span>
  value<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  exports<span class="token punctuation">.</span>a<span class="token punctuation">.</span>value<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// index.js</span>
<span class="token keyword">let</span> <span class="token punctuation">{</span> a <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'./hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>接下来对比编译后的差异，将 ES Module 的源码进行编译（仍然使用 Webpack），编译之后的代码如下所示：​</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token string">'use strict'</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> e <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    e<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1e3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2e3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>可以看出，将 ES Module 的代码进行编译后，使用的是同一个变量值，此时将 CommonJS 的代码进行编译：​</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> e <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token number">418</span><span class="token operator">:</span> <span class="token punctuation">(</span>e<span class="token punctuation">,</span> t<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// hello.js 中的模块代码</span>
        <span class="token punctuation">(</span>t<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            t<span class="token punctuation">.</span>a<span class="token operator">++</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1e3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    t <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">o</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   	<span class="token comment">// 开辟模块的缓存空间</span>
    <span class="token keyword">var</span> s <span class="token operator">=</span> t<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">;</span>
   	<span class="token comment">// 获取缓存信息，每次返回相同的模块对象信息</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token number">0</span> <span class="token operator">!==</span> s<span class="token punctuation">)</span> <span class="token keyword">return</span> s<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
    <span class="token comment">// 开辟模块对象的内存空间</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">(</span>t<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> exports<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 逗号运算符，先运行模块代码，赋值模块对象的值，然后返回模块信息</span>
    <span class="token comment">// 由于缓存，模块代码只会被执行一次</span>
    <span class="token keyword">return</span> e<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> a<span class="token punctuation">.</span>exports<span class="token punctuation">,</span> o<span class="token punctuation">)</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 浅拷贝</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> e <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">o</span><span class="token punctuation">(</span><span class="token number">418</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 尽管 t.a ++，这里输出的仍然是 1</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2e3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>可以发现 CommonJS 规范在编译后会缓存模块的信息，从而使得下一次将从缓存中直接获取模块数据。除此之外，缓存会使得模块代码只会被执行一次。查看 Node.js 官方文档对于 <a href="https://link.juejin.cn/?target=http%3A%2F%2Fnodejs.cn%2Fapi%2Fmodules.html%23modules_caching" target="_blank" rel="noopener noreferrer">CommonJS 规范的缓存描述<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，发现 Webpack 的编译完全符合 CommonJS 规范的缓存机制。了解了这个机制以后，你会发现多次使用 require 进行模块加载不会导致代码被执行多次，这是解决无<a href="https://link.juejin.cn/?target=http%3A%2F%2Fnodejs.cn%2Fapi%2Fmodules.html%23modules_cycles" target="_blank" rel="noopener noreferrer">限循环依<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>赖的一个重要特征。</p> <p>除了引入的方式可能会有区别之外，引入的代码可能还存在一些区别，比如在 ES Module 中：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// hello.js</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'a this: '</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment">// index.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> a <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./hello.js'</span><span class="token punctuation">;</span>

<span class="token comment">// a = 1;</span>
  <span class="token operator">^</span>
<span class="token comment">// TypeError: Assignment to constant variable.</span>
<span class="token comment">//    ...</span>
<span class="token comment">//    at ModuleJob.run (internal/modules/esm/module_job.js:152:23)</span>
<span class="token comment">//    at async Loader.import (internal/modules/esm/loader.js:166:24)</span>
<span class="token comment">//    at async Object.loadESM (internal/process/esm_loader.js:68:5)</span>
a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre></div><p>使用 Node.js 直接运行上述 ES Module 代码，是会产生报错的，因为导入的变量根据提示可以看出是只读变量，而如果采用 Webpack 进行编译后运行，则没有上述问题，除此之外 CommonJS 中导入的变量则可读可写。当然除此之外，你也可以尝试更多的其他方面，比如：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// hello.js</span>

<span class="token comment">// 非严格模式</span>
b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'a this: '</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// index.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> a <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./hello.js'</span><span class="token punctuation">;</span>

<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'a: '</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>你会发现使用 Node.js 环境执行上述 ES Module 代码，会直接抛出下述错误信息：</p> <div class="language- extra-class"><pre class="language-text"><code>ReferenceError: b is not defined
    at file:///Users/ziyi/Desktop/Gitlab/Explore/module-example/esmodule/hello.js:1:3
    at ModuleJob.run (internal/modules/esm/module_job.js:152:23)
    at async Loader.import (internal/modules/esm/loader.js:166:24)
    at async Object.loadESM (internal/process/esm_loader.js:68:5)
</code></pre></div><p>是因为 ES Module 的模块需要运行在严格模式下， 而 CommonJS 规范则没有这样的要求，如果你在仔细一点观察的话，会发现使用 Webpack 进行编译的时候，ES Module 编译的代码会在前面加上 &quot;use strict&quot;，而 CommonJS 编译的代码没有。</p> <h3 id="_4-模块作用域"><a href="#_4-模块作用域" class="header-anchor">#</a> 4 模块作用域</h3> <p>大家会发现在 Node.js 的模块中设计代码时可以使用诸如 __dirname、__filename 之类的变量（需要注意在 Webpack 编译出的 CommonJS 前端产物中，并没有 __filename、__dirname 等变量信息，浏览器中并不需要这些文件系统的变量信息），是因为 Node.js 在加载模块时会对其进行如下包装：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// https://github.com/nodejs/node/blob/master/lib/internal/modules/cjs/loader.js#L206</span>
<span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token string">'(function (exports, require, module, __filename, __dirname) { '</span><span class="token punctuation">,</span>
  <span class="token string">'\n});'</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>索性看到这个模块作用域的代码，我们就继续查看一下 require 的源码：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// https://github.com/nodejs/node/blob/3914354cd7ddc65774f13bbe435978217149793c/lib/internal/modules/cjs/loader.js#L997</span>
Module<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">require</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">validateString</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> <span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">===</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">ERR_INVALID_ARG_VALUE</span></span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> id<span class="token punctuation">,</span>
                                    <span class="token string">'must be a non-empty string'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  requireDepth<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Module<span class="token punctuation">.</span><span class="token function">_load</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token comment">/* isMain */</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
    requireDepth<span class="token operator">--</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// https://github.com/nodejs/node/blob/3914354cd7ddc65774f13bbe435978217149793c/lib/internal/modules/cjs/loader.js#L757</span>

<span class="token comment">// Check the cache for the requested file.</span>
<span class="token comment">// 1. If a module already exists in the cache: return its exports object.</span>
<span class="token comment">// 2. If the module is native: call</span>
<span class="token comment">//    `NativeModule.prototype.compileForPublicLoader()` and return the exports.</span>
<span class="token comment">// 3. Otherwise, create a new module for the file and save it to the cache.</span>
<span class="token comment">//    Then have it load  the file contents before returning its exports</span>
<span class="token comment">//    object.</span>
Module<span class="token punctuation">.</span><span class="token function-variable function">_load</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> parent<span class="token punctuation">,</span> isMain<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> relResolveCacheIdentifier<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">'Module._load REQUEST %s parent: %s'</span><span class="token punctuation">,</span> request<span class="token punctuation">,</span> parent<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Fast path for (lazy loaded) modules in the same directory. The indirect</span>
    <span class="token comment">// caching is required to allow cache invalidation without changing the old</span>
    <span class="token comment">// cache key names.</span>
    relResolveCacheIdentifier <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>parent<span class="token punctuation">.</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\x00</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>request<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> filename <span class="token operator">=</span> relativeResolveCache<span class="token punctuation">[</span>relResolveCacheIdentifier<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// 有缓存，则走缓存</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>filename <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> cachedModule <span class="token operator">=</span> Module<span class="token punctuation">.</span>_cache<span class="token punctuation">[</span>filename<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>cachedModule <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">updateChildren</span><span class="token punctuation">(</span>parent<span class="token punctuation">,</span> cachedModule<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cachedModule<span class="token punctuation">.</span>loaded<span class="token punctuation">)</span>
          <span class="token keyword">return</span> <span class="token function">getExportsForCircularRequire</span><span class="token punctuation">(</span>cachedModule<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> cachedModule<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">delete</span> relativeResolveCache<span class="token punctuation">[</span>relResolveCacheIdentifier<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// `node:` 用于检测核心模块，例如 fs、path 等</span>
  <span class="token comment">// Node.js 文档：http://nodejs.cn/api/modules.html#modules_core_modules</span>
  <span class="token comment">// 这里主要用于绕过 require 缓存</span>
  <span class="token keyword">const</span> filename <span class="token operator">=</span> Module<span class="token punctuation">.</span><span class="token function">_resolveFilename</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> parent<span class="token punctuation">,</span> isMain<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">StringPrototypeStartsWith</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'node:'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Slice 'node:' prefix</span>
    <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">StringPrototypeSlice</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> module <span class="token operator">=</span> <span class="token function">loadNativeModule</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>module<span class="token operator">?.</span>canBeRequiredByUsers<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">ERR_UNKNOWN_BUILTIN_MODULE</span></span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
	
	<span class="token comment">// 缓存处理</span>
  <span class="token keyword">const</span> cachedModule <span class="token operator">=</span> Module<span class="token punctuation">.</span>_cache<span class="token punctuation">[</span>filename<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>cachedModule <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">updateChildren</span><span class="token punctuation">(</span>parent<span class="token punctuation">,</span> cachedModule<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cachedModule<span class="token punctuation">.</span>loaded<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> parseCachedModule <span class="token operator">=</span> cjsParseCache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>cachedModule<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>parseCachedModule <span class="token operator">||</span> parseCachedModule<span class="token punctuation">.</span>loaded<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token function">getExportsForCircularRequire</span><span class="token punctuation">(</span>cachedModule<span class="token punctuation">)</span><span class="token punctuation">;</span>
      parseCachedModule<span class="token punctuation">.</span>loaded <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> cachedModule<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> mod <span class="token operator">=</span> <span class="token function">loadNativeModule</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>mod<span class="token operator">?.</span>canBeRequiredByUsers<span class="token punctuation">)</span> <span class="token keyword">return</span> mod<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>

  <span class="token comment">// Don't call updateChildren(), Module constructor already does.</span>
  <span class="token keyword">const</span> module <span class="token operator">=</span> cachedModule <span class="token operator">||</span> <span class="token keyword">new</span> <span class="token class-name">Module</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> parent<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>isMain<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    process<span class="token punctuation">.</span>mainModule <span class="token operator">=</span> module<span class="token punctuation">;</span>
    module<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token string">'.'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  Module<span class="token punctuation">.</span>_cache<span class="token punctuation">[</span>filename<span class="token punctuation">]</span> <span class="token operator">=</span> module<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>parent <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    relativeResolveCache<span class="token punctuation">[</span>relResolveCacheIdentifier<span class="token punctuation">]</span> <span class="token operator">=</span> filename<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">let</span> threw <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    module<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
    threw <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>threw<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">delete</span> Module<span class="token punctuation">.</span>_cache<span class="token punctuation">[</span>filename<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>parent <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">delete</span> relativeResolveCache<span class="token punctuation">[</span>relResolveCacheIdentifier<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> children <span class="token operator">=</span> parent<span class="token operator">?.</span>children<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ArrayIsArray</span><span class="token punctuation">(</span>children<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> index <span class="token operator">=</span> <span class="token function">ArrayPrototypeIndexOf</span><span class="token punctuation">(</span>children<span class="token punctuation">,</span> module<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">ArrayPrototypeSplice</span><span class="token punctuation">(</span>children<span class="token punctuation">,</span> index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>module<span class="token punctuation">.</span>exports <span class="token operator">&amp;&amp;</span>
               <span class="token operator">!</span><span class="token function">isProxy</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>exports<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
               <span class="token function">ObjectGetPrototypeOf</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>exports<span class="token punctuation">)</span> <span class="token operator">===</span>
                 CircularRequirePrototypeWarningProxy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">ObjectSetPrototypeOf</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>exports<span class="token punctuation">,</span> ObjectPrototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>温馨提示：这里没有将 wrapper 和 _load 的联系说清楚（最后如何在 _load 中执行 wrapper），大家可以在 Node.js 源码中跟踪一下看一下上述代码是怎么被执行的，是否是 eval 呢？不说了，脑壳疼，想要了解更多信息，可以查看 <a href="https://link.juejin.cn/?target=http%3A%2F%2Fnodejs.cn%2Fapi%2Fvm.html" target="_blank" rel="noopener noreferrer">Node.js / vm<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。除此之外，感兴趣的同学也了解一下 import 语法在 Node.js 中的底层实现，这里脑壳疼，就没有深入研究了。</p></blockquote> <blockquote><p>温馨提示的温馨提示：比如你在源码中找不到上述代码的执行链路，那最简单的方式就是引入一个错误的模块，让错误信息将错误栈抛出来，比如如下所示，你会发现最底下执行了 wrapSafe，好了你又可以开始探索了，因为你对 safe 这样的字眼一定感到好奇，底下是不是执行的时候用了沙箱隔离呢？</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>SyntaxError: Cannot use import statement outside a module
    at wrapSafe (internal/modules/cjs/loader.js:979:16)
    at Module._compile (internal/modules/cjs/loader.js:1027:27)
    at Object.Module._extensions..js (internal/modules/cjs/loader.js:1092:10)
    at Module.load (internal/modules/cjs/loader.js:928:32)
    at Function.Module._load (internal/modules/cjs/loader.js:769:14)
    at Function.executeUserEntryPoint [as runMain] (internal/modules/run_main.js:72:12)
    at internal/main/run_main_module.js:17:47
</code></pre></div><blockquote><p>温馨提示：是不是以前经常有面试官询问 exports 和 module.exports 有什么关联，其实根本不用纠结这个问题，因为两者指向的是同一个引用地址，你如果对 exports 进行重新赋值，那么引用发生了改变，你新引用的部分当然就不会导出了，因为从源码里可以看出，我们这里导出的是 module.exports。</p></blockquote> <p>接下来主要是重点看下 this 执行上下文的差异（注意这里只测试 Node.js 环境，编译后的代码可能会有差异），首先执行 ES Module 模块的代码：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// hello.js</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'this: '</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
<span class="token punctuation">}</span>

<span class="token comment">// index.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> a <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./hello.js'</span><span class="token punctuation">;</span>
<span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>我们接着执行 CommonJS 的代码：​</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// hello.js</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">a</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'this: '</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// index.js</span>
<span class="token keyword">let</span> <span class="token punctuation">{</span> a <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'./hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>你会发现 this 的上下文环境是有信息的，可能是当前模块的信息，具体没有深究：​</p> <p><img src="/notes/assets/design/bacb79df619b43058c365bf2e51b8590_tplv-k3u1fbpfcp-watermark.awebp" alt="demo"></p> <blockquote><p>温馨提示：Node.js 的调试还能在浏览器进行？可以查看一下 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fnodejs.org%2Fzh-cn%2Fdocs%2Fguides%2Fdebugging-getting-started%2F" target="_blank" rel="noopener noreferrer">Node.js 调试<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，当然你也可以使用 VS Code 进行调试，需要进行一些额外的 launch 配置，当然如果你觉得 Node.js 自带的浏览器调试方式太难受了，也可以想想办法，如何通过 IP 端口在浏览器中进行调试，并且可以做到代码变动监听调试。</p></blockquote> <p><a href="https://juejin.cn/post/6844903928442667015#heading-37" target="_blank" rel="noopener noreferrer">两年工作经验成功面试阿里P6总结 / 如何在Node端配置路径别名（类似于Webpack中的alias配置）<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>基本上思路就是 HACK 原型链上的 require 方法：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> Module <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'module'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> originalRequire <span class="token operator">=</span> Module<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token keyword">require</span><span class="token punctuation">;</span>

Module<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">require</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 这里加入 path 的逻辑</span>
  <span class="token keyword">return</span> <span class="token function">originalRequire</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></div> <!----> <div class="content__content-bottom"></div> <footer class="page-meta"><div class="edit-link"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon edit-icon"><path d="M117.953 696.992 64.306 959.696l265.931-49.336 450.204-452.505-212.284-213.376-450.204 452.513zm496.384-296.326L219.039 797.993l-46.108-46.34L568.233 354.33l46.104 46.335zm345.357-122.99-114.45 115.04-212.288-213.377 114.45-115.035 212.288 213.371zm0 0" fill="currentColor"></path></svg> <a href="https://github.com/sykinggg/notes/edit/main/docs/design/esHarmony.md" target="_blank" rel="noopener noreferrer">Edit this page</a></div> <div class="meta-item update-time"><span class="label">Last update:</span> <span class="info">August 24, 2021 05:08</span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/notes/design/commonJS/" class="prev"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon prev-icon"><path d="M906.783 588.79c-.02 8.499-6.882 15.36-15.38 15.37l-443.7-.01 75.704 191.682c2.52 6.42.482 13.763-5.038 17.91-5.52 4.168-13.138 4.147-18.616-.092L123.228 524.175a15.362 15.362 0 0 1-6-12.165c0-4.782 2.222-9.277 6-12.185L499.753 210.35a15.388 15.388 0 0 1 9.38-3.195c3.236 0 6.502 1.034 9.236 3.103 5.52 4.147 7.578 11.49 5.038 17.91L447.683 419.84l443.72-.01c8.498.01 15.36 6.881 15.36 15.36l.02 153.6z" fill="currentColor"></path></svg>
        CommonJS
      </a></span> <!----></p></div> <!----> <!----> <div class="content__page-bottom"></div></main> <!----></div><div class="global-ui"><!----><!----><div id="pwa-install"><!----> <div id="install-modal-wrapper" style="display:none;"><div class="background"></div> <div class="install-modal"><div class="header"><button aria-label="Close" class="close-button"><svg width="23" height="22" xmlns="http://www.w3.org/2000/svg" class="icon close-icon"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.12.358a1.224 1.224 0 011.729 0l8.92 8.914L20.686.358a1.224 1.224 0 011.73 1.728L13.497 11l8.92 8.913a1.222 1.222 0 11-1.73 1.729l-8.919-8.913-8.92 8.913a1.224 1.224 0 01-1.729-1.729L10.04 11l-8.92-8.914a1.222 1.222 0 010-1.728z" fill="currentColor"></path></svg></button> <div class="logo"><!----> <div class="title"><h1></h1> <p class="desc">This app can be installed on your PC or mobile device.  This will allow this web app to look and behave like any other installed app.  You will find it in your app lists and be able to pin it to your home screen, start menus or task bars.  This installed web app will also be able to safely interact with other apps and your operating system. </p></div></div></div> <div class="content"><div class="highlight"><!----> <!----></div> <div class="description"><h3>Description</h3> <p></p></div></div> <div class="button-wrapper"><button class="install-button">
        Install <span></span></button> <button class="cancel-button">
        Cancel
      </button></div></div></div></div><div tabindex="-1" role="dialog" aria-hidden="true" class="pswp"><div class="pswp__bg"></div> <div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div> <div class="pswp__item"></div> <div class="pswp__item"></div></div> <div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div> <button class="pswp__button pswp__button--close"></button> <button class="pswp__button pswp__button--share"></button> <button class="pswp__button pswp__button--fs"></button> <button class="pswp__button pswp__button--zoom"></button> <div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div> <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div> <button class="pswp__button pswp__button--arrow--left"></button> <button class="pswp__button pswp__button--arrow--right"></button> <div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div><div class="my-popup" style="display:none;" data-v-5f98aac3><div class="my-popup-container" data-v-5f98aac3><div class="my-popup-exit" data-v-5f98aac3></div> <img src="" alt data-v-5f98aac3></div></div></div></div>
    <script src="/notes/assets/js/app.ea95c64a.js" defer></script><script src="/notes/assets/js/vendors~layout-Layout.be2c5762.js" defer></script><script src="/notes/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.c13b2ebd.js" defer></script><script src="/notes/assets/js/page-es6module.47b21daf.js" defer></script><script src="/notes/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-Slide.b17ba5cc.js" defer></script>
  </body>
</html>
