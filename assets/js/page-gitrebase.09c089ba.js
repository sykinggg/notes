(window.webpackJsonp=window.webpackJsonp||[]).push([[281],{938:function(t,s,e){"use strict";e.r(s);var a=e(1),v=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"git-rebase"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#git-rebase"}},[t._v("#")]),t._v(" git rebase")]),t._v(" "),e("blockquote",[e("p",[t._v("前提：不要通过rebase对任何已经提交到公共仓库中的commit进行修改")])]),t._v(" "),e("h2",{attrs:{id:"合并多个commit为一个完整commit"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#合并多个commit为一个完整commit"}},[t._v("#")]),t._v(" 合并多个commit为一个完整commit")]),t._v(" "),e("p",[t._v("当在本地仓库中提交了多次，在把本地提交push到公共仓库中之前，为了让提交记录更简洁明了，希望把如下分支B、C、D三个提交记录合并为一个完整的提交，然后再push到公共仓库。")]),t._v(" "),e("p",[e("img",{attrs:{src:"/notes/assets/git/2147642-42195cacced56729.webp",alt:"示例"}})]),t._v(" "),e("p",[t._v("现在在测试分支上添加了四次提交，的目标是把最后三个提交合并为一个提交：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/notes/assets/git/2147642-ce849c4eab3d803b.webp",alt:"示例"}})]),t._v(" "),e("p",[t._v("这里使用命令:")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" rebase -i  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("startpoint"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("endpoint"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),e("p",[t._v("其中"),e("code",[t._v("-i")]),t._v("的意思是"),e("code",[t._v("--interactive")]),t._v("，即弹出交互式的界面让用户编辑完成合并操作，"),e("code",[t._v("[startpoint]")]),t._v(" "),e("code",[t._v("[endpoint]")]),t._v("则指定了一个编辑区间，如果不指定"),e("code",[t._v("[endpoint]")]),t._v("，则该区间的终点默认是当前分支"),e("code",[t._v("HEAD")]),t._v("所指向的"),e("code",[t._v("commit")]),t._v("(注：该区间指定的是一个前开后闭的区间)。")]),t._v(" "),e("p",[t._v("在查看到了log日志后，运行以下命令：")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" rebase -i 36224db\n")])])]),e("p",[t._v("或:")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" rebase -i HEAD~3 \n")])])]),e("p",[t._v("然后会看到如下界面:")]),t._v(" "),e("p",[e("img",{attrs:{src:"/notes/assets/git/2147642-03d48aa767efb307.webp",alt:"demo"}})]),t._v(" "),e("p",[t._v("上面未被注释的部分列出的是本次rebase操作包含的所有提交，下面注释部分是git为提供的命令说明。每一个"),e("code",[t._v("commit id")]),t._v(" 前面的"),e("code",[t._v("pick")]),t._v("表示指令类型，"),e("code",[t._v("git")]),t._v(" 为提供了以下几个命令:")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("p，选择"),e("code",[t._v("<commit>")]),t._v(" =使用提交")])]),t._v(" "),e("li",[e("p",[t._v("r，改写"),e("code",[t._v("<commit>")]),t._v(" =使用提交，但编辑提交消息")])]),t._v(" "),e("li",[e("p",[t._v("e，编辑"),e("code",[t._v("<commit>")]),t._v(" =使用提交，但停止进行修改")])]),t._v(" "),e("li",[e("p",[t._v("s，squash "),e("code",[t._v("<commit>")]),t._v(" =使用提交，但可以合并到先前的提交中")])]),t._v(" "),e("li",[e("p",[t._v("f，fixup "),e("code",[t._v("<commit>")]),t._v(" =类似于“ squash”，但丢弃此提交的日志消息")])]),t._v(" "),e("li",[e("p",[t._v("x，exec <命令> =使用shell运行命令（该行的其余部分）")])]),t._v(" "),e("li",[e("p",[t._v("b，break =在这里停止（稍后继续使用'git rebase --continue'进行重新设置）")])]),t._v(" "),e("li",[e("p",[t._v("d，删除"),e("code",[t._v("<commit>")]),t._v(" =删除提交")])]),t._v(" "),e("li",[e("p",[t._v("l，label "),e("code",[t._v("<label>")]),t._v(" =用名称标记当前HEAD")])]),t._v(" "),e("li",[e("p",[t._v("t，重置"),e("code",[t._v("<label>")]),t._v(" =将HEAD重置为标签")])]),t._v(" "),e("li",[e("p",[t._v("m，合并"),e("code",[t._v("[-C <commit> | -c <commit>] <label> [＃<oneline>]")])]),t._v(" "),e("ul",[e("li",[e("p",[t._v("使用原始合并提交的创建合并提交")])]),t._v(" "),e("li",[e("p",[t._v("消息（如果没有原始合并提交，则返回单行）")])]),t._v(" "),e("li",[e("p",[t._v("指定的）。 使用-c "),e("code",[t._v("<commit>")]),t._v("改写提交消息。")])])])])]),t._v(" "),e("p",[t._v("这些行可以重新排序； 它们从上到下执行。\n如果您在此处删除一行，那将丢失。\n但是，如果删除所有内容，则重新定位将中止。")]),t._v(" "),e("p",[t._v("根据的需求，将commit内容编辑如下:")]),t._v(" "),e("p",[e("img",{attrs:{src:"/notes/assets/git/2147642-a651234e62ed20a5.webp",alt:"demo"}})]),t._v(" "),e("p",[t._v("然后是注释修改界面:")]),t._v(" "),e("p",[e("img",{attrs:{src:"/notes/assets/git/2147642-44bbd784dcadfb31.webp",alt:"demo"}})]),t._v(" "),e("p",[t._v("编辑完保存即可完成commit的合并了：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/notes/assets/git/2147642-334e0a5c47a24f87.webp",alt:"demo"}})]),t._v(" "),e("h2",{attrs:{id:"_2-将某一段commit粘贴到另一个分支上"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-将某一段commit粘贴到另一个分支上"}},[t._v("#")]),t._v(" 2.将某一段commit粘贴到另一个分支上")]),t._v(" "),e("p",[t._v("当项目中存在多个分支，有时候需要将某一个分支中的一段提交同时应用到其他分支中，就像下图：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/notes/assets/git/2147642-0de010746cb78401.webp",alt:"demo"}})]),t._v(" "),e("p",[t._v("希望将"),e("code",[t._v("develop")]),t._v("分支中的C~E部分复制到"),e("code",[t._v("master")]),t._v("分支中，这时就可以通过"),e("code",[t._v("rebase")]),t._v("命令来实现（如果只是复制某一两个提交到其他分支，建议使用更简单的命令:"),e("code",[t._v("git cherry-pick")]),t._v("）。")]),t._v(" "),e("p",[t._v("在实际模拟中，创建了"),e("code",[t._v("master")]),t._v("和"),e("code",[t._v("develop")]),t._v("两个分支:")]),t._v(" "),e("p",[e("strong",[t._v("master分支:")])]),t._v(" "),e("p",[e("img",{attrs:{src:"/notes/assets/git/2147642-c41f60d26b00cdfc.webp",alt:"demo"}})]),t._v(" "),e("p",[e("strong",[t._v("develop分支:")])]),t._v(" "),e("p",[e("img",{attrs:{src:"/notes/assets/git/2147642-8519a024c88129c5.webp",alt:"demo"}})]),t._v(" "),e("p",[t._v("使用命令的形式为:")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" rebase "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("startpoint"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("endpoint"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --onto "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("branchName"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),e("p",[t._v("其中，"),e("code",[t._v("[startpoint]")]),t._v(" "),e("code",[t._v("[endpoint]")]),t._v("仍然和上一个命令一样指定了一个编辑区间(前开后闭)，"),e("code",[t._v("--onto")]),t._v("的意思是要将该指定的提交复制到哪个分支上。")]),t._v(" "),e("p",[t._v("所以，在找到C("),e("code",[t._v("90bc0045b")]),t._v(")和E("),e("code",[t._v("5de0da9f2")]),t._v(")的提交id后，运行以下命令：")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" rebase 90bc0045b 5de0da9f2 --onto master\n")])])]),e("p",[t._v("注:因为"),e("code",[t._v("[startpoint]")]),t._v(" "),e("code",[t._v("[endpoint]")]),t._v("指定的是一个前开后闭的区间，为了让这个区间包含C提交，将区间起始点向后退了一步。")]),t._v(" "),e("p",[t._v("运行完成后查看当前分支的日志:")]),t._v(" "),e("p",[e("img",{attrs:{src:"/notes/assets/git/2147642-de397671caac1966.webp",alt:"demo"}})]),t._v(" "),e("p",[t._v("可以看到，C~E部分的提交内容已经复制到了G的后面了，大功告成？NO！看一下当前分支的状态:")]),t._v(" "),e("p",[e("img",{attrs:{src:"/notes/assets/git/2147642-cfd21fdb1e4038bc.webp",alt:"demo"}})]),t._v(" "),e("p",[t._v("当前HEAD处于游离状态，实际上，此时所有分支的状态应该是这样:")]),t._v(" "),e("p",[e("img",{attrs:{src:"/notes/assets/git/2147642-a3bbfea6d760f64a.webp",alt:""}})]),t._v(" "),e("p",[t._v("所以，虽然此时HEAD所指向的内容正是所需要的，但是master分支是没有任何变化的，git只是将C~E部分的提交内容复制一份粘贴到了master所指向的提交后面，需要做的就是将master所指向的提交id设置为当前HEAD所指向的提交id就可以了，即:")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" checkout master\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" reset --hard  0c72e64\n")])])]),e("p",[e("img",{attrs:{src:"/notes/assets/git/2147642-003361cb0305c094.webp",alt:""}})])])}),[],!1,null,null,null);s.default=v.exports}}]);