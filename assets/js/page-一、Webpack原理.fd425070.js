(window.webpackJsonp=window.webpackJsonp||[]).push([[429],{1219:function(t,s,a){"use strict";a.r(s);var n=a(1),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:""}},[a("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")])]),t._v(" "),a("h1",{attrs:{id:"一、webpack-原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、webpack-原理"}},[t._v("#")]),t._v(" 一、Webpack 原理")]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"_1、构建作用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、构建作用"}},[t._v("#")]),t._v(" 1、构建作用")]),t._v(" "),a("p",[t._v("构建工具就是将源代码转换成可执行的 "),a("code",[t._v("JavaScript")]),t._v("、"),a("code",[t._v("CSS")]),t._v("、"),a("code",[t._v("HTML")]),t._v(" 代码，包括以下内容：")]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("代码转换：")]),t._v(" 将 "),a("code",[t._v("TypeScript")]),t._v(" 编译成 "),a("code",[t._v("JavaScript")]),t._v("、将 "),a("code",[t._v("SCSS")]),t._v(" 编译成 "),a("code",[t._v("CSS")]),t._v(" 等；")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("文件优化：")]),t._v(" 压缩 "),a("code",[t._v("JavaScript")]),t._v("、"),a("code",[t._v("CSS")]),t._v("、"),a("code",[t._v("HTML")]),t._v(" 代码，压缩合并图片等；")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("代码分割：")]),t._v(" 提取多个页面的公共代码，提取首屏不需要执行部分的代码，让其异步加载；")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("模块合并：")]),t._v(" 在采用模块化的项目里会有很多个模块和文件，需要通过构建功能将模块分类合并成一个文件；")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("自动刷新：")]),t._v(" 监听本地源代码的变化，自动重新构建、刷新浏览器；")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("代码校验：")]),t._v(" 在代码被提交到仓库前需要校验代码是否符合规范，以及单元测试是否通过；")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("自动发布：")]),t._v(" 更新代码后，自动构建出线上发布代码并传输给发布系统；")])])]),t._v(" "),a("h2",{attrs:{id:"_2、核心概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、核心概念"}},[t._v("#")]),t._v(" 2、核心概念")]),t._v(" "),a("p",[t._v("Webpack 有以下几个核心概念：")]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("Entry：")]),t._v(" 入口，Webpack 执行构建的第一步将从 "),a("code",[t._v("entry")]),t._v(" 开始，可抽象成输入；")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("Module：")]),t._v(" 模块，配置处理模块的规则；在 Webpack 里一切皆模块，一个模块对应一个文件；Webpack 会从配置的 "),a("code",[t._v("Entry")]),t._v(" 开始递归找出所有依赖的模块；")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("Loader：")]),t._v(" 模块转换器，用于将模块的原内容按照需求转换成新内容；")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("Resolve：")]),t._v(" 配置寻找模块的规则；")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("Plugin：")]),t._v(" 扩展插件，在 Webpack 构建流程中的特定时机会广播对应的事件，插件可以监听这些事情的发生，在特定的时机做对应的事情；")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("Output：")]),t._v(" 输出结果，在 Webpack 经过一系列处理并得出最终想要的代码后输出结果；")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("Chunk：")]),t._v(" 代码块，一个 "),a("code",[t._v("Chunk")]),t._v(" 由多个模块组合而成，用于代码合并与分割；")])])]),t._v(" "),a("h2",{attrs:{id:"_3、流程概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、流程概述"}},[t._v("#")]),t._v(" 3、流程概述")]),t._v(" "),a("p",[t._v("（1）初始化参数：从配置文件和 Shell 语句中读取与合并参数，得出最终的参数；")]),t._v(" "),a("p",[t._v("（2）开始编译：用上一步得到的参数初始化 Compiler 对象，加载所有配置的插件，通过执行对象的 run 方法开始执行编译；")]),t._v(" "),a("p",[t._v("（3）确定入口：根据配置中的 entry 找出所有入口文件；")]),t._v(" "),a("p",[t._v("（4）编译模块：从入口文件出发，调用所有配置的 Loader 对模块进行翻译，再找出该模块依赖的模块，再递归本步骤直到所有入口依赖的文件都经过了本步骤的处理；")]),t._v(" "),a("p",[t._v("（5）完成模块编译：在经过第 4 步使用 Loader 翻译完所有模块后，得到了每个模块被翻译后的最终内容及它们之间的依赖关系；")]),t._v(" "),a("p",[t._v("（6）输出资源：根据入口和模块之间的依赖关系，组装成一个个包含多个模块的 Chunk，再将每个 Chunk 转换成一个单独的文件加入输出列表中，这是可以修改输出内容的最后机会；")]),t._v(" "),a("p",[t._v("（7）输出完成：在确定好输出内容后，根据配置确定输出的路径和文件名，将文件的内容写入文件系统中；")]),t._v(" "),a("p",[t._v("在以上过程中，"),a("code",[t._v("Webpack")]),t._v(" 会在特定的时间点广播特定的事件，插件在监听到感兴趣的事件后会执行特定的逻辑，并且插件可以调用 "),a("code",[t._v("Webpack")]),t._v(" 提供的 API 改变 "),a("code",[t._v("Webpack")]),t._v(" 的运行结果；")]),t._v(" "),a("h1",{attrs:{id:"二、webpack-配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、webpack-配置"}},[t._v("#")]),t._v(" 二、Webpack 配置")]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"_1、webpack-项目初始化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、webpack-项目初始化"}},[t._v("#")]),t._v(" 1、Webpack 项目初始化")]),t._v(" "),a("h3",{attrs:{id:"_1、新建-web-项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、新建-web-项目"}},[t._v("#")]),t._v(" 1、新建 Web 项目")]),t._v(" "),a("p",[t._v("新建一个目录，再进入项目根目录执行 "),a("code",[t._v("npm init")]),t._v(" 来初始化最简单的采用了模块化开发的项目；最终生成 "),a("code",[t._v("package.json")]),t._v(" 文件；")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" init\n")])])]),a("h3",{attrs:{id:"_2、安装-webpack-到本项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、安装-webpack-到本项目"}},[t._v("#")]),t._v(" 2、安装 Webpack 到本项目")]),t._v(" "),a("p",[t._v("（1）查看 Webpack 版本")]),t._v(" "),a("p",[t._v("运行以下命令可以查看 Webpack 的版本号")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" view webpack versions\n")])])]),a("p",[t._v("（2）安装 Webpack")]),t._v(" "),a("p",[t._v("可以选择（1）步骤罗列得到的 Webpack 版本号，也可以安装最新稳定版、最新体验版本，相关命令如下所示，选择安装 4.28.2 版本（没有为什么，就想装个 4.x 的版本）；")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("// 安装指定版本\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" i -D webpack@4.28.2\n\n// 安装最新稳定版\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" i -D webpack\n\n// 安装最新体验版本\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" i -D webpack@beta\n")])])]),a("p",[t._v("（3）安装 Webpack 脚手架")]),t._v(" "),a("p",[t._v("需要安装 "),a("code",[t._v("Webpack")]),t._v(" 脚手架，才能在命令窗口执行 "),a("code",[t._v("Webpack")]),t._v(" 命令，运行以下命令安装 "),a("code",[t._v("Webpack")]),t._v(" 脚手架；")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" i -D webpack-cli\n")])])]),a("h3",{attrs:{id:"_3、使用-webpack"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、使用-webpack"}},[t._v("#")]),t._v(" 3、使用 Webpack")]),t._v(" "),a("p",[t._v("使用 Webpack 构建一个采用 "),a("code",[t._v("CommonJS")]),t._v(" 模块化编写的项目；")]),t._v(" "),a("p",[t._v("（1）新建页面入口文件 "),a("code",[t._v("index.html")])]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token doctype"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<!")]),a("span",{pre:!0,attrs:{class:"token doctype-tag"}},[t._v("DOCTYPE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token name"}},[t._v("html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("html")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("lang")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("en"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("head")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("charset")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("UTF-8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("viewport"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("content")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("width=device-width, initial-scale=1.0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("http-equiv")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("X-UA-Compatible"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("content")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("ie=edge"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("title")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Webpack"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("title")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("head")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!--导入 Webpack 输出的 JavaScript 文件--\x3e")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("./dist/bundle.js"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}}),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("  \n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("p",[t._v("（2）新建需要用到的 JS 文件")]),t._v(" "),a("blockquote",[a("p",[t._v("show.js 文件")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 操作 DOM 元素，把 content 显示到网页上")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("show")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("content")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'app'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerText "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Hello,'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" content"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通过 CommonJS 规范导出 show 函数")]),t._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" show"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("main.js 文件")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通过 CommonJS 规范导入 show 函数")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" show "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./show.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 执行 show 函数")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("show")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Webpack'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("（3）新建 Webpack 配置文件 webpack.config.js")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// JavaScript 执行入口文件")]),t._v("\n  entry"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./main.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  output"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 把所有依赖的模块合并输出到一个 bundle.js 文件")]),t._v("\n    filename"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bundle.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 输出文件都放到 dist 目录下")]),t._v("\n    path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./dist'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("（4）执行 webpack 命令进行构建")]),t._v(" "),a("p",[t._v("在 "),a("code",[t._v("package.json")]),t._v(" 文件中配置编译命令，如下所示：")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"build"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"webpack --config webpack.config.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),a("p",[t._v("执行以下命令进行项目的 "),a("code",[t._v("Webpack")]),t._v(" 编译，成功后会在项目根目录下生成编译目录 "),a("code",[t._v("dist")]),t._v(" ；")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build\n")])])]),a("p",[t._v("（5）运行 index.html")]),t._v(" "),a("p",[t._v("编译成功后，用浏览器打开 "),a("code",[t._v("index.html")]),t._v(" 文件，能看到页面成功显示 “Hello Webpack”；")]),t._v(" "),a("h2",{attrs:{id:"_2、loader-配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、loader-配置"}},[t._v("#")]),t._v(" 2、Loader 配置")]),t._v(" "),a("p",[t._v("本节通过为之前的例子添加样式，来尝试使用 "),a("code",[t._v("Loader")]),t._v("；")]),t._v(" "),a("h3",{attrs:{id:"_1-新建样式文件-main-css"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-新建样式文件-main-css"}},[t._v("#")]),t._v(" （1）新建样式文件 main.css")]),t._v(" "),a("div",{staticClass:"language-css extra-class"},[a("pre",{pre:!0,attrs:{class:"language-css"}},[a("code",[a("span",{pre:!0,attrs:{class:"token selector"}},[t._v("#app")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("text-align")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" center"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("color")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#999'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"_2-将-main-css-文件引入入口文件-main-js-中-如下所示"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-将-main-css-文件引入入口文件-main-js-中-如下所示"}},[t._v("#")]),t._v(" （2）将 main.css 文件引入入口文件 main.js 中，如下所示：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通过 CommonJS 规范导入 CSS 模块")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./main.css'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通过 CommonJS 规范导入 show 函数")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" show "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./show.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 执行 show 函数")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("show")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Webpack'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h3",{attrs:{id:"_3-loader-配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-loader-配置"}},[t._v("#")]),t._v(" （3）Loader 配置")]),t._v(" "),a("p",[t._v("以上修改后去执行 "),a("code",[t._v("Webpack")]),t._v(" 构建是会报错的，因为 "),a("code",[t._v("Webpack")]),t._v(" 不原生支持解析 "),a("code",[t._v("CSS")]),t._v(" 文件。要支持非 "),a("code",[t._v("JavaScript")]),t._v(" 类型的文件，需要使用 "),a("code",[t._v("Webpack")]),t._v(" 的 "),a("code",[t._v("Loader")]),t._v(" 机制；")]),t._v(" "),a("p",[t._v("（3.1）运行以下命令，安装 "),a("code",[t._v("style-loader")]),t._v(" 和 "),a("code",[t._v("css-loader")]),t._v("，其中：")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("css-loader")]),t._v(" 用于读取 "),a("code",[t._v("CSS")]),t._v(" 文件；")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("style-loader")]),t._v(" 把 "),a("code",[t._v("CSS")]),t._v(" 内容注入到 "),a("code",[t._v("JavaScript")]),t._v(" 中；")])])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" i -D style-loader css-loader\n")])])]),a("p",[t._v("（3.2）进行以下配置")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("module"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    rules"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 用正则去匹配要用该 loader 转换的 CSS 文件")]),t._v("\n            test"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\.css$")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            use"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'style-loader'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'css-loader'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"_4-查看结果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-查看结果"}},[t._v("#")]),t._v(" （4）查看结果")]),t._v(" "),a("p",[t._v("编译后，刷新 "),a("code",[t._v("index.html")]),t._v(" ，查看刚刚的样式 "),a("code",[t._v("loader")]),t._v(" 已经起作用；")]),t._v(" "),a("p",[a("img",{attrs:{src:"/notes/assets/webpack/16f8ccdeb77f673c.jpg",alt:"demo"}})]),t._v(" "),a("h2",{attrs:{id:"_3、plugin-配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、plugin-配置"}},[t._v("#")]),t._v(" 3、Plugin 配置")]),t._v(" "),a("h3",{attrs:{id:"_1-安装样式提取插件-extract-text-webpack-plugin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装样式提取插件-extract-text-webpack-plugin"}},[t._v("#")]),t._v(" （1）安装样式提取插件 extract-text-webpack-plugin")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" i -D extract-text-webpack-plugin@next\n")])])]),a("h3",{attrs:{id:"_2-plugin-文件配置如下"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-plugin-文件配置如下"}},[t._v("#")]),t._v(" （2）plugin 文件配置如下")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("module"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    rules"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 用正则去匹配要用该 loader 转换的 CSS 文件")]),t._v("\n            test"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\.css$")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            use"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("ExtractTextPlugin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("extract")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                use"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'css-loader'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nplugins"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ExtractTextPlugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 从 .js 文件中提取出来的 .css 文件的名称")]),t._v("\n        filename"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("[name]_[hash:8].css")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("h3",{attrs:{id:"_3-查看结果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-查看结果"}},[t._v("#")]),t._v(" （3）查看结果")]),t._v(" "),a("p",[t._v("通过以上配置后，执行 "),a("code",[t._v("Webapack")]),t._v(" 的执行命令，发现在 "),a("code",[t._v("dist")]),t._v(" 目录下，生成对应的 "),a("code",[t._v("css")]),t._v(" 文件；存在的坑点：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("需要手动将生成的 "),a("code",[t._v("css")]),t._v(" 文件引入到 "),a("code",[t._v("index.html")]),t._v(" 中；")])]),t._v(" "),a("li",[a("p",[t._v("修改 "),a("code",[t._v("css")]),t._v(" 文件后，会生成新的 "),a("code",[t._v("css")]),t._v(" 文件，原先的不会删除；")])])]),t._v(" "),a("h2",{attrs:{id:"_4、使用-devserver"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、使用-devserver"}},[t._v("#")]),t._v(" 4、使用 DevServer")]),t._v(" "),a("h3",{attrs:{id:"_1-执行以下命令安装-webpack-dev-server"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-执行以下命令安装-webpack-dev-server"}},[t._v("#")]),t._v(" （1）执行以下命令安装 webpack-dev-server")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" i -D  webpack-dev-server\n")])])]),a("p",[t._v("在 package.json 中配置启动命令")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"build"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"webpack --config webpack.config.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"dev"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"webpack-dev-server"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),a("p",[t._v("运行命令后，就可以启动 "),a("code",[t._v("HTTP")]),t._v(" 服务")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run dev\n")])])]),a("p",[t._v("启动结果如下所示，可以通过 "),a("code",[t._v("http://localhost:8080/")]),t._v(" 访问的 "),a("code",[t._v("index.html")]),t._v(" 的demo")]),t._v(" "),a("p",[a("img",{attrs:{src:"/notes/assets/webpack/16f8ccdec2f9318d.jpg",alt:"demo"}})]),t._v(" "),a("h3",{attrs:{id:"_2-实时预览"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-实时预览"}},[t._v("#")]),t._v(" （2）实时预览")]),t._v(" "),a("p",[t._v("在运行命令后面添加参数 "),a("code",[t._v("--watch")]),t._v(" 实现实时预览，配置如下所示：")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"dev"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"webpack-dev-server --watch"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("在 "),a("code",[t._v("index.html")]),t._v(" 中需要将 js 的路径修改为：")])]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("bundle.js"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}}),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("  \n")])])]),a("p",[t._v("而不能是之前的（因为这个是编译生成的，并不是通过 "),a("code",[t._v("devServer")]),t._v(" 生成放在内存的）")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("./dist/bundle.js"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}}),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" \n")])])]),a("h3",{attrs:{id:"_3-模块热替换"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-模块热替换"}},[t._v("#")]),t._v(" （3）模块热替换")]),t._v(" "),a("p",[t._v("可以通过配置 "),a("code",[t._v("--hot")]),t._v(" 进行模块热替换；")]),t._v(" "),a("h1",{attrs:{id:"四、编写-loader"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、编写-loader"}},[t._v("#")]),t._v(" 四、编写 Loader")]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"_1、loader-要点总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、loader-要点总结"}},[t._v("#")]),t._v(" 1、Loader 要点总结")]),t._v(" "),a("h3",{attrs:{id:"_1-loader-为模块转换器-用于将模块的原内容按照需求转换成新内容"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-loader-为模块转换器-用于将模块的原内容按照需求转换成新内容"}},[t._v("#")]),t._v(" （1）Loader 为模块转换器，用于将模块的原内容按照需求转换成新内容；")]),t._v(" "),a("h3",{attrs:{id:"_2-loader-的职责是单一的-只需要完成一种转换-遵守单一职责原则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-loader-的职责是单一的-只需要完成一种转换-遵守单一职责原则"}},[t._v("#")]),t._v(" （2）Loader 的职责是单一的，只需要完成一种转换，遵守单一职责原则；")]),t._v(" "),a("h3",{attrs:{id:"_3-webpack-为-loader-提供了一系列-api-供-loader-调用-例如"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-webpack-为-loader-提供了一系列-api-供-loader-调用-例如"}},[t._v("#")]),t._v(" （3）Webpack 为 Loader 提供了一系列 API 供 Loader 调用，例如：")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("loader-utils.getOptions( this )")]),t._v(" 获取用户传入的 options，")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("this.callback( )")]),t._v(" 自定义返回结果，")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("this.async( )")]),t._v(" 支持异步操作；")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("this.context")]),t._v(" 当前文件所在的目录；")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("this.resource")]),t._v(" 当前处理文件的完整请求路径；")])])]),t._v(" "),a("h2",{attrs:{id:"_2、编写-loader-源码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、编写-loader-源码"}},[t._v("#")]),t._v(" 2、编写 loader 源码")]),t._v(" "),a("h3",{attrs:{id:"_1-源码编写"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-源码编写"}},[t._v("#")]),t._v(" （1）源码编写")]),t._v(" "),a("p",[t._v("在原有的项目底下，新建目录 "),a("code",[t._v("custom-loader")]),t._v(" 作为编写 "),a("code",[t._v("loader")]),t._v(" 的名称，执行 "),a("code",[t._v("npm init")]),t._v(" 命令，新建一个模块化项目，然后新建 "),a("code",[t._v("index.js")]),t._v(" 文件，相关源码如下：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("convert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("source")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" source "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" source"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("hello")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("gi")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'HELLO'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("content")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("convert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("content"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"_2-npm-link-模块注册"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-npm-link-模块注册"}},[t._v("#")]),t._v(" （2）Npm link 模块注册")]),t._v(" "),a("p",[t._v("正常安装 "),a("code",[t._v("Loader")]),t._v(" 是从 "),a("code",[t._v("Npm")]),t._v(" 公有仓库安装，也即将 "),a("code",[t._v("Loader")]),t._v(" 发布到 "),a("code",[t._v("Npm")]),t._v(" 仓库，然后再安装到本地使用；但是可以使用 "),a("code",[t._v("Npm link")]),t._v(" 做到在不发布模块的情况下，将本地的一个正在开发的模块的源码链接到项目的 "),a("code",[t._v("node_modules")]),t._v(" 目录下，让项目可以直接使用本地的 "),a("code",[t._v("Npm")]),t._v(" 模块；")]),t._v(" "),a("p",[t._v("在 "),a("code",[t._v("custom-loader")]),t._v(" 目录底下，运行以下命令，将本地模块注册到全局：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("link")]),t._v("\n")])])]),a("p",[t._v("成功结果如下：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/notes/assets/webpack/16f8ccdeb2b4fa5e.jpg",alt:"demo"}})]),t._v(" "),a("p",[t._v("然后在项目根目录执行以下命令，将注册到全局的本地 "),a("code",[t._v("Npm")]),t._v(" 模块链接到项目的 "),a("code",[t._v("node_modules")]),t._v(" 下：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("link")]),t._v(" custom-loader\n")])])]),a("p",[t._v("成功结果如下，并且在 "),a("code",[t._v("node_modules")]),t._v(" 目录下能查找到对应的 "),a("code",[t._v("loader")]),t._v("；")]),t._v(" "),a("p",[a("img",{attrs:{src:"/notes/assets/webpack/16f8ccdebc0fc0bb.jpg",alt:"demo"}})]),t._v(" "),a("h2",{attrs:{id:"_3、webpack-中配置编写的-loader"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、webpack-中配置编写的-loader"}},[t._v("#")]),t._v(" 3、Webpack 中配置编写的 loader")]),t._v(" "),a("p",[t._v("该配置跟第一章节的 "),a("code",[t._v("Webpack")]),t._v(" 配置并没有任何区别，这里不再详述，配置参考如下：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("module"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    rules"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            test"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\.js")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            use"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'custom-loader'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            include"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'show'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("执行运行 "),a("code",[t._v("or")]),t._v(" 编译命令，就能看到的 "),a("code",[t._v("loader")]),t._v(" 起作用了。")]),t._v(" "),a("h1",{attrs:{id:"五、编写-plugin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五、编写-plugin"}},[t._v("#")]),t._v(" 五、编写 Plugin")]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"_1、plugin-要点总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、plugin-要点总结"}},[t._v("#")]),t._v(" 1、Plugin 要点总结")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("Webpack")]),t._v(" 在编译过程中，会广播很多事件，例如 "),a("code",[t._v("run")]),t._v("、"),a("code",[t._v("compile")]),t._v("、"),a("code",[t._v("done")]),t._v("、"),a("code",[t._v("fail")]),t._v(" 等等，可以查看官网；")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("Webpack")]),t._v(" 的事件流机制应用了观察者模式，编写的插件可以监听 "),a("code",[t._v("Webpack")]),t._v(" 事件来触发对应的处理逻辑；")])]),t._v(" "),a("li",[a("p",[t._v("插件中可以使用很多 "),a("code",[t._v("Webpack")]),t._v(" 提供的 "),a("code",[t._v("API")]),t._v("，例如读取输出资源、代码块、模块及依赖等；")])])]),t._v(" "),a("h2",{attrs:{id:"_2、编写-plugin-源码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、编写-plugin-源码"}},[t._v("#")]),t._v(" 2、编写 Plugin 源码")]),t._v(" "),a("p",[t._v("手写一个 "),a("code",[t._v("plugin")]),t._v(" 源码，其功能是在 "),a("code",[t._v("Webpack")]),t._v(" 编译成功或者失败时输出提示；当然这个 "),a("code",[t._v("plugin")]),t._v(" 其实没啥实际意义，纯碎是为了写 "),a("code",[t._v("plugin")]),t._v(" 而写 "),a("code",[t._v("plugin")]),t._v("；当然如果你实际业务有需要编写 "),a("code",[t._v("plugin")]),t._v(" 需求，那就要反思这个业务的合理性，因为庞大的社区，一般合理的需求都能找到对应的 "),a("code",[t._v("plugin")]),t._v("。")]),t._v(" "),a("h3",{attrs:{id:"_1-源码编写-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-源码编写-2"}},[t._v("#")]),t._v(" （1）源码编写")]),t._v(" "),a("p",[t._v("在原有的项目底下，新建目录 "),a("code",[t._v("custom-plugin")]),t._v(" 作为编写 "),a("code",[t._v("plugin")]),t._v(" 的名称，执行 "),a("code",[t._v("npm init")]),t._v(" 命令，新建一个模块化项目，然后新建 "),a("code",[t._v("index.js")]),t._v(" 文件，相关源码如下：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CustomPlugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("doneCallback"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" failCallback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 保存在创建插件实例时传入的回调函数")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("doneCallback "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" doneCallback"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("failCallback "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" failCallback"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apply")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("compiler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 成功完成一次完整的编译和输出流程时，会触发 done 事件")]),t._v("\n        compiler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("plugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'done'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stats")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("doneCallback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("stats"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在编译和输出的流程中遇到异常时，会触发 failed 事件")]),t._v("\n        compiler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("plugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'failed'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("failCallback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CustomPlugin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h3",{attrs:{id:"_2-npm-link-模块注册-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-npm-link-模块注册-2"}},[t._v("#")]),t._v(" （2）Npm link 模块注册")]),t._v(" "),a("p",[t._v("跟 "),a("code",[t._v("Loader")]),t._v(" 注册一样，使用 "),a("code",[t._v("npm link")]),t._v(" 进行注册；")]),t._v(" "),a("p",[t._v("在 "),a("code",[t._v("custom-plugin")]),t._v(" 目录底下，运行以下命令，将本地模块注册到全局：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("link")]),t._v("\n")])])]),a("p",[t._v("然后在项目根目录执行以下命令，将注册到全局的本地 "),a("code",[t._v("Npm")]),t._v(" 模块链接到项目的 "),a("code",[t._v("node_modules")]),t._v(" 下：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("link")]),t._v(" custom-plugin\n")])])]),a("p",[t._v("如果一切顺利，可以在 "),a("code",[t._v("node_modules")]),t._v(" 目录下能查找到对应的 "),a("code",[t._v("plugin")]),t._v("；")]),t._v(" "),a("h2",{attrs:{id:"_3、webpack-中配置编写的-plugin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、webpack-中配置编写的-plugin"}},[t._v("#")]),t._v(" 3、Webpack 中配置编写的 plugin")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("plugins"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CustomPlugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stats")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'编译成功!'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'编译失败!'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),a("p",[t._v("执行运行 "),a("code",[t._v("or")]),t._v(" 编译命令，就能看到的 "),a("code",[t._v("plugin")]),t._v(" 起作用了。")]),t._v(" "),a("h1",{attrs:{id:"六、踩坑汇总"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#六、踩坑汇总"}},[t._v("#")]),t._v(" 六、踩坑汇总")]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"_1、css-loader-以下配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、css-loader-以下配置"}},[t._v("#")]),t._v(" 1、css-loader 以下配置")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("rules"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 用正则去匹配要用该 loader 转换的 CSS 文件")]),t._v("\n        test"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\.css$")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        use"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'style-loader'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'css-loader?minimize'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("p",[t._v("报以下错误:")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v(" - options has an unknown property 'minimize'. These properties are valid:\n   object { url?, import?, modules?, sourceMap?, importLoaders?, localsConvention?, onlyLocals?, esModule? }\n")])])]),a("p",[a("strong",[t._v("原因：")])]),t._v(" "),a("p",[a("code",[t._v("minimize")]),t._v(" 属性在新版本已经被移除，")]),t._v(" "),a("p",[a("strong",[t._v("解决：")])]),t._v(" "),a("p",[t._v("先去掉 "),a("code",[t._v("minimize")]),t._v(" 选项；")]),t._v(" "),a("h2",{attrs:{id:"_2、extracttextplugin-编译以下错误"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、extracttextplugin-编译以下错误"}},[t._v("#")]),t._v(" 2、ExtractTextPlugin 编译以下错误：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/notes/assets/webpack/16f8ccdec2ef858f.jpg",alt:"demo"}})]),t._v(" "),a("p",[a("strong",[t._v("原因：")])]),t._v(" "),a("p",[a("code",[t._v("extract-text-webpack-plugin")]),t._v(" 版本号问题")]),t._v(" "),a("p",[a("strong",[t._v("解决：")])]),t._v(" "),a("p",[t._v("重新安装 "),a("code",[t._v("extract-text-webpack-plugin")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" i -D extract-text-webpack-plugin@next\n")])])]),a("h2",{attrs:{id:"_3、修复第2个坑之后-extracttextplugin-编译继续报以下错误"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、修复第2个坑之后-extracttextplugin-编译继续报以下错误"}},[t._v("#")]),t._v(" 3、修复第2个坑之后，ExtractTextPlugin 编译继续报以下错误：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/notes/assets/webpack/16f8ccdeb8188d88.jpg",alt:"demo"}})]),t._v(" "),a("p",[a("strong",[t._v("原因：")])]),t._v(" "),a("p",[t._v("不存在 "),a("code",[t._v("contenthash")]),t._v(" 这个变量")]),t._v(" "),a("p",[a("strong",[t._v("解决：")])]),t._v(" "),a("p",[t._v("更改 "),a("code",[t._v("extract-text-webpack-plugin")]),t._v(" 的配置：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("plugins"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ExtractTextPlugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 从 .js 文件中提取出来的 .css 文件的名称")]),t._v("\n       filename"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("[name]_[hash:8].css")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("h2",{attrs:{id:"_4、添加-happypack-后-编译-css-文件时报以下错误"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、添加-happypack-后-编译-css-文件时报以下错误"}},[t._v("#")]),t._v(" 4、添加 HappyPack 后，编译 CSS 文件时报以下错误：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/notes/assets/webpack/16f8ccdf66204a16.jpg",alt:"demo"}})]),t._v(" "),a("p",[a("strong",[t._v("原因：")])]),t._v(" "),a("p",[a("code",[t._v("css-loader")]),t._v(" 版本的问题")]),t._v(" "),a("p",[a("strong",[t._v("解决：")])]),t._v(" "),a("p",[t._v("重新安装 "),a("code",[t._v("css-loader@3.2.0")])])])}),[],!1,null,null,null);s.default=e.exports}}]);