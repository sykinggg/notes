<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.43">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>axios 源码整体架构 | </title><meta name="description" content="君子藏器于身 待时而动 天下有道则见 无道则隐">
    <link rel="modulepreload" href="/notes/assets/app.41ff10d5.js"><link rel="modulepreload" href="/notes/assets/axios.html.0a97c09d.js"><link rel="modulepreload" href="/notes/assets/axios.html.152991da.js"><link rel="prefetch" href="/notes/assets/index.html.71fbd40b.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.5e9c1051.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.69139fe7.js"><link rel="prefetch" href="/notes/assets/base.html.55c9999b.js"><link rel="prefetch" href="/notes/assets/customCli.html.3507c8cf.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.88b46823.js"><link rel="prefetch" href="/notes/assets/adapter.html.30be4f23.js"><link rel="prefetch" href="/notes/assets/amd.html.7e568b04.js"><link rel="prefetch" href="/notes/assets/builder.html.2ec6f419.js"><link rel="prefetch" href="/notes/assets/censorJquery.html.dc0e2ac0.js"><link rel="prefetch" href="/notes/assets/combination.html.c97b2a17.js"><link rel="prefetch" href="/notes/assets/command.html.24706be8.js"><link rel="prefetch" href="/notes/assets/commonJS.html.55353194.js"><link rel="prefetch" href="/notes/assets/constructor.html.32508b22.js"><link rel="prefetch" href="/notes/assets/decoration.html.7ad4f28e.js"><link rel="prefetch" href="/notes/assets/esHarmony.html.52a11284.js"><link rel="prefetch" href="/notes/assets/exposed.html.5be6b156.js"><link rel="prefetch" href="/notes/assets/exterior.html.b59c5dab.js"><link rel="prefetch" href="/notes/assets/factory.html.17f6c0c0.js"><link rel="prefetch" href="/notes/assets/flyweight.html.821ca765.js"><link rel="prefetch" href="/notes/assets/functionalProgramming.html.48b08921.js"><link rel="prefetch" href="/notes/assets/intermediary.html.3875139e.js"><link rel="prefetch" href="/notes/assets/iterator.html.80e605a4.js"><link rel="prefetch" href="/notes/assets/lazyInitial.html.c85f4e3c.js"><link rel="prefetch" href="/notes/assets/mixin.html.63ea55c1.js"><link rel="prefetch" href="/notes/assets/module.html.43952a24.js"><link rel="prefetch" href="/notes/assets/mvc.html.27c0817c.js"><link rel="prefetch" href="/notes/assets/mvp.html.6a557eb7.js"><link rel="prefetch" href="/notes/assets/mvvm.html.2f68a42d.js"><link rel="prefetch" href="/notes/assets/observer.html.243272f7.js"><link rel="prefetch" href="/notes/assets/outward.html.f233e8f4.js"><link rel="prefetch" href="/notes/assets/overview.html.8be7f8f1.js"><link rel="prefetch" href="/notes/assets/prototype.html.0a60ba3b.js"><link rel="prefetch" href="/notes/assets/proxy.html.c7a9712c.js"><link rel="prefetch" href="/notes/assets/singleton.html.924eb57a.js"><link rel="prefetch" href="/notes/assets/createUnderscore.html.12ece0eb.js"><link rel="prefetch" href="/notes/assets/jquery.html.11a87e06.js"><link rel="prefetch" href="/notes/assets/lodash.html.a28f3ffa.js"><link rel="prefetch" href="/notes/assets/sentry.html.88bb14c9.js"><link rel="prefetch" href="/notes/assets/underscore.html.65a76115.js"><link rel="prefetch" href="/notes/assets/vuex.html.c241aef7.js"><link rel="prefetch" href="/notes/assets/customCli.html.6827cb4a.js"><link rel="prefetch" href="/notes/assets/description.html.ac769419.js"><link rel="prefetch" href="/notes/assets/indx.html.55eea29a.js"><link rel="prefetch" href="/notes/assets/rebase.html.413e1a1f.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.36614e79.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.d63f531d.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.1fb07a05.js"><link rel="prefetch" href="/notes/assets/44Questions.html.cd56a67c.js"><link rel="prefetch" href="/notes/assets/asyncAwait.html.e7c7adad.js"><link rel="prefetch" href="/notes/assets/babelCompile.html.7fe3caef.js"><link rel="prefetch" href="/notes/assets/base.html.a8bcba86.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.bf629027.js"><link rel="prefetch" href="/notes/assets/baseWebpack.html.4610526f.js"><link rel="prefetch" href="/notes/assets/codeSeparation.html.79666217.js"><link rel="prefetch" href="/notes/assets/cycle.html.8be7ce7d.js"><link rel="prefetch" href="/notes/assets/cycleOtherWay.html.578d145b.js"><link rel="prefetch" href="/notes/assets/executionMechanism.html.d0164cea.js"><link rel="prefetch" href="/notes/assets/hybrid.html.46f4eb67.js"><link rel="prefetch" href="/notes/assets/jsHandwriting.html.bb2381a2.js"><link rel="prefetch" href="/notes/assets/jsonStringify.html.88e72f13.js"><link rel="prefetch" href="/notes/assets/largeFileResumableUpload.html.bfac7f5b.js"><link rel="prefetch" href="/notes/assets/performance.html.b21c0094.js"><link rel="prefetch" href="/notes/assets/promise.html.e52377e3.js"><link rel="prefetch" href="/notes/assets/promiseAll.html.73d8517c.js"><link rel="prefetch" href="/notes/assets/spa.html.82dad5d8.js"><link rel="prefetch" href="/notes/assets/tsBaseInterview.html.e3ac3b37.js"><link rel="prefetch" href="/notes/assets/useEs6.html.50d0cc65.js"><link rel="prefetch" href="/notes/assets/webAnimations.html.d69af296.js"><link rel="prefetch" href="/notes/assets/webpackInterview.html.5b8fab49.js"><link rel="prefetch" href="/notes/assets/webpackLoader.html.12ea42bd.js"><link rel="prefetch" href="/notes/assets/webpackPublic.html.90e1a830.js"><link rel="prefetch" href="/notes/assets/weird.html.b62a60ae.js"><link rel="prefetch" href="/notes/assets/es10News.html.bc158c6b.js"><link rel="prefetch" href="/notes/assets/es11News.html.70b9ea54.js"><link rel="prefetch" href="/notes/assets/es6Interview1.html.6f308cb1.js"><link rel="prefetch" href="/notes/assets/es6Interview2.html.238cb1a5.js"><link rel="prefetch" href="/notes/assets/es6Interview3.html.d92a39f8.js"><link rel="prefetch" href="/notes/assets/es6News.html.3f5912b4.js"><link rel="prefetch" href="/notes/assets/es7News.html.3220d2f0.js"><link rel="prefetch" href="/notes/assets/es8News.html.e8e6f0bf.js"><link rel="prefetch" href="/notes/assets/es9News.html.624864ec.js"><link rel="prefetch" href="/notes/assets/base.html.aafed503.js"><link rel="prefetch" href="/notes/assets/nginxComprehensiveScene.html.5a3a80b7.js"><link rel="prefetch" href="/notes/assets/commonlyUsed.html.d5ba5b67.js"><link rel="prefetch" href="/notes/assets/inelegantHook.html.f3b76427.js"><link rel="prefetch" href="/notes/assets/interview1.html.bdd8631d.js"><link rel="prefetch" href="/notes/assets/interview2.html.5c9a01b0.js"><link rel="prefetch" href="/notes/assets/interview3.html.8dc8fbef.js"><link rel="prefetch" href="/notes/assets/interview4.html.3c256124.js"><link rel="prefetch" href="/notes/assets/base.html.d33792aa.js"><link rel="prefetch" href="/notes/assets/introduction.html.2d939210.js"><link rel="prefetch" href="/notes/assets/base.html.c8430b6f.js"><link rel="prefetch" href="/notes/assets/summarize.html.47365fa8.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.ce7947cb.js"><link rel="prefetch" href="/notes/assets/index.html.a2b37411.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.30c85bb7.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.261dfbbe.js"><link rel="prefetch" href="/notes/assets/bigDataRender.html.eb068e4b.js"><link rel="prefetch" href="/notes/assets/progress.html.bb1f22cd.js"><link rel="prefetch" href="/notes/assets/quirksStandards.html.c2757cfb.js"><link rel="prefetch" href="/notes/assets/redrawReflow.html.0e6ef048.js"><link rel="prefetch" href="/notes/assets/storageSpace.html.1311d9f2.js"><link rel="prefetch" href="/notes/assets/webComLink.html.996218a7.js"><link rel="prefetch" href="/notes/assets/webUrl.html.0844097b.js"><link rel="prefetch" href="/notes/assets/spanWidthHeight.html.095593c2.js"><link rel="prefetch" href="/notes/assets/baseCss.html.ad5cb33b.js"><link rel="prefetch" href="/notes/assets/blockFormattingContext.html.641f4ae6.js"><link rel="prefetch" href="/notes/assets/containingBlock.html.71f6f07e.js"><link rel="prefetch" href="/notes/assets/cssBeforeAfter.html.01f79ba9.js"><link rel="prefetch" href="/notes/assets/cssBoxModal.html.811b8aa6.js"><link rel="prefetch" href="/notes/assets/cssCollapsing.html.f37ecbc6.js"><link rel="prefetch" href="/notes/assets/cssCompatible.html.1db2251c.js"><link rel="prefetch" href="/notes/assets/cssFlexDemo.html.7ad58692.js"><link rel="prefetch" href="/notes/assets/cssFlexLayout.html.82fe4a58.js"><link rel="prefetch" href="/notes/assets/cssGridLayout.html.6789bf3e.js"><link rel="prefetch" href="/notes/assets/cssHack.html.2042c341.js"><link rel="prefetch" href="/notes/assets/cssInlineBlock.html.b7306f11.js"><link rel="prefetch" href="/notes/assets/cssPriority.html.7ed2d7b2.js"><link rel="prefetch" href="/notes/assets/cssPseudo.html.f35ded84.js"><link rel="prefetch" href="/notes/assets/cssPseudoClass.html.e3a05420.js"><link rel="prefetch" href="/notes/assets/cssSelector.html.47705a35.js"><link rel="prefetch" href="/notes/assets/cssTutorial.html.026851bf.js"><link rel="prefetch" href="/notes/assets/fieldInvalid.html.9b253070.js"><link rel="prefetch" href="/notes/assets/frame.html.9ecd6456.js"><link rel="prefetch" href="/notes/assets/knowledgePoints.html.6e482209.js"><link rel="prefetch" href="/notes/assets/linkImport.html.ff9b9b5b.js"><link rel="prefetch" href="/notes/assets/stackingContext.html.273c2180.js"><link rel="prefetch" href="/notes/assets/tools.html.b9935888.js"><link rel="prefetch" href="/notes/assets/units.html.7feaa8f6.js"><link rel="prefetch" href="/notes/assets/transform.html.26475cc2.js"><link rel="prefetch" href="/notes/assets/content.html.441f730c.js"><link rel="prefetch" href="/notes/assets/plugins.html.60d0a9f0.js"><link rel="prefetch" href="/notes/assets/accesskey.html.4aef6215.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.39e33056.js"><link rel="prefetch" href="/notes/assets/canvasSvg.html.21d2fa16.js"><link rel="prefetch" href="/notes/assets/deviceAPI.html.d0290e94.js"><link rel="prefetch" href="/notes/assets/globalAttr.html.e8971ba4.js"><link rel="prefetch" href="/notes/assets/htmlDatalist.html.d50829c2.js"><link rel="prefetch" href="/notes/assets/htmlElement.html.402d03c3.js"><link rel="prefetch" href="/notes/assets/interview10.html.5082ca9f.js"><link rel="prefetch" href="/notes/assets/interview11.html.d60cc86d.js"><link rel="prefetch" href="/notes/assets/interview12.html.2ab3b502.js"><link rel="prefetch" href="/notes/assets/interview13.html.7ece0bd1.js"><link rel="prefetch" href="/notes/assets/interview14.html.6bde5a7d.js"><link rel="prefetch" href="/notes/assets/interview15.html.baa8db5e.js"><link rel="prefetch" href="/notes/assets/interview16.html.f78b2228.js"><link rel="prefetch" href="/notes/assets/interview17.html.16add79f.js"><link rel="prefetch" href="/notes/assets/interview18.html.9564e0d2.js"><link rel="prefetch" href="/notes/assets/interview19.html.3934b85b.js"><link rel="prefetch" href="/notes/assets/interview20.html.445deef8.js"><link rel="prefetch" href="/notes/assets/interview21.html.6c5124ea.js"><link rel="prefetch" href="/notes/assets/interview22.html.b9505f56.js"><link rel="prefetch" href="/notes/assets/interview23.html.92209e12.js"><link rel="prefetch" href="/notes/assets/interview24.html.05aec020.js"><link rel="prefetch" href="/notes/assets/interview25.html.4fc83f5f.js"><link rel="prefetch" href="/notes/assets/interview26.html.62b3fb4e.js"><link rel="prefetch" href="/notes/assets/interview27.html.24cb42ee.js"><link rel="prefetch" href="/notes/assets/interview28.html.6a2d2b94.js"><link rel="prefetch" href="/notes/assets/interview29.html.5377c0c1.js"><link rel="prefetch" href="/notes/assets/interview30.html.3f88f741.js"><link rel="prefetch" href="/notes/assets/interview31.html.8be860ae.js"><link rel="prefetch" href="/notes/assets/interview32.html.ffa104c2.js"><link rel="prefetch" href="/notes/assets/interview33.html.429f938e.js"><link rel="prefetch" href="/notes/assets/interview34.html.d61821ae.js"><link rel="prefetch" href="/notes/assets/interview35.html.d0b951b6.js"><link rel="prefetch" href="/notes/assets/interview36.html.a2bfbbed.js"><link rel="prefetch" href="/notes/assets/interview37.html.80d9b412.js"><link rel="prefetch" href="/notes/assets/interview38.html.dc40b641.js"><link rel="prefetch" href="/notes/assets/interview39.html.e838a06d.js"><link rel="prefetch" href="/notes/assets/interview40.html.ca92f3dd.js"><link rel="prefetch" href="/notes/assets/interview41.html.e8f2a4ec.js"><link rel="prefetch" href="/notes/assets/interview42.html.bf034bac.js"><link rel="prefetch" href="/notes/assets/interview43.html.46b1ef12.js"><link rel="prefetch" href="/notes/assets/interview44.html.be614f5d.js"><link rel="prefetch" href="/notes/assets/interview45.html.3abb7fe3.js"><link rel="prefetch" href="/notes/assets/interview46.html.896e49dd.js"><link rel="prefetch" href="/notes/assets/interview47.html.314aac5a.js"><link rel="prefetch" href="/notes/assets/interview48.html.602e4f5e.js"><link rel="prefetch" href="/notes/assets/interview49.html.d0941a05.js"><link rel="prefetch" href="/notes/assets/interview5.html.baadff11.js"><link rel="prefetch" href="/notes/assets/interview50.html.9c6b09e8.js"><link rel="prefetch" href="/notes/assets/interview51.html.d3282e0d.js"><link rel="prefetch" href="/notes/assets/interview52.html.f22847c1.js"><link rel="prefetch" href="/notes/assets/interview53.html.c09e48af.js"><link rel="prefetch" href="/notes/assets/interview54.html.6e94310c.js"><link rel="prefetch" href="/notes/assets/interview55.html.13ae49c5.js"><link rel="prefetch" href="/notes/assets/interview56.html.0820ec5c.js"><link rel="prefetch" href="/notes/assets/interview57.html.7399c90e.js"><link rel="prefetch" href="/notes/assets/interview58.html.7ee3a7b8.js"><link rel="prefetch" href="/notes/assets/interview59.html.b7cd2c0a.js"><link rel="prefetch" href="/notes/assets/interview6.html.3838ee59.js"><link rel="prefetch" href="/notes/assets/interview7.html.18a57855.js"><link rel="prefetch" href="/notes/assets/interview8.html.6fb9706e.js"><link rel="prefetch" href="/notes/assets/interview9.html.8e623cf8.js"><link rel="prefetch" href="/notes/assets/linkImport.html.62b55985.js"><link rel="prefetch" href="/notes/assets/offlineStorage.html.4392532d.js"><link rel="prefetch" href="/notes/assets/regular.html.0af25dff.js"><link rel="prefetch" href="/notes/assets/shake.html.98be5054.js"><link rel="prefetch" href="/notes/assets/webWorker.html.dc505d02.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.63702d28.js"><link rel="prefetch" href="/notes/assets/cors.html.b0a290ac.js"><link rel="prefetch" href="/notes/assets/crossDomainCookie.html.bf6b2f51.js"><link rel="prefetch" href="/notes/assets/fetch.html.09956e28.js"><link rel="prefetch" href="/notes/assets/nestAxios.html.1f2e7064.js"><link rel="prefetch" href="/notes/assets/debounce.html.15d9af40.js"><link rel="prefetch" href="/notes/assets/lodashPrinciple.html.0bdfa1f8.js"><link rel="prefetch" href="/notes/assets/lodashThrottleDebounce.html.adbfe084.js"><link rel="prefetch" href="/notes/assets/throttle.html.296736b4.js"><link rel="prefetch" href="/notes/assets/throttleDebounceReact.html.cd5ffed7.js"><link rel="prefetch" href="/notes/assets/cloneIntroduction.html.b83010d1.js"><link rel="prefetch" href="/notes/assets/deepClone.html.69460c40.js"><link rel="prefetch" href="/notes/assets/lodashDeepClone.html.f395197a.js"><link rel="prefetch" href="/notes/assets/objectAssign.html.28df3036.js"><link rel="prefetch" href="/notes/assets/arraySourceCode.html.b52f7871.js"><link rel="prefetch" href="/notes/assets/baseHigh.html.52b9f97d.js"><link rel="prefetch" href="/notes/assets/currying.html.442aed16.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.334fcf6b.js"><link rel="prefetch" href="/notes/assets/eventLoop.html.533a98e2.js"><link rel="prefetch" href="/notes/assets/iife.html.7811eb5a.js"><link rel="prefetch" href="/notes/assets/interview1.html.2abdf160.js"><link rel="prefetch" href="/notes/assets/jsCompatible.html.c67930bf.js"><link rel="prefetch" href="/notes/assets/baseProyotype.html.9c153010.js"><link rel="prefetch" href="/notes/assets/functionObjectResource.html.b9fe93d8.js"><link rel="prefetch" href="/notes/assets/prototypeInherit.html.231989d7.js"><link rel="prefetch" href="/notes/assets/closureInterview.html.d7b62950.js"><link rel="prefetch" href="/notes/assets/scopeChain.html.b9e9438b.js"><link rel="prefetch" href="/notes/assets/understandingClosures.html.2283c11b.js"><link rel="prefetch" href="/notes/assets/executionStack.html.365cf24c.js"><link rel="prefetch" href="/notes/assets/memoryLeak.html.7b1f8867.js"><link rel="prefetch" href="/notes/assets/memoryMechanism.html.a8927915.js"><link rel="prefetch" href="/notes/assets/memorySpace.html.79041994.js"><link rel="prefetch" href="/notes/assets/precompiled.html.0f610672.js"><link rel="prefetch" href="/notes/assets/variableObject.html.e3be40ed.js"><link rel="prefetch" href="/notes/assets/arrowFunctionThis.html.17d754a7.js"><link rel="prefetch" href="/notes/assets/bindSimulation.html.ab7b7b44.js"><link rel="prefetch" href="/notes/assets/callApply.html.d9d2a028.js"><link rel="prefetch" href="/notes/assets/newSimulation.html.bda8c01b.js"><link rel="prefetch" href="/notes/assets/thisBind.html.6ab95334.js"><link rel="prefetch" href="/notes/assets/interview1.html.092be8b4.js"><link rel="prefetch" href="/notes/assets/interview10.html.c3bb146b.js"><link rel="prefetch" href="/notes/assets/interview11.html.129bcf14.js"><link rel="prefetch" href="/notes/assets/interview12.html.91b691f5.js"><link rel="prefetch" href="/notes/assets/interview13.html.4bf7bd63.js"><link rel="prefetch" href="/notes/assets/interview14.html.52577789.js"><link rel="prefetch" href="/notes/assets/interview15.html.e8ec5267.js"><link rel="prefetch" href="/notes/assets/interview16.html.4b4862f2.js"><link rel="prefetch" href="/notes/assets/interview17.html.204491ca.js"><link rel="prefetch" href="/notes/assets/interview18.html.0cfde035.js"><link rel="prefetch" href="/notes/assets/interview19.html.f936c750.js"><link rel="prefetch" href="/notes/assets/interview2.html.401cc73e.js"><link rel="prefetch" href="/notes/assets/interview20.html.47d79b3e.js"><link rel="prefetch" href="/notes/assets/interview21.html.1f0bf7ad.js"><link rel="prefetch" href="/notes/assets/interview22.html.06d37ddf.js"><link rel="prefetch" href="/notes/assets/interview23.html.ce078cc0.js"><link rel="prefetch" href="/notes/assets/interview24.html.96400736.js"><link rel="prefetch" href="/notes/assets/interview25.html.c622011d.js"><link rel="prefetch" href="/notes/assets/interview26.html.a6a79665.js"><link rel="prefetch" href="/notes/assets/interview27.html.8e790034.js"><link rel="prefetch" href="/notes/assets/interview28.html.91e4e568.js"><link rel="prefetch" href="/notes/assets/interview29.html.56055415.js"><link rel="prefetch" href="/notes/assets/interview3.html.a0e3b696.js"><link rel="prefetch" href="/notes/assets/interview30.html.819d4fa4.js"><link rel="prefetch" href="/notes/assets/interview4.html.fcc3df3b.js"><link rel="prefetch" href="/notes/assets/interview5.html.31372306.js"><link rel="prefetch" href="/notes/assets/interview6.html.5c1cf633.js"><link rel="prefetch" href="/notes/assets/interview7.html.8ee1cb82.js"><link rel="prefetch" href="/notes/assets/interview8.html.b630d562.js"><link rel="prefetch" href="/notes/assets/interview9.html.3e393902.js"><link rel="prefetch" href="/notes/assets/adjacentSiblingCombinator.html.22769094.js"><link rel="prefetch" href="/notes/assets/attributeSelectors.html.e38d7757.js"><link rel="prefetch" href="/notes/assets/charset.html.60946374.js"><link rel="prefetch" href="/notes/assets/childCombinator.html.f070f777.js"><link rel="prefetch" href="/notes/assets/classSelectors.html.60651ad8.js"><link rel="prefetch" href="/notes/assets/descendantCombinator.html.17ff8c43.js"><link rel="prefetch" href="/notes/assets/generalSiblingCombinator.html.783c4f48.js"><link rel="prefetch" href="/notes/assets/iDSelectors.html.d35b8dae.js"><link rel="prefetch" href="/notes/assets/pseudoClasses.html.de7fae5d.js"><link rel="prefetch" href="/notes/assets/pseudoElements.html.06eb4b3f.js"><link rel="prefetch" href="/notes/assets/selectorList.html.94e6b3fc.js"><link rel="prefetch" href="/notes/assets/typeSelectors.html.0fbf13ca.js"><link rel="prefetch" href="/notes/assets/universalSelectors.html.ecba2ff2.js"><link rel="prefetch" href="/notes/assets/IterationProtocols.html.68b9c74e.js"><link rel="prefetch" href="/notes/assets/arrayFlat.html.3d6527d2.js"><link rel="prefetch" href="/notes/assets/asyncHistory.html.e364d4ad.js"><link rel="prefetch" href="/notes/assets/eventLoop.html.994ecf46.js"><link rel="prefetch" href="/notes/assets/fileReader.html.d6e1ae5d.js"><link rel="prefetch" href="/notes/assets/formData.html.830096b1.js"><link rel="prefetch" href="/notes/assets/functionGenerator.html.309a2aef.js"><link rel="prefetch" href="/notes/assets/generator.html.6339ea74.js"><link rel="prefetch" href="/notes/assets/intersectionObserver.html.3a238681.js"><link rel="prefetch" href="/notes/assets/map.html.e3556c64.js"><link rel="prefetch" href="/notes/assets/promise.html.5784aff5.js"><link rel="prefetch" href="/notes/assets/set.html.3a7cbd16.js"><link rel="prefetch" href="/notes/assets/string.html.99365791.js"><link rel="prefetch" href="/notes/assets/symbol.html.41e58345.js"><link rel="prefetch" href="/notes/assets/xMLHttpRequest.html.1687b050.js"><link rel="prefetch" href="/notes/assets/spreadSyntax.html.4ee8b18c.js"><link rel="prefetch" href="/notes/assets/strictMode.html.d69ebc80.js"><link rel="prefetch" href="/notes/assets/cache.html.e1b1fbcc.js"><link rel="prefetch" href="/notes/assets/drag1.html.ec9ed012.js"><link rel="prefetch" href="/notes/assets/oneLineCode.html.bd341f8b.js"><link rel="prefetch" href="/notes/assets/oneLineCodeArray.html.1d30c523.js"><link rel="prefetch" href="/notes/assets/oneLineCodeDOM.html.71da4b36.js"><link rel="prefetch" href="/notes/assets/oneLineCodeDateTime.html.ef9c1c50.js"><link rel="prefetch" href="/notes/assets/oneLineCodeFunction.html.06e81703.js"><link rel="prefetch" href="/notes/assets/oneLineCodeMath.html.7877af09.js"><link rel="prefetch" href="/notes/assets/oneLineCodeMisc.html.bc92b2ac.js"><link rel="prefetch" href="/notes/assets/oneLineCodeNumber.html.a397e90c.js"><link rel="prefetch" href="/notes/assets/oneLineCodeObject.html.c2f5ea2a.js"><link rel="prefetch" href="/notes/assets/oneLineCodeRandom.html.0f0e2fc5.js"><link rel="prefetch" href="/notes/assets/oneLineCodeString.html.8dd9ccec.js"><link rel="prefetch" href="/notes/assets/oneLineCodeValidator.html.c8874f9c.js"><link rel="prefetch" href="/notes/assets/typeScriptCache.html.cfec8c9c.js"><link rel="prefetch" href="/notes/assets/reactBase.html.3ae39482.js"><link rel="prefetch" href="/notes/assets/reactTypescript.html.292db337.js"><link rel="prefetch" href="/notes/assets/vue2Base.html.387b8b55.js"><link rel="prefetch" href="/notes/assets/vue2Table.html.5e61470f.js"><link rel="prefetch" href="/notes/assets/vue2offsetTop.html.018ac531.js"><link rel="prefetch" href="/notes/assets/componentWillXXX.html.b2f5ae49.js"><link rel="prefetch" href="/notes/assets/disrupt.html.1bfb65fa.js"><link rel="prefetch" href="/notes/assets/lane.html.02f7de6b.js"><link rel="prefetch" href="/notes/assets/prepare.html.403b5795.js"><link rel="prefetch" href="/notes/assets/redux.html.6f2cd894.js"><link rel="prefetch" href="/notes/assets/scheduler.html.c9b137d8.js"><link rel="prefetch" href="/notes/assets/multi.html.fa34663f.js"><link rel="prefetch" href="/notes/assets/one.html.710385e9.js"><link rel="prefetch" href="/notes/assets/prepare.html.04c98351.js"><link rel="prefetch" href="/notes/assets/create.html.cd731e5c.js"><link rel="prefetch" href="/notes/assets/prepare.html.a0031937.js"><link rel="prefetch" href="/notes/assets/structure.html.c13173a1.js"><link rel="prefetch" href="/notes/assets/useeffect.html.4d3a7633.js"><link rel="prefetch" href="/notes/assets/usememo.html.c43372a9.js"><link rel="prefetch" href="/notes/assets/useref.html.62fe578c.js"><link rel="prefetch" href="/notes/assets/usestate.html.d2ea1c97.js"><link rel="prefetch" href="/notes/assets/file.html.e650dad3.js"><link rel="prefetch" href="/notes/assets/idea.html.699fdfd9.js"><link rel="prefetch" href="/notes/assets/jsx.html.8dc05892.js"><link rel="prefetch" href="/notes/assets/newConstructure.html.d4abac8b.js"><link rel="prefetch" href="/notes/assets/oldConstructure.html.574defb4.js"><link rel="prefetch" href="/notes/assets/source.html.40430e8b.js"><link rel="prefetch" href="/notes/assets/summary.html.4ab6607e.js"><link rel="prefetch" href="/notes/assets/basePrinciple.html.928fb18b.js"><link rel="prefetch" href="/notes/assets/componentApi.html.0a2f2b5a.js"><link rel="prefetch" href="/notes/assets/domApi.html.09e3fa66.js"><link rel="prefetch" href="/notes/assets/hoc.html.53814fa0.js"><link rel="prefetch" href="/notes/assets/hookApi.html.50b5d228.js"><link rel="prefetch" href="/notes/assets/hookCustom.html.5913a1fc.js"><link rel="prefetch" href="/notes/assets/hookPrinciple.html.944b664c.js"><link rel="prefetch" href="/notes/assets/hookUse.html.2b6ba1be.js"><link rel="prefetch" href="/notes/assets/reactKeeplive.html.6991ce67.js"><link rel="prefetch" href="/notes/assets/reactRedux.html.8cba8e12.js"><link rel="prefetch" href="/notes/assets/reactRouter.html.81acc7a8.js"><link rel="prefetch" href="/notes/assets/toolApi.html.8da23baf.js"><link rel="prefetch" href="/notes/assets/beginWork.html.c02d7a71.js"><link rel="prefetch" href="/notes/assets/completeWork.html.f1ae90df.js"><link rel="prefetch" href="/notes/assets/doubleBuffer.html.2aaea5b7.js"><link rel="prefetch" href="/notes/assets/fiber-mental.html.5b24e5e0.js"><link rel="prefetch" href="/notes/assets/fiber.html.f1a4a497.js"><link rel="prefetch" href="/notes/assets/reconciler.html.6a75dc57.js"><link rel="prefetch" href="/notes/assets/beforeMutation.html.45eb988d.js"><link rel="prefetch" href="/notes/assets/layout.html.9c305dc2.js"><link rel="prefetch" href="/notes/assets/mutation.html.ff89b9e1.js"><link rel="prefetch" href="/notes/assets/prepare.html.d2af5e0e.js"><link rel="prefetch" href="/notes/assets/mental.html.ca188f6b.js"><link rel="prefetch" href="/notes/assets/prepare.html.9685597b.js"><link rel="prefetch" href="/notes/assets/priority.html.fb51b346.js"><link rel="prefetch" href="/notes/assets/reactdom.html.6c5f50a3.js"><link rel="prefetch" href="/notes/assets/setstate.html.3ca7cbef.js"><link rel="prefetch" href="/notes/assets/update.html.4e027c07.js"><link rel="prefetch" href="/notes/assets/bitfiled.html.d81e4a18.js"><link rel="prefetch" href="/notes/assets/dfs.html.5495b485.js"><link rel="prefetch" href="/notes/assets/diff.html.59a096da.js"><link rel="prefetch" href="/notes/assets/heapsort.html.cd567ad9.js"><link rel="prefetch" href="/notes/assets/linkedlist.html.e6b7a589.js"><link rel="prefetch" href="/notes/assets/stack.html.62766b5c.js"><link rel="prefetch" href="/notes/assets/bootstrap.html.e098c861.js"><link rel="prefetch" href="/notes/assets/context.html.f98b5374.js"><link rel="prefetch" href="/notes/assets/fibertree-commit.html.b0b58f67.js"><link rel="prefetch" href="/notes/assets/fibertree-create.html.19ceafed.js"><link rel="prefetch" href="/notes/assets/fibertree-prepare.html.a02f0823.js"><link rel="prefetch" href="/notes/assets/fibertree-update.html.0948dacd.js"><link rel="prefetch" href="/notes/assets/hook-effect.html.177c1484.js"><link rel="prefetch" href="/notes/assets/hook-state.html.7c4e9d86.js"><link rel="prefetch" href="/notes/assets/hook-summary.html.76673a4e.js"><link rel="prefetch" href="/notes/assets/macro-structure.html.ae2754ed.js"><link rel="prefetch" href="/notes/assets/object-structure.html.6242475b.js"><link rel="prefetch" href="/notes/assets/priority.html.2dca6663.js"><link rel="prefetch" href="/notes/assets/reconciler-workflow.html.7d94e94d.js"><link rel="prefetch" href="/notes/assets/scheduler.html.32a54904.js"><link rel="prefetch" href="/notes/assets/state-effects.html.3c8e4102.js"><link rel="prefetch" href="/notes/assets/synthetic-event.html.81ddf51d.js"><link rel="prefetch" href="/notes/assets/workloop.html.44f5b6b6.js"><link rel="prefetch" href="/notes/assets/ast.html.2c534a6c.js"><link rel="prefetch" href="/notes/assets/binder.html.e3df52a0.js"><link rel="prefetch" href="/notes/assets/checker.html.9826fcb7.js"><link rel="prefetch" href="/notes/assets/emitter.html.e9f1bccf.js"><link rel="prefetch" href="/notes/assets/overview.html.f72b7461.js"><link rel="prefetch" href="/notes/assets/parser.html.5731843e.js"><link rel="prefetch" href="/notes/assets/program.html.a9a9ed36.js"><link rel="prefetch" href="/notes/assets/scanner.html.3b8be153.js"><link rel="prefetch" href="/notes/assets/common.html.5dec5573.js"><link rel="prefetch" href="/notes/assets/interpreting.html.27734eae.js"><link rel="prefetch" href="/notes/assets/class.html.fdca3383.js"><link rel="prefetch" href="/notes/assets/commandline-behavior.html.cb78191e.js"><link rel="prefetch" href="/notes/assets/comments.html.45342ffb.js"><link rel="prefetch" href="/notes/assets/common-bug-not-bugs.html.d4d0497d.js"><link rel="prefetch" href="/notes/assets/common-feature-request.html.000a7b70.js"><link rel="prefetch" href="/notes/assets/decorators.html.bf306def.js"><link rel="prefetch" href="/notes/assets/enums.html.0a1c82a9.js"><link rel="prefetch" href="/notes/assets/function.html.8d847425.js"><link rel="prefetch" href="/notes/assets/generics.html.45b43ec2.js"><link rel="prefetch" href="/notes/assets/glossary-and-terms.html.d482019e.js"><link rel="prefetch" href="/notes/assets/jsx-and-react.html.a828002f.js"><link rel="prefetch" href="/notes/assets/modules.html.df7f48e2.js"><link rel="prefetch" href="/notes/assets/thing-that-dont-work.html.924c924f.js"><link rel="prefetch" href="/notes/assets/tsconfig-behavior.html.cfe0a3b4.js"><link rel="prefetch" href="/notes/assets/type-guards.html.ae22f995.js"><link rel="prefetch" href="/notes/assets/type-system-behavior.html.203b7d9e.js"><link rel="prefetch" href="/notes/assets/nonReactJSX.html.04742307.js"><link rel="prefetch" href="/notes/assets/reactJSX.html.00ec456c.js"><link rel="prefetch" href="/notes/assets/support.html.05a39724.js"><link rel="prefetch" href="/notes/assets/typescript-3.7.html.3ea39099.js"><link rel="prefetch" href="/notes/assets/typescript-3.8.html.77eb495f.js"><link rel="prefetch" href="/notes/assets/typescript-3.9.html.e0f71181.js"><link rel="prefetch" href="/notes/assets/compilationContext.html.19a6d15c.js"><link rel="prefetch" href="/notes/assets/declarationspaces.html.72240dd1.js"><link rel="prefetch" href="/notes/assets/dynamicImportExpressions.html.10be02f8.js"><link rel="prefetch" href="/notes/assets/inDepthTs.html.3fa89264.js"><link rel="prefetch" href="/notes/assets/modules.html.8ce46461.js"><link rel="prefetch" href="/notes/assets/namespaces.html.0aeb049a.js"><link rel="prefetch" href="/notes/assets/unknownAny.html.7bee86ca.js"><link rel="prefetch" href="/notes/assets/avoidExportDefault.html.21a50706.js"><link rel="prefetch" href="/notes/assets/barrel.html.b860e721.js"><link rel="prefetch" href="/notes/assets/bind.html.1d90ecde.js"><link rel="prefetch" href="/notes/assets/buildToggles.html.c9eb290a.js"><link rel="prefetch" href="/notes/assets/classAreUseful.html.da22b579.js"><link rel="prefetch" href="/notes/assets/covarianceAndContravariance.html.d6a9991e.js"><link rel="prefetch" href="/notes/assets/createArrays.html.6c2b0056.js"><link rel="prefetch" href="/notes/assets/curry.html.198bd091.js"><link rel="prefetch" href="/notes/assets/functionParameters.html.2d3fa9ae.js"><link rel="prefetch" href="/notes/assets/infer.html.54a48919.js"><link rel="prefetch" href="/notes/assets/lazyObjectLiteralInitialization.html.a1a02b6b.js"><link rel="prefetch" href="/notes/assets/limitPropertySetters.html.dde91c42.js"><link rel="prefetch" href="/notes/assets/metadata.html.19f8f696.js"><link rel="prefetch" href="/notes/assets/nominalTyping.html.06d8aa39.js"><link rel="prefetch" href="/notes/assets/outFileCaution.html.331c79e5.js"><link rel="prefetch" href="/notes/assets/singletonPatern.html.7918fec5.js"><link rel="prefetch" href="/notes/assets/statefulFunctions.html.21418d74.js"><link rel="prefetch" href="/notes/assets/staticConstructors.html.0acf4dab.js"><link rel="prefetch" href="/notes/assets/stringBasedEmuns.html.2c520520.js"><link rel="prefetch" href="/notes/assets/truthy.html.c1c86de1.js"><link rel="prefetch" href="/notes/assets/typeInstantiation.html.29790a32.js"><link rel="prefetch" href="/notes/assets/typesafeEventEmitter.html.5a558ff1.js"><link rel="prefetch" href="/notes/assets/ambient.html.94ea47f1.js"><link rel="prefetch" href="/notes/assets/callable.html.11dabdc2.js"><link rel="prefetch" href="/notes/assets/discrominatedUnion.html.8ec05528.js"><link rel="prefetch" href="/notes/assets/enums.html.b41682bd.js"><link rel="prefetch" href="/notes/assets/exceptionsHanding.html.943f0d64.js"><link rel="prefetch" href="/notes/assets/freshness.html.649b6003.js"><link rel="prefetch" href="/notes/assets/functions.html.8bacac02.js"><link rel="prefetch" href="/notes/assets/generices.html.be8576f8.js"><link rel="prefetch" href="/notes/assets/indexSignatures.html.aa09f9d2.js"><link rel="prefetch" href="/notes/assets/interfaces.html.eb6d6ae6.js"><link rel="prefetch" href="/notes/assets/lib.html.bd165777.js"><link rel="prefetch" href="/notes/assets/literals.html.1aaf075a.js"><link rel="prefetch" href="/notes/assets/migrating.html.cae7eeb1.js"><link rel="prefetch" href="/notes/assets/mixins.html.d779c13d.js"><link rel="prefetch" href="/notes/assets/movingTypes.html.244adc2e.js"><link rel="prefetch" href="/notes/assets/neverType.html.e47cf131.js"><link rel="prefetch" href="/notes/assets/overview.html.48b07aa6.js"><link rel="prefetch" href="/notes/assets/readonly.html.f7f20ddc.js"><link rel="prefetch" href="/notes/assets/thisType.html.43f2d350.js"><link rel="prefetch" href="/notes/assets/typeAssertion.html.92fc0787.js"><link rel="prefetch" href="/notes/assets/typeCompatibility.html.220d5acd.js"><link rel="prefetch" href="/notes/assets/typeGuard.html.5ac309e6.js"><link rel="prefetch" href="/notes/assets/typeInference.html.90900d8c.js"><link rel="prefetch" href="/notes/assets/types.html.57430054.js"><link rel="prefetch" href="/notes/assets/pluginDva.html.7bc96d87.js"><link rel="prefetch" href="/notes/assets/pluginQiankun.html.fbb1dce5.js"><link rel="prefetch" href="/notes/assets/codegen.html.3d2eec43.js"><link rel="prefetch" href="/notes/assets/entrance.html.c46676cf.js"><link rel="prefetch" href="/notes/assets/optimize.html.5c2cc4a7.js"><link rel="prefetch" href="/notes/assets/outline.html.c143e7ab.js"><link rel="prefetch" href="/notes/assets/parse.html.3dd40222.js"><link rel="prefetch" href="/notes/assets/async-component.html.253503a0.js"><link rel="prefetch" href="/notes/assets/component-register.html.d39f08a5.js"><link rel="prefetch" href="/notes/assets/create-component.html.6ede302b.js"><link rel="prefetch" href="/notes/assets/lifecycle.html.719f4410.js"><link rel="prefetch" href="/notes/assets/merge-option.html.bf8bf46c.js"><link rel="prefetch" href="/notes/assets/outline.html.55ce76e5.js"><link rel="prefetch" href="/notes/assets/patch.html.a3057e6e.js"><link rel="prefetch" href="/notes/assets/_index.html.74f9231f.js"><link rel="prefetch" href="/notes/assets/create-element.html.4f274bc2.js"><link rel="prefetch" href="/notes/assets/mounted.html.69af9a9c.js"><link rel="prefetch" href="/notes/assets/new-vue.html.0c75b848.js"><link rel="prefetch" href="/notes/assets/render.html.1b1bb654.js"><link rel="prefetch" href="/notes/assets/update.html.0620ef4c.js"><link rel="prefetch" href="/notes/assets/virtual-dom.html.26b01fce.js"><link rel="prefetch" href="/notes/assets/event.html.c6a2ead6.js"><link rel="prefetch" href="/notes/assets/keep-alive.html.2f2e5a9d.js"><link rel="prefetch" href="/notes/assets/outline.html.0073d99a.js"><link rel="prefetch" href="/notes/assets/slot.html.23d003cc.js"><link rel="prefetch" href="/notes/assets/tansition-group.html.1e47b07f.js"><link rel="prefetch" href="/notes/assets/tansition.html.059e9e99.js"><link rel="prefetch" href="/notes/assets/v-model.html.f7986754.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.75ba54e7.js"><link rel="prefetch" href="/notes/assets/baseInterviewSecond.html.1a17b4a6.js"><link rel="prefetch" href="/notes/assets/componentCommunication.html.2ee347fb.js"><link rel="prefetch" href="/notes/assets/detailedResponsiveness.html.75946fdd.js"><link rel="prefetch" href="/notes/assets/diff.html.72154af2.js"><link rel="prefetch" href="/notes/assets/eventBinding.html.86d38cd1.js"><link rel="prefetch" href="/notes/assets/eventMechanism.html.a89f975c.js"><link rel="prefetch" href="/notes/assets/key.html.3ac0f202.js"><link rel="prefetch" href="/notes/assets/knowledgeSystem.html.1eeff266.js"><link rel="prefetch" href="/notes/assets/slot.html.79774da7.js"><link rel="prefetch" href="/notes/assets/sourceCodeAsyncDomUpdateNextTick.html.1057b6e6.js"><link rel="prefetch" href="/notes/assets/sourceCodeElementBroadcastDispatch.html.56362af9.js"><link rel="prefetch" href="/notes/assets/sourceCodeKeepAlive.html.2687e65a.js"><link rel="prefetch" href="/notes/assets/sourceCodeResponsiveness.html.53fcc6e2.js"><link rel="prefetch" href="/notes/assets/sourceCodeTemplateCompilation.html.128b40b4.js"><link rel="prefetch" href="/notes/assets/sourceCodeTemplateDom.html.6a8f3140.js"><link rel="prefetch" href="/notes/assets/sourceCodeVuex.html.fd9a58c0.js"><link rel="prefetch" href="/notes/assets/templateCompilation.html.36c2dd91.js"><link rel="prefetch" href="/notes/assets/vNode.html.adc0c5f1.js"><link rel="prefetch" href="/notes/assets/vNodeDiff.html.24c2f820.js"><link rel="prefetch" href="/notes/assets/build.html.0298d094.js"><link rel="prefetch" href="/notes/assets/directory.html.4e00441e.js"><link rel="prefetch" href="/notes/assets/entrance.html.5620a129.js"><link rel="prefetch" href="/notes/assets/flow.html.d02d447d.js"><link rel="prefetch" href="/notes/assets/component-update.html.33260d3c.js"><link rel="prefetch" href="/notes/assets/computed-watcher.html.9aa9a917.js"><link rel="prefetch" href="/notes/assets/getters.html.6be87d6d.js"><link rel="prefetch" href="/notes/assets/next-tick.html.df1481c2.js"><link rel="prefetch" href="/notes/assets/outline.html.bc2c1977.js"><link rel="prefetch" href="/notes/assets/props.html.0341f15f.js"><link rel="prefetch" href="/notes/assets/questions.html.f26faf30.js"><link rel="prefetch" href="/notes/assets/reactive-object.html.33e2889a.js"><link rel="prefetch" href="/notes/assets/setters.html.653ff0d1.js"><link rel="prefetch" href="/notes/assets/summary.html.08f2f1e5.js"><link rel="prefetch" href="/notes/assets/install.html.1e21ff91.js"><link rel="prefetch" href="/notes/assets/matcher.html.e4530366.js"><link rel="prefetch" href="/notes/assets/outline.html.a55fcaea.js"><link rel="prefetch" href="/notes/assets/router.html.f95a2aef.js"><link rel="prefetch" href="/notes/assets/transition-to.html.35ac4a70.js"><link rel="prefetch" href="/notes/assets/api.html.ba96ca24.js"><link rel="prefetch" href="/notes/assets/idex.html.2213eeb1.js"><link rel="prefetch" href="/notes/assets/init.html.67dfdc62.js"><link rel="prefetch" href="/notes/assets/plugin.html.a2c8c50b.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.03178c1d.js"><link rel="prefetch" href="/notes/assets/configuration.html.fde89670.js"><link rel="prefetch" href="/notes/assets/entryPoints.html.03c99ba4.js"><link rel="prefetch" href="/notes/assets/loader.html.10b761b1.js"><link rel="prefetch" href="/notes/assets/output.html.a25e769b.js"><link rel="prefetch" href="/notes/assets/plugin.html.45d1208c.js"><link rel="prefetch" href="/notes/assets/webpackInterview.html.e94fa338.js"><link rel="prefetch" href="/notes/assets/reactApi.html.ac049939.js"><link rel="prefetch" href="/notes/assets/reactChildren.html.6fffa6a3.js"><link rel="prefetch" href="/notes/assets/reactElement.html.4a00d9b5.js"><link rel="prefetch" href="/notes/assets/reactFiber.html.4c55f16f.js"><link rel="prefetch" href="/notes/assets/commitAllHostEffects.html.4639e79a.js"><link rel="prefetch" href="/notes/assets/commitAllLifeCycles.html.3e3e9d3c.js"><link rel="prefetch" href="/notes/assets/commitBeforeMutationLifecycles.html.a7a34848.js"><link rel="prefetch" href="/notes/assets/commitDeletion.html.9c306cf7.js"><link rel="prefetch" href="/notes/assets/commitPlacement.html.b6c0df82.js"><link rel="prefetch" href="/notes/assets/commitRoot.html.9b6ef9eb.js"><link rel="prefetch" href="/notes/assets/commitWork.html.74dc5ebd.js"><link rel="prefetch" href="/notes/assets/invokeGuardedCallback.html.887e100b.js"><link rel="prefetch" href="/notes/assets/expirationTime.html.939b9cac.js"><link rel="prefetch" href="/notes/assets/reactDomRender.html.86b9fafe.js"><link rel="prefetch" href="/notes/assets/setStateForceUpdate.html.4f0b57d9.js"><link rel="prefetch" href="/notes/assets/context.html.80261221.js"><link rel="prefetch" href="/notes/assets/evenInit.html.b7bc3c65.js"><link rel="prefetch" href="/notes/assets/eventBind.html.590e185f.js"><link rel="prefetch" href="/notes/assets/eventCreateEventObject.html.61caf894.js"><link rel="prefetch" href="/notes/assets/eventDispath.html.b4b2920e.js"><link rel="prefetch" href="/notes/assets/hydrate.html.9a0081e4.js"><link rel="prefetch" href="/notes/assets/ref.html.40c06ec7.js"><link rel="prefetch" href="/notes/assets/suspense.html.1ed1f32b.js"><link rel="prefetch" href="/notes/assets/suspenseLazy.html.4446bcc4.js"><link rel="prefetch" href="/notes/assets/suspenseWork.html.7c4f2e37.js"><link rel="prefetch" href="/notes/assets/hooksCommon.html.f7fc2348.js"><link rel="prefetch" href="/notes/assets/hooksOther.html.2934d0b8.js"><link rel="prefetch" href="/notes/assets/start.html.81d46118.js"><link rel="prefetch" href="/notes/assets/useEffect.html.e537ec24.js"><link rel="prefetch" href="/notes/assets/useState.html.a4e92e46.js"><link rel="prefetch" href="/notes/assets/base.html.0f9d5d8a.js"><link rel="prefetch" href="/notes/assets/commpontDiff.html.d0aa2efc.js"><link rel="prefetch" href="/notes/assets/componentUpdate.html.c9721d20.js"><link rel="prefetch" href="/notes/assets/renderProcess.html.dc5f2d60.js"><link rel="prefetch" href="/notes/assets/schedulingPrinciple.html.567e131c.js"><link rel="prefetch" href="/notes/assets/beginWork.html.78dde504.js"><link rel="prefetch" href="/notes/assets/globalVariable.html.8b52ee5c.js"><link rel="prefetch" href="/notes/assets/mountIndeterminateComponent.html.3c377144.js"><link rel="prefetch" href="/notes/assets/mountLazyCompont.html.cb187d51.js"><link rel="prefetch" href="/notes/assets/performUnitOfWork.html.6758cf47.js"><link rel="prefetch" href="/notes/assets/performWork.html.321490d3.js"><link rel="prefetch" href="/notes/assets/reactScheduler.html.67ee99bb.js"><link rel="prefetch" href="/notes/assets/reconcileChildren.html.66ad50ac.js"><link rel="prefetch" href="/notes/assets/reconcileChildrenArray.html.67bddf9e.js"><link rel="prefetch" href="/notes/assets/reconcileSingleElement.html.cc842dbc.js"><link rel="prefetch" href="/notes/assets/renderRoot.html.4a046a76.js"><link rel="prefetch" href="/notes/assets/scheduleWork.html.05214908.js"><link rel="prefetch" href="/notes/assets/throwException.html.c01a7293.js"><link rel="prefetch" href="/notes/assets/updateClassComponent.html.8ccc048d.js"><link rel="prefetch" href="/notes/assets/updateContextConsumer.html.466be6af.js"><link rel="prefetch" href="/notes/assets/updateContextProvider.html.3cf78548.js"><link rel="prefetch" href="/notes/assets/updateForwardRef.html.9ffc67db.js"><link rel="prefetch" href="/notes/assets/updateFragment.html.adcc172a.js"><link rel="prefetch" href="/notes/assets/updateFunctionalComponent.html.1a62ae6a.js"><link rel="prefetch" href="/notes/assets/updateHostComponent.html.bd8c792a.js"><link rel="prefetch" href="/notes/assets/updateHostRoot.html.3b381860.js"><link rel="prefetch" href="/notes/assets/updateHostText.html.9e8af4ce.js"><link rel="prefetch" href="/notes/assets/updateMode.html.62431f46.js"><link rel="prefetch" href="/notes/assets/updatePortalComponent.html.1b863507.js"><link rel="prefetch" href="/notes/assets/updateProfiler.html.b5f76ba3.js"><link rel="prefetch" href="/notes/assets/updateSuspenseComponent.html.c00c6961.js"><link rel="prefetch" href="/notes/assets/interview1.html.a1550bbd.js"><link rel="prefetch" href="/notes/assets/interview2.html.60141cad.js"><link rel="prefetch" href="/notes/assets/interview3.html.7d6dd664.js"><link rel="prefetch" href="/notes/assets/interview51.html.bd919bf0.js"><link rel="prefetch" href="/notes/assets/interview52.html.0c7f4ab4.js"><link rel="prefetch" href="/notes/assets/interview53.html.00ce5830.js"><link rel="prefetch" href="/notes/assets/interview54.html.3c5065b0.js"><link rel="prefetch" href="/notes/assets/interview55.html.8c24c22f.js"><link rel="prefetch" href="/notes/assets/interview56.html.f3e42d7c.js"><link rel="prefetch" href="/notes/assets/interview57.html.bce535d0.js"><link rel="prefetch" href="/notes/assets/interview1.html.16053d6a.js"><link rel="prefetch" href="/notes/assets/interview10.html.b0de3b5f.js"><link rel="prefetch" href="/notes/assets/interview11.html.64ba2734.js"><link rel="prefetch" href="/notes/assets/interview12.html.3ff60a48.js"><link rel="prefetch" href="/notes/assets/interview13.html.b33340c1.js"><link rel="prefetch" href="/notes/assets/interview14.html.a56321cf.js"><link rel="prefetch" href="/notes/assets/interview15.html.4126c39f.js"><link rel="prefetch" href="/notes/assets/interview16.html.f9becdf2.js"><link rel="prefetch" href="/notes/assets/interview17.html.30ae8b76.js"><link rel="prefetch" href="/notes/assets/interview18.html.38cf0a3a.js"><link rel="prefetch" href="/notes/assets/interview19.html.d6166de6.js"><link rel="prefetch" href="/notes/assets/interview2.html.0dc0805e.js"><link rel="prefetch" href="/notes/assets/interview20.html.2c7994bc.js"><link rel="prefetch" href="/notes/assets/interview21.html.839875a9.js"><link rel="prefetch" href="/notes/assets/interview22.html.c6d857cf.js"><link rel="prefetch" href="/notes/assets/interview23.html.ca6914cb.js"><link rel="prefetch" href="/notes/assets/interview24.html.b3998091.js"><link rel="prefetch" href="/notes/assets/interview25.html.e981c90f.js"><link rel="prefetch" href="/notes/assets/interview26.html.f891c30e.js"><link rel="prefetch" href="/notes/assets/interview27.html.cd87e477.js"><link rel="prefetch" href="/notes/assets/interview28.html.59a7a09f.js"><link rel="prefetch" href="/notes/assets/interview29.html.9521f3a3.js"><link rel="prefetch" href="/notes/assets/interview3.html.aeb8fb72.js"><link rel="prefetch" href="/notes/assets/interview30.html.4b7e24f9.js"><link rel="prefetch" href="/notes/assets/interview31.html.4d738052.js"><link rel="prefetch" href="/notes/assets/interview32.html.6c77b6d5.js"><link rel="prefetch" href="/notes/assets/interview33.html.26133902.js"><link rel="prefetch" href="/notes/assets/interview34.html.d8c88fdd.js"><link rel="prefetch" href="/notes/assets/interview35.html.a7b3501f.js"><link rel="prefetch" href="/notes/assets/interview36.html.54b0a586.js"><link rel="prefetch" href="/notes/assets/interview37.html.726e15c9.js"><link rel="prefetch" href="/notes/assets/interview38.html.53566d68.js"><link rel="prefetch" href="/notes/assets/interview39.html.8551f834.js"><link rel="prefetch" href="/notes/assets/interview4.html.007cf386.js"><link rel="prefetch" href="/notes/assets/interview40.html.b68a3f58.js"><link rel="prefetch" href="/notes/assets/interview41.html.a463b768.js"><link rel="prefetch" href="/notes/assets/interview42.html.5f589e30.js"><link rel="prefetch" href="/notes/assets/interview43.html.8e2e737b.js"><link rel="prefetch" href="/notes/assets/interview44.html.4eb1a209.js"><link rel="prefetch" href="/notes/assets/interview45.html.0c0c42de.js"><link rel="prefetch" href="/notes/assets/interview46.html.66476631.js"><link rel="prefetch" href="/notes/assets/interview47.html.5802a9df.js"><link rel="prefetch" href="/notes/assets/interview48.html.cd08d5cc.js"><link rel="prefetch" href="/notes/assets/interview49.html.40bee64f.js"><link rel="prefetch" href="/notes/assets/interview5.html.505cb504.js"><link rel="prefetch" href="/notes/assets/interview50.html.2a8f8afb.js"><link rel="prefetch" href="/notes/assets/interview6.html.b7965d47.js"><link rel="prefetch" href="/notes/assets/interview7.html.fccc91a1.js"><link rel="prefetch" href="/notes/assets/interview8.html.55e242b3.js"><link rel="prefetch" href="/notes/assets/interview9.html.6c1be04b.js"><link rel="prefetch" href="/notes/assets/404.html.93146c89.js"><link rel="prefetch" href="/notes/assets/index.html.59d1cc02.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.3275609a.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.039cf795.js"><link rel="prefetch" href="/notes/assets/base.html.bbe58e6f.js"><link rel="prefetch" href="/notes/assets/customCli.html.605fd326.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.f7ef029f.js"><link rel="prefetch" href="/notes/assets/adapter.html.ccd89b8e.js"><link rel="prefetch" href="/notes/assets/amd.html.0bae9eb6.js"><link rel="prefetch" href="/notes/assets/builder.html.1ed6e7b0.js"><link rel="prefetch" href="/notes/assets/censorJquery.html.c1f5721d.js"><link rel="prefetch" href="/notes/assets/combination.html.20158409.js"><link rel="prefetch" href="/notes/assets/command.html.fd273e62.js"><link rel="prefetch" href="/notes/assets/commonJS.html.2a6e4d19.js"><link rel="prefetch" href="/notes/assets/constructor.html.19f4c6e0.js"><link rel="prefetch" href="/notes/assets/decoration.html.56900b9c.js"><link rel="prefetch" href="/notes/assets/esHarmony.html.0806c6bb.js"><link rel="prefetch" href="/notes/assets/exposed.html.96bdda3a.js"><link rel="prefetch" href="/notes/assets/exterior.html.06aaea6b.js"><link rel="prefetch" href="/notes/assets/factory.html.4dd7c25e.js"><link rel="prefetch" href="/notes/assets/flyweight.html.294dac2a.js"><link rel="prefetch" href="/notes/assets/functionalProgramming.html.2e24b27e.js"><link rel="prefetch" href="/notes/assets/intermediary.html.3daee5a1.js"><link rel="prefetch" href="/notes/assets/iterator.html.f7ca5ba9.js"><link rel="prefetch" href="/notes/assets/lazyInitial.html.7285ca9a.js"><link rel="prefetch" href="/notes/assets/mixin.html.be0d22f3.js"><link rel="prefetch" href="/notes/assets/module.html.bb1d92c4.js"><link rel="prefetch" href="/notes/assets/mvc.html.6f309de6.js"><link rel="prefetch" href="/notes/assets/mvp.html.e8b96312.js"><link rel="prefetch" href="/notes/assets/mvvm.html.fc7b3f4d.js"><link rel="prefetch" href="/notes/assets/observer.html.6486d682.js"><link rel="prefetch" href="/notes/assets/outward.html.7f2ce9fb.js"><link rel="prefetch" href="/notes/assets/overview.html.6e35fedc.js"><link rel="prefetch" href="/notes/assets/prototype.html.2d714a50.js"><link rel="prefetch" href="/notes/assets/proxy.html.58ecb0a4.js"><link rel="prefetch" href="/notes/assets/singleton.html.20b1827a.js"><link rel="prefetch" href="/notes/assets/createUnderscore.html.05db342b.js"><link rel="prefetch" href="/notes/assets/jquery.html.f36c18e9.js"><link rel="prefetch" href="/notes/assets/lodash.html.0bb28bad.js"><link rel="prefetch" href="/notes/assets/sentry.html.4e244800.js"><link rel="prefetch" href="/notes/assets/underscore.html.287e9fc1.js"><link rel="prefetch" href="/notes/assets/vuex.html.952fc123.js"><link rel="prefetch" href="/notes/assets/customCli.html.719d54a7.js"><link rel="prefetch" href="/notes/assets/description.html.6dcda73d.js"><link rel="prefetch" href="/notes/assets/indx.html.fb4419c4.js"><link rel="prefetch" href="/notes/assets/rebase.html.5e4efff0.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.22ab27aa.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.1904f76f.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.cc8be744.js"><link rel="prefetch" href="/notes/assets/44Questions.html.99f14626.js"><link rel="prefetch" href="/notes/assets/asyncAwait.html.30964671.js"><link rel="prefetch" href="/notes/assets/babelCompile.html.deeaf606.js"><link rel="prefetch" href="/notes/assets/base.html.6497ada9.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.35b619e9.js"><link rel="prefetch" href="/notes/assets/baseWebpack.html.1387f663.js"><link rel="prefetch" href="/notes/assets/codeSeparation.html.cc8768d9.js"><link rel="prefetch" href="/notes/assets/cycle.html.b08fa9d9.js"><link rel="prefetch" href="/notes/assets/cycleOtherWay.html.bdaf8d23.js"><link rel="prefetch" href="/notes/assets/executionMechanism.html.ec67259a.js"><link rel="prefetch" href="/notes/assets/hybrid.html.c1bd5345.js"><link rel="prefetch" href="/notes/assets/jsHandwriting.html.cb6eadcd.js"><link rel="prefetch" href="/notes/assets/jsonStringify.html.35c85527.js"><link rel="prefetch" href="/notes/assets/largeFileResumableUpload.html.c6f80bc1.js"><link rel="prefetch" href="/notes/assets/performance.html.3abfbb61.js"><link rel="prefetch" href="/notes/assets/promise.html.1c843b04.js"><link rel="prefetch" href="/notes/assets/promiseAll.html.b78e6a5a.js"><link rel="prefetch" href="/notes/assets/spa.html.82410342.js"><link rel="prefetch" href="/notes/assets/tsBaseInterview.html.7f994b71.js"><link rel="prefetch" href="/notes/assets/useEs6.html.91c785c3.js"><link rel="prefetch" href="/notes/assets/webAnimations.html.752a872b.js"><link rel="prefetch" href="/notes/assets/webpackInterview.html.d20ac258.js"><link rel="prefetch" href="/notes/assets/webpackLoader.html.cd6b7aca.js"><link rel="prefetch" href="/notes/assets/webpackPublic.html.5e2c932e.js"><link rel="prefetch" href="/notes/assets/weird.html.b30f890a.js"><link rel="prefetch" href="/notes/assets/es10News.html.0e617b1b.js"><link rel="prefetch" href="/notes/assets/es11News.html.9f80e547.js"><link rel="prefetch" href="/notes/assets/es6Interview1.html.fabb2c62.js"><link rel="prefetch" href="/notes/assets/es6Interview2.html.90ced9ed.js"><link rel="prefetch" href="/notes/assets/es6Interview3.html.f037cc09.js"><link rel="prefetch" href="/notes/assets/es6News.html.61bf9838.js"><link rel="prefetch" href="/notes/assets/es7News.html.00056024.js"><link rel="prefetch" href="/notes/assets/es8News.html.51231b01.js"><link rel="prefetch" href="/notes/assets/es9News.html.1e1a683f.js"><link rel="prefetch" href="/notes/assets/base.html.4aeec713.js"><link rel="prefetch" href="/notes/assets/nginxComprehensiveScene.html.9904d7ee.js"><link rel="prefetch" href="/notes/assets/commonlyUsed.html.90e25025.js"><link rel="prefetch" href="/notes/assets/inelegantHook.html.95add480.js"><link rel="prefetch" href="/notes/assets/interview1.html.f9300432.js"><link rel="prefetch" href="/notes/assets/interview2.html.89547fd3.js"><link rel="prefetch" href="/notes/assets/interview3.html.aa16375e.js"><link rel="prefetch" href="/notes/assets/interview4.html.20c0c6c7.js"><link rel="prefetch" href="/notes/assets/base.html.41f4a409.js"><link rel="prefetch" href="/notes/assets/introduction.html.5232d90d.js"><link rel="prefetch" href="/notes/assets/base.html.d5527198.js"><link rel="prefetch" href="/notes/assets/summarize.html.b7a25cf7.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.54aaade3.js"><link rel="prefetch" href="/notes/assets/index.html.55cee17f.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.6ec1a6c0.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.fdb7c934.js"><link rel="prefetch" href="/notes/assets/bigDataRender.html.dbdee14a.js"><link rel="prefetch" href="/notes/assets/progress.html.205cee2d.js"><link rel="prefetch" href="/notes/assets/quirksStandards.html.e1121138.js"><link rel="prefetch" href="/notes/assets/redrawReflow.html.0904b8e0.js"><link rel="prefetch" href="/notes/assets/storageSpace.html.946053eb.js"><link rel="prefetch" href="/notes/assets/webComLink.html.bacea579.js"><link rel="prefetch" href="/notes/assets/webUrl.html.7084ef5d.js"><link rel="prefetch" href="/notes/assets/spanWidthHeight.html.c81b60bf.js"><link rel="prefetch" href="/notes/assets/baseCss.html.27a787d3.js"><link rel="prefetch" href="/notes/assets/blockFormattingContext.html.67f5f5bf.js"><link rel="prefetch" href="/notes/assets/containingBlock.html.ceda1920.js"><link rel="prefetch" href="/notes/assets/cssBeforeAfter.html.1fee2a65.js"><link rel="prefetch" href="/notes/assets/cssBoxModal.html.12603dbb.js"><link rel="prefetch" href="/notes/assets/cssCollapsing.html.f185befe.js"><link rel="prefetch" href="/notes/assets/cssCompatible.html.ba332af9.js"><link rel="prefetch" href="/notes/assets/cssFlexDemo.html.ee15b8f7.js"><link rel="prefetch" href="/notes/assets/cssFlexLayout.html.ac40b45f.js"><link rel="prefetch" href="/notes/assets/cssGridLayout.html.4270663e.js"><link rel="prefetch" href="/notes/assets/cssHack.html.64a285c0.js"><link rel="prefetch" href="/notes/assets/cssInlineBlock.html.d0f0205e.js"><link rel="prefetch" href="/notes/assets/cssPriority.html.bfbbe3c1.js"><link rel="prefetch" href="/notes/assets/cssPseudo.html.87e6a00c.js"><link rel="prefetch" href="/notes/assets/cssPseudoClass.html.f00099b7.js"><link rel="prefetch" href="/notes/assets/cssSelector.html.3c8c548e.js"><link rel="prefetch" href="/notes/assets/cssTutorial.html.38044a5b.js"><link rel="prefetch" href="/notes/assets/fieldInvalid.html.2b97059c.js"><link rel="prefetch" href="/notes/assets/frame.html.ea6f1467.js"><link rel="prefetch" href="/notes/assets/knowledgePoints.html.5b872e7c.js"><link rel="prefetch" href="/notes/assets/linkImport.html.2561cec3.js"><link rel="prefetch" href="/notes/assets/stackingContext.html.bec21579.js"><link rel="prefetch" href="/notes/assets/tools.html.72ee8d83.js"><link rel="prefetch" href="/notes/assets/units.html.51c132b9.js"><link rel="prefetch" href="/notes/assets/transform.html.ee7d9b68.js"><link rel="prefetch" href="/notes/assets/content.html.7aadd60b.js"><link rel="prefetch" href="/notes/assets/plugins.html.f7973877.js"><link rel="prefetch" href="/notes/assets/accesskey.html.3071aee5.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.c5770846.js"><link rel="prefetch" href="/notes/assets/canvasSvg.html.92fff38c.js"><link rel="prefetch" href="/notes/assets/deviceAPI.html.6bf92692.js"><link rel="prefetch" href="/notes/assets/globalAttr.html.054d6586.js"><link rel="prefetch" href="/notes/assets/htmlDatalist.html.b7aceabd.js"><link rel="prefetch" href="/notes/assets/htmlElement.html.a5fd82a3.js"><link rel="prefetch" href="/notes/assets/interview10.html.572ba5b0.js"><link rel="prefetch" href="/notes/assets/interview11.html.4ae5d536.js"><link rel="prefetch" href="/notes/assets/interview12.html.74667790.js"><link rel="prefetch" href="/notes/assets/interview13.html.881700a1.js"><link rel="prefetch" href="/notes/assets/interview14.html.1c867e08.js"><link rel="prefetch" href="/notes/assets/interview15.html.650942a4.js"><link rel="prefetch" href="/notes/assets/interview16.html.43f3216c.js"><link rel="prefetch" href="/notes/assets/interview17.html.49e4afce.js"><link rel="prefetch" href="/notes/assets/interview18.html.6ffd8569.js"><link rel="prefetch" href="/notes/assets/interview19.html.48b174d4.js"><link rel="prefetch" href="/notes/assets/interview20.html.65fabeea.js"><link rel="prefetch" href="/notes/assets/interview21.html.6b82500e.js"><link rel="prefetch" href="/notes/assets/interview22.html.72c2c85c.js"><link rel="prefetch" href="/notes/assets/interview23.html.2699b50a.js"><link rel="prefetch" href="/notes/assets/interview24.html.3d6c90d4.js"><link rel="prefetch" href="/notes/assets/interview25.html.80239cf9.js"><link rel="prefetch" href="/notes/assets/interview26.html.32f397c9.js"><link rel="prefetch" href="/notes/assets/interview27.html.1d89f34a.js"><link rel="prefetch" href="/notes/assets/interview28.html.b16484c6.js"><link rel="prefetch" href="/notes/assets/interview29.html.961e38d3.js"><link rel="prefetch" href="/notes/assets/interview30.html.80462a11.js"><link rel="prefetch" href="/notes/assets/interview31.html.1868dd06.js"><link rel="prefetch" href="/notes/assets/interview32.html.8ade965c.js"><link rel="prefetch" href="/notes/assets/interview33.html.de78ddad.js"><link rel="prefetch" href="/notes/assets/interview34.html.97dbda25.js"><link rel="prefetch" href="/notes/assets/interview35.html.cb683608.js"><link rel="prefetch" href="/notes/assets/interview36.html.3baa8214.js"><link rel="prefetch" href="/notes/assets/interview37.html.f0c86c3d.js"><link rel="prefetch" href="/notes/assets/interview38.html.8ad97c94.js"><link rel="prefetch" href="/notes/assets/interview39.html.5eb95b98.js"><link rel="prefetch" href="/notes/assets/interview40.html.5181b867.js"><link rel="prefetch" href="/notes/assets/interview41.html.76a7bc87.js"><link rel="prefetch" href="/notes/assets/interview42.html.fd2423db.js"><link rel="prefetch" href="/notes/assets/interview43.html.bd3f269f.js"><link rel="prefetch" href="/notes/assets/interview44.html.5d417535.js"><link rel="prefetch" href="/notes/assets/interview45.html.d2db91f1.js"><link rel="prefetch" href="/notes/assets/interview46.html.07bfd784.js"><link rel="prefetch" href="/notes/assets/interview47.html.d4d6018e.js"><link rel="prefetch" href="/notes/assets/interview48.html.82defccd.js"><link rel="prefetch" href="/notes/assets/interview49.html.020b1260.js"><link rel="prefetch" href="/notes/assets/interview5.html.80ff00ed.js"><link rel="prefetch" href="/notes/assets/interview50.html.17489c88.js"><link rel="prefetch" href="/notes/assets/interview51.html.7e48f164.js"><link rel="prefetch" href="/notes/assets/interview52.html.07cc6c82.js"><link rel="prefetch" href="/notes/assets/interview53.html.969207d3.js"><link rel="prefetch" href="/notes/assets/interview54.html.ec4d9024.js"><link rel="prefetch" href="/notes/assets/interview55.html.151a1e12.js"><link rel="prefetch" href="/notes/assets/interview56.html.b8e22659.js"><link rel="prefetch" href="/notes/assets/interview57.html.d7c49103.js"><link rel="prefetch" href="/notes/assets/interview58.html.963a2565.js"><link rel="prefetch" href="/notes/assets/interview59.html.ed7a90cb.js"><link rel="prefetch" href="/notes/assets/interview6.html.e01a8691.js"><link rel="prefetch" href="/notes/assets/interview7.html.41eee1e3.js"><link rel="prefetch" href="/notes/assets/interview8.html.fec914cc.js"><link rel="prefetch" href="/notes/assets/interview9.html.0a4aef06.js"><link rel="prefetch" href="/notes/assets/linkImport.html.a7088394.js"><link rel="prefetch" href="/notes/assets/offlineStorage.html.de185ba8.js"><link rel="prefetch" href="/notes/assets/regular.html.d75dbf05.js"><link rel="prefetch" href="/notes/assets/shake.html.7e9d7a34.js"><link rel="prefetch" href="/notes/assets/webWorker.html.574ce212.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.9b85a944.js"><link rel="prefetch" href="/notes/assets/cors.html.dd8a8368.js"><link rel="prefetch" href="/notes/assets/crossDomainCookie.html.6d554b68.js"><link rel="prefetch" href="/notes/assets/fetch.html.677a57ba.js"><link rel="prefetch" href="/notes/assets/nestAxios.html.f2e414f8.js"><link rel="prefetch" href="/notes/assets/debounce.html.9a9f528a.js"><link rel="prefetch" href="/notes/assets/lodashPrinciple.html.115a6dd1.js"><link rel="prefetch" href="/notes/assets/lodashThrottleDebounce.html.2584fa05.js"><link rel="prefetch" href="/notes/assets/throttle.html.c5c177da.js"><link rel="prefetch" href="/notes/assets/throttleDebounceReact.html.018f4a4d.js"><link rel="prefetch" href="/notes/assets/cloneIntroduction.html.19644993.js"><link rel="prefetch" href="/notes/assets/deepClone.html.d4978e33.js"><link rel="prefetch" href="/notes/assets/lodashDeepClone.html.9b1be3ba.js"><link rel="prefetch" href="/notes/assets/objectAssign.html.d709ff35.js"><link rel="prefetch" href="/notes/assets/arraySourceCode.html.c23b9c04.js"><link rel="prefetch" href="/notes/assets/baseHigh.html.59d9030d.js"><link rel="prefetch" href="/notes/assets/currying.html.ce080774.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.73b96206.js"><link rel="prefetch" href="/notes/assets/eventLoop.html.de5da7e2.js"><link rel="prefetch" href="/notes/assets/iife.html.93d028cf.js"><link rel="prefetch" href="/notes/assets/interview1.html.c0170f6a.js"><link rel="prefetch" href="/notes/assets/jsCompatible.html.2693e9b5.js"><link rel="prefetch" href="/notes/assets/baseProyotype.html.8d3c2d5c.js"><link rel="prefetch" href="/notes/assets/functionObjectResource.html.6fee45a0.js"><link rel="prefetch" href="/notes/assets/prototypeInherit.html.8e882ad5.js"><link rel="prefetch" href="/notes/assets/closureInterview.html.67ccb10f.js"><link rel="prefetch" href="/notes/assets/scopeChain.html.6f8712c3.js"><link rel="prefetch" href="/notes/assets/understandingClosures.html.63039e3a.js"><link rel="prefetch" href="/notes/assets/executionStack.html.655d8901.js"><link rel="prefetch" href="/notes/assets/memoryLeak.html.939aa95d.js"><link rel="prefetch" href="/notes/assets/memoryMechanism.html.8991f1fa.js"><link rel="prefetch" href="/notes/assets/memorySpace.html.eb0ec98a.js"><link rel="prefetch" href="/notes/assets/precompiled.html.221e0b77.js"><link rel="prefetch" href="/notes/assets/variableObject.html.1e50ec75.js"><link rel="prefetch" href="/notes/assets/arrowFunctionThis.html.71a55008.js"><link rel="prefetch" href="/notes/assets/bindSimulation.html.c8f72903.js"><link rel="prefetch" href="/notes/assets/callApply.html.8284f0de.js"><link rel="prefetch" href="/notes/assets/newSimulation.html.68045bbf.js"><link rel="prefetch" href="/notes/assets/thisBind.html.2dbf57a0.js"><link rel="prefetch" href="/notes/assets/interview1.html.c69b54ec.js"><link rel="prefetch" href="/notes/assets/interview10.html.859d229d.js"><link rel="prefetch" href="/notes/assets/interview11.html.1a5c1b85.js"><link rel="prefetch" href="/notes/assets/interview12.html.188a22a0.js"><link rel="prefetch" href="/notes/assets/interview13.html.dbc36883.js"><link rel="prefetch" href="/notes/assets/interview14.html.4f25414b.js"><link rel="prefetch" href="/notes/assets/interview15.html.b4fe72f3.js"><link rel="prefetch" href="/notes/assets/interview16.html.29c3b5cf.js"><link rel="prefetch" href="/notes/assets/interview17.html.5b1780d1.js"><link rel="prefetch" href="/notes/assets/interview18.html.f2932005.js"><link rel="prefetch" href="/notes/assets/interview19.html.29182401.js"><link rel="prefetch" href="/notes/assets/interview2.html.716337af.js"><link rel="prefetch" href="/notes/assets/interview20.html.d18fcc33.js"><link rel="prefetch" href="/notes/assets/interview21.html.b6a421c5.js"><link rel="prefetch" href="/notes/assets/interview22.html.313d741e.js"><link rel="prefetch" href="/notes/assets/interview23.html.25078ef4.js"><link rel="prefetch" href="/notes/assets/interview24.html.946cbda7.js"><link rel="prefetch" href="/notes/assets/interview25.html.0309fc6e.js"><link rel="prefetch" href="/notes/assets/interview26.html.d5dd8063.js"><link rel="prefetch" href="/notes/assets/interview27.html.3918bffe.js"><link rel="prefetch" href="/notes/assets/interview28.html.bc20a850.js"><link rel="prefetch" href="/notes/assets/interview29.html.317e754b.js"><link rel="prefetch" href="/notes/assets/interview3.html.8abf8589.js"><link rel="prefetch" href="/notes/assets/interview30.html.1414c56d.js"><link rel="prefetch" href="/notes/assets/interview4.html.c90fcba6.js"><link rel="prefetch" href="/notes/assets/interview5.html.3dcce375.js"><link rel="prefetch" href="/notes/assets/interview6.html.86227a88.js"><link rel="prefetch" href="/notes/assets/interview7.html.dfc0b4c7.js"><link rel="prefetch" href="/notes/assets/interview8.html.6a8da69c.js"><link rel="prefetch" href="/notes/assets/interview9.html.62382633.js"><link rel="prefetch" href="/notes/assets/adjacentSiblingCombinator.html.0ee38e61.js"><link rel="prefetch" href="/notes/assets/attributeSelectors.html.f06adbb1.js"><link rel="prefetch" href="/notes/assets/charset.html.8d9638b1.js"><link rel="prefetch" href="/notes/assets/childCombinator.html.4632336b.js"><link rel="prefetch" href="/notes/assets/classSelectors.html.31db1ba4.js"><link rel="prefetch" href="/notes/assets/descendantCombinator.html.b20e130b.js"><link rel="prefetch" href="/notes/assets/generalSiblingCombinator.html.40f12dab.js"><link rel="prefetch" href="/notes/assets/iDSelectors.html.e385209c.js"><link rel="prefetch" href="/notes/assets/pseudoClasses.html.69487433.js"><link rel="prefetch" href="/notes/assets/pseudoElements.html.c16c1900.js"><link rel="prefetch" href="/notes/assets/selectorList.html.124885d5.js"><link rel="prefetch" href="/notes/assets/typeSelectors.html.940ab20e.js"><link rel="prefetch" href="/notes/assets/universalSelectors.html.70bd5af5.js"><link rel="prefetch" href="/notes/assets/IterationProtocols.html.9d9c5de4.js"><link rel="prefetch" href="/notes/assets/arrayFlat.html.4048bb98.js"><link rel="prefetch" href="/notes/assets/asyncHistory.html.b98eaf2e.js"><link rel="prefetch" href="/notes/assets/eventLoop.html.4cbf6ad8.js"><link rel="prefetch" href="/notes/assets/fileReader.html.8b21aeee.js"><link rel="prefetch" href="/notes/assets/formData.html.e0e9aa4d.js"><link rel="prefetch" href="/notes/assets/functionGenerator.html.ad453e77.js"><link rel="prefetch" href="/notes/assets/generator.html.9ac91403.js"><link rel="prefetch" href="/notes/assets/intersectionObserver.html.2537e8be.js"><link rel="prefetch" href="/notes/assets/map.html.b9e5c99f.js"><link rel="prefetch" href="/notes/assets/promise.html.7d231b05.js"><link rel="prefetch" href="/notes/assets/set.html.2a999041.js"><link rel="prefetch" href="/notes/assets/string.html.9e55a664.js"><link rel="prefetch" href="/notes/assets/symbol.html.4954b228.js"><link rel="prefetch" href="/notes/assets/xMLHttpRequest.html.3de35f4d.js"><link rel="prefetch" href="/notes/assets/spreadSyntax.html.71683c54.js"><link rel="prefetch" href="/notes/assets/strictMode.html.d25ad9fb.js"><link rel="prefetch" href="/notes/assets/cache.html.36a19549.js"><link rel="prefetch" href="/notes/assets/drag1.html.37d834eb.js"><link rel="prefetch" href="/notes/assets/oneLineCode.html.8679c733.js"><link rel="prefetch" href="/notes/assets/oneLineCodeArray.html.dcb5eb0f.js"><link rel="prefetch" href="/notes/assets/oneLineCodeDOM.html.f35d8b51.js"><link rel="prefetch" href="/notes/assets/oneLineCodeDateTime.html.4ea68915.js"><link rel="prefetch" href="/notes/assets/oneLineCodeFunction.html.a5390748.js"><link rel="prefetch" href="/notes/assets/oneLineCodeMath.html.206157fd.js"><link rel="prefetch" href="/notes/assets/oneLineCodeMisc.html.db2b029d.js"><link rel="prefetch" href="/notes/assets/oneLineCodeNumber.html.21cfaec8.js"><link rel="prefetch" href="/notes/assets/oneLineCodeObject.html.84419773.js"><link rel="prefetch" href="/notes/assets/oneLineCodeRandom.html.998ca246.js"><link rel="prefetch" href="/notes/assets/oneLineCodeString.html.fbb2a53d.js"><link rel="prefetch" href="/notes/assets/oneLineCodeValidator.html.204fbdbf.js"><link rel="prefetch" href="/notes/assets/typeScriptCache.html.9a12e543.js"><link rel="prefetch" href="/notes/assets/reactBase.html.2f86267d.js"><link rel="prefetch" href="/notes/assets/reactTypescript.html.0e2d77c2.js"><link rel="prefetch" href="/notes/assets/vue2Base.html.b147d4f6.js"><link rel="prefetch" href="/notes/assets/vue2Table.html.13141846.js"><link rel="prefetch" href="/notes/assets/vue2offsetTop.html.2f2eb446.js"><link rel="prefetch" href="/notes/assets/componentWillXXX.html.b32f4e26.js"><link rel="prefetch" href="/notes/assets/disrupt.html.10ee66b4.js"><link rel="prefetch" href="/notes/assets/lane.html.4479bb14.js"><link rel="prefetch" href="/notes/assets/prepare.html.25953400.js"><link rel="prefetch" href="/notes/assets/redux.html.b34dc96f.js"><link rel="prefetch" href="/notes/assets/scheduler.html.0ac7ce61.js"><link rel="prefetch" href="/notes/assets/multi.html.025b6f8f.js"><link rel="prefetch" href="/notes/assets/one.html.56899106.js"><link rel="prefetch" href="/notes/assets/prepare.html.32964c2a.js"><link rel="prefetch" href="/notes/assets/create.html.381c119c.js"><link rel="prefetch" href="/notes/assets/prepare.html.1b6c1641.js"><link rel="prefetch" href="/notes/assets/structure.html.5fa4e158.js"><link rel="prefetch" href="/notes/assets/useeffect.html.55d0779b.js"><link rel="prefetch" href="/notes/assets/usememo.html.570f20af.js"><link rel="prefetch" href="/notes/assets/useref.html.2cf2fe0d.js"><link rel="prefetch" href="/notes/assets/usestate.html.e5216311.js"><link rel="prefetch" href="/notes/assets/file.html.1d4344a0.js"><link rel="prefetch" href="/notes/assets/idea.html.a84b127b.js"><link rel="prefetch" href="/notes/assets/jsx.html.4ca5ac6a.js"><link rel="prefetch" href="/notes/assets/newConstructure.html.89292a70.js"><link rel="prefetch" href="/notes/assets/oldConstructure.html.dbf2fb76.js"><link rel="prefetch" href="/notes/assets/source.html.a0b99aaf.js"><link rel="prefetch" href="/notes/assets/summary.html.d669143d.js"><link rel="prefetch" href="/notes/assets/basePrinciple.html.f22f7f36.js"><link rel="prefetch" href="/notes/assets/componentApi.html.575d391c.js"><link rel="prefetch" href="/notes/assets/domApi.html.d3cca537.js"><link rel="prefetch" href="/notes/assets/hoc.html.3cc65744.js"><link rel="prefetch" href="/notes/assets/hookApi.html.2cd83f62.js"><link rel="prefetch" href="/notes/assets/hookCustom.html.be43c84f.js"><link rel="prefetch" href="/notes/assets/hookPrinciple.html.b3356172.js"><link rel="prefetch" href="/notes/assets/hookUse.html.94eb6e34.js"><link rel="prefetch" href="/notes/assets/reactKeeplive.html.df077275.js"><link rel="prefetch" href="/notes/assets/reactRedux.html.db95adea.js"><link rel="prefetch" href="/notes/assets/reactRouter.html.cecfccef.js"><link rel="prefetch" href="/notes/assets/toolApi.html.7e385999.js"><link rel="prefetch" href="/notes/assets/beginWork.html.61e5286d.js"><link rel="prefetch" href="/notes/assets/completeWork.html.7dc056d0.js"><link rel="prefetch" href="/notes/assets/doubleBuffer.html.90dfbd7d.js"><link rel="prefetch" href="/notes/assets/fiber-mental.html.63bd9e31.js"><link rel="prefetch" href="/notes/assets/fiber.html.0b3a8d87.js"><link rel="prefetch" href="/notes/assets/reconciler.html.a51c09c0.js"><link rel="prefetch" href="/notes/assets/beforeMutation.html.80cb875b.js"><link rel="prefetch" href="/notes/assets/layout.html.18999bed.js"><link rel="prefetch" href="/notes/assets/mutation.html.cf6b5006.js"><link rel="prefetch" href="/notes/assets/prepare.html.97e746a1.js"><link rel="prefetch" href="/notes/assets/mental.html.4f62b879.js"><link rel="prefetch" href="/notes/assets/prepare.html.4a855c50.js"><link rel="prefetch" href="/notes/assets/priority.html.facef2f0.js"><link rel="prefetch" href="/notes/assets/reactdom.html.5d10a918.js"><link rel="prefetch" href="/notes/assets/setstate.html.88dddb33.js"><link rel="prefetch" href="/notes/assets/update.html.6f0b6a5f.js"><link rel="prefetch" href="/notes/assets/bitfiled.html.acd56f95.js"><link rel="prefetch" href="/notes/assets/dfs.html.04aedd2f.js"><link rel="prefetch" href="/notes/assets/diff.html.d483028e.js"><link rel="prefetch" href="/notes/assets/heapsort.html.9800698a.js"><link rel="prefetch" href="/notes/assets/linkedlist.html.f9fbb305.js"><link rel="prefetch" href="/notes/assets/stack.html.15c85749.js"><link rel="prefetch" href="/notes/assets/bootstrap.html.d3504d80.js"><link rel="prefetch" href="/notes/assets/context.html.36c1f5aa.js"><link rel="prefetch" href="/notes/assets/fibertree-commit.html.f42c4f83.js"><link rel="prefetch" href="/notes/assets/fibertree-create.html.5989778e.js"><link rel="prefetch" href="/notes/assets/fibertree-prepare.html.601d01b2.js"><link rel="prefetch" href="/notes/assets/fibertree-update.html.54392280.js"><link rel="prefetch" href="/notes/assets/hook-effect.html.53451ddc.js"><link rel="prefetch" href="/notes/assets/hook-state.html.32f19f9a.js"><link rel="prefetch" href="/notes/assets/hook-summary.html.f4fa814c.js"><link rel="prefetch" href="/notes/assets/macro-structure.html.a909538f.js"><link rel="prefetch" href="/notes/assets/object-structure.html.409ab3f2.js"><link rel="prefetch" href="/notes/assets/priority.html.c92b6537.js"><link rel="prefetch" href="/notes/assets/reconciler-workflow.html.44e92c3c.js"><link rel="prefetch" href="/notes/assets/scheduler.html.6bb21903.js"><link rel="prefetch" href="/notes/assets/state-effects.html.d292d482.js"><link rel="prefetch" href="/notes/assets/synthetic-event.html.efd8e0cb.js"><link rel="prefetch" href="/notes/assets/workloop.html.de7c39ed.js"><link rel="prefetch" href="/notes/assets/ast.html.e9f5d853.js"><link rel="prefetch" href="/notes/assets/binder.html.d2937d5f.js"><link rel="prefetch" href="/notes/assets/checker.html.638b51a8.js"><link rel="prefetch" href="/notes/assets/emitter.html.84f8b886.js"><link rel="prefetch" href="/notes/assets/overview.html.f1d088dd.js"><link rel="prefetch" href="/notes/assets/parser.html.3ea842db.js"><link rel="prefetch" href="/notes/assets/program.html.721ce2f2.js"><link rel="prefetch" href="/notes/assets/scanner.html.2299d63d.js"><link rel="prefetch" href="/notes/assets/common.html.195d0bb5.js"><link rel="prefetch" href="/notes/assets/interpreting.html.37f8b172.js"><link rel="prefetch" href="/notes/assets/class.html.8aa0ca63.js"><link rel="prefetch" href="/notes/assets/commandline-behavior.html.aa9c4243.js"><link rel="prefetch" href="/notes/assets/comments.html.d23e5883.js"><link rel="prefetch" href="/notes/assets/common-bug-not-bugs.html.ccdab638.js"><link rel="prefetch" href="/notes/assets/common-feature-request.html.bf113a66.js"><link rel="prefetch" href="/notes/assets/decorators.html.84a1d2b9.js"><link rel="prefetch" href="/notes/assets/enums.html.66919c52.js"><link rel="prefetch" href="/notes/assets/function.html.bf510755.js"><link rel="prefetch" href="/notes/assets/generics.html.aad792fe.js"><link rel="prefetch" href="/notes/assets/glossary-and-terms.html.b5aad0e9.js"><link rel="prefetch" href="/notes/assets/jsx-and-react.html.df7e9da6.js"><link rel="prefetch" href="/notes/assets/modules.html.707d4f03.js"><link rel="prefetch" href="/notes/assets/thing-that-dont-work.html.a840a414.js"><link rel="prefetch" href="/notes/assets/tsconfig-behavior.html.835b8565.js"><link rel="prefetch" href="/notes/assets/type-guards.html.34963965.js"><link rel="prefetch" href="/notes/assets/type-system-behavior.html.39771f7d.js"><link rel="prefetch" href="/notes/assets/nonReactJSX.html.6c4a16bb.js"><link rel="prefetch" href="/notes/assets/reactJSX.html.0a81697e.js"><link rel="prefetch" href="/notes/assets/support.html.9b3ec8bc.js"><link rel="prefetch" href="/notes/assets/typescript-3.7.html.20ae2fd8.js"><link rel="prefetch" href="/notes/assets/typescript-3.8.html.ccb003ba.js"><link rel="prefetch" href="/notes/assets/typescript-3.9.html.07d37d33.js"><link rel="prefetch" href="/notes/assets/compilationContext.html.a7eec6e5.js"><link rel="prefetch" href="/notes/assets/declarationspaces.html.d2a9034a.js"><link rel="prefetch" href="/notes/assets/dynamicImportExpressions.html.c04621d7.js"><link rel="prefetch" href="/notes/assets/inDepthTs.html.7e5f1b0a.js"><link rel="prefetch" href="/notes/assets/modules.html.c0480cc1.js"><link rel="prefetch" href="/notes/assets/namespaces.html.be81f214.js"><link rel="prefetch" href="/notes/assets/unknownAny.html.e7eefddf.js"><link rel="prefetch" href="/notes/assets/avoidExportDefault.html.0aa2de1e.js"><link rel="prefetch" href="/notes/assets/barrel.html.8ff163b5.js"><link rel="prefetch" href="/notes/assets/bind.html.25b002e5.js"><link rel="prefetch" href="/notes/assets/buildToggles.html.427be824.js"><link rel="prefetch" href="/notes/assets/classAreUseful.html.866f36fc.js"><link rel="prefetch" href="/notes/assets/covarianceAndContravariance.html.614b098b.js"><link rel="prefetch" href="/notes/assets/createArrays.html.ef00855b.js"><link rel="prefetch" href="/notes/assets/curry.html.3a3032bf.js"><link rel="prefetch" href="/notes/assets/functionParameters.html.227062b2.js"><link rel="prefetch" href="/notes/assets/infer.html.8af8e864.js"><link rel="prefetch" href="/notes/assets/lazyObjectLiteralInitialization.html.4e0dea5d.js"><link rel="prefetch" href="/notes/assets/limitPropertySetters.html.7f88d132.js"><link rel="prefetch" href="/notes/assets/metadata.html.a19cf05a.js"><link rel="prefetch" href="/notes/assets/nominalTyping.html.2a724bdc.js"><link rel="prefetch" href="/notes/assets/outFileCaution.html.1da1e197.js"><link rel="prefetch" href="/notes/assets/singletonPatern.html.c3810ee4.js"><link rel="prefetch" href="/notes/assets/statefulFunctions.html.8567bf8b.js"><link rel="prefetch" href="/notes/assets/staticConstructors.html.606276a4.js"><link rel="prefetch" href="/notes/assets/stringBasedEmuns.html.191f27fc.js"><link rel="prefetch" href="/notes/assets/truthy.html.277bf90f.js"><link rel="prefetch" href="/notes/assets/typeInstantiation.html.d9d7b913.js"><link rel="prefetch" href="/notes/assets/typesafeEventEmitter.html.e5232a52.js"><link rel="prefetch" href="/notes/assets/ambient.html.9e4528f0.js"><link rel="prefetch" href="/notes/assets/callable.html.71483cf3.js"><link rel="prefetch" href="/notes/assets/discrominatedUnion.html.db34145d.js"><link rel="prefetch" href="/notes/assets/enums.html.692645dd.js"><link rel="prefetch" href="/notes/assets/exceptionsHanding.html.46999c07.js"><link rel="prefetch" href="/notes/assets/freshness.html.7467dc1d.js"><link rel="prefetch" href="/notes/assets/functions.html.d763c488.js"><link rel="prefetch" href="/notes/assets/generices.html.ac7ce48d.js"><link rel="prefetch" href="/notes/assets/indexSignatures.html.dcf2d88b.js"><link rel="prefetch" href="/notes/assets/interfaces.html.1c089a21.js"><link rel="prefetch" href="/notes/assets/lib.html.2f9fa1c0.js"><link rel="prefetch" href="/notes/assets/literals.html.96b2ac28.js"><link rel="prefetch" href="/notes/assets/migrating.html.46fa8ed4.js"><link rel="prefetch" href="/notes/assets/mixins.html.4a6bbe7c.js"><link rel="prefetch" href="/notes/assets/movingTypes.html.be8fe08a.js"><link rel="prefetch" href="/notes/assets/neverType.html.9ffe2c42.js"><link rel="prefetch" href="/notes/assets/overview.html.b5786235.js"><link rel="prefetch" href="/notes/assets/readonly.html.5f1bdf0b.js"><link rel="prefetch" href="/notes/assets/thisType.html.381808bf.js"><link rel="prefetch" href="/notes/assets/typeAssertion.html.b3258562.js"><link rel="prefetch" href="/notes/assets/typeCompatibility.html.52d62743.js"><link rel="prefetch" href="/notes/assets/typeGuard.html.66d84d75.js"><link rel="prefetch" href="/notes/assets/typeInference.html.f8e56ebd.js"><link rel="prefetch" href="/notes/assets/types.html.5d6a41c1.js"><link rel="prefetch" href="/notes/assets/pluginDva.html.3218ac37.js"><link rel="prefetch" href="/notes/assets/pluginQiankun.html.d4f0bc95.js"><link rel="prefetch" href="/notes/assets/codegen.html.45e525d0.js"><link rel="prefetch" href="/notes/assets/entrance.html.1514cbe8.js"><link rel="prefetch" href="/notes/assets/optimize.html.be732d48.js"><link rel="prefetch" href="/notes/assets/outline.html.5dcac477.js"><link rel="prefetch" href="/notes/assets/parse.html.d8b086fa.js"><link rel="prefetch" href="/notes/assets/async-component.html.8fd3a46c.js"><link rel="prefetch" href="/notes/assets/component-register.html.1c57c20d.js"><link rel="prefetch" href="/notes/assets/create-component.html.a0f4000f.js"><link rel="prefetch" href="/notes/assets/lifecycle.html.9346eed7.js"><link rel="prefetch" href="/notes/assets/merge-option.html.50d4d706.js"><link rel="prefetch" href="/notes/assets/outline.html.b79fc2ce.js"><link rel="prefetch" href="/notes/assets/patch.html.335aef9d.js"><link rel="prefetch" href="/notes/assets/_index.html.fdf8e0e5.js"><link rel="prefetch" href="/notes/assets/create-element.html.79d81e9f.js"><link rel="prefetch" href="/notes/assets/mounted.html.2f24c956.js"><link rel="prefetch" href="/notes/assets/new-vue.html.63171fd0.js"><link rel="prefetch" href="/notes/assets/render.html.83f9bb8a.js"><link rel="prefetch" href="/notes/assets/update.html.3d58d007.js"><link rel="prefetch" href="/notes/assets/virtual-dom.html.95b3e4bd.js"><link rel="prefetch" href="/notes/assets/event.html.cd692109.js"><link rel="prefetch" href="/notes/assets/keep-alive.html.bca4b169.js"><link rel="prefetch" href="/notes/assets/outline.html.731dae6a.js"><link rel="prefetch" href="/notes/assets/slot.html.f78f8fea.js"><link rel="prefetch" href="/notes/assets/tansition-group.html.7d729ab6.js"><link rel="prefetch" href="/notes/assets/tansition.html.31dd3320.js"><link rel="prefetch" href="/notes/assets/v-model.html.3bb5bf44.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.35bb155e.js"><link rel="prefetch" href="/notes/assets/baseInterviewSecond.html.e7f344de.js"><link rel="prefetch" href="/notes/assets/componentCommunication.html.891a7697.js"><link rel="prefetch" href="/notes/assets/detailedResponsiveness.html.3e787d0e.js"><link rel="prefetch" href="/notes/assets/diff.html.58c99060.js"><link rel="prefetch" href="/notes/assets/eventBinding.html.7196e041.js"><link rel="prefetch" href="/notes/assets/eventMechanism.html.50b58be9.js"><link rel="prefetch" href="/notes/assets/key.html.abe017e2.js"><link rel="prefetch" href="/notes/assets/knowledgeSystem.html.620b9c71.js"><link rel="prefetch" href="/notes/assets/slot.html.2e1b2c87.js"><link rel="prefetch" href="/notes/assets/sourceCodeAsyncDomUpdateNextTick.html.32491212.js"><link rel="prefetch" href="/notes/assets/sourceCodeElementBroadcastDispatch.html.a92f79ed.js"><link rel="prefetch" href="/notes/assets/sourceCodeKeepAlive.html.b3d27f2e.js"><link rel="prefetch" href="/notes/assets/sourceCodeResponsiveness.html.9489c687.js"><link rel="prefetch" href="/notes/assets/sourceCodeTemplateCompilation.html.66d795e6.js"><link rel="prefetch" href="/notes/assets/sourceCodeTemplateDom.html.f8335256.js"><link rel="prefetch" href="/notes/assets/sourceCodeVuex.html.1d1da07e.js"><link rel="prefetch" href="/notes/assets/templateCompilation.html.5d528bae.js"><link rel="prefetch" href="/notes/assets/vNode.html.eb9b7dc5.js"><link rel="prefetch" href="/notes/assets/vNodeDiff.html.c492f3cf.js"><link rel="prefetch" href="/notes/assets/build.html.05a7aefd.js"><link rel="prefetch" href="/notes/assets/directory.html.85021b7a.js"><link rel="prefetch" href="/notes/assets/entrance.html.7b694aa9.js"><link rel="prefetch" href="/notes/assets/flow.html.a66bb677.js"><link rel="prefetch" href="/notes/assets/component-update.html.972bfda7.js"><link rel="prefetch" href="/notes/assets/computed-watcher.html.061430b7.js"><link rel="prefetch" href="/notes/assets/getters.html.02821ae0.js"><link rel="prefetch" href="/notes/assets/next-tick.html.671874af.js"><link rel="prefetch" href="/notes/assets/outline.html.13b74144.js"><link rel="prefetch" href="/notes/assets/props.html.0f998986.js"><link rel="prefetch" href="/notes/assets/questions.html.cc5d2ab1.js"><link rel="prefetch" href="/notes/assets/reactive-object.html.30c6de91.js"><link rel="prefetch" href="/notes/assets/setters.html.73e4a34a.js"><link rel="prefetch" href="/notes/assets/summary.html.277d73cc.js"><link rel="prefetch" href="/notes/assets/install.html.7e5db123.js"><link rel="prefetch" href="/notes/assets/matcher.html.eef5cd32.js"><link rel="prefetch" href="/notes/assets/outline.html.f909f64b.js"><link rel="prefetch" href="/notes/assets/router.html.d62362ec.js"><link rel="prefetch" href="/notes/assets/transition-to.html.ace05f14.js"><link rel="prefetch" href="/notes/assets/api.html.f3853ae3.js"><link rel="prefetch" href="/notes/assets/idex.html.349b6244.js"><link rel="prefetch" href="/notes/assets/init.html.8dfb493e.js"><link rel="prefetch" href="/notes/assets/plugin.html.124a58ab.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.87009ade.js"><link rel="prefetch" href="/notes/assets/configuration.html.a9fd781e.js"><link rel="prefetch" href="/notes/assets/entryPoints.html.c83eab97.js"><link rel="prefetch" href="/notes/assets/loader.html.73f4cf87.js"><link rel="prefetch" href="/notes/assets/output.html.1a6b2116.js"><link rel="prefetch" href="/notes/assets/plugin.html.a8808953.js"><link rel="prefetch" href="/notes/assets/webpackInterview.html.f61d2bef.js"><link rel="prefetch" href="/notes/assets/reactApi.html.65a39a4e.js"><link rel="prefetch" href="/notes/assets/reactChildren.html.e77a0069.js"><link rel="prefetch" href="/notes/assets/reactElement.html.554c4dcc.js"><link rel="prefetch" href="/notes/assets/reactFiber.html.bfedb2df.js"><link rel="prefetch" href="/notes/assets/commitAllHostEffects.html.6969ddee.js"><link rel="prefetch" href="/notes/assets/commitAllLifeCycles.html.26d4e066.js"><link rel="prefetch" href="/notes/assets/commitBeforeMutationLifecycles.html.000ce894.js"><link rel="prefetch" href="/notes/assets/commitDeletion.html.beadff25.js"><link rel="prefetch" href="/notes/assets/commitPlacement.html.4fd89511.js"><link rel="prefetch" href="/notes/assets/commitRoot.html.c957f258.js"><link rel="prefetch" href="/notes/assets/commitWork.html.d9b2e2c8.js"><link rel="prefetch" href="/notes/assets/invokeGuardedCallback.html.5cea8c95.js"><link rel="prefetch" href="/notes/assets/expirationTime.html.ac807b7c.js"><link rel="prefetch" href="/notes/assets/reactDomRender.html.5e6ed3b9.js"><link rel="prefetch" href="/notes/assets/setStateForceUpdate.html.6dde2766.js"><link rel="prefetch" href="/notes/assets/context.html.945831fd.js"><link rel="prefetch" href="/notes/assets/evenInit.html.a0106c3f.js"><link rel="prefetch" href="/notes/assets/eventBind.html.dbe8cc4d.js"><link rel="prefetch" href="/notes/assets/eventCreateEventObject.html.7d9f0337.js"><link rel="prefetch" href="/notes/assets/eventDispath.html.759964d9.js"><link rel="prefetch" href="/notes/assets/hydrate.html.26e9f5ab.js"><link rel="prefetch" href="/notes/assets/ref.html.fce07319.js"><link rel="prefetch" href="/notes/assets/suspense.html.0d01e747.js"><link rel="prefetch" href="/notes/assets/suspenseLazy.html.b2b44e96.js"><link rel="prefetch" href="/notes/assets/suspenseWork.html.b92dd570.js"><link rel="prefetch" href="/notes/assets/hooksCommon.html.53e97634.js"><link rel="prefetch" href="/notes/assets/hooksOther.html.4d139667.js"><link rel="prefetch" href="/notes/assets/start.html.4125706b.js"><link rel="prefetch" href="/notes/assets/useEffect.html.af8a6a65.js"><link rel="prefetch" href="/notes/assets/useState.html.4d108635.js"><link rel="prefetch" href="/notes/assets/base.html.b69ad7c1.js"><link rel="prefetch" href="/notes/assets/commpontDiff.html.478eb7b3.js"><link rel="prefetch" href="/notes/assets/componentUpdate.html.484c96b2.js"><link rel="prefetch" href="/notes/assets/renderProcess.html.395adf94.js"><link rel="prefetch" href="/notes/assets/schedulingPrinciple.html.5d556bb4.js"><link rel="prefetch" href="/notes/assets/beginWork.html.940e61c6.js"><link rel="prefetch" href="/notes/assets/globalVariable.html.7a04c5d0.js"><link rel="prefetch" href="/notes/assets/mountIndeterminateComponent.html.fbe0d741.js"><link rel="prefetch" href="/notes/assets/mountLazyCompont.html.36c7e14b.js"><link rel="prefetch" href="/notes/assets/performUnitOfWork.html.23a1c528.js"><link rel="prefetch" href="/notes/assets/performWork.html.8f9f6604.js"><link rel="prefetch" href="/notes/assets/reactScheduler.html.4ef39ea7.js"><link rel="prefetch" href="/notes/assets/reconcileChildren.html.d86c8afe.js"><link rel="prefetch" href="/notes/assets/reconcileChildrenArray.html.c64f3853.js"><link rel="prefetch" href="/notes/assets/reconcileSingleElement.html.e2bb64ef.js"><link rel="prefetch" href="/notes/assets/renderRoot.html.d88bb04b.js"><link rel="prefetch" href="/notes/assets/scheduleWork.html.d35f7a01.js"><link rel="prefetch" href="/notes/assets/throwException.html.95d16f49.js"><link rel="prefetch" href="/notes/assets/updateClassComponent.html.b89d73df.js"><link rel="prefetch" href="/notes/assets/updateContextConsumer.html.9f9ac25d.js"><link rel="prefetch" href="/notes/assets/updateContextProvider.html.c7c4c6af.js"><link rel="prefetch" href="/notes/assets/updateForwardRef.html.5ac14f9e.js"><link rel="prefetch" href="/notes/assets/updateFragment.html.42cc3960.js"><link rel="prefetch" href="/notes/assets/updateFunctionalComponent.html.3d4db26f.js"><link rel="prefetch" href="/notes/assets/updateHostComponent.html.297d1b72.js"><link rel="prefetch" href="/notes/assets/updateHostRoot.html.3dd4c2ed.js"><link rel="prefetch" href="/notes/assets/updateHostText.html.50caafe6.js"><link rel="prefetch" href="/notes/assets/updateMode.html.88ef0df8.js"><link rel="prefetch" href="/notes/assets/updatePortalComponent.html.03aed5de.js"><link rel="prefetch" href="/notes/assets/updateProfiler.html.4f024180.js"><link rel="prefetch" href="/notes/assets/updateSuspenseComponent.html.159143ee.js"><link rel="prefetch" href="/notes/assets/interview1.html.72ed1098.js"><link rel="prefetch" href="/notes/assets/interview2.html.4c516f12.js"><link rel="prefetch" href="/notes/assets/interview3.html.1c4b9a91.js"><link rel="prefetch" href="/notes/assets/interview51.html.9c6909ff.js"><link rel="prefetch" href="/notes/assets/interview52.html.625cac9f.js"><link rel="prefetch" href="/notes/assets/interview53.html.842d69c4.js"><link rel="prefetch" href="/notes/assets/interview54.html.0d047114.js"><link rel="prefetch" href="/notes/assets/interview55.html.81bedb61.js"><link rel="prefetch" href="/notes/assets/interview56.html.17628f3e.js"><link rel="prefetch" href="/notes/assets/interview57.html.0ce45bfc.js"><link rel="prefetch" href="/notes/assets/interview1.html.d008cbdf.js"><link rel="prefetch" href="/notes/assets/interview10.html.6c06f76c.js"><link rel="prefetch" href="/notes/assets/interview11.html.3c01fbb9.js"><link rel="prefetch" href="/notes/assets/interview12.html.9c7b20d5.js"><link rel="prefetch" href="/notes/assets/interview13.html.b359f884.js"><link rel="prefetch" href="/notes/assets/interview14.html.5eabc084.js"><link rel="prefetch" href="/notes/assets/interview15.html.d9d74ad7.js"><link rel="prefetch" href="/notes/assets/interview16.html.db2b10dc.js"><link rel="prefetch" href="/notes/assets/interview17.html.c7217d86.js"><link rel="prefetch" href="/notes/assets/interview18.html.8506acc8.js"><link rel="prefetch" href="/notes/assets/interview19.html.9ad7ba81.js"><link rel="prefetch" href="/notes/assets/interview2.html.b65acabc.js"><link rel="prefetch" href="/notes/assets/interview20.html.7ce54be4.js"><link rel="prefetch" href="/notes/assets/interview21.html.4f6ab36a.js"><link rel="prefetch" href="/notes/assets/interview22.html.d21a30d3.js"><link rel="prefetch" href="/notes/assets/interview23.html.44779b86.js"><link rel="prefetch" href="/notes/assets/interview24.html.9464e118.js"><link rel="prefetch" href="/notes/assets/interview25.html.cc3b8950.js"><link rel="prefetch" href="/notes/assets/interview26.html.257a9321.js"><link rel="prefetch" href="/notes/assets/interview27.html.aac02d5f.js"><link rel="prefetch" href="/notes/assets/interview28.html.68e6c175.js"><link rel="prefetch" href="/notes/assets/interview29.html.5bf9ea33.js"><link rel="prefetch" href="/notes/assets/interview3.html.b5ad8604.js"><link rel="prefetch" href="/notes/assets/interview30.html.a1b9aaf2.js"><link rel="prefetch" href="/notes/assets/interview31.html.37c30903.js"><link rel="prefetch" href="/notes/assets/interview32.html.0cddc25a.js"><link rel="prefetch" href="/notes/assets/interview33.html.58265999.js"><link rel="prefetch" href="/notes/assets/interview34.html.5b2e2207.js"><link rel="prefetch" href="/notes/assets/interview35.html.6c3b4734.js"><link rel="prefetch" href="/notes/assets/interview36.html.76569451.js"><link rel="prefetch" href="/notes/assets/interview37.html.86edd0ee.js"><link rel="prefetch" href="/notes/assets/interview38.html.51775ed0.js"><link rel="prefetch" href="/notes/assets/interview39.html.6dd30d67.js"><link rel="prefetch" href="/notes/assets/interview4.html.49a1ad41.js"><link rel="prefetch" href="/notes/assets/interview40.html.b9c21a0c.js"><link rel="prefetch" href="/notes/assets/interview41.html.7d88f14a.js"><link rel="prefetch" href="/notes/assets/interview42.html.be276ed1.js"><link rel="prefetch" href="/notes/assets/interview43.html.b31c5792.js"><link rel="prefetch" href="/notes/assets/interview44.html.0fa11e44.js"><link rel="prefetch" href="/notes/assets/interview45.html.e16ec694.js"><link rel="prefetch" href="/notes/assets/interview46.html.5c433146.js"><link rel="prefetch" href="/notes/assets/interview47.html.45769216.js"><link rel="prefetch" href="/notes/assets/interview48.html.3068a10d.js"><link rel="prefetch" href="/notes/assets/interview49.html.5713274f.js"><link rel="prefetch" href="/notes/assets/interview5.html.904c4942.js"><link rel="prefetch" href="/notes/assets/interview50.html.ebb94acf.js"><link rel="prefetch" href="/notes/assets/interview6.html.b4717fdb.js"><link rel="prefetch" href="/notes/assets/interview7.html.370437c7.js"><link rel="prefetch" href="/notes/assets/interview8.html.9bd86cf0.js"><link rel="prefetch" href="/notes/assets/interview9.html.cacfedcf.js"><link rel="prefetch" href="/notes/assets/404.html.dcc94ef0.js"><link rel="prefetch" href="/notes/assets/404.5f647267.js"><link rel="prefetch" href="/notes/assets/Layout.7b3c98f3.js">
    <link rel="stylesheet" href="/notes/assets/style.524e36e5.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/notes/" class=""><!----><!----></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><!----><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><!----><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">axios 源码整体架构 <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/notes/designFrame/axios.html#chrome-和-vscode-调试-axios-源码方法" class="router-link-active router-link-exact-active sidebar-item" aria-label="chrome 和 vscode 调试 axios 源码方法"><!--[--><!--]--> chrome 和 vscode 调试 axios 源码方法 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/notes/designFrame/axios.html#chrome-调试浏览器环境的-axios" class="router-link-active router-link-exact-active sidebar-item" aria-label="chrome 调试浏览器环境的 axios"><!--[--><!--]--> chrome 调试浏览器环境的 axios <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/designFrame/axios.html#vscode-调试-node-环境的-axios" class="router-link-active router-link-exact-active sidebar-item" aria-label="vscode 调试 node 环境的 axios"><!--[--><!--]--> vscode 调试 node 环境的 axios <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/notes/designFrame/axios.html#axios-结构" class="router-link-active router-link-exact-active sidebar-item" aria-label="axios 结构"><!--[--><!--]--> axios 结构 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/designFrame/axios.html#axios-源码-初始化" class="router-link-active router-link-exact-active sidebar-item" aria-label="axios 源码 初始化"><!--[--><!--]--> axios 源码 初始化 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/notes/designFrame/axios.html#lib-axios-js主文件" class="router-link-active router-link-exact-active sidebar-item" aria-label="lib/axios.js主文件"><!--[--><!--]--> lib/axios.js主文件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/designFrame/axios.html#第一部分" class="router-link-active router-link-exact-active sidebar-item" aria-label="第一部分"><!--[--><!--]--> 第一部分 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/designFrame/axios.html#第二部分" class="router-link-active router-link-exact-active sidebar-item" aria-label="第二部分"><!--[--><!--]--> 第二部分 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/designFrame/axios.html#工具方法之-bind" class="router-link-active router-link-exact-active sidebar-item" aria-label="工具方法之 bind"><!--[--><!--]--> 工具方法之 bind <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/designFrame/axios.html#工具方法之-utils-extend" class="router-link-active router-link-exact-active sidebar-item" aria-label="工具方法之 utils.extend"><!--[--><!--]--> 工具方法之 utils.extend <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/designFrame/axios.html#工具方法之-utils-foreach" class="router-link-active router-link-exact-active sidebar-item" aria-label="工具方法之 utils.forEach"><!--[--><!--]--> 工具方法之 utils.forEach <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/designFrame/axios.html#第三部分" class="router-link-active router-link-exact-active sidebar-item" aria-label="第三部分"><!--[--><!--]--> 第三部分 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/designFrame/axios.html#核心构造函数-axios" class="router-link-active router-link-exact-active sidebar-item" aria-label="核心构造函数 Axios"><!--[--><!--]--> 核心构造函数 Axios <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/designFrame/axios.html#拦截器管理构造函数-interceptormanager" class="router-link-active router-link-exact-active sidebar-item" aria-label="拦截器管理构造函数 InterceptorManager"><!--[--><!--]--> 拦截器管理构造函数 InterceptorManager <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/designFrame/axios.html#interceptormanager-prototype-use-使用" class="router-link-active router-link-exact-active sidebar-item" aria-label="InterceptorManager.prototype.use 使用"><!--[--><!--]--> InterceptorManager.prototype.use 使用 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/designFrame/axios.html#interceptormanager-prototype-eject-移除" class="router-link-active router-link-exact-active sidebar-item" aria-label="InterceptorManager.prototype.eject 移除"><!--[--><!--]--> InterceptorManager.prototype.eject 移除 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/designFrame/axios.html#interceptormanager-prototype-foreach-遍历" class="router-link-active router-link-exact-active sidebar-item" aria-label="InterceptorManager.prototype.forEach 遍历"><!--[--><!--]--> InterceptorManager.prototype.forEach 遍历 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/notes/designFrame/axios.html#实例结合" class="router-link-active router-link-exact-active sidebar-item" aria-label="实例结合"><!--[--><!--]--> 实例结合 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/notes/designFrame/axios.html#先看调用栈流程" class="router-link-active router-link-exact-active sidebar-item" aria-label="先看调用栈流程"><!--[--><!--]--> 先看调用栈流程 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/designFrame/axios.html#axios-prototype-request-请求核心方法" class="router-link-active router-link-exact-active sidebar-item" aria-label="Axios.prototype.request 请求核心方法"><!--[--><!--]--> Axios.prototype.request 请求核心方法 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/designFrame/axios.html#组成promise链-返回promise实例" class="router-link-active router-link-exact-active sidebar-item" aria-label="组成Promise链，返回Promise实例"><!--[--><!--]--> 组成Promise链，返回Promise实例 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/designFrame/axios.html#dispatchrequest-最终派发请求" class="router-link-active router-link-exact-active sidebar-item" aria-label="dispatchRequest 最终派发请求"><!--[--><!--]--> dispatchRequest 最终派发请求 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/designFrame/axios.html#dispatchrequest-之-adapter-适配器执行部分" class="router-link-active router-link-exact-active sidebar-item" aria-label="dispatchRequest 之 adapter 适配器执行部分"><!--[--><!--]--> dispatchRequest 之 adapter 适配器执行部分 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/designFrame/axios.html#adapter-适配器-真正发送请求" class="router-link-active router-link-exact-active sidebar-item" aria-label="adapter 适配器 真正发送请求"><!--[--><!--]--> adapter 适配器 真正发送请求 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/designFrame/axios.html#dispatchrequest-之-取消模块" class="router-link-active router-link-exact-active sidebar-item" aria-label="dispatchRequest 之 取消模块"><!--[--><!--]--> dispatchRequest 之 取消模块 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/designFrame/axios.html#取消请求模块代码示例" class="router-link-active router-link-exact-active sidebar-item" aria-label="取消请求模块代码示例"><!--[--><!--]--> 取消请求模块代码示例 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/designFrame/axios.html#接下来看取消模块的源码" class="router-link-active router-link-exact-active sidebar-item" aria-label="接下来看取消模块的源码"><!--[--><!--]--> 接下来看取消模块的源码 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/notes/designFrame/axios.html#对比其他请求库" class="router-link-active router-link-exact-active sidebar-item" aria-label="对比其他请求库"><!--[--><!--]--> 对比其他请求库 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/notes/designFrame/axios.html#koajax" class="router-link-active router-link-exact-active sidebar-item" aria-label="KoAjax"><!--[--><!--]--> KoAjax <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/designFrame/axios.html#umi-request-阿里开源的请求库" class="router-link-active router-link-exact-active sidebar-item" aria-label="umi-request 阿里开源的请求库"><!--[--><!--]--> umi-request 阿里开源的请求库 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/notes/designFrame/axios.html#总结" class="router-link-active router-link-exact-active sidebar-item" aria-label="总结"><!--[--><!--]--> 总结 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="axios-源码整体架构" tabindex="-1"><a class="header-anchor" href="#axios-源码整体架构" aria-hidden="true">#</a> axios 源码整体架构</h1><p>axios 版本是<code>v0.19.0</code></p><p>克隆的官方仓库的<code>master</code>分支</p><p>最新一次<code>commit</code>是<code>2019-12-09 15:52 ZhaoXC dc4bc49673943e352</code>，<code>fix: fix ignore set withCredentials false (#2582)</code></p><h2 id="chrome-和-vscode-调试-axios-源码方法" tabindex="-1"><a class="header-anchor" href="#chrome-和-vscode-调试-axios-源码方法" aria-hidden="true">#</a> chrome 和 vscode 调试 axios 源码方法</h2><h3 id="chrome-调试浏览器环境的-axios" tabindex="-1"><a class="header-anchor" href="#chrome-调试浏览器环境的-axios" aria-hidden="true">#</a> chrome 调试浏览器环境的 axios</h3><blockquote><p>调试方法</p></blockquote><p><code>axios</code>打包后有<code>sourcemap</code>文件。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 可以克隆笔者的这个仓库代码</span>
<span class="token function">git</span> clone https://github.com/lxchuan12/axios-analysis.git
<span class="token builtin class-name">cd</span> axios-analaysis/axios
<span class="token function">npm</span> <span class="token function">install</span>
<span class="token function">npm</span> start
<span class="token comment"># open [http://localhost:3000](http://localhost:3000)</span>
<span class="token comment"># chrome F12 source 控制面板  webpack//   .  lib 目录下，根据情况自行断点调试</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>本文就是通过上述的例子<code>axios/sandbox/client.html</code>来调试的。</p><p>找到文件<code>axios/examples/server.js</code>，修改代码如下：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> url <span class="token operator">=</span> req<span class="token punctuation">.</span>url<span class="token punctuation">;</span>
  <span class="token comment">// 调试 examples</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Process axios itself</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">axios\.min\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 原来的代码 是 axios.min.js</span>
    <span class="token comment">// pipeFileToResponse(res, &#39;../dist/axios.min.js&#39;, &#39;text/javascript&#39;);</span>
    <span class="token function">pipeFileToResponse</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">&#39;../dist/axios.js&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;text/javascript&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 原来的代码 是 axios.min.map</span>
  <span class="token comment">// if (/axios\.min.map$/.test(url)) {</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">axios\.map$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 原来的代码 是 axios.min.map</span>
    <span class="token comment">// pipeFileToResponse(res, &#39;../dist/axios.min.map&#39;, &#39;text/javascript&#39;);</span>
    <span class="token function">pipeFileToResponse</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">&#39;../dist/axios.map&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;text/javascript&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 上述安装好依赖后</span>
<span class="token comment"># npm run examples 不能同时开启，默认都是3000端口</span>
<span class="token comment"># 可以指定端口 5000</span>
<span class="token comment"># npm run examples ===  node ./examples/server.js</span>
<span class="token function">node</span> ./examples/server.js -p <span class="token number">5000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>打开<a href="http://localhost:5000" target="_blank" rel="noopener noreferrer">http://localhost:5000<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>，然后就可以开心的在<code>Chrome</code>浏览器中调试<code>examples</code>里的例子了。</p><p><code>axios</code> 是支持 <code>node</code> 环境发送请求的。接下来看如何用 <code>vscode</code> 调试 <code>node</code> 环境下的<code>axios</code>。</p><h3 id="vscode-调试-node-环境的-axios" tabindex="-1"><a class="header-anchor" href="#vscode-调试-node-环境的-axios" aria-hidden="true">#</a> vscode 调试 node 环境的 axios</h3><p>在根目录下 <code>axios-analysis/</code> 创建<code>.vscode/launch.json</code>文件如下：</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token comment">// 使用 IntelliSense 了解相关属性。</span>
    <span class="token comment">// 悬停以查看现有属性的描述。</span>
    <span class="token comment">// 欲了解更多信息，请访问: https://go.microsoft.com/fwlink/?linkid=830387</span>
    <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.2.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;configurations&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;request&quot;</span><span class="token operator">:</span> <span class="token string">&quot;launch&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Launch Program&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;program&quot;</span><span class="token operator">:</span> <span class="token string">&quot;${workspaceFolder}/axios/sandbox/client.js&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;skipFiles&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;&lt;node_internals&gt;/**&quot;</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>按<code>F5</code>开始调试即可，按照自己的情况，单步跳过<code>（F10）</code>、单步调试<code>（F11）</code>断点调试。</p><h2 id="axios-结构" tabindex="-1"><a class="header-anchor" href="#axios-结构" aria-hidden="true">#</a> axios 结构</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> clone https://github.com/lxchuan12/axios-analysis.git
<span class="token builtin class-name">cd</span> axios-analaysis/axios
<span class="token function">npm</span> <span class="token function">install</span>
<span class="token function">npm</span> start
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>按照上文说的调试方法， <code>npm start</code> 后，直接在 <code>chrome</code> 浏览器中调试。 打开 <a href="http://localhost:3000" target="_blank" rel="noopener noreferrer">http://localhost:3000<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>，在控制台打印出<code>axios</code>，估计很多人都没打印出来看过。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">axios</span><span class="token operator">:</span> axios<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>层层点开来看，<code>axios</code> 的结构是怎样的，先有一个大概印象。</p><img src="/notes/assets/designFrame/16efe5acd92aaa7f_tplv-t2oaga2asx-watermark.awebp" alt="demo"><p>看完结构图，如果看过<code>jQuery</code>、<code>underscore</code>和<code>lodash</code>源码，会发现其实跟<code>axios</code>源码设计类似。</p><p><code>jQuery</code> 别名 <code>$</code>，<code>underscore</code> <code>loadsh</code> 别名 <code>_</code> 也既是函数，也是对象。比如<code>jQuery</code>使用方式。<code>$(&#39;#id&#39;)</code>, <code>$.ajax</code>。</p><div class="custom-container tip"><p class="custom-container-title">断点调试</p><p>断点调试要领： 赋值语句可以一步跳过，看返回值即可，后续详细再看。 函数执行需要断点跟着看，也可以结合注释和上下文倒推这个函数做了什么。</p></div><h2 id="axios-源码-初始化" tabindex="-1"><a class="header-anchor" href="#axios-源码-初始化" aria-hidden="true">#</a> axios 源码 初始化</h2><p>看源码第一步，先看<code>package.json</code>。一般都会申明 <code>main</code> 主入口文件。</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token comment">// package.json</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;axios&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.19.0&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Promise based HTTP client for the browser and node.js&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;main&quot;</span><span class="token operator">:</span> <span class="token string">&quot;index.js&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>主入口文件</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// index.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./lib/axios&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="lib-axios-js主文件" tabindex="-1"><a class="header-anchor" href="#lib-axios-js主文件" aria-hidden="true">#</a> lib/axios.js主文件</h3><p><code>axios.js</code>文件 代码相对比较多。分为三部分展开叙述。</p><blockquote><ol><li><p>第一部分：引入一些工具函数<code>utils</code>、<code>Axios</code>构造函数、默认配置<code>defaults</code>等。</p></li><li><p>第二部分：是生成实例对象 <code>axios</code>、<code>axios.Axios</code>、<code>axios.create</code>等。</p></li><li><p>第三部分取消相关API实现，还有<code>all</code>、<code>spread</code>、导出等实现。</p></li></ol></blockquote><h3 id="第一部分" tabindex="-1"><a class="header-anchor" href="#第一部分" aria-hidden="true">#</a> 第一部分</h3><p>引入一些工具函数<code>utils</code>、<code>Axios</code>构造函数、默认配置<code>defaults</code>等。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 第一部分：</span>
<span class="token comment">// lib/axios</span>
<span class="token comment">// 严格模式</span>
<span class="token string">&#39;use strict&#39;</span><span class="token punctuation">;</span>
<span class="token comment">// 引入 utils 对象，有很多工具方法。</span>
<span class="token keyword">var</span> utils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./utils&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 引入 bind 方法</span>
<span class="token keyword">var</span> bind <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./helpers/bind&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 核心构造函数 Axios</span>
<span class="token keyword">var</span> Axios <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./core/Axios&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 合并配置方法</span>
<span class="token keyword">var</span> mergeConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./core/mergeConfig&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 引入默认配置</span>
<span class="token keyword">var</span> defaults <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./defaults&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="第二部分" tabindex="-1"><a class="header-anchor" href="#第二部分" aria-hidden="true">#</a> 第二部分</h3><p>是生成实例对象 <code>axios</code>、<code>axios.Axios</code>、<code>axios.create</code>等。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * Create an instance of Axios
 *
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>Object<span class="token punctuation">}</span></span> <span class="token parameter">defaultConfig</span> The default config for the instance
 * <span class="token keyword">@return</span> <span class="token class-name"><span class="token punctuation">{</span>Axios<span class="token punctuation">}</span></span> A new instance of Axios
 */</span>
<span class="token keyword">function</span> <span class="token function">createInstance</span><span class="token punctuation">(</span><span class="token parameter">defaultConfig</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// new 一个 Axios 生成实例对象</span>
  <span class="token keyword">var</span> context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Axios</span><span class="token punctuation">(</span>defaultConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// bind 返回一个新的 wrap 函数，</span>
  <span class="token comment">// 也就是为什么调用 axios 是调用 Axios.prototype.request 函数的原因</span>
  <span class="token keyword">var</span> instance <span class="token operator">=</span> <span class="token function">bind</span><span class="token punctuation">(</span><span class="token class-name">Axios</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>request<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Copy axios.prototype to instance</span>
  <span class="token comment">// 复制 Axios.prototype 到实例上。</span>
  <span class="token comment">// 也就是为什么 有 axios.get 等别名方法，</span>
  <span class="token comment">// 且调用的是 Axios.prototype.get 等别名方法。</span>
  utils<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> <span class="token class-name">Axios</span><span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Copy context to instance</span>
  <span class="token comment">// 复制 context 到 intance 实例</span>
  <span class="token comment">// 也就是为什么默认配置 axios.defaults 和拦截器  axios.interceptors 可以使用的原因</span>
  <span class="token comment">// 其实是new Axios().defaults 和 new Axios().interceptors</span>
  utils<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 最后返回实例对象，以上代码，在上文的图中都有体现。这时可以仔细看下上图。</span>
  <span class="token keyword">return</span> instance<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Create the default instance to be exported</span>
<span class="token comment">// 导出 创建默认实例</span>
<span class="token keyword">var</span> axios <span class="token operator">=</span> <span class="token function">createInstance</span><span class="token punctuation">(</span>defaults<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Expose Axios class to allow class inheritance</span>
<span class="token comment">// 暴露 Axios class 允许 class 继承 也就是可以 new axios.Axios()</span>
<span class="token comment">// 但  axios 文档中 并没有提到这个，我们平时也用得少。</span>
axios<span class="token punctuation">.</span>Axios <span class="token operator">=</span> Axios<span class="token punctuation">;</span>

<span class="token comment">// Factory for creating new instances</span>
<span class="token comment">// 工厂模式 创建新的实例 用户可以自定义一些参数</span>
axios<span class="token punctuation">.</span><span class="token function-variable function">create</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">instanceConfig</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">createInstance</span><span class="token punctuation">(</span><span class="token function">mergeConfig</span><span class="token punctuation">(</span>axios<span class="token punctuation">.</span>defaults<span class="token punctuation">,</span> instanceConfig<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>这里简述下工厂模式。<code>axios.create</code>，也就是用户不需要知道内部是怎么实现的。</p><blockquote><p>举个生活的例子，我们买手机，不需要知道手机是怎么做的，就是工厂模式。</p></blockquote><p>看完第二部分，里面涉及几个工具函数，如<code>bind</code>、<code>extend</code>。接下来讲述这几个工具方法。</p><h3 id="工具方法之-bind" tabindex="-1"><a class="header-anchor" href="#工具方法之-bind" aria-hidden="true">#</a> 工具方法之 bind</h3><p><code>axios/lib/helpers/bind.js</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&#39;use strict&#39;</span><span class="token punctuation">;</span>
<span class="token comment">// 返回一个新的函数 wrap</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">bind</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> thisArg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">wrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> args<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      args<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> arguments<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 把 argument 对象放在数组 args 里</span>
    <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>thisArg<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>传递两个参数函数和<code>thisArg</code>指向。</p><p>把参数<code>arguments</code>生成数组，最后调用返回参数结构。</p><p>其实现在 <code>apply</code> 支持 <code>arguments</code>这样的类数组对象了，不需要手动转数组。</p><blockquote><p>举个例子</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>console<span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 1 2 3 4 5 6</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="工具方法之-utils-extend" tabindex="-1"><a class="header-anchor" href="#工具方法之-utils-extend" aria-hidden="true">#</a> 工具方法之 utils.extend</h3><p><code>axios/lib/utils.js</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">extend</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> thisArg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">forEach</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token function">assignValue</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>thisArg <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> val <span class="token operator">===</span> <span class="token string">&#39;function&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      a<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">bind</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> thisArg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      a<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> val<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> a<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>其实就是遍历参数 <code>b</code> 对象，复制到 <code>a</code> 对象上，如果是函数就是则用 <code>bind</code> 调用。</p><h3 id="工具方法之-utils-foreach" tabindex="-1"><a class="header-anchor" href="#工具方法之-utils-foreach" aria-hidden="true">#</a> 工具方法之 utils.forEach</h3><p><code>axios/lib/utils.js</code></p><p>遍历数组和对象。设计模式称之为迭代器模式。很多源码都有类似这样的遍历函数。比如大家熟知的<code>jQuery</code> <code>$.each</code>。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>Object<span class="token operator">|</span>Array<span class="token punctuation">}</span></span> <span class="token parameter">obj</span> The object to iterate
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>Function<span class="token punctuation">}</span></span> <span class="token parameter">fn</span> The callback to invoke for each item
 */</span>
<span class="token keyword">function</span> <span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Don&#39;t bother if no value provided</span>
  <span class="token comment">// 判断 null 和 undefined 直接返回</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token keyword">typeof</span> obj <span class="token operator">===</span> <span class="token string">&#39;undefined&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Force an array if not already something iterable</span>
  <span class="token comment">// 如果不是对象，放在数组里。</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> obj <span class="token operator">!==</span> <span class="token string">&#39;object&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">/*eslint no-param-reassign:0*/</span>
    obj <span class="token operator">=</span> <span class="token punctuation">[</span>obj<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 是数组 则用for 循环，调用 fn 函数。参数类似 Array.prototype.forEach 的前三个参数。</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isArray</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Iterate over array values</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> obj<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> obj<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// Iterate over object keys</span>
    <span class="token comment">// 用 for in 遍历对象，但 for in 会遍历原型链上可遍历的属性。</span>
    <span class="token comment">// 所以用 hasOwnProperty 来过滤自身属性了。</span>
    <span class="token comment">// 其实也可以用Object.keys来遍历，它不遍历原型链上可遍历的属性。</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><h3 id="第三部分" tabindex="-1"><a class="header-anchor" href="#第三部分" aria-hidden="true">#</a> 第三部分</h3><p>取消相关API实现，还有<code>all</code>、<code>spread</code>、<code>导出</code>等实现。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// Expose Cancel &amp; CancelToken</span>
<span class="token comment">// 导出 Cancel 和 CancelToken</span>
axios<span class="token punctuation">.</span>Cancel <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./cancel/Cancel&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
axios<span class="token punctuation">.</span>CancelToken <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./cancel/CancelToken&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
axios<span class="token punctuation">.</span>isCancel <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./cancel/isCancel&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Expose all/spread</span>
<span class="token comment">// 导出 all 和 spread API</span>
axios<span class="token punctuation">.</span><span class="token function-variable function">all</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">all</span><span class="token punctuation">(</span><span class="token parameter">promises</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>promises<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
axios<span class="token punctuation">.</span>spread <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./helpers/spread&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> axios<span class="token punctuation">;</span>

<span class="token comment">// Allow use of default import syntax in TypeScript</span>
<span class="token comment">// 也就是可以以下方式引入</span>
<span class="token comment">// import axios from &#39;axios&#39;;</span>
module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span>default <span class="token operator">=</span> axios<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>这里介绍下 <code>spread</code>，取消的<code>API</code>暂时不做分析，后文再详细分析。</p><blockquote><p>假设你有这样的需求。</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">f</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>那么可以用<code>spread</code>方法。用法：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>axios<span class="token punctuation">.</span><span class="token function">spread</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>实现也比较简单。源码实现：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>Function<span class="token punctuation">}</span></span> <span class="token parameter">callback</span>
 * <span class="token keyword">@returns</span> <span class="token class-name"><span class="token punctuation">{</span>Function<span class="token punctuation">}</span></span>
 */</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">spread</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">wrap</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>上文<code>var context = new Axios(defaultConfig);</code>，接下来介绍核心构造函数<code>Axios</code>。</p><h3 id="核心构造函数-axios" tabindex="-1"><a class="header-anchor" href="#核心构造函数-axios" aria-hidden="true">#</a> 核心构造函数 Axios</h3><p><code>axios/lib/core/Axios.js</code></p><p>构造函数<code>Axios</code>。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Axios</span><span class="token punctuation">(</span><span class="token parameter">instanceConfig</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 默认参数</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>defaults <span class="token operator">=</span> instanceConfig<span class="token punctuation">;</span>
  <span class="token comment">// 拦截器 请求和响应拦截器</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>interceptors <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">request</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">InterceptorManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">response</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">InterceptorManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token class-name">Axios</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">request</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 省略，这个是核心方法，后文结合例子详细描述</span>
  <span class="token comment">// code ...</span>
  <span class="token keyword">var</span> promise <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// code ...</span>
  <span class="token keyword">return</span> promise<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 这是获取 Uri 的函数，这里省略</span>
<span class="token class-name">Axios</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getUri</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// 提供一些请求方法的别名</span>
<span class="token comment">// Provide aliases for supported request methods</span>
<span class="token comment">// 遍历执行</span>
<span class="token comment">// 也就是为啥我们可以 axios.get 等别名的方式调用，而且调用的是 Axios.prototype.request 方法</span>
<span class="token comment">// 这个也在上面的 axios 结构图上有所体现。</span>
utils<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;delete&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;get&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;head&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;options&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token function">forEachMethodNoData</span><span class="token punctuation">(</span><span class="token parameter">method</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/*eslint func-names:0*/</span>
  <span class="token class-name">Axios</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span>method<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>utils<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>config <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">method</span><span class="token operator">:</span> method<span class="token punctuation">,</span>
      <span class="token literal-property property">url</span><span class="token operator">:</span> url
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

utils<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;post&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;put&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;patch&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token function">forEachMethodWithData</span><span class="token punctuation">(</span><span class="token parameter">method</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/*eslint func-names:0*/</span>
  <span class="token class-name">Axios</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span>method<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>utils<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>config <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">method</span><span class="token operator">:</span> method<span class="token punctuation">,</span>
      <span class="token literal-property property">url</span><span class="token operator">:</span> url<span class="token punctuation">,</span>
      <span class="token literal-property property">data</span><span class="token operator">:</span> data
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> Axios<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><h3 id="拦截器管理构造函数-interceptormanager" tabindex="-1"><a class="header-anchor" href="#拦截器管理构造函数-interceptormanager" aria-hidden="true">#</a> 拦截器管理构造函数 InterceptorManager</h3><blockquote><p>请求前拦截，和请求后拦截。</p></blockquote><p>在<code>Axios.prototype.request</code>函数里使用，具体怎么实现的拦截的，后文配合例子详细讲述。</p><blockquote><p>如何使用：</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// Add a request interceptor</span>
<span class="token comment">// 添加请求前拦截器</span>
axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Do something before request is sent</span>
  <span class="token keyword">return</span> config<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Do something with request error</span>
  <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Add a response interceptor</span>
<span class="token comment">// 添加请求后拦截器</span>
axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Any status code that lie within the range of 2xx cause this function to trigger</span>
  <span class="token comment">// Do something with response data</span>
  <span class="token keyword">return</span> response<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Any status codes that falls outside the range of 2xx cause this function to trigger</span>
  <span class="token comment">// Do something with response error</span>
  <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><blockquote><p>如果想把拦截器，可以用<code>eject</code>方法。</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> myInterceptor <span class="token operator">=</span> axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">/*...*/</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">eject</span><span class="token punctuation">(</span>myInterceptor<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>拦截器也可以添加自定义的实例上。</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> instance <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">/*...*/</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>源码实现：</p><blockquote><p>构造函数，<code>handles</code> 用于存储拦截器函数。</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">InterceptorManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>handlers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>接下来声明了三个方法：<code>使用</code>、<code>移除</code>、<code>遍历</code>。</p><h3 id="interceptormanager-prototype-use-使用" tabindex="-1"><a class="header-anchor" href="#interceptormanager-prototype-use-使用" aria-hidden="true">#</a> InterceptorManager.prototype.use 使用</h3><p>传递两个函数作为参数，数组中的一项存储的是<code>{fulfilled: function(){}, rejected: function(){}}</code>。返回数字 <code>ID</code>，用于移除拦截器。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>Function<span class="token punctuation">}</span></span> <span class="token parameter">fulfilled</span> The function to handle `then` for a `Promise`
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>Function<span class="token punctuation">}</span></span> <span class="token parameter">rejected</span> The function to handle `reject` for a `Promise`
 *
 * <span class="token keyword">@return</span> <span class="token class-name"><span class="token punctuation">{</span>Number<span class="token punctuation">}</span></span> 返回ID 是为了用 eject 移除
 */</span>
<span class="token class-name">InterceptorManager</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">use</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">use</span><span class="token punctuation">(</span><span class="token parameter">fulfilled<span class="token punctuation">,</span> rejected</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>handlers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">fulfilled</span><span class="token operator">:</span> fulfilled<span class="token punctuation">,</span>
    <span class="token literal-property property">rejected</span><span class="token operator">:</span> rejected
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handlers<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="interceptormanager-prototype-eject-移除" tabindex="-1"><a class="header-anchor" href="#interceptormanager-prototype-eject-移除" aria-hidden="true">#</a> InterceptorManager.prototype.eject 移除</h3><p>根据 <code>use</code> 返回的 <code>ID</code> 移除 拦截器。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>Number<span class="token punctuation">}</span></span> <span class="token parameter">id</span> The ID that was returned by `use`
 */</span>
<span class="token class-name">InterceptorManager</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">eject</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">eject</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>handlers<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>handlers<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>有点类似定时器<code>setTimeout</code> 和 <code>setInterval</code>，返回值是<code>id</code>。用<code>clearTimeout</code> 和<code>clearInterval</code>来清除定时器。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 提一下 定时器回调函数是可以传参的，返回值 timer 是数字</span>
<span class="token keyword">var</span> timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token string">&#39;若川&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 数字 ID</span>
<span class="token comment">// 在控制台等会再输入执行这句，定时器就被清除了</span>
<span class="token function">clearInterval</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="interceptormanager-prototype-foreach-遍历" tabindex="-1"><a class="header-anchor" href="#interceptormanager-prototype-foreach-遍历" aria-hidden="true">#</a> InterceptorManager.prototype.forEach 遍历</h3><p>遍历执行所有拦截器，传递一个回调函数（每一个拦截器函数作为参数）调用，被移除的一项是<code>null</code>，所以不会执行，也就达到了移除的效果。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>Function<span class="token punctuation">}</span></span> <span class="token parameter">fn</span> The function to call for each interceptor
 */</span>
<span class="token class-name">InterceptorManager</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">forEach</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  utils<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>handlers<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token function">forEachHandler</span><span class="token punctuation">(</span><span class="token parameter">h</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>h <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">fn</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="实例结合" tabindex="-1"><a class="header-anchor" href="#实例结合" aria-hidden="true">#</a> 实例结合</h2><p>上文叙述的调试时运行<code>npm start</code> 是用<code>axios/sandbox/client.html</code>路径的文件作为示例的</p><blockquote><p>以下是一段这个文件中的代码。</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">axios</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  response<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  response<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="先看调用栈流程" tabindex="-1"><a class="header-anchor" href="#先看调用栈流程" aria-hidden="true">#</a> 先看调用栈流程</h3><p>如果不想一步步调试，有个偷巧的方法。 知道 <code>axios</code> 使用了<code>XMLHttpRequest</code>。 可以在项目中搜索：<code>new XMLHttpRequest</code>。 定位到文件 <code>axios/lib/adapters/xhr.js</code> 在这条语句 <code>var request = new XMLHttpRequest();</code><code>chrome</code> 浏览器中 打个断点调试下，再根据调用栈来细看具体函数等实现。</p><p><code>Call Stack</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">dispatchXhrRequest</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>js<span class="token operator">:</span><span class="token number">19</span><span class="token punctuation">)</span>
<span class="token function">xhrAdapter</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>js<span class="token operator">:</span><span class="token number">12</span><span class="token punctuation">)</span>
<span class="token function">dispatchRequest</span> <span class="token punctuation">(</span>dispatchRequest<span class="token punctuation">.</span>js<span class="token operator">:</span><span class="token number">60</span><span class="token punctuation">)</span>
Promise<span class="token punctuation">.</span><span class="token function">then</span> <span class="token punctuation">(</span>async<span class="token punctuation">)</span>
<span class="token function">request</span> <span class="token punctuation">(</span>Axios<span class="token punctuation">.</span>js<span class="token operator">:</span><span class="token number">54</span><span class="token punctuation">)</span>
<span class="token function">wrap</span> <span class="token punctuation">(</span>bind<span class="token punctuation">.</span>js<span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">)</span>
submit<span class="token punctuation">.</span><span class="token function">onclick</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token operator">:</span><span class="token number">138</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">简述下流程：</p><ol><li><p><code>Send Request</code> 按钮点击 <code>submit.onclick</code></p></li><li><p>调用 <code>axios</code> 函数实际上是调用 <code>Axios.prototype.request</code> 函数，而这个函数使用 <code>bind</code> 返回的一个名为<code>wrap</code>的函数。</p></li><li><p>调用 <code>Axios.prototype.request</code></p></li><li><p>（有请求拦截器的情况下执行请求拦截器），中间会执行 <code>dispatchRequest</code>方法</p></li><li><p><code>dispatchRequest</code> 之后调用 <code>adapter(xhrAdapter)</code></p></li><li><p>最后调用 <code>Promise</code> 中的函数<code>dispatchXhrRequest</code>，（有响应拦截器的情况下最后会再调用响应拦截器）</p></li></ol></div><h3 id="axios-prototype-request-请求核心方法" tabindex="-1"><a class="header-anchor" href="#axios-prototype-request-请求核心方法" aria-hidden="true">#</a> Axios.prototype.request 请求核心方法</h3><p>这个函数是核心函数。 主要做了这几件事：</p><blockquote><ol><li><p>判断第一个参数是字符串，则设置 <code>url</code>,也就是支持<code>axios(&#39;example/url&#39;, [, config])</code>，也支持<code>axios({})</code>。</p></li><li><p>合并默认参数和用户传递的参数</p></li><li><p>设置请求的方法，默认是是<code>get</code>方法</p></li><li><p>将用户设置的请求和响应拦截器、发送请求的<code>dispatchRequest</code>组成<code>Promise</code>链，最后返回还是<code>Promise</code>实例。</p></li></ol></blockquote><blockquote><p>也就是保证了请求前拦截器先执行，然后发送请求，再响应拦截器执行这样的顺序。</p><p>也就是为啥最后还是可以<code>then</code>，<code>catch</code>方法的缘故。</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token class-name">Axios</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">request</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/*eslint no-param-reassign:0*/</span>
  <span class="token comment">// Allow for axios(&#39;example/url&#39;[, config]) a la fetch API</span>
  <span class="token comment">// 这一段代码 其实就是 使 axios(&#39;example/url&#39;, [, config])</span>
  <span class="token comment">// config 参数可以省略</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> config <span class="token operator">===</span> <span class="token string">&#39;string&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    config <span class="token operator">=</span> arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    config<span class="token punctuation">.</span>url <span class="token operator">=</span> arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    config <span class="token operator">=</span> config <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 合并默认参数和用户传递的参数</span>
  config <span class="token operator">=</span> <span class="token function">mergeConfig</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>defaults<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Set config.method</span>
  <span class="token comment">// 设置 请求方法，默认 get 。</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span>method<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span>method <span class="token operator">=</span> config<span class="token punctuation">.</span>method<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>method<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span>method <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>method<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span>method <span class="token operator">=</span> <span class="token string">&#39;get&#39;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Hook up interceptors middleware</span>
  <span class="token comment">// 组成`Promise`链 这段拆开到后文再讲述</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="组成promise链-返回promise实例" tabindex="-1"><a class="header-anchor" href="#组成promise链-返回promise实例" aria-hidden="true">#</a> 组成Promise链，返回Promise实例</h3><blockquote><p>这部分：用户设置的请求和响应拦截器、发送请求的<code>dispatchRequest</code>组成<code>Promise</code>链。也就是保证了请求前拦截器先执行，然后发送请求，再响应拦截器执行这样的顺序</p></blockquote><blockquote><p>也就是保证了请求前拦截器先执行，然后发送请求，再响应拦截器执行这样的顺序</p><p>也就是为啥最后还是可以<code>then</code>，<code>catch</code>方法的缘故。</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>  <span class="token comment">// 组成`Promise`链</span>
  <span class="token comment">// Hook up interceptors middleware</span>
  <span class="token comment">// 把 xhr 请求 的 dispatchRequest 和 undefined 放在一个数组里</span>
  <span class="token keyword">var</span> chain <span class="token operator">=</span> <span class="token punctuation">[</span>dispatchRequest<span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// 创建 Promise 实例</span>
  <span class="token keyword">var</span> promise <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token comment">// 遍历用户设置的请求拦截器 放到数组的 chain 前面</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">unshiftRequestInterceptors</span><span class="token punctuation">(</span><span class="token parameter">interceptor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    chain<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span>interceptor<span class="token punctuation">.</span>fulfilled<span class="token punctuation">,</span> interceptor<span class="token punctuation">.</span>rejected<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token comment">// 遍历用户设置的响应拦截器 放到数组的 chain 后面</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">pushResponseInterceptors</span><span class="token punctuation">(</span><span class="token parameter">interceptor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    chain<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>interceptor<span class="token punctuation">.</span>fulfilled<span class="token punctuation">,</span> interceptor<span class="token punctuation">.</span>rejected<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token comment">// 遍历 chain 数组，直到遍历 chain.length 为 0</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>chain<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 两两对应移出来 放到 then 的两个参数里。</span>
    promise <span class="token operator">=</span> promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>chain<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> chain<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> promise<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> promise <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><blockquote><p>作用是生成Promise实例</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> promise <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;若川&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 等价于</span>
<span class="token comment">// new Promise(resolve =&gt; resolve({name: &#39;若川&#39;}))</span>
promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// {name: &quot;若川&quot;}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><blockquote><p>同样解释下后文会出现的<code>Promise.reject(error);</code>：</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> promise <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;若川&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 等价于</span>
<span class="token comment">// new Promise(reject =&gt; reject({name: &#39;若川&#39;}))</span>

<span class="token comment">// promise.then(null, function (config){</span>
<span class="token comment">//   console.log(config)</span>
<span class="token comment">// });</span>
<span class="token comment">// 等价于</span>
promise<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// {name: &quot;若川&quot;}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>接下来结合例子，来理解这段代码。</p><p>很遗憾，在<code>example</code>文件夹没有拦截器的例子。在<code>example</code>中在<code>example/get</code>的基础上添加了一个拦截器的示例。<code>axios/examples/interceptors</code>，便于调试。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">node</span> ./examples/server.js -p <span class="token number">5000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><code>promise = promise.then(chain.shift(), chain.shift());</code>这段代码打个断点。</p><img src="/notes/assets/designFrame/16efe5beaa35ac54_tplv-t2oaga2asx-watermark.awebp" alt="demo"><blockquote><p>特别关注下，右侧，<code>local</code>中的<code>chain</code>数组。也就是这样的结构。</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> chain <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token string">&#39;请求成功拦截2&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;请求失败拦截2&#39;</span><span class="token punctuation">,</span>  
  <span class="token string">&#39;请求成功拦截1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;请求失败拦截1&#39;</span><span class="token punctuation">,</span>  
  dispatch<span class="token punctuation">,</span>  <span class="token keyword">undefined</span><span class="token punctuation">,</span>
  <span class="token string">&#39;响应成功拦截1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;响应失败拦截1&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&#39;响应成功拦截2&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;响应失败拦截2&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>这段代码相对比较绕。也就是会生成如下类似的代码，中间会调用<code>dispatchRequest</code>方法。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// config 是 用户配置和默认配置合并的</span>
<span class="token keyword">var</span> promise <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token string">&#39;请求成功拦截2&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;请求失败拦截2&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token string">&#39;请求成功拦截1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;请求失败拦截1&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>dispatchRequest<span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token string">&#39;响应成功拦截1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;响应失败拦截1&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token string">&#39;响应成功拦截2&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;响应失败拦截2&#39;</span><span class="token punctuation">)</span>

<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token string">&#39;用户写的业务处理函数&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token string">&#39;用户写的报错业务处理函数&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">总结</p><p>这里提下<code>promise</code> <code>then</code>和<code>catch</code>知识：</p><p><code>Promise.prototype.then</code>方法的第一个参数是<code>resolved</code>状态的回调函数，第二个参数（可选）是<code>rejected</code>状态的回调函数。所以是成对出现的。</p><p><code>Promise.prototype.catch</code>方法是<code>.then(null, rejection)</code>或<code>.then(undefined, rejection)</code>的别名，用于指定发生错误时的回调函数。</p><p><code>then</code>方法返回的是一个新的<code>Promise</code>实例（注意，不是原来那个<code>Promise</code>实例）。因此可以采用链式写法，即<code>then</code>方法后面再调用另一个<code>then</code>方法。</p></div><blockquote><p>结合上述的例子更详细一点，代码则是这样的。</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> promise <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// promise.then(&#39;请求成功拦截2&#39;, &#39;请求失败拦截2&#39;)</span>
promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">requestSuccess2</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;------request------success------2&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> config<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token function">requestError2</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;------response------error------2&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// .then(&#39;请求成功拦截1&#39;, &#39;请求失败拦截1&#39;)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">requestSuccess1</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;------request------success------1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> config<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token function">requestError1</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;------response------error------1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// .then(dispatchRequest, undefined)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token keyword">function</span> <span class="token function">dispatchRequest</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token doc-comment comment">/**
    * 适配器返回的也是Promise 实例
      adapter = function xhrAdapter(config) <span class="token punctuation">{</span>
            return new Promise(function dispatchXhrRequest(resolve, reject) <span class="token punctuation">{</span><span class="token punctuation">}</span>)
      <span class="token punctuation">}</span>
    **/</span>
  <span class="token keyword">return</span> <span class="token function">adapter</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">onAdapterResolution</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 省略代码 ...</span>
    <span class="token keyword">return</span> response<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token function">onAdapterRejection</span><span class="token punctuation">(</span><span class="token parameter">reason</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 省略代码 ...</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span>

<span class="token comment">// .then(&#39;响应成功拦截1&#39;, &#39;响应失败拦截1&#39;)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">responseSuccess1</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;------response------success------1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> response<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token function">responseError1</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;------response------error------1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// .then(&#39;响应成功拦截2&#39;, &#39;响应失败拦截2&#39;)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">responseSuccess2</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;------response------success------2&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> response<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token function">responseError2</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;------response------error------2&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// .then(&#39;用户写的业务处理函数&#39;)</span>
<span class="token comment">// .catch(&#39;用户写的报错业务处理函数&#39;);</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;哈哈哈，终于获取到数据了&#39;</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;哎呀，怎么报错了&#39;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br></div></div><p>仔细看这段<code>Promise</code>链式调用，代码都类似。<code>then</code>方法最后返回的参数，就是下一个<code>then</code>方法第一个参数。</p><p><code>catch</code>错误捕获，都返回<code>Promise.reject(error)</code>，这是为了便于用户<code>catch</code>时能捕获到错误。</p><blockquote><p>举个例子：</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
 <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;若川&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

p1<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">&#39;err&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token string">&#39;err1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token string">&#39;err2&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><code>err2</code>不会捕获到，也就是不会执行，但如果都返回了<code>return Promise.reject(err)</code>，则可以捕获到。</p><p>最后画个图总结下 <code>Promise</code> 链式调用。</p><img src="/notes/assets/designFrame/16f0f56a048b5c7d_tplv-t2oaga2asx-watermark.awebp" alt="demo"><div class="custom-container tip"><p class="custom-container-title">小结</p><ol><li>请求和响应的拦截器可以写Promise。</li><li>如果设置了多个请求响应器，后设置的先执行。</li><li>如果设置了多个响应拦截器，先设置的先执行。</li></ol></div><p><code>dispatchRequest(config)</code> 这里的<code>config</code>是请求成功拦截器返回的。接下来看<code>dispatchRequest</code>函数。</p><h3 id="dispatchrequest-最终派发请求" tabindex="-1"><a class="header-anchor" href="#dispatchrequest-最终派发请求" aria-hidden="true">#</a> dispatchRequest 最终派发请求</h3><p>这个函数主要做了如下几件事情：</p><blockquote><p>1.如果已经取消，则 throw 原因报错，使Promise走向rejected。</p><p>2.确保 config.header 存在。</p><p>3.利用用户设置的和默认的请求转换器转换数据。</p><p>4.拍平 config.header。</p><p>5.删除一些 config.header。</p><p>6.返回适配器adapter（Promise实例）执行后 then执行后的 Promise实例。返回结果传递给响应拦截器处理。</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&#39;use strict&#39;</span><span class="token punctuation">;</span>
<span class="token comment">// utils 工具函数</span>
<span class="token keyword">var</span> utils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./../utils&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 转换数据</span>
<span class="token keyword">var</span> transformData <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./transformData&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 取消状态</span>
<span class="token keyword">var</span> isCancel <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;../cancel/isCancel&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 默认参数</span>
<span class="token keyword">var</span> defaults <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;../defaults&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * 抛出 错误原因，使`Promise`走向`rejected`
 */</span>
<span class="token keyword">function</span> <span class="token function">throwIfCancellationRequested</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span>cancelToken<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span>cancelToken<span class="token punctuation">.</span><span class="token function">throwIfRequested</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * Dispatch a request to the server using the configured adapter.
 *
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>object<span class="token punctuation">}</span></span> <span class="token parameter">config</span> The config that is to be used for the request
 * <span class="token keyword">@returns</span> <span class="token class-name"><span class="token punctuation">{</span>Promise<span class="token punctuation">}</span></span> The Promise to be fulfilled
 */</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">dispatchRequest</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 取消相关</span>
  <span class="token function">throwIfCancellationRequested</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Ensure headers exist</span>
  <span class="token comment">// 确保 headers 存在</span>
  config<span class="token punctuation">.</span>headers <span class="token operator">=</span> config<span class="token punctuation">.</span>headers <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">// Transform request data</span>
  <span class="token comment">// 转换请求的数据</span>
  config<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token function">transformData</span><span class="token punctuation">(</span>
    config<span class="token punctuation">.</span>data<span class="token punctuation">,</span>
    config<span class="token punctuation">.</span>headers<span class="token punctuation">,</span>
    config<span class="token punctuation">.</span>transformRequest
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Flatten headers</span>
  <span class="token comment">// 拍平 headers</span>
  config<span class="token punctuation">.</span>headers <span class="token operator">=</span> utils<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>
    config<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>common <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    config<span class="token punctuation">.</span>headers<span class="token punctuation">[</span>config<span class="token punctuation">.</span>method<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    config<span class="token punctuation">.</span>headers <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 以下这些方法 删除 headers</span>
  utils<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>
    <span class="token punctuation">[</span><span class="token string">&#39;delete&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;get&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;head&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;post&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;put&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;patch&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;common&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span> <span class="token function">cleanHeaderConfig</span><span class="token punctuation">(</span><span class="token parameter">method</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">delete</span> config<span class="token punctuation">.</span>headers<span class="token punctuation">[</span>method<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// adapter 适配器部分 拆开 放在下文讲</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br></div></div><p>上文的代码里有个函数 <code>transformData</code> ，这里解释下。其实就是遍历传递的函数数组 对数据操作，最后返回数据。</p><p><code>axios.defaults.transformResponse</code> 数组中默认就有一个函数，所以使用<code>concat</code>链接自定义的函数。</p><blockquote><p>使用：</p></blockquote><p>文件路径 <code>axios/examples/transform-response/index.html</code></p><p>这段代码其实就是对时间格式的字符串转换成时间对象，可以直接调用<code>getMonth</code>等方法。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token constant">ISO_8601</span> <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(\d{4}-\d{2}-\d{2})T(\d{2}:\d{2}:\d{2})Z</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">formatDate</span><span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;/&#39;</span> <span class="token operator">+</span> d<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;/&#39;</span> <span class="token operator">+</span> d<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;https://api.github.com/users/mzabriskie&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">transformResponse</span><span class="token operator">:</span> axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>transformResponse<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> headers</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">k</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">ISO_8601</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        data<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> data<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;created&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token function">formatDate</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>created_at<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><blockquote><p>源码：</p></blockquote><p>就是遍历数组，调用数组里的传递 <code>data</code> 和 <code>headers</code> 参数调用函数。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">transformData</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> headers<span class="token punctuation">,</span> fns</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/*eslint no-param-reassign:0*/</span>
  utils<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>fns<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token function">transform</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    data <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> headers<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> data<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="dispatchrequest-之-adapter-适配器执行部分" tabindex="-1"><a class="header-anchor" href="#dispatchrequest-之-adapter-适配器执行部分" aria-hidden="true">#</a> dispatchRequest 之 adapter 适配器执行部分</h3><p>适配器，在设计模式中称之为适配器模式。讲个生活中简单的例子，大家就容易理解。</p><p>我们常用以前手机耳机孔都是圆孔，而现在基本是耳机孔和充电接口合二为一。统一为<code>typec</code>。</p><p>这时我们需要需要一个<code>typec转圆孔的转接口</code>，这就是适配器。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>  <span class="token comment">// adapter 适配器部分</span>
  <span class="token keyword">var</span> adapter <span class="token operator">=</span> config<span class="token punctuation">.</span>adapter <span class="token operator">||</span> defaults<span class="token punctuation">.</span>adapter<span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token function">adapter</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">onAdapterResolution</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">throwIfCancellationRequested</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Transform response data</span>
    <span class="token comment">// 转换响应的数据</span>
    response<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token function">transformData</span><span class="token punctuation">(</span>
      response<span class="token punctuation">.</span>data<span class="token punctuation">,</span>
      response<span class="token punctuation">.</span>headers<span class="token punctuation">,</span>
      config<span class="token punctuation">.</span>transformResponse
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> response<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token function">onAdapterRejection</span><span class="token punctuation">(</span><span class="token parameter">reason</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isCancel</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 取消相关</span>
      <span class="token function">throwIfCancellationRequested</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// Transform response data</span>
      <span class="token comment">// 转换响应的数据</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>reason <span class="token operator">&amp;&amp;</span> reason<span class="token punctuation">.</span>response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        reason<span class="token punctuation">.</span>response<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token function">transformData</span><span class="token punctuation">(</span>
          reason<span class="token punctuation">.</span>response<span class="token punctuation">.</span>data<span class="token punctuation">,</span>
          reason<span class="token punctuation">.</span>response<span class="token punctuation">.</span>headers<span class="token punctuation">,</span>
          config<span class="token punctuation">.</span>transformResponse
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>接下来看具体的 <code>adapter</code>。</p><h3 id="adapter-适配器-真正发送请求" tabindex="-1"><a class="header-anchor" href="#adapter-适配器-真正发送请求" aria-hidden="true">#</a> adapter 适配器 真正发送请求</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> adapter <span class="token operator">=</span> config<span class="token punctuation">.</span>adapter <span class="token operator">||</span> defaults<span class="token punctuation">.</span>adapter<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>看了上文的 <code>adapter</code>，可以知道支持用户自定义。比如可以通过微信小程序 <code>wx.request</code> 按照要求也写一个 <code>adapter</code>。</p><p>接着来看下 <code>defaults.ddapter</code>。</p><p>文件路径：<code>axios/lib/defaults.js</code></p><p>根据当前环境引入，如果是浏览器环境引入<code>xhr</code>，是<code>node</code>环境则引入<code>http</code>。</p><p>类似判断<code>node</code>环境，也在<code>sentry-javascript</code>源码中有看到。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">getDefaultAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> adapter<span class="token punctuation">;</span>
  <span class="token comment">// 根据 XMLHttpRequest 判断</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> XMLHttpRequest <span class="token operator">!==</span> <span class="token string">&#39;undefined&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// For browsers use XHR adapter</span>
    adapter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./adapters/xhr&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 根据 process 判断</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> process <span class="token operator">!==</span> <span class="token string">&#39;undefined&#39;</span> <span class="token operator">&amp;&amp;</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>process<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&#39;[object process]&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// For node use HTTP adapter</span>
    adapter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./adapters/http&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> adapter<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> defaults <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">adapter</span><span class="token operator">:</span> <span class="token function">getDefaultAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p><code>xhr</code></p><p>接下来就是我们熟悉的 <code>XMLHttpRequest</code> 对象。</p><div class="custom-container tip"><p class="custom-container-title">注意</p><p>主要提醒下：<code>onabort</code>是请求取消事件，<code>withCredentials</code>是一个布尔值，用来指定跨域 <code>Access-Control</code> 请求是否应带有授权信息，如 <code>cookie</code> 或授权 <code>header</code> 头。</p></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">xhrAdapter</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">dispatchXhrRequest</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 这块代码有删减</span>
    <span class="token keyword">var</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    request<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    request<span class="token punctuation">.</span>timeout <span class="token operator">=</span> config<span class="token punctuation">.</span>timeout<span class="token punctuation">;</span>
    <span class="token comment">// 监听 state 改变</span>
    request<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">handleLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>request <span class="token operator">||</span> request<span class="token punctuation">.</span>readyState <span class="token operator">!==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 取消</span>
    request<span class="token punctuation">.</span><span class="token function-variable function">onabort</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// 错误</span>
    request<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// 超时</span>
    request<span class="token punctuation">.</span><span class="token function-variable function">ontimeout</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// cookies 跨域携带 cookies 面试官常喜欢考这个</span>
    <span class="token comment">// 一个布尔值，用来指定跨域 Access-Control 请求是否应带有授权信息，如 cookie 或授权 header 头。</span>
    <span class="token comment">// Add withCredentials to request if needed</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>utils<span class="token punctuation">.</span><span class="token function">isUndefined</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>withCredentials<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      request<span class="token punctuation">.</span>withCredentials <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>config<span class="token punctuation">.</span>withCredentials<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 上传下载进度相关</span>
    <span class="token comment">// Handle progress if needed</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> config<span class="token punctuation">.</span>onDownloadProgress <span class="token operator">===</span> <span class="token string">&#39;function&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      request<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;progress&#39;</span><span class="token punctuation">,</span> config<span class="token punctuation">.</span>onDownloadProgress<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Not all browsers support upload events</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> config<span class="token punctuation">.</span>onUploadProgress <span class="token operator">===</span> <span class="token string">&#39;function&#39;</span> <span class="token operator">&amp;&amp;</span> request<span class="token punctuation">.</span>upload<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      request<span class="token punctuation">.</span>upload<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;progress&#39;</span><span class="token punctuation">,</span> config<span class="token punctuation">.</span>onUploadProgress<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Send the request</span>
    <span class="token comment">// 发送请求</span>
    request<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>requestData<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><p>而实际上现在 <code>fetch</code> 支持的很好了，阿里开源的 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fumijs%2Fumi-request%2Fblob%2Fmaster%2FREADME_zh-CN.md" target="_blank" rel="noopener noreferrer">umi-request<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 请求库，就是用<code>fetch</code>封装的，而不是用<code>XMLHttpRequest</code>。 文章末尾，大概讲述下 <code>umi-request</code> 和 <code>axios</code> 的区别。</p><p><code>http</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">httpAdapter</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">dispatchHttpRequest</span><span class="token punctuation">(</span><span class="token parameter">resolvePromise<span class="token punctuation">,</span> rejectPromise</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>上文 <code>dispatchRequest</code> 有取消模块：</p><h3 id="dispatchrequest-之-取消模块" tabindex="-1"><a class="header-anchor" href="#dispatchrequest-之-取消模块" aria-hidden="true">#</a> dispatchRequest 之 取消模块</h3><p>可以使用<code>cancel token</code>取消请求。</p><p><code>axios cancel token API</code> 是基于撤销的 <code>promise</code> 取消提议。</p><blockquote><p>文档上详细描述了两种使用方式。</p></blockquote><p>很遗憾，在<code>example</code>文件夹也没有取消的例子。笔者在<code>example</code>中在<code>example/get</code>的基础上添加了一个取消的示例。<code>axios/examples/cancel</code>，便于读者调试。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">node</span> ./examples/server.js -p <span class="token number">5000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><code>request</code>中的拦截器和<code>dispatch</code>中的取消这两个模块相对复杂，可以多调试调试，吸收消化。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> CancelToken <span class="token operator">=</span> axios<span class="token punctuation">.</span>CancelToken<span class="token punctuation">;</span>
<span class="token keyword">const</span> source <span class="token operator">=</span> CancelToken<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/get/server&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">cancelToken</span><span class="token operator">:</span> source<span class="token punctuation">.</span>token
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>axios<span class="token punctuation">.</span><span class="token function">isCancel</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Request canceled&#39;</span><span class="token punctuation">,</span> err<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// handle error</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// cancel the request (the message parameter is optional)</span>
<span class="token comment">// 取消函数。</span>
source<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token string">&#39;哎呀，我被若川取消了&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="取消请求模块代码示例" tabindex="-1"><a class="header-anchor" href="#取消请求模块代码示例" aria-hidden="true">#</a> 取消请求模块代码示例</h3><p>结合源码取消流程大概是这样的。这段放在代码在<code>axios/examples/cancel-token/index.html</code>。</p><p>参数的 <code>config.cancelToken</code> 是触发了<code>source.cancel(&#39;哎呀，我被若川取消了&#39;);</code>才生成的。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// source.cancel(&#39;哎呀，我被若川取消了&#39;);</span>
<span class="token comment">// 点击取消时才会 生成 cancelToken 实例对象。</span>
<span class="token comment">// 点击取消后，会生成原因，看懂了这段在看之后的源码，可能就好理解了。</span>
<span class="token keyword">var</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;若川&#39;</span><span class="token punctuation">,</span>
  <span class="token comment">// 这里简化了</span>
  <span class="token literal-property property">cancelToken</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">promise</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&#39;哎呀，我被若川取消了&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">reason</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&#39;哎呀，我被若川取消了&#39;</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 取消 抛出异常方法</span>
<span class="token keyword">function</span> <span class="token function">throwIfCancellationRequested</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 取消的情况下执行这句</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>cancelToken<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//   这里源代码 便于执行，我改成具体代码</span>
    <span class="token comment">// config.cancelToken.throwIfRequested();</span>
    <span class="token comment">// if (this.reason) {</span>
    <span class="token comment">//     throw this.reason;</span>
    <span class="token comment">//   }</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>cancelToken<span class="token punctuation">.</span>reason<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">throw</span> config<span class="token punctuation">.</span>cancelToken<span class="token punctuation">.</span>reason<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">dispatchRequest</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 有可能是执行到这里就取消了，所以抛出错误会被err2 捕获到</span>
  <span class="token function">throwIfCancellationRequested</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//  adapter xhr适配器</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resovle<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;request&#39;</span><span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span>cancelToken<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Handle cancellation</span>
        config<span class="token punctuation">.</span>cancelToken<span class="token punctuation">.</span>promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">onCanceled</span><span class="token punctuation">(</span><span class="token parameter">cancel</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            request<span class="token punctuation">.</span><span class="token function">abort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">reject</span><span class="token punctuation">(</span>cancel<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// Clean up request</span>
            request <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 有可能是执行到这里就才取消 取消的情况下执行这句</span>
    <span class="token function">throwIfCancellationRequested</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;res&#39;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">reason</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 有可能是执行到这里就才取消 取消的情况下执行这句</span>
    <span class="token function">throwIfCancellationRequested</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;reason&#39;</span><span class="token punctuation">,</span> reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> promise <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 没设置拦截器的情况下是这样的</span>
promise
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>dispatchRequest<span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span>
<span class="token comment">// 用户定义的then 和 catch</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;res1&#39;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;err2&#39;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// err2 {message: &quot;哎呀，我被若川取消了&quot;}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br></div></div><h3 id="接下来看取消模块的源码" tabindex="-1"><a class="header-anchor" href="#接下来看取消模块的源码" aria-hidden="true">#</a> 接下来看取消模块的源码</h3><p>看如何通过生成<code>config.cancelToken</code>。</p><p>文件路径：</p><p><code>axios/lib/cancel/CancelToken.js</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> CancelToken <span class="token operator">=</span> axios<span class="token punctuation">.</span>CancelToken<span class="token punctuation">;</span>
<span class="token keyword">const</span> source <span class="token operator">=</span> CancelToken<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
source<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token string">&#39;哎呀，我被若川取消了&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>由示例看 <code>CancelToken.source</code>的实现，</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>CancelToken<span class="token punctuation">.</span><span class="token function-variable function">source</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> cancel<span class="token punctuation">;</span>
  <span class="token keyword">var</span> token <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CancelToken</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">executor</span><span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cancel <span class="token operator">=</span> c<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// token</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">token</span><span class="token operator">:</span> token<span class="token punctuation">,</span>
    <span class="token literal-property property">cancel</span><span class="token operator">:</span> cancel
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>执行后<code>source</code>的大概结构是这样的。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    <span class="token literal-property property">token</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">promise</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&#39;哎呀，我被若川取消了&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">reason</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&#39;哎呀，我被若川取消了&#39;</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">cancel</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">cancel</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>token<span class="token punctuation">.</span>reason<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Cancellation has already been requested</span>
      <span class="token comment">// 已经取消</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    token<span class="token punctuation">.</span>reason <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&#39;哎呀，我被若川取消了&#39;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>接着看 <code>new CancelToken</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// CancelToken</span>
<span class="token comment">// 通过 CancelToken 来取消请求操作</span>
<span class="token keyword">function</span> <span class="token function">CancelToken</span><span class="token punctuation">(</span><span class="token parameter">executor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> executor <span class="token operator">!==</span> <span class="token string">&#39;function&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">&#39;executor must be a function.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">var</span> resolvePromise<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">promiseExecutor</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    resolvePromise <span class="token operator">=</span> resolve<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> token <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token function">executor</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">cancel</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>token<span class="token punctuation">.</span>reason<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Cancellation has already been requested</span>
      <span class="token comment">// 已经取消</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    token<span class="token punctuation">.</span>reason <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cancel</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">resolvePromise</span><span class="token punctuation">(</span>token<span class="token punctuation">.</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> CancelToken<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><blockquote><p>发送请求的适配器里是这样使用的。</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// xhr</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span>cancelToken<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Handle cancellation</span>
  config<span class="token punctuation">.</span>cancelToken<span class="token punctuation">.</span>promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">onCanceled</span><span class="token punctuation">(</span><span class="token parameter">cancel</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    request<span class="token punctuation">.</span><span class="token function">abort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">reject</span><span class="token punctuation">(</span>cancel<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Clean up request</span>
    request <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><code>dispatchRequest</code> 中的<code>throwIfCancellationRequested</code>具体实现：throw 抛出异常。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 抛出异常函数</span>
<span class="token keyword">function</span> <span class="token function">throwIfCancellationRequested</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span>cancelToken<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span>cancelToken<span class="token punctuation">.</span><span class="token function">throwIfRequested</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 抛出异常 用户 { message: &#39;哎呀，我被若川取消了&#39; }</span>
<span class="token class-name">CancelToken</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">throwIfRequested</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">throwIfRequested</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>reason<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">this</span><span class="token punctuation">.</span>reason<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">取消流程调用栈</p><ol><li><p>source.cancel()</p></li><li><p>resolvePromise(token.reason);</p></li><li><p>config.cancelToken.promise.then(function onCanceled(cancel) {})</p></li></ol></div><p>最后进入<code>request.abort();``reject(cancel);</code></p><p>到这里取消的流程就介绍完毕了。主要就是通过传递配置参数<code>cancelToken</code>，取消时才会生成<code>cancelToken</code>，判断有，则抛出错误，使<code>Promise</code> 走向<code>rejected</code>，让用户捕获到消息<code>{message: &#39;用户设置的取消信息&#39;}</code>。</p><h2 id="对比其他请求库" tabindex="-1"><a class="header-anchor" href="#对比其他请求库" aria-hidden="true">#</a> 对比其他请求库</h2><h3 id="koajax" tabindex="-1"><a class="header-anchor" href="#koajax" aria-hidden="true">#</a> KoAjax</h3><blockquote><p>前端请求库 —— KoAJAX 国内前端同学最常用的 HTTP 请求库应该是 axios 了吧？虽然它的 Interceptor（拦截器）API 是 .use()，但和 Node.js 的 Express、Koa 等框架的中间件模式完全不同，相比 jQuery .ajaxPrefilter()、dataFilter() 并没什么实质改进；上传、下载进度比 jQuery.Deferred() 还简陋，只是两个专门的回调选项。所以，它还是要对特定的需求记忆特定的 API，不够简洁。</p></blockquote><blockquote><p>幸运的是，水歌在研究如何用 <a href="https://link.juejin.cn/?target=https%3A%2F%2Ftech-query.me%2Fonion-stack%2F" target="_blank" rel="noopener noreferrer">ES 2018 异步迭代器实现一个类 Koa 中间件引擎<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>的过程中，做出了一个更有实际价值的上层应用 —— KoAJAX。它的整个执行过程基于 Koa 式的中间件，而且它自己就是一个中间件调用栈。除了 RESTful API 常用的 .get()、.post()、.put()、.delete() 等快捷方法外，开发者就只需记住 .use() 和 next()，其它都是 ES 标准语法和 TS 类型推导。</p></blockquote><h3 id="umi-request-阿里开源的请求库" tabindex="-1"><a class="header-anchor" href="#umi-request-阿里开源的请求库" aria-hidden="true">#</a> umi-request 阿里开源的请求库</h3><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fumijs%2Fumi-request%2Fblob%2Fmaster%2FREADME_zh-CN.md" target="_blank" rel="noopener noreferrer">umi-request github 仓库<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><code>umi-request</code> 与 <code>fetch</code>, <code>axios</code> 异同。</p><img src="/notes/assets/designFrame/16efe5c696a5e5f7_tplv-t2oaga2asx-watermark.awebp" alt="demo"><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结" aria-hidden="true">#</a> 总结</h2><img src="/notes/assets/designFrame/16f0f5560e4aa850_tplv-t2oaga2asx-watermark.awebp" alt="demo"><blockquote><ol><li>为什么 <code>axios</code> 既可以当函数调用，也可以当对象使用，比如<code>axios({})</code>、<code>axios.get</code>。</li></ol></blockquote><p>答：<code>axios</code>本质是函数，赋值了一些别名方法，比如<code>get</code>、<code>post</code>方法，可被调用，最终调用的还是<code>Axios.prototype.request</code>函数。</p><blockquote><ol start="2"><li>简述 <code>axios</code> 调用流程。</li></ol></blockquote><p>答：实际是调用的<code>Axios.prototype.request</code>方法，最终返回的是<code>promise</code>链式调用，实际请求是在<code>dispatchRequest</code>中派发的。</p><blockquote><ol start="3"><li>有用过拦截器吗？原理是怎样的？</li></ol></blockquote><p>答：用过，用<code>axios.interceptors.request.use</code>添加请求成功和失败拦截器函数，用<code>axios.interceptors.response.use</code>添加响应成功和失败拦截器函数。在<code>Axios.prototype.request</code>函数组成<code>promise</code>链式调用时，<code>Interceptors.protype.forEach</code>遍历请求和响应拦截器添加到真正发送请求<code>dispatchRequest</code>的两端，从而做到请求前拦截和响应后拦截。拦截器也支持用<code>Interceptors.protype.eject</code>方法移除。</p><blockquote><ol start="4"><li>有使用<code>axios</code>的取消功能吗？是怎么实现的？</li></ol></blockquote><p>答：用过，通过传递<code>config</code>配置<code>cancelToken</code>的形式，来取消的。判断有传<code>cancelToken</code>，在<code>promise</code>链式调用的<code>dispatchRequest</code>抛出错误，在<code>adapter</code>中<code>request.abort()</code>取消请求，使<code>promise</code>走向<code>rejected</code>，被用户捕获取消信息。</p><blockquote><ol start="5"><li>为什么支持浏览器中发送请求也支持<code>node</code>发送请求？</li></ol></blockquote><p>答：<code>axios.defaults.adapter</code>默认配置中根据环境判断是浏览器还是<code>node</code>环境，使用对应的适配器。适配器支持自定义。</p><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: dean@57blocks.com">DeanSui</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/notes/assets/app.41ff10d5.js" defer></script>
  </body>
</html>
