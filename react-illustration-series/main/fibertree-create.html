<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.48">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>fiber 树构造(初次创建) | </title><meta name="description" content="君子藏器于身 待时而动 天下有道则见 无道则隐">
    <link rel="modulepreload" href="/notes/assets/app.013e756e.js"><link rel="modulepreload" href="/notes/assets/fibertree-create.html.5d944821.js"><link rel="modulepreload" href="/notes/assets/fibertree-create.html.3774a8fc.js"><link rel="prefetch" href="/notes/assets/index.html.3634373a.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.3ba9ec24.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.c28c3f3c.js"><link rel="prefetch" href="/notes/assets/base.html.1093b531.js"><link rel="prefetch" href="/notes/assets/customCli.html.bd95fbb6.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.7df24b52.js"><link rel="prefetch" href="/notes/assets/adapter.html.228754b3.js"><link rel="prefetch" href="/notes/assets/amd.html.374db1f8.js"><link rel="prefetch" href="/notes/assets/builder.html.4ab18b18.js"><link rel="prefetch" href="/notes/assets/censorJquery.html.8cb430d5.js"><link rel="prefetch" href="/notes/assets/combination.html.9e0e20cf.js"><link rel="prefetch" href="/notes/assets/command.html.2a7e3e32.js"><link rel="prefetch" href="/notes/assets/commonJS.html.335e912d.js"><link rel="prefetch" href="/notes/assets/constructor.html.0b23ee40.js"><link rel="prefetch" href="/notes/assets/decoration.html.0520d7ca.js"><link rel="prefetch" href="/notes/assets/esHarmony.html.f9b6c6b0.js"><link rel="prefetch" href="/notes/assets/exposed.html.8436d4f7.js"><link rel="prefetch" href="/notes/assets/exterior.html.637510d7.js"><link rel="prefetch" href="/notes/assets/factory.html.cee24005.js"><link rel="prefetch" href="/notes/assets/flyweight.html.77af5a34.js"><link rel="prefetch" href="/notes/assets/functionalProgramming.html.826201d8.js"><link rel="prefetch" href="/notes/assets/intermediary.html.017a62d8.js"><link rel="prefetch" href="/notes/assets/iterator.html.9879f57a.js"><link rel="prefetch" href="/notes/assets/lazyInitial.html.a662b8a9.js"><link rel="prefetch" href="/notes/assets/mixin.html.8e083c8c.js"><link rel="prefetch" href="/notes/assets/module.html.ccbf7e1e.js"><link rel="prefetch" href="/notes/assets/mvc.html.7c775a82.js"><link rel="prefetch" href="/notes/assets/mvp.html.1ab68755.js"><link rel="prefetch" href="/notes/assets/mvvm.html.31bbe5fa.js"><link rel="prefetch" href="/notes/assets/observer.html.f28c60ea.js"><link rel="prefetch" href="/notes/assets/outward.html.c9113669.js"><link rel="prefetch" href="/notes/assets/overview.html.fd9ac12c.js"><link rel="prefetch" href="/notes/assets/prototype.html.17eb0ec7.js"><link rel="prefetch" href="/notes/assets/proxy.html.4a69fa28.js"><link rel="prefetch" href="/notes/assets/singleton.html.ac8326eb.js"><link rel="prefetch" href="/notes/assets/axios.html.894c36f5.js"><link rel="prefetch" href="/notes/assets/createUnderscore.html.086e63d6.js"><link rel="prefetch" href="/notes/assets/jquery.html.800f2d11.js"><link rel="prefetch" href="/notes/assets/lodash.html.a1c5d14b.js"><link rel="prefetch" href="/notes/assets/sentry.html.3380eab9.js"><link rel="prefetch" href="/notes/assets/underscore.html.408b3621.js"><link rel="prefetch" href="/notes/assets/vuex.html.5a13be39.js"><link rel="prefetch" href="/notes/assets/customCli.html.5fea6892.js"><link rel="prefetch" href="/notes/assets/description.html.ee95e973.js"><link rel="prefetch" href="/notes/assets/indx.html.fb991811.js"><link rel="prefetch" href="/notes/assets/rebase.html.315da41b.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.8d5399c2.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.49333970.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.fd446871.js"><link rel="prefetch" href="/notes/assets/44Questions.html.e09b9e77.js"><link rel="prefetch" href="/notes/assets/asyncAwait.html.8fcdbc04.js"><link rel="prefetch" href="/notes/assets/babelCompile.html.373d5380.js"><link rel="prefetch" href="/notes/assets/base.html.96ef6e10.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.4822e1da.js"><link rel="prefetch" href="/notes/assets/baseWebpack.html.1c0b1ad6.js"><link rel="prefetch" href="/notes/assets/codeSeparation.html.917a63a3.js"><link rel="prefetch" href="/notes/assets/cycle.html.340b3610.js"><link rel="prefetch" href="/notes/assets/cycleOtherWay.html.034fe39b.js"><link rel="prefetch" href="/notes/assets/executionMechanism.html.67387e19.js"><link rel="prefetch" href="/notes/assets/hybrid.html.a54f648d.js"><link rel="prefetch" href="/notes/assets/jsHandwriting.html.91b44994.js"><link rel="prefetch" href="/notes/assets/jsonStringify.html.4c9735e2.js"><link rel="prefetch" href="/notes/assets/largeFileResumableUpload.html.d860ce97.js"><link rel="prefetch" href="/notes/assets/performance.html.95200270.js"><link rel="prefetch" href="/notes/assets/promise.html.34412d36.js"><link rel="prefetch" href="/notes/assets/promiseAll.html.82f50799.js"><link rel="prefetch" href="/notes/assets/spa.html.f9a327ec.js"><link rel="prefetch" href="/notes/assets/tsBaseInterview.html.1adc8582.js"><link rel="prefetch" href="/notes/assets/useEs6.html.d9c2b1c5.js"><link rel="prefetch" href="/notes/assets/webAnimations.html.4f59d2fe.js"><link rel="prefetch" href="/notes/assets/webpackInterview.html.11c71b4f.js"><link rel="prefetch" href="/notes/assets/webpackLoader.html.e137d628.js"><link rel="prefetch" href="/notes/assets/webpackPublic.html.22c85b9e.js"><link rel="prefetch" href="/notes/assets/weird.html.5b8c02b0.js"><link rel="prefetch" href="/notes/assets/es10News.html.5f65989d.js"><link rel="prefetch" href="/notes/assets/es11News.html.62ff1633.js"><link rel="prefetch" href="/notes/assets/es6Interview1.html.33c84747.js"><link rel="prefetch" href="/notes/assets/es6Interview2.html.3da1892a.js"><link rel="prefetch" href="/notes/assets/es6Interview3.html.7eb30dbe.js"><link rel="prefetch" href="/notes/assets/es6News.html.9548af96.js"><link rel="prefetch" href="/notes/assets/es7News.html.a6a0fa9a.js"><link rel="prefetch" href="/notes/assets/es8News.html.abebd8e3.js"><link rel="prefetch" href="/notes/assets/es9News.html.2544d57f.js"><link rel="prefetch" href="/notes/assets/base.html.abd02c91.js"><link rel="prefetch" href="/notes/assets/nginxComprehensiveScene.html.eefe1e40.js"><link rel="prefetch" href="/notes/assets/commonlyUsed.html.3d56cebb.js"><link rel="prefetch" href="/notes/assets/inelegantHook.html.6acf2a38.js"><link rel="prefetch" href="/notes/assets/interview1.html.f22b3b85.js"><link rel="prefetch" href="/notes/assets/interview2.html.b0c3bb67.js"><link rel="prefetch" href="/notes/assets/interview3.html.77f72812.js"><link rel="prefetch" href="/notes/assets/interview4.html.bf5749b9.js"><link rel="prefetch" href="/notes/assets/base.html.5c694567.js"><link rel="prefetch" href="/notes/assets/introduction.html.4ae01b9b.js"><link rel="prefetch" href="/notes/assets/base.html.4b98657a.js"><link rel="prefetch" href="/notes/assets/summarize.html.0e390eb4.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.fb56a9de.js"><link rel="prefetch" href="/notes/assets/index.html.6cadf120.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.5f455e90.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.70945f28.js"><link rel="prefetch" href="/notes/assets/bigDataRender.html.16fc9dd9.js"><link rel="prefetch" href="/notes/assets/progress.html.32b74572.js"><link rel="prefetch" href="/notes/assets/quirksStandards.html.d59cf821.js"><link rel="prefetch" href="/notes/assets/redrawReflow.html.8aa659c4.js"><link rel="prefetch" href="/notes/assets/storageSpace.html.dcc11060.js"><link rel="prefetch" href="/notes/assets/webComLink.html.aa29f7e7.js"><link rel="prefetch" href="/notes/assets/webUrl.html.c5ea3916.js"><link rel="prefetch" href="/notes/assets/spanWidthHeight.html.3678c09c.js"><link rel="prefetch" href="/notes/assets/baseCss.html.1b3854fa.js"><link rel="prefetch" href="/notes/assets/blockFormattingContext.html.77b718c0.js"><link rel="prefetch" href="/notes/assets/containingBlock.html.8e433b42.js"><link rel="prefetch" href="/notes/assets/cssBeforeAfter.html.eb9b03ee.js"><link rel="prefetch" href="/notes/assets/cssBoxModal.html.80f3eb90.js"><link rel="prefetch" href="/notes/assets/cssCollapsing.html.0e35aa83.js"><link rel="prefetch" href="/notes/assets/cssCompatible.html.f171139f.js"><link rel="prefetch" href="/notes/assets/cssFlexDemo.html.167a483f.js"><link rel="prefetch" href="/notes/assets/cssFlexLayout.html.196b26b8.js"><link rel="prefetch" href="/notes/assets/cssGridLayout.html.1cad8452.js"><link rel="prefetch" href="/notes/assets/cssHack.html.396ee0f0.js"><link rel="prefetch" href="/notes/assets/cssInlineBlock.html.a6923bf7.js"><link rel="prefetch" href="/notes/assets/cssPriority.html.c4772a9a.js"><link rel="prefetch" href="/notes/assets/cssPseudo.html.43d0dd35.js"><link rel="prefetch" href="/notes/assets/cssPseudoClass.html.43db38dd.js"><link rel="prefetch" href="/notes/assets/cssSelector.html.2b368cc7.js"><link rel="prefetch" href="/notes/assets/cssTutorial.html.c16444ba.js"><link rel="prefetch" href="/notes/assets/fieldInvalid.html.1fcb2558.js"><link rel="prefetch" href="/notes/assets/frame.html.fda09f9b.js"><link rel="prefetch" href="/notes/assets/knowledgePoints.html.844ecbe9.js"><link rel="prefetch" href="/notes/assets/linkImport.html.8e3fbbf4.js"><link rel="prefetch" href="/notes/assets/stackingContext.html.84ce02ee.js"><link rel="prefetch" href="/notes/assets/tools.html.3370ac55.js"><link rel="prefetch" href="/notes/assets/units.html.a8ce632a.js"><link rel="prefetch" href="/notes/assets/transform.html.c584daae.js"><link rel="prefetch" href="/notes/assets/content.html.6e1fa151.js"><link rel="prefetch" href="/notes/assets/plugins.html.6e17ba17.js"><link rel="prefetch" href="/notes/assets/accesskey.html.cc77cd1e.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.417bda6c.js"><link rel="prefetch" href="/notes/assets/canvasSvg.html.56545180.js"><link rel="prefetch" href="/notes/assets/deviceAPI.html.d0af0732.js"><link rel="prefetch" href="/notes/assets/globalAttr.html.312d06e6.js"><link rel="prefetch" href="/notes/assets/htmlDatalist.html.2a3a0833.js"><link rel="prefetch" href="/notes/assets/htmlElement.html.5e1b1f69.js"><link rel="prefetch" href="/notes/assets/interview10.html.57058a90.js"><link rel="prefetch" href="/notes/assets/interview11.html.ebb261a8.js"><link rel="prefetch" href="/notes/assets/interview12.html.2e022b4e.js"><link rel="prefetch" href="/notes/assets/interview13.html.5adf2646.js"><link rel="prefetch" href="/notes/assets/interview14.html.69021bf6.js"><link rel="prefetch" href="/notes/assets/interview15.html.6fa214b3.js"><link rel="prefetch" href="/notes/assets/interview16.html.5977700c.js"><link rel="prefetch" href="/notes/assets/interview17.html.ade3757d.js"><link rel="prefetch" href="/notes/assets/interview18.html.cb8e09c0.js"><link rel="prefetch" href="/notes/assets/interview19.html.698b83d0.js"><link rel="prefetch" href="/notes/assets/interview20.html.518d535f.js"><link rel="prefetch" href="/notes/assets/interview21.html.48008fc2.js"><link rel="prefetch" href="/notes/assets/interview22.html.45a1d5a7.js"><link rel="prefetch" href="/notes/assets/interview23.html.74da7576.js"><link rel="prefetch" href="/notes/assets/interview24.html.417cd5f3.js"><link rel="prefetch" href="/notes/assets/interview25.html.4e8b4df3.js"><link rel="prefetch" href="/notes/assets/interview26.html.0bb23540.js"><link rel="prefetch" href="/notes/assets/interview27.html.f55bdf74.js"><link rel="prefetch" href="/notes/assets/interview28.html.89a195cc.js"><link rel="prefetch" href="/notes/assets/interview29.html.75ed487e.js"><link rel="prefetch" href="/notes/assets/interview30.html.3ee6174e.js"><link rel="prefetch" href="/notes/assets/interview31.html.eec2c665.js"><link rel="prefetch" href="/notes/assets/interview32.html.ded26d9b.js"><link rel="prefetch" href="/notes/assets/interview33.html.bec603c5.js"><link rel="prefetch" href="/notes/assets/interview34.html.ce8f1f2b.js"><link rel="prefetch" href="/notes/assets/interview35.html.7fe9d232.js"><link rel="prefetch" href="/notes/assets/interview36.html.f7fee400.js"><link rel="prefetch" href="/notes/assets/interview37.html.358d81ef.js"><link rel="prefetch" href="/notes/assets/interview38.html.ceaba854.js"><link rel="prefetch" href="/notes/assets/interview39.html.17669b12.js"><link rel="prefetch" href="/notes/assets/interview40.html.15d2b768.js"><link rel="prefetch" href="/notes/assets/interview41.html.42d648d3.js"><link rel="prefetch" href="/notes/assets/interview42.html.3eb38913.js"><link rel="prefetch" href="/notes/assets/interview43.html.26053012.js"><link rel="prefetch" href="/notes/assets/interview44.html.3f94ae6d.js"><link rel="prefetch" href="/notes/assets/interview45.html.0f1d944a.js"><link rel="prefetch" href="/notes/assets/interview46.html.18a1fb80.js"><link rel="prefetch" href="/notes/assets/interview47.html.ef24f77c.js"><link rel="prefetch" href="/notes/assets/interview48.html.cf96e72c.js"><link rel="prefetch" href="/notes/assets/interview49.html.ec4c15a0.js"><link rel="prefetch" href="/notes/assets/interview5.html.d97befa1.js"><link rel="prefetch" href="/notes/assets/interview50.html.13c54965.js"><link rel="prefetch" href="/notes/assets/interview51.html.5ae12de0.js"><link rel="prefetch" href="/notes/assets/interview52.html.0987028e.js"><link rel="prefetch" href="/notes/assets/interview53.html.435860a0.js"><link rel="prefetch" href="/notes/assets/interview54.html.ace84b23.js"><link rel="prefetch" href="/notes/assets/interview55.html.e61ea5db.js"><link rel="prefetch" href="/notes/assets/interview56.html.a03aa17c.js"><link rel="prefetch" href="/notes/assets/interview57.html.3f370b24.js"><link rel="prefetch" href="/notes/assets/interview58.html.8d506b26.js"><link rel="prefetch" href="/notes/assets/interview59.html.ec25e0b8.js"><link rel="prefetch" href="/notes/assets/interview6.html.91ab47ae.js"><link rel="prefetch" href="/notes/assets/interview7.html.6e7ad964.js"><link rel="prefetch" href="/notes/assets/interview8.html.8f88b421.js"><link rel="prefetch" href="/notes/assets/interview9.html.661af964.js"><link rel="prefetch" href="/notes/assets/linkImport.html.3ad74614.js"><link rel="prefetch" href="/notes/assets/offlineStorage.html.b7194813.js"><link rel="prefetch" href="/notes/assets/regular.html.b564d981.js"><link rel="prefetch" href="/notes/assets/shake.html.34c879f6.js"><link rel="prefetch" href="/notes/assets/webWorker.html.67aabe71.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.e13f29fe.js"><link rel="prefetch" href="/notes/assets/cors.html.ec497b42.js"><link rel="prefetch" href="/notes/assets/crossDomainCookie.html.e2651e8e.js"><link rel="prefetch" href="/notes/assets/fetch.html.df3586ee.js"><link rel="prefetch" href="/notes/assets/nestAxios.html.34d301c5.js"><link rel="prefetch" href="/notes/assets/debounce.html.246f1249.js"><link rel="prefetch" href="/notes/assets/lodashPrinciple.html.a1224740.js"><link rel="prefetch" href="/notes/assets/lodashThrottleDebounce.html.cf17f742.js"><link rel="prefetch" href="/notes/assets/throttle.html.b65a9a84.js"><link rel="prefetch" href="/notes/assets/throttleDebounceReact.html.b4708828.js"><link rel="prefetch" href="/notes/assets/cloneIntroduction.html.279c2e37.js"><link rel="prefetch" href="/notes/assets/deepClone.html.40e86fdc.js"><link rel="prefetch" href="/notes/assets/lodashDeepClone.html.6de4b699.js"><link rel="prefetch" href="/notes/assets/objectAssign.html.edde2fe8.js"><link rel="prefetch" href="/notes/assets/arraySourceCode.html.550282f0.js"><link rel="prefetch" href="/notes/assets/baseHigh.html.5baf3feb.js"><link rel="prefetch" href="/notes/assets/currying.html.a50e541b.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.556732a6.js"><link rel="prefetch" href="/notes/assets/eventLoop.html.6c87e5bf.js"><link rel="prefetch" href="/notes/assets/iife.html.cbc4ac9e.js"><link rel="prefetch" href="/notes/assets/interview1.html.adb99297.js"><link rel="prefetch" href="/notes/assets/jsCompatible.html.0485a376.js"><link rel="prefetch" href="/notes/assets/baseProyotype.html.fa37ab8f.js"><link rel="prefetch" href="/notes/assets/functionObjectResource.html.9f7987a9.js"><link rel="prefetch" href="/notes/assets/prototypeInherit.html.e9b74bbb.js"><link rel="prefetch" href="/notes/assets/closureInterview.html.fe63ce7a.js"><link rel="prefetch" href="/notes/assets/scopeChain.html.02cc51bb.js"><link rel="prefetch" href="/notes/assets/understandingClosures.html.dd45842c.js"><link rel="prefetch" href="/notes/assets/executionStack.html.a5ec7982.js"><link rel="prefetch" href="/notes/assets/memoryLeak.html.f89480f2.js"><link rel="prefetch" href="/notes/assets/memoryMechanism.html.68458b9b.js"><link rel="prefetch" href="/notes/assets/memorySpace.html.f646fb9c.js"><link rel="prefetch" href="/notes/assets/precompiled.html.b9bd0775.js"><link rel="prefetch" href="/notes/assets/variableObject.html.24584172.js"><link rel="prefetch" href="/notes/assets/arrowFunctionThis.html.0d4f2a11.js"><link rel="prefetch" href="/notes/assets/bindSimulation.html.b10f47ed.js"><link rel="prefetch" href="/notes/assets/callApply.html.bb89fb6d.js"><link rel="prefetch" href="/notes/assets/newSimulation.html.e9a46a2d.js"><link rel="prefetch" href="/notes/assets/thisBind.html.9b29966c.js"><link rel="prefetch" href="/notes/assets/interview1.html.60905fd0.js"><link rel="prefetch" href="/notes/assets/interview10.html.c3710a54.js"><link rel="prefetch" href="/notes/assets/interview11.html.72a1479f.js"><link rel="prefetch" href="/notes/assets/interview12.html.b52c7cd4.js"><link rel="prefetch" href="/notes/assets/interview13.html.31129e17.js"><link rel="prefetch" href="/notes/assets/interview14.html.065c83de.js"><link rel="prefetch" href="/notes/assets/interview15.html.7cd64175.js"><link rel="prefetch" href="/notes/assets/interview16.html.e0705a9e.js"><link rel="prefetch" href="/notes/assets/interview17.html.7ac28e03.js"><link rel="prefetch" href="/notes/assets/interview18.html.4b581106.js"><link rel="prefetch" href="/notes/assets/interview19.html.b1e228df.js"><link rel="prefetch" href="/notes/assets/interview2.html.1a08035a.js"><link rel="prefetch" href="/notes/assets/interview20.html.d60b849e.js"><link rel="prefetch" href="/notes/assets/interview21.html.916434ab.js"><link rel="prefetch" href="/notes/assets/interview22.html.43654bce.js"><link rel="prefetch" href="/notes/assets/interview23.html.4ab3b65f.js"><link rel="prefetch" href="/notes/assets/interview24.html.f5c28f46.js"><link rel="prefetch" href="/notes/assets/interview25.html.1f6b3711.js"><link rel="prefetch" href="/notes/assets/interview26.html.5dd408ce.js"><link rel="prefetch" href="/notes/assets/interview27.html.613b78e8.js"><link rel="prefetch" href="/notes/assets/interview28.html.9d583e49.js"><link rel="prefetch" href="/notes/assets/interview29.html.e3e91794.js"><link rel="prefetch" href="/notes/assets/interview3.html.d91e6cbc.js"><link rel="prefetch" href="/notes/assets/interview30.html.fd59a335.js"><link rel="prefetch" href="/notes/assets/interview4.html.f7c40889.js"><link rel="prefetch" href="/notes/assets/interview5.html.8d50dce4.js"><link rel="prefetch" href="/notes/assets/interview6.html.713e0433.js"><link rel="prefetch" href="/notes/assets/interview7.html.5fabb993.js"><link rel="prefetch" href="/notes/assets/interview8.html.319a0a05.js"><link rel="prefetch" href="/notes/assets/interview9.html.02e24993.js"><link rel="prefetch" href="/notes/assets/adjacentSiblingCombinator.html.5096394b.js"><link rel="prefetch" href="/notes/assets/attributeSelectors.html.812746a2.js"><link rel="prefetch" href="/notes/assets/charset.html.df6a0eed.js"><link rel="prefetch" href="/notes/assets/childCombinator.html.99556bf0.js"><link rel="prefetch" href="/notes/assets/classSelectors.html.2a670a32.js"><link rel="prefetch" href="/notes/assets/descendantCombinator.html.4d112c8d.js"><link rel="prefetch" href="/notes/assets/generalSiblingCombinator.html.e88b3fee.js"><link rel="prefetch" href="/notes/assets/iDSelectors.html.3659c9ca.js"><link rel="prefetch" href="/notes/assets/pseudoClasses.html.44095e63.js"><link rel="prefetch" href="/notes/assets/pseudoElements.html.06764528.js"><link rel="prefetch" href="/notes/assets/selectorList.html.9de86fc9.js"><link rel="prefetch" href="/notes/assets/typeSelectors.html.28e08301.js"><link rel="prefetch" href="/notes/assets/universalSelectors.html.1613dad4.js"><link rel="prefetch" href="/notes/assets/IterationProtocols.html.fdbf21f1.js"><link rel="prefetch" href="/notes/assets/arrayFlat.html.8964f69e.js"><link rel="prefetch" href="/notes/assets/asyncHistory.html.319b8c8e.js"><link rel="prefetch" href="/notes/assets/eventLoop.html.57f3c860.js"><link rel="prefetch" href="/notes/assets/fileReader.html.8ebcd641.js"><link rel="prefetch" href="/notes/assets/formData.html.673df4bf.js"><link rel="prefetch" href="/notes/assets/functionGenerator.html.5108df41.js"><link rel="prefetch" href="/notes/assets/generator.html.4457b02b.js"><link rel="prefetch" href="/notes/assets/intersectionObserver.html.316627dd.js"><link rel="prefetch" href="/notes/assets/map.html.377533ac.js"><link rel="prefetch" href="/notes/assets/promise.html.c87a1c96.js"><link rel="prefetch" href="/notes/assets/set.html.3087e56d.js"><link rel="prefetch" href="/notes/assets/string.html.389091af.js"><link rel="prefetch" href="/notes/assets/symbol.html.d8beaf5c.js"><link rel="prefetch" href="/notes/assets/xMLHttpRequest.html.81e366c7.js"><link rel="prefetch" href="/notes/assets/spreadSyntax.html.b08766c2.js"><link rel="prefetch" href="/notes/assets/strictMode.html.042eb95e.js"><link rel="prefetch" href="/notes/assets/cache.html.9563af31.js"><link rel="prefetch" href="/notes/assets/drag1.html.39006ee1.js"><link rel="prefetch" href="/notes/assets/oneLineCode.html.8b3de338.js"><link rel="prefetch" href="/notes/assets/oneLineCodeArray.html.63d3aa5c.js"><link rel="prefetch" href="/notes/assets/oneLineCodeDOM.html.0e67c5a4.js"><link rel="prefetch" href="/notes/assets/oneLineCodeDateTime.html.cb3221f3.js"><link rel="prefetch" href="/notes/assets/oneLineCodeFunction.html.2ed6695d.js"><link rel="prefetch" href="/notes/assets/oneLineCodeMath.html.53d81b83.js"><link rel="prefetch" href="/notes/assets/oneLineCodeMisc.html.d40e1885.js"><link rel="prefetch" href="/notes/assets/oneLineCodeNumber.html.a4616ae4.js"><link rel="prefetch" href="/notes/assets/oneLineCodeObject.html.e5769f7b.js"><link rel="prefetch" href="/notes/assets/oneLineCodeRandom.html.7290419e.js"><link rel="prefetch" href="/notes/assets/oneLineCodeString.html.f7f0a5a0.js"><link rel="prefetch" href="/notes/assets/oneLineCodeValidator.html.222bcd1b.js"><link rel="prefetch" href="/notes/assets/typeScriptCache.html.e7b19746.js"><link rel="prefetch" href="/notes/assets/reactBase.html.da9d3bf4.js"><link rel="prefetch" href="/notes/assets/reactTypescript.html.bdd4fc1d.js"><link rel="prefetch" href="/notes/assets/vue2Base.html.125b96a2.js"><link rel="prefetch" href="/notes/assets/vue2Table.html.ecf755fb.js"><link rel="prefetch" href="/notes/assets/vue2offsetTop.html.398a0620.js"><link rel="prefetch" href="/notes/assets/componentWillXXX.html.dfd83436.js"><link rel="prefetch" href="/notes/assets/disrupt.html.edb0a123.js"><link rel="prefetch" href="/notes/assets/lane.html.7c9f1076.js"><link rel="prefetch" href="/notes/assets/prepare.html.a6149102.js"><link rel="prefetch" href="/notes/assets/redux.html.c414d064.js"><link rel="prefetch" href="/notes/assets/scheduler.html.ab84b9f7.js"><link rel="prefetch" href="/notes/assets/multi.html.68bbb70d.js"><link rel="prefetch" href="/notes/assets/one.html.1d4214e3.js"><link rel="prefetch" href="/notes/assets/prepare.html.6a50b601.js"><link rel="prefetch" href="/notes/assets/create.html.95bc14c0.js"><link rel="prefetch" href="/notes/assets/prepare.html.64d54e96.js"><link rel="prefetch" href="/notes/assets/structure.html.f10da85a.js"><link rel="prefetch" href="/notes/assets/useeffect.html.d41c0552.js"><link rel="prefetch" href="/notes/assets/usememo.html.e6724780.js"><link rel="prefetch" href="/notes/assets/useref.html.7de6ef18.js"><link rel="prefetch" href="/notes/assets/usestate.html.bff28972.js"><link rel="prefetch" href="/notes/assets/file.html.452cd6b4.js"><link rel="prefetch" href="/notes/assets/idea.html.23d82840.js"><link rel="prefetch" href="/notes/assets/jsx.html.7ea04643.js"><link rel="prefetch" href="/notes/assets/newConstructure.html.ec2955b8.js"><link rel="prefetch" href="/notes/assets/oldConstructure.html.01c900e4.js"><link rel="prefetch" href="/notes/assets/source.html.6d4002ce.js"><link rel="prefetch" href="/notes/assets/summary.html.70509c01.js"><link rel="prefetch" href="/notes/assets/basePrinciple.html.3ac69798.js"><link rel="prefetch" href="/notes/assets/componentApi.html.68272ea6.js"><link rel="prefetch" href="/notes/assets/domApi.html.ea575506.js"><link rel="prefetch" href="/notes/assets/hoc.html.218fa21d.js"><link rel="prefetch" href="/notes/assets/hookApi.html.e8deb339.js"><link rel="prefetch" href="/notes/assets/hookCustom.html.03859cf3.js"><link rel="prefetch" href="/notes/assets/hookPrinciple.html.69d4a4f4.js"><link rel="prefetch" href="/notes/assets/hookUse.html.4a37cf6a.js"><link rel="prefetch" href="/notes/assets/reactKeeplive.html.43b24141.js"><link rel="prefetch" href="/notes/assets/reactRedux.html.862bc529.js"><link rel="prefetch" href="/notes/assets/reactRouter.html.249d9c56.js"><link rel="prefetch" href="/notes/assets/toolApi.html.930ef809.js"><link rel="prefetch" href="/notes/assets/beginWork.html.72f45750.js"><link rel="prefetch" href="/notes/assets/completeWork.html.4586a4fb.js"><link rel="prefetch" href="/notes/assets/doubleBuffer.html.a11c81e0.js"><link rel="prefetch" href="/notes/assets/fiber-mental.html.cafca097.js"><link rel="prefetch" href="/notes/assets/fiber.html.20635461.js"><link rel="prefetch" href="/notes/assets/reconciler.html.75f26a38.js"><link rel="prefetch" href="/notes/assets/beforeMutation.html.18c3d418.js"><link rel="prefetch" href="/notes/assets/layout.html.82f6a8bd.js"><link rel="prefetch" href="/notes/assets/mutation.html.4c44b4e0.js"><link rel="prefetch" href="/notes/assets/prepare.html.6c2c7865.js"><link rel="prefetch" href="/notes/assets/mental.html.d5611145.js"><link rel="prefetch" href="/notes/assets/prepare.html.e04c1cef.js"><link rel="prefetch" href="/notes/assets/priority.html.dc54c5f2.js"><link rel="prefetch" href="/notes/assets/reactdom.html.f9746c8b.js"><link rel="prefetch" href="/notes/assets/setstate.html.76380815.js"><link rel="prefetch" href="/notes/assets/update.html.75d61392.js"><link rel="prefetch" href="/notes/assets/bitfiled.html.4497a4ee.js"><link rel="prefetch" href="/notes/assets/dfs.html.f4981d5e.js"><link rel="prefetch" href="/notes/assets/diff.html.b5dc691e.js"><link rel="prefetch" href="/notes/assets/heapsort.html.c98a34da.js"><link rel="prefetch" href="/notes/assets/linkedlist.html.6b38e462.js"><link rel="prefetch" href="/notes/assets/stack.html.f38e01d1.js"><link rel="prefetch" href="/notes/assets/bootstrap.html.b68a1fba.js"><link rel="prefetch" href="/notes/assets/context.html.47334994.js"><link rel="prefetch" href="/notes/assets/fibertree-commit.html.2c50b45f.js"><link rel="prefetch" href="/notes/assets/fibertree-prepare.html.7e65d454.js"><link rel="prefetch" href="/notes/assets/fibertree-update.html.0743e8f1.js"><link rel="prefetch" href="/notes/assets/hook-effect.html.65ac138b.js"><link rel="prefetch" href="/notes/assets/hook-state.html.5a1d0b94.js"><link rel="prefetch" href="/notes/assets/hook-summary.html.80ca5f24.js"><link rel="prefetch" href="/notes/assets/macro-structure.html.42a05b10.js"><link rel="prefetch" href="/notes/assets/object-structure.html.0e9cc867.js"><link rel="prefetch" href="/notes/assets/priority.html.9dcaa721.js"><link rel="prefetch" href="/notes/assets/reconciler-workflow.html.2f14fc74.js"><link rel="prefetch" href="/notes/assets/scheduler.html.8de0ba69.js"><link rel="prefetch" href="/notes/assets/state-effects.html.f98ea9dd.js"><link rel="prefetch" href="/notes/assets/synthetic-event.html.83a97757.js"><link rel="prefetch" href="/notes/assets/workloop.html.6b1b49b2.js"><link rel="prefetch" href="/notes/assets/ast.html.4e3d26f1.js"><link rel="prefetch" href="/notes/assets/binder.html.10191d6e.js"><link rel="prefetch" href="/notes/assets/checker.html.d97fb222.js"><link rel="prefetch" href="/notes/assets/emitter.html.afaf9c6d.js"><link rel="prefetch" href="/notes/assets/overview.html.66f5058a.js"><link rel="prefetch" href="/notes/assets/parser.html.66cd1f14.js"><link rel="prefetch" href="/notes/assets/program.html.6a13a6b5.js"><link rel="prefetch" href="/notes/assets/scanner.html.26547aa8.js"><link rel="prefetch" href="/notes/assets/common.html.0a779e9c.js"><link rel="prefetch" href="/notes/assets/interpreting.html.33bcd6ff.js"><link rel="prefetch" href="/notes/assets/class.html.ee2a16b9.js"><link rel="prefetch" href="/notes/assets/commandline-behavior.html.33efaddf.js"><link rel="prefetch" href="/notes/assets/comments.html.3c6ae00f.js"><link rel="prefetch" href="/notes/assets/common-bug-not-bugs.html.23cbd94f.js"><link rel="prefetch" href="/notes/assets/common-feature-request.html.f7f3c2f2.js"><link rel="prefetch" href="/notes/assets/decorators.html.ffdbfbdc.js"><link rel="prefetch" href="/notes/assets/enums.html.8ffc0bd2.js"><link rel="prefetch" href="/notes/assets/function.html.8390b605.js"><link rel="prefetch" href="/notes/assets/generics.html.2e81ad12.js"><link rel="prefetch" href="/notes/assets/glossary-and-terms.html.8bf2a811.js"><link rel="prefetch" href="/notes/assets/jsx-and-react.html.5c92d149.js"><link rel="prefetch" href="/notes/assets/modules.html.fba886a8.js"><link rel="prefetch" href="/notes/assets/thing-that-dont-work.html.b2be08f7.js"><link rel="prefetch" href="/notes/assets/tsconfig-behavior.html.0465ebff.js"><link rel="prefetch" href="/notes/assets/type-guards.html.33119345.js"><link rel="prefetch" href="/notes/assets/type-system-behavior.html.652cd8cc.js"><link rel="prefetch" href="/notes/assets/nonReactJSX.html.696b295e.js"><link rel="prefetch" href="/notes/assets/reactJSX.html.910a510e.js"><link rel="prefetch" href="/notes/assets/support.html.356c6692.js"><link rel="prefetch" href="/notes/assets/typescript-3.7.html.89c9611c.js"><link rel="prefetch" href="/notes/assets/typescript-3.8.html.910b71ac.js"><link rel="prefetch" href="/notes/assets/typescript-3.9.html.4b57f15d.js"><link rel="prefetch" href="/notes/assets/compilationContext.html.fa6f0430.js"><link rel="prefetch" href="/notes/assets/declarationspaces.html.822aa053.js"><link rel="prefetch" href="/notes/assets/dynamicImportExpressions.html.f98b7968.js"><link rel="prefetch" href="/notes/assets/inDepthTs.html.fa9bfe2b.js"><link rel="prefetch" href="/notes/assets/modules.html.c15f7d6a.js"><link rel="prefetch" href="/notes/assets/namespaces.html.93f801cd.js"><link rel="prefetch" href="/notes/assets/unknownAny.html.976849b1.js"><link rel="prefetch" href="/notes/assets/avoidExportDefault.html.ac6d87c9.js"><link rel="prefetch" href="/notes/assets/barrel.html.6794741a.js"><link rel="prefetch" href="/notes/assets/bind.html.f54a6e02.js"><link rel="prefetch" href="/notes/assets/buildToggles.html.13aaaf55.js"><link rel="prefetch" href="/notes/assets/classAreUseful.html.7c972e3f.js"><link rel="prefetch" href="/notes/assets/covarianceAndContravariance.html.5fefb500.js"><link rel="prefetch" href="/notes/assets/createArrays.html.6c7ea302.js"><link rel="prefetch" href="/notes/assets/curry.html.1361bd2a.js"><link rel="prefetch" href="/notes/assets/functionParameters.html.31251d8f.js"><link rel="prefetch" href="/notes/assets/infer.html.c23e7680.js"><link rel="prefetch" href="/notes/assets/lazyObjectLiteralInitialization.html.3edf1c57.js"><link rel="prefetch" href="/notes/assets/limitPropertySetters.html.d57bcdef.js"><link rel="prefetch" href="/notes/assets/metadata.html.a34b2ffd.js"><link rel="prefetch" href="/notes/assets/nominalTyping.html.f74a704c.js"><link rel="prefetch" href="/notes/assets/outFileCaution.html.038c22ae.js"><link rel="prefetch" href="/notes/assets/singletonPatern.html.f5d23140.js"><link rel="prefetch" href="/notes/assets/statefulFunctions.html.d77e2c58.js"><link rel="prefetch" href="/notes/assets/staticConstructors.html.582de6d2.js"><link rel="prefetch" href="/notes/assets/stringBasedEmuns.html.2ad937f3.js"><link rel="prefetch" href="/notes/assets/truthy.html.799693b4.js"><link rel="prefetch" href="/notes/assets/typeInstantiation.html.53b5a743.js"><link rel="prefetch" href="/notes/assets/typesafeEventEmitter.html.02b7fcad.js"><link rel="prefetch" href="/notes/assets/ambient.html.033b359d.js"><link rel="prefetch" href="/notes/assets/callable.html.00bc7bc4.js"><link rel="prefetch" href="/notes/assets/discrominatedUnion.html.839cc7ec.js"><link rel="prefetch" href="/notes/assets/enums.html.8430345c.js"><link rel="prefetch" href="/notes/assets/exceptionsHanding.html.2cb5ec21.js"><link rel="prefetch" href="/notes/assets/freshness.html.35bc8ec4.js"><link rel="prefetch" href="/notes/assets/functions.html.b220682d.js"><link rel="prefetch" href="/notes/assets/generices.html.0533796e.js"><link rel="prefetch" href="/notes/assets/indexSignatures.html.844fee69.js"><link rel="prefetch" href="/notes/assets/interfaces.html.4a90ac39.js"><link rel="prefetch" href="/notes/assets/lib.html.566eeeaa.js"><link rel="prefetch" href="/notes/assets/literals.html.0144ad55.js"><link rel="prefetch" href="/notes/assets/migrating.html.dd93c00e.js"><link rel="prefetch" href="/notes/assets/mixins.html.17f144ed.js"><link rel="prefetch" href="/notes/assets/movingTypes.html.4e2561e1.js"><link rel="prefetch" href="/notes/assets/neverType.html.b7432023.js"><link rel="prefetch" href="/notes/assets/overview.html.6028da03.js"><link rel="prefetch" href="/notes/assets/readonly.html.4d2e164c.js"><link rel="prefetch" href="/notes/assets/thisType.html.861f262b.js"><link rel="prefetch" href="/notes/assets/typeAssertion.html.bd054af5.js"><link rel="prefetch" href="/notes/assets/typeCompatibility.html.ec0e4fe0.js"><link rel="prefetch" href="/notes/assets/typeGuard.html.0b235f49.js"><link rel="prefetch" href="/notes/assets/typeInference.html.695b9714.js"><link rel="prefetch" href="/notes/assets/types.html.9c3c304d.js"><link rel="prefetch" href="/notes/assets/pluginDva.html.58086bbe.js"><link rel="prefetch" href="/notes/assets/pluginQiankun.html.b619d471.js"><link rel="prefetch" href="/notes/assets/codegen.html.8a25084a.js"><link rel="prefetch" href="/notes/assets/entrance.html.d6a6c262.js"><link rel="prefetch" href="/notes/assets/optimize.html.ecfbaafd.js"><link rel="prefetch" href="/notes/assets/outline.html.8bd18a41.js"><link rel="prefetch" href="/notes/assets/parse.html.207ccc62.js"><link rel="prefetch" href="/notes/assets/async-component.html.4e6fd3d0.js"><link rel="prefetch" href="/notes/assets/component-register.html.567b3d22.js"><link rel="prefetch" href="/notes/assets/create-component.html.d2ad96a5.js"><link rel="prefetch" href="/notes/assets/lifecycle.html.a7341a2d.js"><link rel="prefetch" href="/notes/assets/merge-option.html.33e38550.js"><link rel="prefetch" href="/notes/assets/outline.html.3bd8050f.js"><link rel="prefetch" href="/notes/assets/patch.html.a23c1430.js"><link rel="prefetch" href="/notes/assets/_index.html.5e0c2ad2.js"><link rel="prefetch" href="/notes/assets/create-element.html.b2749a32.js"><link rel="prefetch" href="/notes/assets/mounted.html.88367ff4.js"><link rel="prefetch" href="/notes/assets/new-vue.html.e80f61b5.js"><link rel="prefetch" href="/notes/assets/render.html.ede2cd1a.js"><link rel="prefetch" href="/notes/assets/update.html.629be0db.js"><link rel="prefetch" href="/notes/assets/virtual-dom.html.f89e76a9.js"><link rel="prefetch" href="/notes/assets/event.html.f781d591.js"><link rel="prefetch" href="/notes/assets/keep-alive.html.3654aec6.js"><link rel="prefetch" href="/notes/assets/outline.html.b464ad9c.js"><link rel="prefetch" href="/notes/assets/slot.html.98186991.js"><link rel="prefetch" href="/notes/assets/tansition-group.html.49dda1e9.js"><link rel="prefetch" href="/notes/assets/tansition.html.cd19b645.js"><link rel="prefetch" href="/notes/assets/v-model.html.78547e74.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.ff5c2dc8.js"><link rel="prefetch" href="/notes/assets/baseInterviewSecond.html.9a83fd95.js"><link rel="prefetch" href="/notes/assets/componentCommunication.html.3e63ecf8.js"><link rel="prefetch" href="/notes/assets/detailedResponsiveness.html.3baff8fa.js"><link rel="prefetch" href="/notes/assets/diff.html.4a6b9b04.js"><link rel="prefetch" href="/notes/assets/eventBinding.html.98834559.js"><link rel="prefetch" href="/notes/assets/eventMechanism.html.273c84e6.js"><link rel="prefetch" href="/notes/assets/key.html.d1e7b2c7.js"><link rel="prefetch" href="/notes/assets/knowledgeSystem.html.ac648a3f.js"><link rel="prefetch" href="/notes/assets/slot.html.3739495c.js"><link rel="prefetch" href="/notes/assets/sourceCodeAsyncDomUpdateNextTick.html.408a7dfd.js"><link rel="prefetch" href="/notes/assets/sourceCodeElementBroadcastDispatch.html.0dbe791e.js"><link rel="prefetch" href="/notes/assets/sourceCodeKeepAlive.html.c5329a90.js"><link rel="prefetch" href="/notes/assets/sourceCodeResponsiveness.html.d92486b7.js"><link rel="prefetch" href="/notes/assets/sourceCodeTemplateCompilation.html.5eb389f6.js"><link rel="prefetch" href="/notes/assets/sourceCodeTemplateDom.html.2e821c78.js"><link rel="prefetch" href="/notes/assets/sourceCodeVuex.html.ec58ed75.js"><link rel="prefetch" href="/notes/assets/templateCompilation.html.2de196a3.js"><link rel="prefetch" href="/notes/assets/vNode.html.f3a66151.js"><link rel="prefetch" href="/notes/assets/vNodeDiff.html.eff1b477.js"><link rel="prefetch" href="/notes/assets/build.html.f7ff4d7c.js"><link rel="prefetch" href="/notes/assets/directory.html.7c9650ca.js"><link rel="prefetch" href="/notes/assets/entrance.html.8db62399.js"><link rel="prefetch" href="/notes/assets/flow.html.86c95575.js"><link rel="prefetch" href="/notes/assets/component-update.html.4ed4b9b0.js"><link rel="prefetch" href="/notes/assets/computed-watcher.html.10ec4873.js"><link rel="prefetch" href="/notes/assets/getters.html.961157cb.js"><link rel="prefetch" href="/notes/assets/next-tick.html.45966cac.js"><link rel="prefetch" href="/notes/assets/outline.html.c1c53cb5.js"><link rel="prefetch" href="/notes/assets/props.html.ee05e609.js"><link rel="prefetch" href="/notes/assets/questions.html.e2183e14.js"><link rel="prefetch" href="/notes/assets/reactive-object.html.97ee8915.js"><link rel="prefetch" href="/notes/assets/setters.html.21d89da6.js"><link rel="prefetch" href="/notes/assets/summary.html.dd1d8bc9.js"><link rel="prefetch" href="/notes/assets/install.html.0230a0da.js"><link rel="prefetch" href="/notes/assets/matcher.html.25ca848d.js"><link rel="prefetch" href="/notes/assets/outline.html.ea733f14.js"><link rel="prefetch" href="/notes/assets/router.html.f8ecf748.js"><link rel="prefetch" href="/notes/assets/transition-to.html.d7c1785b.js"><link rel="prefetch" href="/notes/assets/api.html.0c764efb.js"><link rel="prefetch" href="/notes/assets/idex.html.00a33403.js"><link rel="prefetch" href="/notes/assets/init.html.2bb7927a.js"><link rel="prefetch" href="/notes/assets/plugin.html.89e6dcbd.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.81b34fee.js"><link rel="prefetch" href="/notes/assets/configuration.html.11907dd4.js"><link rel="prefetch" href="/notes/assets/entryPoints.html.b3492578.js"><link rel="prefetch" href="/notes/assets/loader.html.2d3c2488.js"><link rel="prefetch" href="/notes/assets/output.html.33466c9c.js"><link rel="prefetch" href="/notes/assets/plugin.html.7b1fc668.js"><link rel="prefetch" href="/notes/assets/webpackInterview.html.ae24d5df.js"><link rel="prefetch" href="/notes/assets/reactApi.html.e27c9c81.js"><link rel="prefetch" href="/notes/assets/reactChildren.html.f03f41a5.js"><link rel="prefetch" href="/notes/assets/reactElement.html.507c3fac.js"><link rel="prefetch" href="/notes/assets/reactFiber.html.e4b8886f.js"><link rel="prefetch" href="/notes/assets/commitAllHostEffects.html.c54c88a4.js"><link rel="prefetch" href="/notes/assets/commitAllLifeCycles.html.a9f9e3e3.js"><link rel="prefetch" href="/notes/assets/commitBeforeMutationLifecycles.html.9e252799.js"><link rel="prefetch" href="/notes/assets/commitDeletion.html.1aadc4a7.js"><link rel="prefetch" href="/notes/assets/commitPlacement.html.b0c82218.js"><link rel="prefetch" href="/notes/assets/commitRoot.html.fc87e11a.js"><link rel="prefetch" href="/notes/assets/commitWork.html.98be50bf.js"><link rel="prefetch" href="/notes/assets/invokeGuardedCallback.html.95a15db2.js"><link rel="prefetch" href="/notes/assets/expirationTime.html.7c625a26.js"><link rel="prefetch" href="/notes/assets/reactDomRender.html.c49d921a.js"><link rel="prefetch" href="/notes/assets/setStateForceUpdate.html.a495477a.js"><link rel="prefetch" href="/notes/assets/context.html.3041834a.js"><link rel="prefetch" href="/notes/assets/evenInit.html.b949b8f6.js"><link rel="prefetch" href="/notes/assets/eventBind.html.9d39cf36.js"><link rel="prefetch" href="/notes/assets/eventCreateEventObject.html.22578639.js"><link rel="prefetch" href="/notes/assets/eventDispath.html.a2ed0b3b.js"><link rel="prefetch" href="/notes/assets/hydrate.html.ccddb779.js"><link rel="prefetch" href="/notes/assets/ref.html.c54fc786.js"><link rel="prefetch" href="/notes/assets/suspense.html.61f7fd70.js"><link rel="prefetch" href="/notes/assets/suspenseLazy.html.9b65aba3.js"><link rel="prefetch" href="/notes/assets/suspenseWork.html.9fff5d2a.js"><link rel="prefetch" href="/notes/assets/hooksCommon.html.39fc3c3d.js"><link rel="prefetch" href="/notes/assets/hooksOther.html.af4fc03b.js"><link rel="prefetch" href="/notes/assets/start.html.9b89c182.js"><link rel="prefetch" href="/notes/assets/useEffect.html.95d1a1bf.js"><link rel="prefetch" href="/notes/assets/useState.html.e0ce9b91.js"><link rel="prefetch" href="/notes/assets/base.html.d6050cd8.js"><link rel="prefetch" href="/notes/assets/commpontDiff.html.f9c99166.js"><link rel="prefetch" href="/notes/assets/componentUpdate.html.a5bf7a34.js"><link rel="prefetch" href="/notes/assets/renderProcess.html.b36be742.js"><link rel="prefetch" href="/notes/assets/schedulingPrinciple.html.796f1238.js"><link rel="prefetch" href="/notes/assets/beginWork.html.a0a0ab63.js"><link rel="prefetch" href="/notes/assets/globalVariable.html.c883bfed.js"><link rel="prefetch" href="/notes/assets/mountIndeterminateComponent.html.fac0d48f.js"><link rel="prefetch" href="/notes/assets/mountLazyCompont.html.62cd6c46.js"><link rel="prefetch" href="/notes/assets/performUnitOfWork.html.070bbadc.js"><link rel="prefetch" href="/notes/assets/performWork.html.733f7291.js"><link rel="prefetch" href="/notes/assets/reactScheduler.html.1f778c02.js"><link rel="prefetch" href="/notes/assets/reconcileChildren.html.2b860d71.js"><link rel="prefetch" href="/notes/assets/reconcileChildrenArray.html.381b105d.js"><link rel="prefetch" href="/notes/assets/reconcileSingleElement.html.44fad5a0.js"><link rel="prefetch" href="/notes/assets/renderRoot.html.fb25ae42.js"><link rel="prefetch" href="/notes/assets/scheduleWork.html.7a558025.js"><link rel="prefetch" href="/notes/assets/throwException.html.f22c6a0f.js"><link rel="prefetch" href="/notes/assets/updateClassComponent.html.725e93cc.js"><link rel="prefetch" href="/notes/assets/updateContextConsumer.html.d2656620.js"><link rel="prefetch" href="/notes/assets/updateContextProvider.html.d9d47bfb.js"><link rel="prefetch" href="/notes/assets/updateForwardRef.html.3c86c539.js"><link rel="prefetch" href="/notes/assets/updateFragment.html.96f0a888.js"><link rel="prefetch" href="/notes/assets/updateFunctionalComponent.html.63af40cc.js"><link rel="prefetch" href="/notes/assets/updateHostComponent.html.8e3ff9b5.js"><link rel="prefetch" href="/notes/assets/updateHostRoot.html.d24ba535.js"><link rel="prefetch" href="/notes/assets/updateHostText.html.f84848da.js"><link rel="prefetch" href="/notes/assets/updateMode.html.cb525529.js"><link rel="prefetch" href="/notes/assets/updatePortalComponent.html.a767215b.js"><link rel="prefetch" href="/notes/assets/updateProfiler.html.e314f177.js"><link rel="prefetch" href="/notes/assets/updateSuspenseComponent.html.589fa689.js"><link rel="prefetch" href="/notes/assets/interview1.html.41bc9376.js"><link rel="prefetch" href="/notes/assets/interview2.html.47645b5c.js"><link rel="prefetch" href="/notes/assets/interview3.html.fbd751ea.js"><link rel="prefetch" href="/notes/assets/interview51.html.deda2164.js"><link rel="prefetch" href="/notes/assets/interview52.html.b1b59a06.js"><link rel="prefetch" href="/notes/assets/interview53.html.0e2f12c3.js"><link rel="prefetch" href="/notes/assets/interview54.html.81fd2641.js"><link rel="prefetch" href="/notes/assets/interview55.html.dd644a77.js"><link rel="prefetch" href="/notes/assets/interview56.html.8622c49c.js"><link rel="prefetch" href="/notes/assets/interview57.html.ae17d31c.js"><link rel="prefetch" href="/notes/assets/interview1.html.a10d9f41.js"><link rel="prefetch" href="/notes/assets/interview10.html.a5473eb4.js"><link rel="prefetch" href="/notes/assets/interview11.html.4ec338d4.js"><link rel="prefetch" href="/notes/assets/interview12.html.7e541841.js"><link rel="prefetch" href="/notes/assets/interview13.html.5f4314d9.js"><link rel="prefetch" href="/notes/assets/interview14.html.b8b47a9d.js"><link rel="prefetch" href="/notes/assets/interview15.html.b05f6140.js"><link rel="prefetch" href="/notes/assets/interview16.html.4f9641bb.js"><link rel="prefetch" href="/notes/assets/interview17.html.f1139a52.js"><link rel="prefetch" href="/notes/assets/interview18.html.52eafe00.js"><link rel="prefetch" href="/notes/assets/interview19.html.2da89b87.js"><link rel="prefetch" href="/notes/assets/interview2.html.b3fc7674.js"><link rel="prefetch" href="/notes/assets/interview20.html.434e7ebc.js"><link rel="prefetch" href="/notes/assets/interview21.html.be155c93.js"><link rel="prefetch" href="/notes/assets/interview22.html.3fcfe936.js"><link rel="prefetch" href="/notes/assets/interview23.html.58585208.js"><link rel="prefetch" href="/notes/assets/interview24.html.da156180.js"><link rel="prefetch" href="/notes/assets/interview25.html.a72f5e5f.js"><link rel="prefetch" href="/notes/assets/interview26.html.1176ff2d.js"><link rel="prefetch" href="/notes/assets/interview27.html.04571a63.js"><link rel="prefetch" href="/notes/assets/interview28.html.aed56fc9.js"><link rel="prefetch" href="/notes/assets/interview29.html.fdea7c1a.js"><link rel="prefetch" href="/notes/assets/interview3.html.4f17acbd.js"><link rel="prefetch" href="/notes/assets/interview30.html.c201b7b5.js"><link rel="prefetch" href="/notes/assets/interview31.html.070110ac.js"><link rel="prefetch" href="/notes/assets/interview32.html.e7ca88ff.js"><link rel="prefetch" href="/notes/assets/interview33.html.b9a5cd87.js"><link rel="prefetch" href="/notes/assets/interview34.html.5bb792e0.js"><link rel="prefetch" href="/notes/assets/interview35.html.d058e78e.js"><link rel="prefetch" href="/notes/assets/interview36.html.63cc043e.js"><link rel="prefetch" href="/notes/assets/interview37.html.06886248.js"><link rel="prefetch" href="/notes/assets/interview38.html.92e03ed4.js"><link rel="prefetch" href="/notes/assets/interview39.html.04b1e4bf.js"><link rel="prefetch" href="/notes/assets/interview4.html.47fcc3f2.js"><link rel="prefetch" href="/notes/assets/interview40.html.588d78ee.js"><link rel="prefetch" href="/notes/assets/interview41.html.af8003ff.js"><link rel="prefetch" href="/notes/assets/interview42.html.f46006e0.js"><link rel="prefetch" href="/notes/assets/interview43.html.2ade31c7.js"><link rel="prefetch" href="/notes/assets/interview44.html.63ef8a1f.js"><link rel="prefetch" href="/notes/assets/interview45.html.f81226f1.js"><link rel="prefetch" href="/notes/assets/interview46.html.416c1c5c.js"><link rel="prefetch" href="/notes/assets/interview47.html.ec144a20.js"><link rel="prefetch" href="/notes/assets/interview48.html.3f72e1fd.js"><link rel="prefetch" href="/notes/assets/interview49.html.35802761.js"><link rel="prefetch" href="/notes/assets/interview5.html.38a98bab.js"><link rel="prefetch" href="/notes/assets/interview50.html.7c376d2a.js"><link rel="prefetch" href="/notes/assets/interview6.html.b04e1f18.js"><link rel="prefetch" href="/notes/assets/interview7.html.75fded6e.js"><link rel="prefetch" href="/notes/assets/interview8.html.d1c6af7e.js"><link rel="prefetch" href="/notes/assets/interview9.html.989fd897.js"><link rel="prefetch" href="/notes/assets/404.html.265028f6.js"><link rel="prefetch" href="/notes/assets/index.html.2bc919d1.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.53ddd914.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.8a3b1187.js"><link rel="prefetch" href="/notes/assets/base.html.e10ecb31.js"><link rel="prefetch" href="/notes/assets/customCli.html.e65c81f4.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.60b6cbdc.js"><link rel="prefetch" href="/notes/assets/adapter.html.4d7b63ce.js"><link rel="prefetch" href="/notes/assets/amd.html.87b2a486.js"><link rel="prefetch" href="/notes/assets/builder.html.7466b17b.js"><link rel="prefetch" href="/notes/assets/censorJquery.html.8217cef4.js"><link rel="prefetch" href="/notes/assets/combination.html.d3748258.js"><link rel="prefetch" href="/notes/assets/command.html.15cf4f1a.js"><link rel="prefetch" href="/notes/assets/commonJS.html.2b9b573a.js"><link rel="prefetch" href="/notes/assets/constructor.html.35bef683.js"><link rel="prefetch" href="/notes/assets/decoration.html.4b1093c7.js"><link rel="prefetch" href="/notes/assets/esHarmony.html.9b197e48.js"><link rel="prefetch" href="/notes/assets/exposed.html.d37915f1.js"><link rel="prefetch" href="/notes/assets/exterior.html.9e995435.js"><link rel="prefetch" href="/notes/assets/factory.html.ec25fa71.js"><link rel="prefetch" href="/notes/assets/flyweight.html.20202362.js"><link rel="prefetch" href="/notes/assets/functionalProgramming.html.e6db6781.js"><link rel="prefetch" href="/notes/assets/intermediary.html.24808e26.js"><link rel="prefetch" href="/notes/assets/iterator.html.9dfdb73e.js"><link rel="prefetch" href="/notes/assets/lazyInitial.html.776f553f.js"><link rel="prefetch" href="/notes/assets/mixin.html.5110d82b.js"><link rel="prefetch" href="/notes/assets/module.html.a659bcf4.js"><link rel="prefetch" href="/notes/assets/mvc.html.1f1d2bd2.js"><link rel="prefetch" href="/notes/assets/mvp.html.aa22786f.js"><link rel="prefetch" href="/notes/assets/mvvm.html.8c35bd9c.js"><link rel="prefetch" href="/notes/assets/observer.html.b525adfa.js"><link rel="prefetch" href="/notes/assets/outward.html.e7be3323.js"><link rel="prefetch" href="/notes/assets/overview.html.3ba437b9.js"><link rel="prefetch" href="/notes/assets/prototype.html.139fbc4b.js"><link rel="prefetch" href="/notes/assets/proxy.html.6b609222.js"><link rel="prefetch" href="/notes/assets/singleton.html.2349f962.js"><link rel="prefetch" href="/notes/assets/axios.html.f4b6061f.js"><link rel="prefetch" href="/notes/assets/createUnderscore.html.b72c5809.js"><link rel="prefetch" href="/notes/assets/jquery.html.5fe64ac3.js"><link rel="prefetch" href="/notes/assets/lodash.html.7946392d.js"><link rel="prefetch" href="/notes/assets/sentry.html.912e7447.js"><link rel="prefetch" href="/notes/assets/underscore.html.a51dfb33.js"><link rel="prefetch" href="/notes/assets/vuex.html.83651dfd.js"><link rel="prefetch" href="/notes/assets/customCli.html.0aa387c0.js"><link rel="prefetch" href="/notes/assets/description.html.34352d72.js"><link rel="prefetch" href="/notes/assets/indx.html.fe859500.js"><link rel="prefetch" href="/notes/assets/rebase.html.8c07abac.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.3ff074dd.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.f49f8318.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.ebe4f40a.js"><link rel="prefetch" href="/notes/assets/44Questions.html.d64a67bd.js"><link rel="prefetch" href="/notes/assets/asyncAwait.html.bccb0d25.js"><link rel="prefetch" href="/notes/assets/babelCompile.html.1e553c05.js"><link rel="prefetch" href="/notes/assets/base.html.12ae8217.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.7593d268.js"><link rel="prefetch" href="/notes/assets/baseWebpack.html.29aba1ab.js"><link rel="prefetch" href="/notes/assets/codeSeparation.html.7bab3aaf.js"><link rel="prefetch" href="/notes/assets/cycle.html.6ee7b34a.js"><link rel="prefetch" href="/notes/assets/cycleOtherWay.html.d1518074.js"><link rel="prefetch" href="/notes/assets/executionMechanism.html.ab7b08bf.js"><link rel="prefetch" href="/notes/assets/hybrid.html.8eb3040d.js"><link rel="prefetch" href="/notes/assets/jsHandwriting.html.09092caf.js"><link rel="prefetch" href="/notes/assets/jsonStringify.html.c6635772.js"><link rel="prefetch" href="/notes/assets/largeFileResumableUpload.html.bd5dcd0c.js"><link rel="prefetch" href="/notes/assets/performance.html.219fc204.js"><link rel="prefetch" href="/notes/assets/promise.html.1160aa4d.js"><link rel="prefetch" href="/notes/assets/promiseAll.html.7d80dcc7.js"><link rel="prefetch" href="/notes/assets/spa.html.52db0c16.js"><link rel="prefetch" href="/notes/assets/tsBaseInterview.html.ab09fd0b.js"><link rel="prefetch" href="/notes/assets/useEs6.html.3edbfb3c.js"><link rel="prefetch" href="/notes/assets/webAnimations.html.955ac76b.js"><link rel="prefetch" href="/notes/assets/webpackInterview.html.c97c14cd.js"><link rel="prefetch" href="/notes/assets/webpackLoader.html.bc2bf76d.js"><link rel="prefetch" href="/notes/assets/webpackPublic.html.7d7548ec.js"><link rel="prefetch" href="/notes/assets/weird.html.401e9e2d.js"><link rel="prefetch" href="/notes/assets/es10News.html.26f9cfd4.js"><link rel="prefetch" href="/notes/assets/es11News.html.ac9818fb.js"><link rel="prefetch" href="/notes/assets/es6Interview1.html.9d443454.js"><link rel="prefetch" href="/notes/assets/es6Interview2.html.d5516ae1.js"><link rel="prefetch" href="/notes/assets/es6Interview3.html.644e0656.js"><link rel="prefetch" href="/notes/assets/es6News.html.c417ec7b.js"><link rel="prefetch" href="/notes/assets/es7News.html.723625b3.js"><link rel="prefetch" href="/notes/assets/es8News.html.a2bfcacf.js"><link rel="prefetch" href="/notes/assets/es9News.html.902277e2.js"><link rel="prefetch" href="/notes/assets/base.html.6c344670.js"><link rel="prefetch" href="/notes/assets/nginxComprehensiveScene.html.fd78a225.js"><link rel="prefetch" href="/notes/assets/commonlyUsed.html.7532abb4.js"><link rel="prefetch" href="/notes/assets/inelegantHook.html.78e8df89.js"><link rel="prefetch" href="/notes/assets/interview1.html.b2ac7e5e.js"><link rel="prefetch" href="/notes/assets/interview2.html.9f67e548.js"><link rel="prefetch" href="/notes/assets/interview3.html.0b1748b7.js"><link rel="prefetch" href="/notes/assets/interview4.html.dcc40224.js"><link rel="prefetch" href="/notes/assets/base.html.962e7f7b.js"><link rel="prefetch" href="/notes/assets/introduction.html.b18bc7ec.js"><link rel="prefetch" href="/notes/assets/base.html.9ef3d613.js"><link rel="prefetch" href="/notes/assets/summarize.html.d2e41e94.js"><link rel="prefetch" href="/notes/assets/_sidebar.html.075bbf63.js"><link rel="prefetch" href="/notes/assets/index.html.16137b61.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.308a97a4.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.60d1a94c.js"><link rel="prefetch" href="/notes/assets/bigDataRender.html.09f473d3.js"><link rel="prefetch" href="/notes/assets/progress.html.11cbac36.js"><link rel="prefetch" href="/notes/assets/quirksStandards.html.054e376d.js"><link rel="prefetch" href="/notes/assets/redrawReflow.html.6e93d9cd.js"><link rel="prefetch" href="/notes/assets/storageSpace.html.868a8aa5.js"><link rel="prefetch" href="/notes/assets/webComLink.html.77f5a109.js"><link rel="prefetch" href="/notes/assets/webUrl.html.12929f94.js"><link rel="prefetch" href="/notes/assets/spanWidthHeight.html.474fb276.js"><link rel="prefetch" href="/notes/assets/baseCss.html.531424bb.js"><link rel="prefetch" href="/notes/assets/blockFormattingContext.html.fcee83bd.js"><link rel="prefetch" href="/notes/assets/containingBlock.html.b2bd4c0e.js"><link rel="prefetch" href="/notes/assets/cssBeforeAfter.html.8cc50c97.js"><link rel="prefetch" href="/notes/assets/cssBoxModal.html.8863f69f.js"><link rel="prefetch" href="/notes/assets/cssCollapsing.html.e096dba2.js"><link rel="prefetch" href="/notes/assets/cssCompatible.html.fc886e35.js"><link rel="prefetch" href="/notes/assets/cssFlexDemo.html.3ab61c9a.js"><link rel="prefetch" href="/notes/assets/cssFlexLayout.html.9d974529.js"><link rel="prefetch" href="/notes/assets/cssGridLayout.html.ebdea580.js"><link rel="prefetch" href="/notes/assets/cssHack.html.764a95b0.js"><link rel="prefetch" href="/notes/assets/cssInlineBlock.html.647aff5c.js"><link rel="prefetch" href="/notes/assets/cssPriority.html.22192bac.js"><link rel="prefetch" href="/notes/assets/cssPseudo.html.bef0d565.js"><link rel="prefetch" href="/notes/assets/cssPseudoClass.html.d1fa4bca.js"><link rel="prefetch" href="/notes/assets/cssSelector.html.4d6504fc.js"><link rel="prefetch" href="/notes/assets/cssTutorial.html.f4f9f615.js"><link rel="prefetch" href="/notes/assets/fieldInvalid.html.504ebd60.js"><link rel="prefetch" href="/notes/assets/frame.html.4313443d.js"><link rel="prefetch" href="/notes/assets/knowledgePoints.html.4cb6c7df.js"><link rel="prefetch" href="/notes/assets/linkImport.html.3c856a14.js"><link rel="prefetch" href="/notes/assets/stackingContext.html.0c64900f.js"><link rel="prefetch" href="/notes/assets/tools.html.7531a8aa.js"><link rel="prefetch" href="/notes/assets/units.html.cf3e10f8.js"><link rel="prefetch" href="/notes/assets/transform.html.622d774f.js"><link rel="prefetch" href="/notes/assets/content.html.119cd871.js"><link rel="prefetch" href="/notes/assets/plugins.html.c141e9eb.js"><link rel="prefetch" href="/notes/assets/accesskey.html.aebd3895.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.abd75c89.js"><link rel="prefetch" href="/notes/assets/canvasSvg.html.6ba8b8a7.js"><link rel="prefetch" href="/notes/assets/deviceAPI.html.228879ec.js"><link rel="prefetch" href="/notes/assets/globalAttr.html.2c9b5878.js"><link rel="prefetch" href="/notes/assets/htmlDatalist.html.f443d738.js"><link rel="prefetch" href="/notes/assets/htmlElement.html.be5d633b.js"><link rel="prefetch" href="/notes/assets/interview10.html.58ef0b51.js"><link rel="prefetch" href="/notes/assets/interview11.html.245e8707.js"><link rel="prefetch" href="/notes/assets/interview12.html.a0ffc46d.js"><link rel="prefetch" href="/notes/assets/interview13.html.50a7e94d.js"><link rel="prefetch" href="/notes/assets/interview14.html.fe819996.js"><link rel="prefetch" href="/notes/assets/interview15.html.75e3e018.js"><link rel="prefetch" href="/notes/assets/interview16.html.8804d3cf.js"><link rel="prefetch" href="/notes/assets/interview17.html.a5dde44b.js"><link rel="prefetch" href="/notes/assets/interview18.html.64908e2c.js"><link rel="prefetch" href="/notes/assets/interview19.html.e2d2f639.js"><link rel="prefetch" href="/notes/assets/interview20.html.a8b035ee.js"><link rel="prefetch" href="/notes/assets/interview21.html.c23621b3.js"><link rel="prefetch" href="/notes/assets/interview22.html.0955c07e.js"><link rel="prefetch" href="/notes/assets/interview23.html.fce24471.js"><link rel="prefetch" href="/notes/assets/interview24.html.8da51007.js"><link rel="prefetch" href="/notes/assets/interview25.html.f3c8c1f2.js"><link rel="prefetch" href="/notes/assets/interview26.html.dc7856f5.js"><link rel="prefetch" href="/notes/assets/interview27.html.9cbf4039.js"><link rel="prefetch" href="/notes/assets/interview28.html.048685f1.js"><link rel="prefetch" href="/notes/assets/interview29.html.aba09531.js"><link rel="prefetch" href="/notes/assets/interview30.html.c25142cc.js"><link rel="prefetch" href="/notes/assets/interview31.html.4bb0ea59.js"><link rel="prefetch" href="/notes/assets/interview32.html.39ac0919.js"><link rel="prefetch" href="/notes/assets/interview33.html.29a66e90.js"><link rel="prefetch" href="/notes/assets/interview34.html.c46064e6.js"><link rel="prefetch" href="/notes/assets/interview35.html.254730f2.js"><link rel="prefetch" href="/notes/assets/interview36.html.cb5abc32.js"><link rel="prefetch" href="/notes/assets/interview37.html.f0f05a76.js"><link rel="prefetch" href="/notes/assets/interview38.html.4517da61.js"><link rel="prefetch" href="/notes/assets/interview39.html.eaedf0d4.js"><link rel="prefetch" href="/notes/assets/interview40.html.b1e31d2f.js"><link rel="prefetch" href="/notes/assets/interview41.html.880073ff.js"><link rel="prefetch" href="/notes/assets/interview42.html.68d95d99.js"><link rel="prefetch" href="/notes/assets/interview43.html.fb14f3b3.js"><link rel="prefetch" href="/notes/assets/interview44.html.8b54f99b.js"><link rel="prefetch" href="/notes/assets/interview45.html.8ed67fe8.js"><link rel="prefetch" href="/notes/assets/interview46.html.ed2b7812.js"><link rel="prefetch" href="/notes/assets/interview47.html.091dc360.js"><link rel="prefetch" href="/notes/assets/interview48.html.6dbaf4e8.js"><link rel="prefetch" href="/notes/assets/interview49.html.cb2b402f.js"><link rel="prefetch" href="/notes/assets/interview5.html.637bbee5.js"><link rel="prefetch" href="/notes/assets/interview50.html.daaf7f5d.js"><link rel="prefetch" href="/notes/assets/interview51.html.3aab31b0.js"><link rel="prefetch" href="/notes/assets/interview52.html.14331410.js"><link rel="prefetch" href="/notes/assets/interview53.html.24dddb37.js"><link rel="prefetch" href="/notes/assets/interview54.html.a2179093.js"><link rel="prefetch" href="/notes/assets/interview55.html.4f09e99d.js"><link rel="prefetch" href="/notes/assets/interview56.html.ef1b59a5.js"><link rel="prefetch" href="/notes/assets/interview57.html.8b99f632.js"><link rel="prefetch" href="/notes/assets/interview58.html.087e08c5.js"><link rel="prefetch" href="/notes/assets/interview59.html.a798022e.js"><link rel="prefetch" href="/notes/assets/interview6.html.4e51556c.js"><link rel="prefetch" href="/notes/assets/interview7.html.75a9c971.js"><link rel="prefetch" href="/notes/assets/interview8.html.91097031.js"><link rel="prefetch" href="/notes/assets/interview9.html.d91aef32.js"><link rel="prefetch" href="/notes/assets/linkImport.html.3d260333.js"><link rel="prefetch" href="/notes/assets/offlineStorage.html.ebc0c9e1.js"><link rel="prefetch" href="/notes/assets/regular.html.f1456fe9.js"><link rel="prefetch" href="/notes/assets/shake.html.425040dc.js"><link rel="prefetch" href="/notes/assets/webWorker.html.73f2decf.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.de786ffc.js"><link rel="prefetch" href="/notes/assets/cors.html.f972de8c.js"><link rel="prefetch" href="/notes/assets/crossDomainCookie.html.568a7762.js"><link rel="prefetch" href="/notes/assets/fetch.html.47f081d4.js"><link rel="prefetch" href="/notes/assets/nestAxios.html.ffa01685.js"><link rel="prefetch" href="/notes/assets/debounce.html.a9765c71.js"><link rel="prefetch" href="/notes/assets/lodashPrinciple.html.33d86b6c.js"><link rel="prefetch" href="/notes/assets/lodashThrottleDebounce.html.ac89ffc3.js"><link rel="prefetch" href="/notes/assets/throttle.html.3f27380b.js"><link rel="prefetch" href="/notes/assets/throttleDebounceReact.html.95252c4b.js"><link rel="prefetch" href="/notes/assets/cloneIntroduction.html.5f0aad33.js"><link rel="prefetch" href="/notes/assets/deepClone.html.3d6fdf4b.js"><link rel="prefetch" href="/notes/assets/lodashDeepClone.html.e46bd18e.js"><link rel="prefetch" href="/notes/assets/objectAssign.html.cc45057f.js"><link rel="prefetch" href="/notes/assets/arraySourceCode.html.bd7ef8eb.js"><link rel="prefetch" href="/notes/assets/baseHigh.html.8b5c9ca3.js"><link rel="prefetch" href="/notes/assets/currying.html.79aba5be.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.d3029f05.js"><link rel="prefetch" href="/notes/assets/eventLoop.html.4f9292f1.js"><link rel="prefetch" href="/notes/assets/iife.html.8c6ed048.js"><link rel="prefetch" href="/notes/assets/interview1.html.0358e564.js"><link rel="prefetch" href="/notes/assets/jsCompatible.html.28afe903.js"><link rel="prefetch" href="/notes/assets/baseProyotype.html.a2353573.js"><link rel="prefetch" href="/notes/assets/functionObjectResource.html.b06d7dd4.js"><link rel="prefetch" href="/notes/assets/prototypeInherit.html.5af39f98.js"><link rel="prefetch" href="/notes/assets/closureInterview.html.ae8e7860.js"><link rel="prefetch" href="/notes/assets/scopeChain.html.28002029.js"><link rel="prefetch" href="/notes/assets/understandingClosures.html.20fe42d3.js"><link rel="prefetch" href="/notes/assets/executionStack.html.1d1a1fb5.js"><link rel="prefetch" href="/notes/assets/memoryLeak.html.70c915cb.js"><link rel="prefetch" href="/notes/assets/memoryMechanism.html.9c04cd74.js"><link rel="prefetch" href="/notes/assets/memorySpace.html.5aec4afd.js"><link rel="prefetch" href="/notes/assets/precompiled.html.9001c280.js"><link rel="prefetch" href="/notes/assets/variableObject.html.50547e4a.js"><link rel="prefetch" href="/notes/assets/arrowFunctionThis.html.9dce3d78.js"><link rel="prefetch" href="/notes/assets/bindSimulation.html.58ef3bd0.js"><link rel="prefetch" href="/notes/assets/callApply.html.0a3f2779.js"><link rel="prefetch" href="/notes/assets/newSimulation.html.9c170eb2.js"><link rel="prefetch" href="/notes/assets/thisBind.html.b1f69be3.js"><link rel="prefetch" href="/notes/assets/interview1.html.e5fcd053.js"><link rel="prefetch" href="/notes/assets/interview10.html.5c4c895a.js"><link rel="prefetch" href="/notes/assets/interview11.html.b6fb7d14.js"><link rel="prefetch" href="/notes/assets/interview12.html.abaad215.js"><link rel="prefetch" href="/notes/assets/interview13.html.442918f1.js"><link rel="prefetch" href="/notes/assets/interview14.html.3b7e3ca7.js"><link rel="prefetch" href="/notes/assets/interview15.html.8dc91059.js"><link rel="prefetch" href="/notes/assets/interview16.html.cf538a1c.js"><link rel="prefetch" href="/notes/assets/interview17.html.a32abbc8.js"><link rel="prefetch" href="/notes/assets/interview18.html.0fa2efef.js"><link rel="prefetch" href="/notes/assets/interview19.html.b4e27e0a.js"><link rel="prefetch" href="/notes/assets/interview2.html.95463e7d.js"><link rel="prefetch" href="/notes/assets/interview20.html.4d5fae90.js"><link rel="prefetch" href="/notes/assets/interview21.html.0882cf96.js"><link rel="prefetch" href="/notes/assets/interview22.html.e31ca229.js"><link rel="prefetch" href="/notes/assets/interview23.html.a74f7426.js"><link rel="prefetch" href="/notes/assets/interview24.html.27ebb542.js"><link rel="prefetch" href="/notes/assets/interview25.html.33cb142b.js"><link rel="prefetch" href="/notes/assets/interview26.html.b3b58f4f.js"><link rel="prefetch" href="/notes/assets/interview27.html.8e27aa06.js"><link rel="prefetch" href="/notes/assets/interview28.html.49e6df7e.js"><link rel="prefetch" href="/notes/assets/interview29.html.7ce852fd.js"><link rel="prefetch" href="/notes/assets/interview3.html.5f77b1cd.js"><link rel="prefetch" href="/notes/assets/interview30.html.9979403c.js"><link rel="prefetch" href="/notes/assets/interview4.html.b462ca7f.js"><link rel="prefetch" href="/notes/assets/interview5.html.a5a38165.js"><link rel="prefetch" href="/notes/assets/interview6.html.fa4e533e.js"><link rel="prefetch" href="/notes/assets/interview7.html.6ad76192.js"><link rel="prefetch" href="/notes/assets/interview8.html.4420f599.js"><link rel="prefetch" href="/notes/assets/interview9.html.d936486e.js"><link rel="prefetch" href="/notes/assets/adjacentSiblingCombinator.html.4678ef29.js"><link rel="prefetch" href="/notes/assets/attributeSelectors.html.26ba4611.js"><link rel="prefetch" href="/notes/assets/charset.html.d2c457ea.js"><link rel="prefetch" href="/notes/assets/childCombinator.html.3141043e.js"><link rel="prefetch" href="/notes/assets/classSelectors.html.12522638.js"><link rel="prefetch" href="/notes/assets/descendantCombinator.html.fab8f35d.js"><link rel="prefetch" href="/notes/assets/generalSiblingCombinator.html.b4c4cbae.js"><link rel="prefetch" href="/notes/assets/iDSelectors.html.8c4c70d3.js"><link rel="prefetch" href="/notes/assets/pseudoClasses.html.a3601830.js"><link rel="prefetch" href="/notes/assets/pseudoElements.html.4f98065a.js"><link rel="prefetch" href="/notes/assets/selectorList.html.24e96ba6.js"><link rel="prefetch" href="/notes/assets/typeSelectors.html.b26b0828.js"><link rel="prefetch" href="/notes/assets/universalSelectors.html.eccbf364.js"><link rel="prefetch" href="/notes/assets/IterationProtocols.html.51c4e03d.js"><link rel="prefetch" href="/notes/assets/arrayFlat.html.b8cb5aed.js"><link rel="prefetch" href="/notes/assets/asyncHistory.html.aa784c29.js"><link rel="prefetch" href="/notes/assets/eventLoop.html.ecc7202d.js"><link rel="prefetch" href="/notes/assets/fileReader.html.531b6b74.js"><link rel="prefetch" href="/notes/assets/formData.html.15fdfb84.js"><link rel="prefetch" href="/notes/assets/functionGenerator.html.19d1dbd5.js"><link rel="prefetch" href="/notes/assets/generator.html.b0314375.js"><link rel="prefetch" href="/notes/assets/intersectionObserver.html.b0ed8797.js"><link rel="prefetch" href="/notes/assets/map.html.13056768.js"><link rel="prefetch" href="/notes/assets/promise.html.0205a234.js"><link rel="prefetch" href="/notes/assets/set.html.5065a76a.js"><link rel="prefetch" href="/notes/assets/string.html.315b17c9.js"><link rel="prefetch" href="/notes/assets/symbol.html.2cc4e5e6.js"><link rel="prefetch" href="/notes/assets/xMLHttpRequest.html.c899cb52.js"><link rel="prefetch" href="/notes/assets/spreadSyntax.html.e2d75338.js"><link rel="prefetch" href="/notes/assets/strictMode.html.3cff9f18.js"><link rel="prefetch" href="/notes/assets/cache.html.5ab9ab96.js"><link rel="prefetch" href="/notes/assets/drag1.html.5eee75e6.js"><link rel="prefetch" href="/notes/assets/oneLineCode.html.8ced55da.js"><link rel="prefetch" href="/notes/assets/oneLineCodeArray.html.2a6deae0.js"><link rel="prefetch" href="/notes/assets/oneLineCodeDOM.html.e3420bc3.js"><link rel="prefetch" href="/notes/assets/oneLineCodeDateTime.html.371ec1ec.js"><link rel="prefetch" href="/notes/assets/oneLineCodeFunction.html.9b5afa57.js"><link rel="prefetch" href="/notes/assets/oneLineCodeMath.html.c4c84b27.js"><link rel="prefetch" href="/notes/assets/oneLineCodeMisc.html.607580cb.js"><link rel="prefetch" href="/notes/assets/oneLineCodeNumber.html.0c24a0dc.js"><link rel="prefetch" href="/notes/assets/oneLineCodeObject.html.5ad38b80.js"><link rel="prefetch" href="/notes/assets/oneLineCodeRandom.html.6f54ca72.js"><link rel="prefetch" href="/notes/assets/oneLineCodeString.html.6836187a.js"><link rel="prefetch" href="/notes/assets/oneLineCodeValidator.html.6f3faa87.js"><link rel="prefetch" href="/notes/assets/typeScriptCache.html.cf83e89c.js"><link rel="prefetch" href="/notes/assets/reactBase.html.34722524.js"><link rel="prefetch" href="/notes/assets/reactTypescript.html.ee954354.js"><link rel="prefetch" href="/notes/assets/vue2Base.html.5e4d06d2.js"><link rel="prefetch" href="/notes/assets/vue2Table.html.5bb59922.js"><link rel="prefetch" href="/notes/assets/vue2offsetTop.html.3083a997.js"><link rel="prefetch" href="/notes/assets/componentWillXXX.html.febd278d.js"><link rel="prefetch" href="/notes/assets/disrupt.html.b6c0351f.js"><link rel="prefetch" href="/notes/assets/lane.html.72f390d4.js"><link rel="prefetch" href="/notes/assets/prepare.html.d81b7442.js"><link rel="prefetch" href="/notes/assets/redux.html.86a12e77.js"><link rel="prefetch" href="/notes/assets/scheduler.html.8c339c02.js"><link rel="prefetch" href="/notes/assets/multi.html.0739ede4.js"><link rel="prefetch" href="/notes/assets/one.html.f797fb2f.js"><link rel="prefetch" href="/notes/assets/prepare.html.6449d220.js"><link rel="prefetch" href="/notes/assets/create.html.2c1770d7.js"><link rel="prefetch" href="/notes/assets/prepare.html.19a0c63a.js"><link rel="prefetch" href="/notes/assets/structure.html.4af4a93a.js"><link rel="prefetch" href="/notes/assets/useeffect.html.cb0836a6.js"><link rel="prefetch" href="/notes/assets/usememo.html.7c201360.js"><link rel="prefetch" href="/notes/assets/useref.html.bad9c523.js"><link rel="prefetch" href="/notes/assets/usestate.html.ac4c6a0c.js"><link rel="prefetch" href="/notes/assets/file.html.30b2a472.js"><link rel="prefetch" href="/notes/assets/idea.html.9c212512.js"><link rel="prefetch" href="/notes/assets/jsx.html.ad8d5832.js"><link rel="prefetch" href="/notes/assets/newConstructure.html.810f09a4.js"><link rel="prefetch" href="/notes/assets/oldConstructure.html.891dc0ee.js"><link rel="prefetch" href="/notes/assets/source.html.d63d9625.js"><link rel="prefetch" href="/notes/assets/summary.html.8616e021.js"><link rel="prefetch" href="/notes/assets/basePrinciple.html.8885dd7f.js"><link rel="prefetch" href="/notes/assets/componentApi.html.40834033.js"><link rel="prefetch" href="/notes/assets/domApi.html.22e55c76.js"><link rel="prefetch" href="/notes/assets/hoc.html.91d90706.js"><link rel="prefetch" href="/notes/assets/hookApi.html.818a01de.js"><link rel="prefetch" href="/notes/assets/hookCustom.html.32a36dfb.js"><link rel="prefetch" href="/notes/assets/hookPrinciple.html.56d6f673.js"><link rel="prefetch" href="/notes/assets/hookUse.html.00a61215.js"><link rel="prefetch" href="/notes/assets/reactKeeplive.html.44eaf288.js"><link rel="prefetch" href="/notes/assets/reactRedux.html.a420779a.js"><link rel="prefetch" href="/notes/assets/reactRouter.html.ca1881e7.js"><link rel="prefetch" href="/notes/assets/toolApi.html.e9d4c75a.js"><link rel="prefetch" href="/notes/assets/beginWork.html.16f412a1.js"><link rel="prefetch" href="/notes/assets/completeWork.html.9ff3db0d.js"><link rel="prefetch" href="/notes/assets/doubleBuffer.html.2567847d.js"><link rel="prefetch" href="/notes/assets/fiber-mental.html.20df01fb.js"><link rel="prefetch" href="/notes/assets/fiber.html.8a441b3e.js"><link rel="prefetch" href="/notes/assets/reconciler.html.04c2e687.js"><link rel="prefetch" href="/notes/assets/beforeMutation.html.3c5603ea.js"><link rel="prefetch" href="/notes/assets/layout.html.4658d427.js"><link rel="prefetch" href="/notes/assets/mutation.html.dcc1b732.js"><link rel="prefetch" href="/notes/assets/prepare.html.68c8bf56.js"><link rel="prefetch" href="/notes/assets/mental.html.03393ba5.js"><link rel="prefetch" href="/notes/assets/prepare.html.ee2c080f.js"><link rel="prefetch" href="/notes/assets/priority.html.913dca70.js"><link rel="prefetch" href="/notes/assets/reactdom.html.373713ad.js"><link rel="prefetch" href="/notes/assets/setstate.html.4ed38489.js"><link rel="prefetch" href="/notes/assets/update.html.2d0f9ee0.js"><link rel="prefetch" href="/notes/assets/bitfiled.html.8eca7f28.js"><link rel="prefetch" href="/notes/assets/dfs.html.8a40d17e.js"><link rel="prefetch" href="/notes/assets/diff.html.19c98a3c.js"><link rel="prefetch" href="/notes/assets/heapsort.html.4eaf85a8.js"><link rel="prefetch" href="/notes/assets/linkedlist.html.17aee4ad.js"><link rel="prefetch" href="/notes/assets/stack.html.fe3b2471.js"><link rel="prefetch" href="/notes/assets/bootstrap.html.bd305359.js"><link rel="prefetch" href="/notes/assets/context.html.b92a2241.js"><link rel="prefetch" href="/notes/assets/fibertree-commit.html.6cb97cdb.js"><link rel="prefetch" href="/notes/assets/fibertree-prepare.html.d7c62d4b.js"><link rel="prefetch" href="/notes/assets/fibertree-update.html.d18efe4d.js"><link rel="prefetch" href="/notes/assets/hook-effect.html.0862838e.js"><link rel="prefetch" href="/notes/assets/hook-state.html.5552f208.js"><link rel="prefetch" href="/notes/assets/hook-summary.html.38ae18b1.js"><link rel="prefetch" href="/notes/assets/macro-structure.html.08c0b408.js"><link rel="prefetch" href="/notes/assets/object-structure.html.1899253b.js"><link rel="prefetch" href="/notes/assets/priority.html.24f4fd27.js"><link rel="prefetch" href="/notes/assets/reconciler-workflow.html.51a79eb6.js"><link rel="prefetch" href="/notes/assets/scheduler.html.701a1c65.js"><link rel="prefetch" href="/notes/assets/state-effects.html.f67a9fd1.js"><link rel="prefetch" href="/notes/assets/synthetic-event.html.f75a320b.js"><link rel="prefetch" href="/notes/assets/workloop.html.281d6eba.js"><link rel="prefetch" href="/notes/assets/ast.html.4722246c.js"><link rel="prefetch" href="/notes/assets/binder.html.bed71a48.js"><link rel="prefetch" href="/notes/assets/checker.html.ca8111ef.js"><link rel="prefetch" href="/notes/assets/emitter.html.af546fcd.js"><link rel="prefetch" href="/notes/assets/overview.html.4a519291.js"><link rel="prefetch" href="/notes/assets/parser.html.02c420d4.js"><link rel="prefetch" href="/notes/assets/program.html.941d3fd0.js"><link rel="prefetch" href="/notes/assets/scanner.html.06598dca.js"><link rel="prefetch" href="/notes/assets/common.html.2840c671.js"><link rel="prefetch" href="/notes/assets/interpreting.html.9d0247dd.js"><link rel="prefetch" href="/notes/assets/class.html.176b10c4.js"><link rel="prefetch" href="/notes/assets/commandline-behavior.html.9c679556.js"><link rel="prefetch" href="/notes/assets/comments.html.8840c294.js"><link rel="prefetch" href="/notes/assets/common-bug-not-bugs.html.1c50db4c.js"><link rel="prefetch" href="/notes/assets/common-feature-request.html.cbdc85e0.js"><link rel="prefetch" href="/notes/assets/decorators.html.e685ca45.js"><link rel="prefetch" href="/notes/assets/enums.html.e3d4bed0.js"><link rel="prefetch" href="/notes/assets/function.html.2f3827b6.js"><link rel="prefetch" href="/notes/assets/generics.html.ef35fef5.js"><link rel="prefetch" href="/notes/assets/glossary-and-terms.html.ff76a163.js"><link rel="prefetch" href="/notes/assets/jsx-and-react.html.af6a3ed5.js"><link rel="prefetch" href="/notes/assets/modules.html.fca96b11.js"><link rel="prefetch" href="/notes/assets/thing-that-dont-work.html.0798ae85.js"><link rel="prefetch" href="/notes/assets/tsconfig-behavior.html.7186d572.js"><link rel="prefetch" href="/notes/assets/type-guards.html.338be1fc.js"><link rel="prefetch" href="/notes/assets/type-system-behavior.html.b3d484fb.js"><link rel="prefetch" href="/notes/assets/nonReactJSX.html.6224d2f0.js"><link rel="prefetch" href="/notes/assets/reactJSX.html.2ab93f4e.js"><link rel="prefetch" href="/notes/assets/support.html.38d65ad9.js"><link rel="prefetch" href="/notes/assets/typescript-3.7.html.22fbc5c7.js"><link rel="prefetch" href="/notes/assets/typescript-3.8.html.7e45b554.js"><link rel="prefetch" href="/notes/assets/typescript-3.9.html.d3535b93.js"><link rel="prefetch" href="/notes/assets/compilationContext.html.42cc41f0.js"><link rel="prefetch" href="/notes/assets/declarationspaces.html.5e8d853d.js"><link rel="prefetch" href="/notes/assets/dynamicImportExpressions.html.2351b7f3.js"><link rel="prefetch" href="/notes/assets/inDepthTs.html.23b9ed3c.js"><link rel="prefetch" href="/notes/assets/modules.html.a267ca3f.js"><link rel="prefetch" href="/notes/assets/namespaces.html.e9e0a691.js"><link rel="prefetch" href="/notes/assets/unknownAny.html.130e4df1.js"><link rel="prefetch" href="/notes/assets/avoidExportDefault.html.e6bf98c9.js"><link rel="prefetch" href="/notes/assets/barrel.html.4784a045.js"><link rel="prefetch" href="/notes/assets/bind.html.4a0d2947.js"><link rel="prefetch" href="/notes/assets/buildToggles.html.73cc1fff.js"><link rel="prefetch" href="/notes/assets/classAreUseful.html.2ef5f86f.js"><link rel="prefetch" href="/notes/assets/covarianceAndContravariance.html.cceeb4e4.js"><link rel="prefetch" href="/notes/assets/createArrays.html.6ba7a0e7.js"><link rel="prefetch" href="/notes/assets/curry.html.9bed419f.js"><link rel="prefetch" href="/notes/assets/functionParameters.html.bdb6bd3d.js"><link rel="prefetch" href="/notes/assets/infer.html.205651e2.js"><link rel="prefetch" href="/notes/assets/lazyObjectLiteralInitialization.html.5f61d58a.js"><link rel="prefetch" href="/notes/assets/limitPropertySetters.html.7c772ffe.js"><link rel="prefetch" href="/notes/assets/metadata.html.e9eb3a03.js"><link rel="prefetch" href="/notes/assets/nominalTyping.html.530eea23.js"><link rel="prefetch" href="/notes/assets/outFileCaution.html.36b23ec7.js"><link rel="prefetch" href="/notes/assets/singletonPatern.html.3a72448b.js"><link rel="prefetch" href="/notes/assets/statefulFunctions.html.8ec60826.js"><link rel="prefetch" href="/notes/assets/staticConstructors.html.5a25406b.js"><link rel="prefetch" href="/notes/assets/stringBasedEmuns.html.b4519990.js"><link rel="prefetch" href="/notes/assets/truthy.html.6496d11c.js"><link rel="prefetch" href="/notes/assets/typeInstantiation.html.8e59e083.js"><link rel="prefetch" href="/notes/assets/typesafeEventEmitter.html.6300f4fa.js"><link rel="prefetch" href="/notes/assets/ambient.html.c822fd90.js"><link rel="prefetch" href="/notes/assets/callable.html.d0c0bbad.js"><link rel="prefetch" href="/notes/assets/discrominatedUnion.html.a172d541.js"><link rel="prefetch" href="/notes/assets/enums.html.76032376.js"><link rel="prefetch" href="/notes/assets/exceptionsHanding.html.3090d295.js"><link rel="prefetch" href="/notes/assets/freshness.html.07d033ad.js"><link rel="prefetch" href="/notes/assets/functions.html.1702d26f.js"><link rel="prefetch" href="/notes/assets/generices.html.c2df4cac.js"><link rel="prefetch" href="/notes/assets/indexSignatures.html.85f6577d.js"><link rel="prefetch" href="/notes/assets/interfaces.html.2e1c0ca0.js"><link rel="prefetch" href="/notes/assets/lib.html.8e150cb1.js"><link rel="prefetch" href="/notes/assets/literals.html.3cd9a741.js"><link rel="prefetch" href="/notes/assets/migrating.html.53df00fb.js"><link rel="prefetch" href="/notes/assets/mixins.html.62e5f0fd.js"><link rel="prefetch" href="/notes/assets/movingTypes.html.9d36cd6f.js"><link rel="prefetch" href="/notes/assets/neverType.html.16150149.js"><link rel="prefetch" href="/notes/assets/overview.html.85bcab3e.js"><link rel="prefetch" href="/notes/assets/readonly.html.66f74561.js"><link rel="prefetch" href="/notes/assets/thisType.html.638f1d8d.js"><link rel="prefetch" href="/notes/assets/typeAssertion.html.cedb905a.js"><link rel="prefetch" href="/notes/assets/typeCompatibility.html.f314b22e.js"><link rel="prefetch" href="/notes/assets/typeGuard.html.2ff8201d.js"><link rel="prefetch" href="/notes/assets/typeInference.html.1fae7266.js"><link rel="prefetch" href="/notes/assets/types.html.67883b92.js"><link rel="prefetch" href="/notes/assets/pluginDva.html.b68c212d.js"><link rel="prefetch" href="/notes/assets/pluginQiankun.html.7f956b9b.js"><link rel="prefetch" href="/notes/assets/codegen.html.decbe76e.js"><link rel="prefetch" href="/notes/assets/entrance.html.78975e1d.js"><link rel="prefetch" href="/notes/assets/optimize.html.9f58b1dc.js"><link rel="prefetch" href="/notes/assets/outline.html.b228ff98.js"><link rel="prefetch" href="/notes/assets/parse.html.cf87e83c.js"><link rel="prefetch" href="/notes/assets/async-component.html.f2fce7a4.js"><link rel="prefetch" href="/notes/assets/component-register.html.ec777791.js"><link rel="prefetch" href="/notes/assets/create-component.html.b7ea7d86.js"><link rel="prefetch" href="/notes/assets/lifecycle.html.6dfe8f3c.js"><link rel="prefetch" href="/notes/assets/merge-option.html.fda33cc2.js"><link rel="prefetch" href="/notes/assets/outline.html.ef6eb680.js"><link rel="prefetch" href="/notes/assets/patch.html.984b33c4.js"><link rel="prefetch" href="/notes/assets/_index.html.0917df2e.js"><link rel="prefetch" href="/notes/assets/create-element.html.64d36854.js"><link rel="prefetch" href="/notes/assets/mounted.html.17638664.js"><link rel="prefetch" href="/notes/assets/new-vue.html.52de603e.js"><link rel="prefetch" href="/notes/assets/render.html.5cf78daa.js"><link rel="prefetch" href="/notes/assets/update.html.2e285d46.js"><link rel="prefetch" href="/notes/assets/virtual-dom.html.ebbd5cff.js"><link rel="prefetch" href="/notes/assets/event.html.2885b882.js"><link rel="prefetch" href="/notes/assets/keep-alive.html.91309197.js"><link rel="prefetch" href="/notes/assets/outline.html.dc94c30d.js"><link rel="prefetch" href="/notes/assets/slot.html.ca1e313b.js"><link rel="prefetch" href="/notes/assets/tansition-group.html.109ceff3.js"><link rel="prefetch" href="/notes/assets/tansition.html.2cb870c6.js"><link rel="prefetch" href="/notes/assets/v-model.html.4cd30505.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.3eae277e.js"><link rel="prefetch" href="/notes/assets/baseInterviewSecond.html.d6cde389.js"><link rel="prefetch" href="/notes/assets/componentCommunication.html.ecbe72e8.js"><link rel="prefetch" href="/notes/assets/detailedResponsiveness.html.483c396e.js"><link rel="prefetch" href="/notes/assets/diff.html.07197252.js"><link rel="prefetch" href="/notes/assets/eventBinding.html.f9c13bf1.js"><link rel="prefetch" href="/notes/assets/eventMechanism.html.435fbd64.js"><link rel="prefetch" href="/notes/assets/key.html.e1b89141.js"><link rel="prefetch" href="/notes/assets/knowledgeSystem.html.2967f0fb.js"><link rel="prefetch" href="/notes/assets/slot.html.b6cff939.js"><link rel="prefetch" href="/notes/assets/sourceCodeAsyncDomUpdateNextTick.html.987a85c5.js"><link rel="prefetch" href="/notes/assets/sourceCodeElementBroadcastDispatch.html.51b7b968.js"><link rel="prefetch" href="/notes/assets/sourceCodeKeepAlive.html.d20fe26a.js"><link rel="prefetch" href="/notes/assets/sourceCodeResponsiveness.html.5dc22fc3.js"><link rel="prefetch" href="/notes/assets/sourceCodeTemplateCompilation.html.f7a1dd87.js"><link rel="prefetch" href="/notes/assets/sourceCodeTemplateDom.html.d20c743f.js"><link rel="prefetch" href="/notes/assets/sourceCodeVuex.html.b2c2f6d7.js"><link rel="prefetch" href="/notes/assets/templateCompilation.html.7c059f34.js"><link rel="prefetch" href="/notes/assets/vNode.html.8be72310.js"><link rel="prefetch" href="/notes/assets/vNodeDiff.html.52f30892.js"><link rel="prefetch" href="/notes/assets/build.html.df2322c4.js"><link rel="prefetch" href="/notes/assets/directory.html.c1bf8102.js"><link rel="prefetch" href="/notes/assets/entrance.html.d8a98236.js"><link rel="prefetch" href="/notes/assets/flow.html.e4f444d4.js"><link rel="prefetch" href="/notes/assets/component-update.html.784b890d.js"><link rel="prefetch" href="/notes/assets/computed-watcher.html.28270353.js"><link rel="prefetch" href="/notes/assets/getters.html.a2e7d109.js"><link rel="prefetch" href="/notes/assets/next-tick.html.9c857394.js"><link rel="prefetch" href="/notes/assets/outline.html.76b6ab45.js"><link rel="prefetch" href="/notes/assets/props.html.ad58cf0f.js"><link rel="prefetch" href="/notes/assets/questions.html.127aeab2.js"><link rel="prefetch" href="/notes/assets/reactive-object.html.64466fea.js"><link rel="prefetch" href="/notes/assets/setters.html.0dca9440.js"><link rel="prefetch" href="/notes/assets/summary.html.c18427a9.js"><link rel="prefetch" href="/notes/assets/install.html.7de46a8b.js"><link rel="prefetch" href="/notes/assets/matcher.html.d080fc07.js"><link rel="prefetch" href="/notes/assets/outline.html.607a3a2d.js"><link rel="prefetch" href="/notes/assets/router.html.a6fa1e47.js"><link rel="prefetch" href="/notes/assets/transition-to.html.5c90d737.js"><link rel="prefetch" href="/notes/assets/api.html.39f6da24.js"><link rel="prefetch" href="/notes/assets/idex.html.e1c16a01.js"><link rel="prefetch" href="/notes/assets/init.html.462c5cf9.js"><link rel="prefetch" href="/notes/assets/plugin.html.ca8bed91.js"><link rel="prefetch" href="/notes/assets/baseInterview.html.866c3c06.js"><link rel="prefetch" href="/notes/assets/configuration.html.9e58a0fa.js"><link rel="prefetch" href="/notes/assets/entryPoints.html.09ad4a83.js"><link rel="prefetch" href="/notes/assets/loader.html.4cf291fa.js"><link rel="prefetch" href="/notes/assets/output.html.8cf664a5.js"><link rel="prefetch" href="/notes/assets/plugin.html.a5428135.js"><link rel="prefetch" href="/notes/assets/webpackInterview.html.9adadcaf.js"><link rel="prefetch" href="/notes/assets/reactApi.html.6cb8a5bd.js"><link rel="prefetch" href="/notes/assets/reactChildren.html.96c46a9a.js"><link rel="prefetch" href="/notes/assets/reactElement.html.b4f8352a.js"><link rel="prefetch" href="/notes/assets/reactFiber.html.4b137f5f.js"><link rel="prefetch" href="/notes/assets/commitAllHostEffects.html.68a9a0ef.js"><link rel="prefetch" href="/notes/assets/commitAllLifeCycles.html.06ba456b.js"><link rel="prefetch" href="/notes/assets/commitBeforeMutationLifecycles.html.2ce9b59b.js"><link rel="prefetch" href="/notes/assets/commitDeletion.html.a9d92fcf.js"><link rel="prefetch" href="/notes/assets/commitPlacement.html.a7b8b479.js"><link rel="prefetch" href="/notes/assets/commitRoot.html.28d39b32.js"><link rel="prefetch" href="/notes/assets/commitWork.html.03ce0c1e.js"><link rel="prefetch" href="/notes/assets/invokeGuardedCallback.html.bffcf147.js"><link rel="prefetch" href="/notes/assets/expirationTime.html.b50e0cc1.js"><link rel="prefetch" href="/notes/assets/reactDomRender.html.a52e57c1.js"><link rel="prefetch" href="/notes/assets/setStateForceUpdate.html.97a36dcc.js"><link rel="prefetch" href="/notes/assets/context.html.16ea2e60.js"><link rel="prefetch" href="/notes/assets/evenInit.html.30c2727f.js"><link rel="prefetch" href="/notes/assets/eventBind.html.26edb394.js"><link rel="prefetch" href="/notes/assets/eventCreateEventObject.html.986a4a58.js"><link rel="prefetch" href="/notes/assets/eventDispath.html.66c4062e.js"><link rel="prefetch" href="/notes/assets/hydrate.html.17e9bdee.js"><link rel="prefetch" href="/notes/assets/ref.html.52737b61.js"><link rel="prefetch" href="/notes/assets/suspense.html.214d4f5e.js"><link rel="prefetch" href="/notes/assets/suspenseLazy.html.fe491204.js"><link rel="prefetch" href="/notes/assets/suspenseWork.html.556b0edf.js"><link rel="prefetch" href="/notes/assets/hooksCommon.html.379b077c.js"><link rel="prefetch" href="/notes/assets/hooksOther.html.22aa738b.js"><link rel="prefetch" href="/notes/assets/start.html.7311ac86.js"><link rel="prefetch" href="/notes/assets/useEffect.html.6574b772.js"><link rel="prefetch" href="/notes/assets/useState.html.cbcfa61c.js"><link rel="prefetch" href="/notes/assets/base.html.25bf7666.js"><link rel="prefetch" href="/notes/assets/commpontDiff.html.a1e53d65.js"><link rel="prefetch" href="/notes/assets/componentUpdate.html.644e4b07.js"><link rel="prefetch" href="/notes/assets/renderProcess.html.2666f6c0.js"><link rel="prefetch" href="/notes/assets/schedulingPrinciple.html.ccbcd29b.js"><link rel="prefetch" href="/notes/assets/beginWork.html.655d69f7.js"><link rel="prefetch" href="/notes/assets/globalVariable.html.31502402.js"><link rel="prefetch" href="/notes/assets/mountIndeterminateComponent.html.04a5f30e.js"><link rel="prefetch" href="/notes/assets/mountLazyCompont.html.2fe93bfc.js"><link rel="prefetch" href="/notes/assets/performUnitOfWork.html.ace3ee26.js"><link rel="prefetch" href="/notes/assets/performWork.html.2497511d.js"><link rel="prefetch" href="/notes/assets/reactScheduler.html.d0ac2d54.js"><link rel="prefetch" href="/notes/assets/reconcileChildren.html.3c846629.js"><link rel="prefetch" href="/notes/assets/reconcileChildrenArray.html.97182f29.js"><link rel="prefetch" href="/notes/assets/reconcileSingleElement.html.bfa84cf2.js"><link rel="prefetch" href="/notes/assets/renderRoot.html.ba5288e4.js"><link rel="prefetch" href="/notes/assets/scheduleWork.html.c90062e5.js"><link rel="prefetch" href="/notes/assets/throwException.html.c51288e7.js"><link rel="prefetch" href="/notes/assets/updateClassComponent.html.7cc962b4.js"><link rel="prefetch" href="/notes/assets/updateContextConsumer.html.403bc04b.js"><link rel="prefetch" href="/notes/assets/updateContextProvider.html.b19839fa.js"><link rel="prefetch" href="/notes/assets/updateForwardRef.html.0b6c16ba.js"><link rel="prefetch" href="/notes/assets/updateFragment.html.3be4ca6a.js"><link rel="prefetch" href="/notes/assets/updateFunctionalComponent.html.63214472.js"><link rel="prefetch" href="/notes/assets/updateHostComponent.html.855bd285.js"><link rel="prefetch" href="/notes/assets/updateHostRoot.html.a008bdc7.js"><link rel="prefetch" href="/notes/assets/updateHostText.html.778f20ec.js"><link rel="prefetch" href="/notes/assets/updateMode.html.72e7cae7.js"><link rel="prefetch" href="/notes/assets/updatePortalComponent.html.ee67a0b1.js"><link rel="prefetch" href="/notes/assets/updateProfiler.html.eb313acf.js"><link rel="prefetch" href="/notes/assets/updateSuspenseComponent.html.ac4368be.js"><link rel="prefetch" href="/notes/assets/interview1.html.233c8a55.js"><link rel="prefetch" href="/notes/assets/interview2.html.ad211fb1.js"><link rel="prefetch" href="/notes/assets/interview3.html.ff6c200b.js"><link rel="prefetch" href="/notes/assets/interview51.html.332896a2.js"><link rel="prefetch" href="/notes/assets/interview52.html.c9e9a740.js"><link rel="prefetch" href="/notes/assets/interview53.html.bb2200fc.js"><link rel="prefetch" href="/notes/assets/interview54.html.31c68b7d.js"><link rel="prefetch" href="/notes/assets/interview55.html.9de26700.js"><link rel="prefetch" href="/notes/assets/interview56.html.f54f5c68.js"><link rel="prefetch" href="/notes/assets/interview57.html.e990ca13.js"><link rel="prefetch" href="/notes/assets/interview1.html.fec6abfb.js"><link rel="prefetch" href="/notes/assets/interview10.html.cc9cc0ff.js"><link rel="prefetch" href="/notes/assets/interview11.html.c9c43373.js"><link rel="prefetch" href="/notes/assets/interview12.html.3c7c219b.js"><link rel="prefetch" href="/notes/assets/interview13.html.df11d69d.js"><link rel="prefetch" href="/notes/assets/interview14.html.064ab175.js"><link rel="prefetch" href="/notes/assets/interview15.html.aaaf13f8.js"><link rel="prefetch" href="/notes/assets/interview16.html.b917ebad.js"><link rel="prefetch" href="/notes/assets/interview17.html.89fe2b4e.js"><link rel="prefetch" href="/notes/assets/interview18.html.5945983b.js"><link rel="prefetch" href="/notes/assets/interview19.html.af91505c.js"><link rel="prefetch" href="/notes/assets/interview2.html.7eba2145.js"><link rel="prefetch" href="/notes/assets/interview20.html.bbc39973.js"><link rel="prefetch" href="/notes/assets/interview21.html.3135e99c.js"><link rel="prefetch" href="/notes/assets/interview22.html.517fb777.js"><link rel="prefetch" href="/notes/assets/interview23.html.e85e7c30.js"><link rel="prefetch" href="/notes/assets/interview24.html.2ec0e247.js"><link rel="prefetch" href="/notes/assets/interview25.html.896a5d9e.js"><link rel="prefetch" href="/notes/assets/interview26.html.c9099ff6.js"><link rel="prefetch" href="/notes/assets/interview27.html.e0d813df.js"><link rel="prefetch" href="/notes/assets/interview28.html.98ae23f7.js"><link rel="prefetch" href="/notes/assets/interview29.html.bfc17d61.js"><link rel="prefetch" href="/notes/assets/interview3.html.123f8330.js"><link rel="prefetch" href="/notes/assets/interview30.html.556a950e.js"><link rel="prefetch" href="/notes/assets/interview31.html.03ba5989.js"><link rel="prefetch" href="/notes/assets/interview32.html.8ac251f8.js"><link rel="prefetch" href="/notes/assets/interview33.html.ebc204c1.js"><link rel="prefetch" href="/notes/assets/interview34.html.0e51800a.js"><link rel="prefetch" href="/notes/assets/interview35.html.f6e32ab4.js"><link rel="prefetch" href="/notes/assets/interview36.html.18a99299.js"><link rel="prefetch" href="/notes/assets/interview37.html.be5f0d27.js"><link rel="prefetch" href="/notes/assets/interview38.html.d77a4503.js"><link rel="prefetch" href="/notes/assets/interview39.html.ddc70590.js"><link rel="prefetch" href="/notes/assets/interview4.html.22d72ffa.js"><link rel="prefetch" href="/notes/assets/interview40.html.5f53c675.js"><link rel="prefetch" href="/notes/assets/interview41.html.6cb0baa4.js"><link rel="prefetch" href="/notes/assets/interview42.html.801d18f8.js"><link rel="prefetch" href="/notes/assets/interview43.html.0a26e65b.js"><link rel="prefetch" href="/notes/assets/interview44.html.4f99e5a6.js"><link rel="prefetch" href="/notes/assets/interview45.html.7eabfa3e.js"><link rel="prefetch" href="/notes/assets/interview46.html.e625d4a6.js"><link rel="prefetch" href="/notes/assets/interview47.html.496b56ef.js"><link rel="prefetch" href="/notes/assets/interview48.html.62ce9ca7.js"><link rel="prefetch" href="/notes/assets/interview49.html.c8a9b27d.js"><link rel="prefetch" href="/notes/assets/interview5.html.e5b8b894.js"><link rel="prefetch" href="/notes/assets/interview50.html.192b7d23.js"><link rel="prefetch" href="/notes/assets/interview6.html.64688c44.js"><link rel="prefetch" href="/notes/assets/interview7.html.20d70ae4.js"><link rel="prefetch" href="/notes/assets/interview8.html.b2cfde5b.js"><link rel="prefetch" href="/notes/assets/interview9.html.05d43054.js"><link rel="prefetch" href="/notes/assets/404.html.a80f367c.js"><link rel="prefetch" href="/notes/assets/404.cd38f2df.js"><link rel="prefetch" href="/notes/assets/Layout.f13adff3.js">
    <link rel="stylesheet" href="/notes/assets/style.d23a4eb9.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/notes/" class=""><!----><!----></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><!----><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><!----><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">fiber 树构造(初次创建) <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/notes/react-illustration-series/main/fibertree-create.html#启动阶段" class="router-link-active router-link-exact-active sidebar-item" aria-label="启动阶段"><!--[--><!--]--> 启动阶段 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/react-illustration-series/main/fibertree-create.html#构造阶段" class="router-link-active router-link-exact-active sidebar-item" aria-label="构造阶段"><!--[--><!--]--> 构造阶段 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/notes/react-illustration-series/main/fibertree-create.html#循环构造" class="router-link-active router-link-exact-active sidebar-item" aria-label="循环构造"><!--[--><!--]--> 循环构造 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/react-illustration-series/main/fibertree-create.html#探寻阶段-beginwork" class="router-link-active router-link-exact-active sidebar-item" aria-label="探寻阶段 beginWork"><!--[--><!--]--> 探寻阶段 beginWork <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/react-illustration-series/main/fibertree-create.html#回溯阶段-completework" class="router-link-active router-link-exact-active sidebar-item" aria-label="回溯阶段 completeWork"><!--[--><!--]--> 回溯阶段 completeWork <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/notes/react-illustration-series/main/fibertree-create.html#过程图解" class="router-link-active router-link-exact-active sidebar-item" aria-label="过程图解"><!--[--><!--]--> 过程图解 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/react-illustration-series/main/fibertree-create.html#总结" class="router-link-active router-link-exact-active sidebar-item" aria-label="总结"><!--[--><!--]--> 总结 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="fiber-树构造-初次创建" tabindex="-1"><a class="header-anchor" href="#fiber-树构造-初次创建" aria-hidden="true">#</a> fiber 树构造(初次创建)</h1><p>本节的内容完全建立在前文<a href="/notes/react-illustration-series/main/fibertree-prepare.html" class="">fiber 树构造(基础准备)</a>中介绍的基础知识之上, 其中总结了<code>fiber 树构造</code>的 2 种情况:</p><ol><li>初次创建: 在<code>React</code>应用首次启动时, 界面还没有渲染, 此时并不会进入对比过程, 相当于直接构造一棵全新的树.</li><li>对比更新: <code>React</code>应用启动后, 界面已经渲染. 如果再次发生更新, 创建<code>新fiber</code>之前需要和<code>旧fiber</code>进行对比. 最后构造的 fiber 树有可能是全新的, 也可能是部分更新的.</li></ol><p>本节只讨论<code>初次创建</code>这种情况, 为了控制篇幅(本节直击核心源码, 不再介绍基础知识, 可参照<a href="/notes/react-illustration-series/main/fibertree-prepare.html" class="">fiber 树构造(基础准备)</a>)并突出<code>fiber 树构造</code>过程, 后文会在<code>Legacy</code>模式下进行分析(因为只讨论<code>fiber树构造</code>原理, <code>Concurrent</code>模式与<code>Legacy</code>没有区别).</p><p>本节示例代码如下(<a href="https://codesandbox.io/s/busy-jang-b26hy?file=/src/App.js" target="_blank" rel="noopener noreferrer">codesandbox 地址<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>):</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">App Mount</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">App 组件对应的fiber节点: </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_reactInternals<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;app&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>header<span class="token operator">&gt;</span>header<span class="token operator">&lt;</span><span class="token operator">/</span>header<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Content <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Content</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Content Mount</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Content 组件对应的fiber节点: </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_reactInternals<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>Fragment<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token number">2</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>Fragment<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="启动阶段" tabindex="-1"><a class="header-anchor" href="#启动阶段" aria-hidden="true">#</a> 启动阶段</h2><p>在前文<a href="/notes/react-illustration-series/main/bootstrap.html" class="">React 应用的启动过程</a>中分析了 3 种启动模式的差异, 在进入<code>react-reconciler</code>包之前(调用<code>updateContainer</code>之前), 内存状态图如下:</p><p>此时的内存结构如下</p><img src="/notes/assets/react-illustration-series/process-legacy.png" alt="demo"><p>根据这个结构, 可以在控制台中打出当前页面对应的<code>fiber</code>树(用于观察其结构):</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;root&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>_reactRootContainer<span class="token punctuation">.</span>_internalRoot<span class="token punctuation">.</span>current<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>然后进入<code>react-reconciler</code>包调用<a href="https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberReconciler.old.js#L250-L321" target="_blank" rel="noopener noreferrer">updateContainer 函数<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// ... 省略了部分代码</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">updateContainer</span><span class="token punctuation">(</span>
  <span class="token parameter"><span class="token literal-property property">element</span><span class="token operator">:</span> ReactNodeList<span class="token punctuation">,</span>
  <span class="token literal-property property">container</span><span class="token operator">:</span> OpaqueRoot<span class="token punctuation">,</span>
  <span class="token literal-property property">parentComponent</span><span class="token operator">:</span> <span class="token operator">?</span>React$Component<span class="token operator">&lt;</span>any<span class="token punctuation">,</span> any<span class="token operator">&gt;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">callback</span><span class="token operator">:</span> <span class="token operator">?</span>Function<span class="token punctuation">,</span></span>
<span class="token punctuation">)</span><span class="token operator">:</span> Lane <span class="token punctuation">{</span>
  <span class="token comment">// 获取当前时间戳</span>
  <span class="token keyword">const</span> current <span class="token operator">=</span> container<span class="token punctuation">.</span>current<span class="token punctuation">;</span>
  <span class="token keyword">const</span> eventTime <span class="token operator">=</span> <span class="token function">requestEventTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 1. 创建一个优先级变量(车道模型)</span>
  <span class="token keyword">const</span> lane <span class="token operator">=</span> <span class="token function">requestUpdateLane</span><span class="token punctuation">(</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 2. 根据车道优先级, 创建update对象, 并加入fiber.updateQueue.pending队列</span>
  <span class="token keyword">const</span> update <span class="token operator">=</span> <span class="token function">createUpdate</span><span class="token punctuation">(</span>eventTime<span class="token punctuation">,</span> lane<span class="token punctuation">)</span><span class="token punctuation">;</span>
  update<span class="token punctuation">.</span>payload <span class="token operator">=</span> <span class="token punctuation">{</span> element <span class="token punctuation">}</span><span class="token punctuation">;</span>
  callback <span class="token operator">=</span> callback <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> callback<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>callback <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    update<span class="token punctuation">.</span>callback <span class="token operator">=</span> callback<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">enqueueUpdate</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> update<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 3. 进入reconcier运作流程中的`输入`环节</span>
  <span class="token function">scheduleUpdateOnFiber</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> lane<span class="token punctuation">,</span> eventTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> lane<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>由于<code>update</code>对象的创建, 此时的内存结构如下:</p><img src="/notes/assets/react-illustration-series/update-container.png" alt="demo"><p>注意: 最初的<code>ReactElement</code>对象<code>&lt;App/&gt;</code>被挂载到<code>HostRootFiber.updateQueue.shared.pending.payload.element</code>中, 后文<code>fiber树构造</code>过程中会再次变动.</p><h2 id="构造阶段" tabindex="-1"><a class="header-anchor" href="#构造阶段" aria-hidden="true">#</a> 构造阶段</h2><p>为了突出构造过程,排除干扰,先把内存状态图中的<code>FiberRoot</code>和<code>HostRootFiber</code>单独提出来(后文在此基础上添加):</p><img src="/notes/assets/react-illustration-series/initial-status.png" alt="demo"><p>在<a href="https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberWorkLoop.old.js#L517-L619" target="_blank" rel="noopener noreferrer">scheduleUpdateOnFiber 函数<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>中:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// ...省略部分代码</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">scheduleUpdateOnFiber</span><span class="token punctuation">(</span>
  <span class="token parameter"><span class="token literal-property property">fiber</span><span class="token operator">:</span> Fiber<span class="token punctuation">,</span>
  <span class="token literal-property property">lane</span><span class="token operator">:</span> Lane<span class="token punctuation">,</span>
  <span class="token literal-property property">eventTime</span><span class="token operator">:</span> number<span class="token punctuation">,</span></span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 标记优先级</span>
  <span class="token keyword">const</span> root <span class="token operator">=</span> <span class="token function">markUpdateLaneFromFiberToRoot</span><span class="token punctuation">(</span>fiber<span class="token punctuation">,</span> lane<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>lane <span class="token operator">===</span> SyncLane<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>
      <span class="token punctuation">(</span>executionContext <span class="token operator">&amp;</span> LegacyUnbatchedContext<span class="token punctuation">)</span> <span class="token operator">!==</span> NoContext <span class="token operator">&amp;&amp;</span>
      <span class="token punctuation">(</span>executionContext <span class="token operator">&amp;</span> <span class="token punctuation">(</span>RenderContext <span class="token operator">|</span> CommitContext<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">===</span> NoContext
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 首次渲染, 直接进行`fiber构造`</span>
      <span class="token function">performSyncWorkOnRoot</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以看到, 在<code>Legacy</code>模式下且首次渲染时, 有 2 个函数<a href="https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberWorkLoop.old.js#L625-L667" target="_blank" rel="noopener noreferrer">markUpdateLaneFromFiberToRoot<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>和<a href="https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberWorkLoop.old.js#L965-L1045" target="_blank" rel="noopener noreferrer">performSyncWorkOnRoot<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><p>其中<code>markUpdateLaneFromFiberToRoot(fiber, lane)</code>函数在<code>fiber树构造(对比更新)</code>中才会发挥作用, 因为在<code>初次创建</code>时并没有与当前页面所对应的<code>fiber树</code>, 所以核心代码并没有执行, 最后直接返回了<code>FiberRoot</code>对象.</p><p><code>performSyncWorkOnRoot</code>看起来源码很多, <code>初次创建</code>中真正用到的就 2 个函数:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">performSyncWorkOnRoot</span><span class="token punctuation">(</span><span class="token parameter">root</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> lanes<span class="token punctuation">;</span>
  <span class="token keyword">let</span> exitStatus<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>
    root <span class="token operator">===</span> workInProgressRoot <span class="token operator">&amp;&amp;</span>
    <span class="token function">includesSomeLane</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>expiredLanes<span class="token punctuation">,</span> workInProgressRootRenderLanes<span class="token punctuation">)</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 初次构造时(因为root=fiberRoot, workInProgressRoot=null), 所以不会进入</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1. 获取本次render的优先级, 初次构造返回 NoLanes</span>
    lanes <span class="token operator">=</span> <span class="token function">getNextLanes</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> NoLanes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 2. 从root节点开始, 至上而下更新</span>
    exitStatus <span class="token operator">=</span> <span class="token function">renderRootSync</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> lanes<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 将最新的fiber树挂载到root.finishedWork节点上</span>
  <span class="token keyword">const</span> <span class="token literal-property property">finishedWork</span><span class="token operator">:</span> Fiber <span class="token operator">=</span> <span class="token punctuation">(</span>root<span class="token punctuation">.</span>current<span class="token punctuation">.</span>alternate<span class="token operator">:</span> any<span class="token punctuation">)</span><span class="token punctuation">;</span>
  root<span class="token punctuation">.</span>finishedWork <span class="token operator">=</span> finishedWork<span class="token punctuation">;</span>
  root<span class="token punctuation">.</span>finishedLanes <span class="token operator">=</span> lanes<span class="token punctuation">;</span>
  <span class="token comment">// 进入commit阶段</span>
  <span class="token function">commitRoot</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// ...后面的内容本节不讨论</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中<code>getNextLanes</code>返回本次 render 的渲染优先级(详见<a href="/notes/react-illustration-series/main/fibertree-prepare.html#%E4%BC%98%E5%85%88%E7%BA%A7" class="">fiber 树构造(基础准备)</a>中<code>优先级</code>相关小节)</p><p><a href="https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberWorkLoop.old.js#L1490-L1553" target="_blank" rel="noopener noreferrer">renderRootSync<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">renderRootSync</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">root</span><span class="token operator">:</span> FiberRoot<span class="token punctuation">,</span> <span class="token literal-property property">lanes</span><span class="token operator">:</span> Lanes</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> prevExecutionContext <span class="token operator">=</span> executionContext<span class="token punctuation">;</span>
  executionContext <span class="token operator">|=</span> RenderContext<span class="token punctuation">;</span>
  <span class="token comment">// 如果fiberRoot变动, 或者update.lane变动, 都会刷新栈帧, 丢弃上一次渲染进度</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>workInProgressRoot <span class="token operator">!==</span> root <span class="token operator">||</span> workInProgressRootRenderLanes <span class="token operator">!==</span> lanes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 刷新栈帧, legacy模式下都会进入</span>
    <span class="token function">prepareFreshStack</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> lanes<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">do</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token function">workLoopSync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>thrownValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">handleError</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> thrownValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  executionContext <span class="token operator">=</span> prevExecutionContext<span class="token punctuation">;</span>
  <span class="token comment">// 重置全局变量, 表明render结束</span>
  workInProgressRoot <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  workInProgressRootRenderLanes <span class="token operator">=</span> NoLanes<span class="token punctuation">;</span>
  <span class="token keyword">return</span> workInProgressRootExitStatus<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在<code>renderRootSync</code>中, 在执行<code>fiber树构造</code>前(<code>workLoopSync</code>)会先刷新栈帧<code>prepareFreshStack</code>(参考<a href="/notes/react-illustration-series/main/fibertree-prepare.html#%E6%A0%88%E5%B8%A7%E7%AE%A1%E7%90%86" class="">fiber 树构造(基础准备)</a>).在这里创建了<code>HostRootFiber.alternate</code>, 重置全局变量<code>workInProgress</code>和<code>workInProgressRoot</code>等.</p><img src="/notes/assets/react-illustration-series/status-freshstack.png" alt="demo"><h3 id="循环构造" tabindex="-1"><a class="header-anchor" href="#循环构造" aria-hidden="true">#</a> 循环构造</h3><p>逻辑来到<code>workLoopSync</code>, 虽然本节在<code>Legacy</code>模式下进行讨论, 此处还是对比一下<code>workLoopConcurrent</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">workLoopSync</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>workInProgress <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">performUnitOfWork</span><span class="token punctuation">(</span>workInProgress<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">workLoopConcurrent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Perform work until Scheduler asks us to yield</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>workInProgress <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">shouldYield</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">performUnitOfWork</span><span class="token punctuation">(</span>workInProgress<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以看到<code>workLoopConcurrent</code>相比于<code>Sync</code>, 会多一个停顿机制, 这个机制实现了<code>时间切片</code>和<code>可中断渲染</code>(参考<a href="/notes/react-illustration-series/main/scheduler.html#%E6%97%B6%E9%97%B4%E5%88%87%E7%89%87%E5%8E%9F%E7%90%86" class="">React 调度原理</a>)</p><p>结合<code>performUnitOfWork函数</code>(<a href="https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberWorkLoop.old.js#L1642-L1668" target="_blank" rel="noopener noreferrer">源码地址<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>)</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// ... 省略部分无关代码</span>
<span class="token keyword">function</span> <span class="token function">performUnitOfWork</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">unitOfWork</span><span class="token operator">:</span> Fiber</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
  <span class="token comment">// unitOfWork就是被传入的workInProgress</span>
  <span class="token keyword">const</span> current <span class="token operator">=</span> unitOfWork<span class="token punctuation">.</span>alternate<span class="token punctuation">;</span>
  <span class="token keyword">let</span> next<span class="token punctuation">;</span>
  next <span class="token operator">=</span> <span class="token function">beginWork</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> unitOfWork<span class="token punctuation">,</span> subtreeRenderLanes<span class="token punctuation">)</span><span class="token punctuation">;</span>
  unitOfWork<span class="token punctuation">.</span>memoizedProps <span class="token operator">=</span> unitOfWork<span class="token punctuation">.</span>pendingProps<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>next <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果没有派生出新的节点, 则进入completeWork阶段, 传入的是当前unitOfWork</span>
    <span class="token function">completeUnitOfWork</span><span class="token punctuation">(</span>unitOfWork<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    workInProgress <span class="token operator">=</span> next<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以明显的看出, 整个<code>fiber树构造</code>是一个深度优先遍历(可参考<a href="/notes/react-illustration-series/algorithm/dfs.html" class="">React 算法之深度优先遍历</a>), 其中有 2 个重要的变量<code>workInProgress</code>和<code>current</code>(可参考前文<a href="/notes/react-illustration-series/main/fibertree-prepare.html#%E5%8F%8C%E7%BC%93%E5%86%B2%E6%8A%80%E6%9C%AF" class="">fiber 树构造(基础准备)</a>中介绍的<code>双缓冲技术</code>):</p><ul><li><code>workInProgress</code>和<code>current</code>都视为指针</li><li><code>workInProgress</code>指向当前正在构造的<code>fiber</code>节点</li><li><code>current = workInProgress.alternate</code>(即<code>fiber.alternate</code>), 指向当前页面正在使用的<code>fiber</code>节点. 初次构造时, 页面还未渲染, 此时<code>current = null</code>.</li></ul><p>在深度优先遍历中, 每个<code>fiber</code>节点都会经历 2 个阶段:</p><ol><li>探寻阶段 <code>beginWork</code></li><li>回溯阶段 <code>completeWork</code></li></ol><p>这 2 个阶段共同完成了每一个<code>fiber</code>节点的创建, 所有<code>fiber</code>节点则构成了<code>fiber树</code>.</p><h3 id="探寻阶段-beginwork" tabindex="-1"><a class="header-anchor" href="#探寻阶段-beginwork" aria-hidden="true">#</a> 探寻阶段 beginWork</h3><p><code>beginWork(current, unitOfWork, subtreeRenderLanes)</code>(<a href="https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberBeginWork.old.js#L3083-L3494" target="_blank" rel="noopener noreferrer">源码地址<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>)针对所有的 Fiber 类型, 其中的每一个 case 处理一种 Fiber 类型. <code>updateXXX</code>函数(如: <code>updateHostRoot</code>, <code>updateClassComponent</code> 等)的主要逻辑:</p><ol><li>根据 <code>ReactElement</code>对象创建所有的<code>fiber</code>节点, 最终构造出<code>fiber树形结构</code>(设置<code>return</code>和<code>sibling</code>指针)</li><li>设置<code>fiber.flags</code>(二进制形式变量, 用来标记 <code>fiber</code>节点 的<code>增,删,改</code>状态, 等待<code>completeWork阶段处理</code>)</li><li>设置<code>fiber.stateNode</code>局部状态(如<code>Class类型</code>节点: <code>fiber.stateNode=new Class()</code>)</li></ol><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">beginWork</span><span class="token punctuation">(</span>
  <span class="token parameter"><span class="token literal-property property">current</span><span class="token operator">:</span> Fiber <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  <span class="token literal-property property">workInProgress</span><span class="token operator">:</span> Fiber<span class="token punctuation">,</span>
  <span class="token literal-property property">renderLanes</span><span class="token operator">:</span> Lanes<span class="token punctuation">,</span></span>
<span class="token punctuation">)</span><span class="token operator">:</span> Fiber <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> updateLanes <span class="token operator">=</span> workInProgress<span class="token punctuation">.</span>lanes<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>current <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// update逻辑, 首次render不会进入</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    didReceiveUpdate <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 1. 设置workInProgress优先级为NoLanes(最高优先级)</span>
  workInProgress<span class="token punctuation">.</span>lanes <span class="token operator">=</span> NoLanes<span class="token punctuation">;</span>
  <span class="token comment">// 2. 根据workInProgress节点的类型, 用不同的方法派生出子节点</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>
    workInProgress<span class="token punctuation">.</span>tag <span class="token comment">// 只保留了本例使用到的case</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token literal-property property">ClassComponent</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> Component <span class="token operator">=</span> workInProgress<span class="token punctuation">.</span>type<span class="token punctuation">;</span>
      <span class="token keyword">const</span> unresolvedProps <span class="token operator">=</span> workInProgress<span class="token punctuation">.</span>pendingProps<span class="token punctuation">;</span>
      <span class="token keyword">const</span> resolvedProps <span class="token operator">=</span>
        workInProgress<span class="token punctuation">.</span>elementType <span class="token operator">===</span> Component
          <span class="token operator">?</span> unresolvedProps
          <span class="token operator">:</span> <span class="token function">resolveDefaultProps</span><span class="token punctuation">(</span>Component<span class="token punctuation">,</span> unresolvedProps<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">updateClassComponent</span><span class="token punctuation">(</span>
        current<span class="token punctuation">,</span>
        workInProgress<span class="token punctuation">,</span>
        Component<span class="token punctuation">,</span>
        resolvedProps<span class="token punctuation">,</span>
        renderLanes<span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">case</span> <span class="token literal-property property">HostRoot</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token function">updateHostRoot</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> workInProgress<span class="token punctuation">,</span> renderLanes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token literal-property property">HostComponent</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token function">updateHostComponent</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> workInProgress<span class="token punctuation">,</span> renderLanes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token literal-property property">HostText</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token function">updateHostText</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> workInProgress<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token literal-property property">Fragment</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token function">updateFragment</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> workInProgress<span class="token punctuation">,</span> renderLanes<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>updateXXX</code>函数(如: updateHostRoot, updateClassComponent 等)虽然 case 较多, 但是主要逻辑可以概括为 3 个步骤:</p><ol><li>根据<code>fiber.pendingProps, fiber.updateQueue</code>等<code>输入数据</code>状态, 计算<code>fiber.memoizedState</code>作为<code>输出状态</code></li><li>获取下级<code>ReactElement</code>对象 <ol><li>class 类型的 <code>fiber</code> 节点 <ul><li>构建<code>React.Component</code>实例</li><li>把新实例挂载到<code>fiber.stateNode</code>上</li><li>执行<code>render</code>之前的生命周期函数</li><li>执行<code>render</code>方法, 获取下级<code>reactElement</code></li><li>根据实际情况, 设置<code>fiber.flags</code></li></ul></li><li>function 类型的 <code>fiber</code> 节点 <ul><li>执行 function, 获取下级<code>reactElement</code></li><li>根据实际情况, 设置<code>fiber.flags</code></li></ul></li><li>HostComponent 类型(如: <code>div, span, button</code> 等)的 <code>fiber</code> 节点 <ul><li><code>pendingProps.children</code>作为下级<code>reactElement</code></li><li>如果下级节点是文本节点,则设置下级节点为 null. 准备进入<code>completeUnitOfWork</code>阶段</li><li>根据实际情况, 设置<code>fiber.flags</code></li></ul></li><li>其他类型...</li></ol></li><li>根据<code>ReactElement</code>对象, 调用<code>reconcilerChildren</code>生成<code>Fiber</code>子节点(只生成<code>次级子节点</code>) <ul><li>根据实际情况, 设置<code>fiber.flags</code></li></ul></li></ol><p>不同的<code>updateXXX</code>函数处理的<code>fiber</code>节点类型不同, 总的目的是为了向下生成子节点. 在这个过程中把一些需要持久化的数据挂载到<code>fiber</code>节点上(如<code>fiber.stateNode</code>,<code>fiber.memoizedState</code>等); 把<code>fiber</code>节点的特殊操作设置到<code>fiber.flags</code>(如:<code>节点ref</code>,<code>class组件的生命周期</code>,<code>function组件的hook</code>,<code>节点删除</code>等).</p><p>这里列出<code>updateHostRoot</code>, <code>updateHostComponent</code>的代码, 对于其他常用 case 的分析(如<code>class</code>类型, <code>function</code>类型), 在<code>状态组件</code>章节中进行探讨.</p><p><code>fiber树</code>的根节点是<code>HostRootFiber</code>节点, 所以第一次进入<code>beginWork</code>会调用<a href="https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberBeginWork.old.js#L1053-L1122" target="_blank" rel="noopener noreferrer">updateHostRoot(current, workInProgress, renderLanes)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 省略与本节无关代码</span>
<span class="token keyword">function</span> <span class="token function">updateHostRoot</span><span class="token punctuation">(</span><span class="token parameter">current<span class="token punctuation">,</span> workInProgress<span class="token punctuation">,</span> renderLanes</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 1. 状态计算, 更新整合到 workInProgress.memoizedState中来</span>
  <span class="token keyword">const</span> updateQueue <span class="token operator">=</span> workInProgress<span class="token punctuation">.</span>updateQueue<span class="token punctuation">;</span>
  <span class="token keyword">const</span> nextProps <span class="token operator">=</span> workInProgress<span class="token punctuation">.</span>pendingProps<span class="token punctuation">;</span>
  <span class="token keyword">const</span> prevState <span class="token operator">=</span> workInProgress<span class="token punctuation">.</span>memoizedState<span class="token punctuation">;</span>
  <span class="token keyword">const</span> prevChildren <span class="token operator">=</span> prevState <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">?</span> prevState<span class="token punctuation">.</span>element <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token function">cloneUpdateQueue</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> workInProgress<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 遍历updateQueue.shared.pending, 提取有足够优先级的update对象, 计算出最终的状态 workInProgress.memoizedState</span>
  <span class="token function">processUpdateQueue</span><span class="token punctuation">(</span>workInProgress<span class="token punctuation">,</span> nextProps<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> renderLanes<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> nextState <span class="token operator">=</span> workInProgress<span class="token punctuation">.</span>memoizedState<span class="token punctuation">;</span>
  <span class="token comment">// 2. 获取下级`ReactElement`对象</span>
  <span class="token keyword">const</span> nextChildren <span class="token operator">=</span> nextState<span class="token punctuation">.</span>element<span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token literal-property property">root</span><span class="token operator">:</span> FiberRoot <span class="token operator">=</span> workInProgress<span class="token punctuation">.</span>stateNode<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token punctuation">.</span>hydrate <span class="token operator">&amp;&amp;</span> <span class="token function">enterHydrationState</span><span class="token punctuation">(</span>workInProgress<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...服务端渲染相关, 此处省略</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// 3. 根据`ReactElement`对象, 调用`reconcilerChildren`生成`Fiber`子节点(只生成`次级子节点`)</span>
    <span class="token function">reconcileChildren</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> workInProgress<span class="token punctuation">,</span> nextChildren<span class="token punctuation">,</span> renderLanes<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> workInProgress<span class="token punctuation">.</span>child<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>普通 DOM 标签类型的节点(如<code>div</code>,<code>span</code>,<code>p</code>),会进入<a href="https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberBeginWork.old.js#L1124-L1157" target="_blank" rel="noopener noreferrer">updateHostComponent<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// ...省略部分无关代码</span>
<span class="token keyword">function</span> <span class="token function">updateHostComponent</span><span class="token punctuation">(</span>
  <span class="token parameter"><span class="token literal-property property">current</span><span class="token operator">:</span> Fiber <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  <span class="token literal-property property">workInProgress</span><span class="token operator">:</span> Fiber<span class="token punctuation">,</span>
  <span class="token literal-property property">renderLanes</span><span class="token operator">:</span> Lanes<span class="token punctuation">,</span></span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 1. 状态计算, 由于HostComponent是无状态组件, 所以只需要收集 nextProps即可, 它没有 memoizedState</span>
  <span class="token keyword">const</span> type <span class="token operator">=</span> workInProgress<span class="token punctuation">.</span>type<span class="token punctuation">;</span>
  <span class="token keyword">const</span> nextProps <span class="token operator">=</span> workInProgress<span class="token punctuation">.</span>pendingProps<span class="token punctuation">;</span>
  <span class="token keyword">const</span> prevProps <span class="token operator">=</span> current <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">?</span> current<span class="token punctuation">.</span>memoizedProps <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token comment">// 2. 获取下级`ReactElement`对象</span>
  <span class="token keyword">let</span> nextChildren <span class="token operator">=</span> nextProps<span class="token punctuation">.</span>children<span class="token punctuation">;</span>
  <span class="token keyword">const</span> isDirectTextChild <span class="token operator">=</span> <span class="token function">shouldSetTextContent</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> nextProps<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>isDirectTextChild<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果子节点只有一个文本节点, 不用再创建一个HostText类型的fiber</span>
    nextChildren <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>prevProps <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token function">shouldSetTextContent</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> prevProps<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 特殊操作需要设置fiber.flags</span>
    workInProgress<span class="token punctuation">.</span>flags <span class="token operator">|=</span> ContentReset<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 特殊操作需要设置fiber.flags</span>
  <span class="token function">markRef</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> workInProgress<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 3. 根据`ReactElement`对象, 调用`reconcilerChildren`生成`Fiber`子节点(只生成`次级子节点`)</span>
  <span class="token function">reconcileChildren</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> workInProgress<span class="token punctuation">,</span> nextChildren<span class="token punctuation">,</span> renderLanes<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> workInProgress<span class="token punctuation">.</span>child<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="回溯阶段-completework" tabindex="-1"><a class="header-anchor" href="#回溯阶段-completework" aria-hidden="true">#</a> 回溯阶段 completeWork</h3><p><code>completeUnitOfWork(unitOfWork)</code>(<a href="https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberWorkLoop.old.js#L1670-L1802" target="_blank" rel="noopener noreferrer">源码地址<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>), 处理 <code>beginWork</code> 阶段已经创建出来的 <code>fiber</code> 节点, 核心逻辑:</p><ol><li>调用<code>completeWork</code><ul><li>给<code>fiber</code>节点(tag=HostComponent, HostText)创建 DOM 实例, 设置<code>fiber.stateNode</code>局部状态(如<code>tag=HostComponent, HostText</code>节点: fiber.stateNode 指向这个 DOM 实例).</li><li>为 DOM 节点设置属性, 绑定事件(这里先说明有这个步骤, 详细的事件处理流程, 在<code>合成事件原理</code>中详细说明).</li><li>设置<code>fiber.flags</code>标记</li></ul></li><li>把当前 <code>fiber</code> 对象的副作用队列(<code>firstEffect</code>和<code>lastEffect</code>)添加到父节点的副作用队列之后, 更新父节点的<code>firstEffect</code>和<code>lastEffect</code>指针.</li><li>识别<code>beginWork</code>阶段设置的<code>fiber.flags</code>, 判断当前 <code>fiber</code> 是否有副作用(增,删,改), 如果有, 需要将当前 <code>fiber</code> 加入到父节点的<code>effects</code>队列, 等待<code>commit</code>阶段处理.</li></ol><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">completeUnitOfWork</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">unitOfWork</span><span class="token operator">:</span> Fiber</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> completedWork <span class="token operator">=</span> unitOfWork<span class="token punctuation">;</span>
  <span class="token comment">// 外层循环控制并移动指针(`workInProgress`,`completedWork`等)</span>
  <span class="token keyword">do</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> current <span class="token operator">=</span> completedWork<span class="token punctuation">.</span>alternate<span class="token punctuation">;</span>
    <span class="token keyword">const</span> returnFiber <span class="token operator">=</span> completedWork<span class="token punctuation">.</span>return<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>completedWork<span class="token punctuation">.</span>flags <span class="token operator">&amp;</span> Incomplete<span class="token punctuation">)</span> <span class="token operator">===</span> NoFlags<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> next<span class="token punctuation">;</span>
      <span class="token comment">// 1. 处理Fiber节点, 会调用渲染器(调用react-dom包, 关联Fiber节点和dom对象, 绑定事件等)</span>
      next <span class="token operator">=</span> <span class="token function">completeWork</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> completedWork<span class="token punctuation">,</span> subtreeRenderLanes<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 处理单个节点</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>next <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 如果派生出其他的子节点, 则回到`beginWork`阶段进行处理</span>
        workInProgress <span class="token operator">=</span> next<span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 重置子节点的优先级</span>
      <span class="token function">resetChildLanes</span><span class="token punctuation">(</span>completedWork<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>
        returnFiber <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span>
        <span class="token punctuation">(</span>returnFiber<span class="token punctuation">.</span>flags <span class="token operator">&amp;</span> Incomplete<span class="token punctuation">)</span> <span class="token operator">===</span> NoFlags
      <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 2. 收集当前Fiber节点以及其子树的副作用effects</span>
        <span class="token comment">// 2.1 把子节点的副作用队列添加到父节点上</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>returnFiber<span class="token punctuation">.</span>firstEffect <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          returnFiber<span class="token punctuation">.</span>firstEffect <span class="token operator">=</span> completedWork<span class="token punctuation">.</span>firstEffect<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>completedWork<span class="token punctuation">.</span>lastEffect <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>returnFiber<span class="token punctuation">.</span>lastEffect <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            returnFiber<span class="token punctuation">.</span>lastEffect<span class="token punctuation">.</span>nextEffect <span class="token operator">=</span> completedWork<span class="token punctuation">.</span>firstEffect<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          returnFiber<span class="token punctuation">.</span>lastEffect <span class="token operator">=</span> completedWork<span class="token punctuation">.</span>lastEffect<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 2.2 如果当前fiber节点有副作用, 将其添加到子节点的副作用队列之后.</span>
        <span class="token keyword">const</span> flags <span class="token operator">=</span> completedWork<span class="token punctuation">.</span>flags<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>flags <span class="token operator">&gt;</span> PerformedWork<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// PerformedWork是提供给 React DevTools读取的, 所以略过PerformedWork</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>returnFiber<span class="token punctuation">.</span>lastEffect <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            returnFiber<span class="token punctuation">.</span>lastEffect<span class="token punctuation">.</span>nextEffect <span class="token operator">=</span> completedWork<span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            returnFiber<span class="token punctuation">.</span>firstEffect <span class="token operator">=</span> completedWork<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          returnFiber<span class="token punctuation">.</span>lastEffect <span class="token operator">=</span> completedWork<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// 异常处理, 本节不讨论</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> siblingFiber <span class="token operator">=</span> completedWork<span class="token punctuation">.</span>sibling<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>siblingFiber <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 如果有兄弟节点, 返回之后再次进入`beginWork`阶段</span>
      workInProgress <span class="token operator">=</span> siblingFiber<span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 移动指针, 指向下一个节点</span>
    completedWork <span class="token operator">=</span> returnFiber<span class="token punctuation">;</span>
    workInProgress <span class="token operator">=</span> completedWork<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>completedWork <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 已回溯到根节点, 设置workInProgressRootExitStatus = RootCompleted</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>workInProgressRootExitStatus <span class="token operator">===</span> RootIncomplete<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    workInProgressRootExitStatus <span class="token operator">=</span> RootCompleted<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>接下来分析<code>fiber</code>处理函数<a href="https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberCompleteWork.old.js#L645-L1289" target="_blank" rel="noopener noreferrer">completeWork<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">completeWork</span><span class="token punctuation">(</span>
  <span class="token parameter"><span class="token literal-property property">current</span><span class="token operator">:</span> Fiber <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  <span class="token literal-property property">workInProgress</span><span class="token operator">:</span> Fiber<span class="token punctuation">,</span>
  <span class="token literal-property property">renderLanes</span><span class="token operator">:</span> Lanes<span class="token punctuation">,</span></span>
<span class="token punctuation">)</span><span class="token operator">:</span> Fiber <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> newProps <span class="token operator">=</span> workInProgress<span class="token punctuation">.</span>pendingProps<span class="token punctuation">;</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>workInProgress<span class="token punctuation">.</span>tag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token literal-property property">ClassComponent</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// Class类型不做处理</span>
      <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">case</span> <span class="token literal-property property">HostRoot</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> fiberRoot <span class="token operator">=</span> <span class="token punctuation">(</span>workInProgress<span class="token punctuation">.</span>stateNode<span class="token operator">:</span> FiberRoot<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>fiberRoot<span class="token punctuation">.</span>pendingContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        fiberRoot<span class="token punctuation">.</span>context <span class="token operator">=</span> fiberRoot<span class="token punctuation">.</span>pendingContext<span class="token punctuation">;</span>
        fiberRoot<span class="token punctuation">.</span>pendingContext <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>current <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> current<span class="token punctuation">.</span>child <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token comment">// 设置fiber.flags标记</span>
         workInProgress<span class="token punctuation">.</span>flags <span class="token operator">|=</span> Snapshot<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">case</span> <span class="token literal-property property">HostComponent</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function">popHostContext</span><span class="token punctuation">(</span>workInProgress<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> rootContainerInstance <span class="token operator">=</span> <span class="token function">getRootHostContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> type <span class="token operator">=</span> workInProgress<span class="token punctuation">.</span>type<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>current <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> workInProgress<span class="token punctuation">.</span>stateNode <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// update逻辑, 初次render不会进入</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> currentHostContext <span class="token operator">=</span> <span class="token function">getHostContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 1. 创建DOM对象</span>
        <span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token function">createInstance</span><span class="token punctuation">(</span>
          type<span class="token punctuation">,</span>
          newProps<span class="token punctuation">,</span>
          rootContainerInstance<span class="token punctuation">,</span>
          currentHostContext<span class="token punctuation">,</span>
          workInProgress<span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2. 把子树中的DOM对象append到本节点的DOM对象之后</span>
        <span class="token function">appendAllChildren</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> workInProgress<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 设置stateNode属性, 指向DOM对象</span>
        workInProgress<span class="token punctuation">.</span>stateNode <span class="token operator">=</span> instance<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>
          <span class="token comment">// 3. 设置DOM对象的属性, 绑定事件等</span>
          <span class="token function">finalizeInitialChildren</span><span class="token punctuation">(</span>
            instance<span class="token punctuation">,</span>
            type<span class="token punctuation">,</span>
            newProps<span class="token punctuation">,</span>
            rootContainerInstance<span class="token punctuation">,</span>
            currentHostContext<span class="token punctuation">,</span>
          <span class="token punctuation">)</span>
        <span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 设置fiber.flags标记(Update)</span>
          <span class="token function">markUpdate</span><span class="token punctuation">(</span>workInProgress<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>workInProgress<span class="token punctuation">.</span>ref <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 设置fiber.flags标记(Ref)</span>
          <span class="token function">markRef</span><span class="token punctuation">(</span>workInProgress<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以看到在满足条件的时候也会设置<code>fiber.flags</code>, 所以设置<code>fiber.flags</code>并非只在<code>beginWork</code>阶段.</p><h2 id="过程图解" tabindex="-1"><a class="header-anchor" href="#过程图解" aria-hidden="true">#</a> 过程图解</h2><p>针对本节的示例代码, 将整个<code>fiber</code>树构造过程表示出来:</p><p>构造前:</p><p>在上文已经说明, 进入循环构造前会调用<code>prepareFreshStack</code>刷新栈帧, 在进入<code>fiber树构造</code>循环之前, 保持这这个初始化状态:</p><img src="/notes/assets/react-illustration-series/unitofwork0.png" alt="demo"><p><code>performUnitOfWork</code>第 1 次调用(只执行<code>beginWork</code>):</p><ul><li>执行前: <code>workInProgress</code>指针指向<code>HostRootFiber.alternate</code>对象, 此时<code>current = workInProgress.alternate</code>指向<code>fiberRoot.current</code>是非空的(初次构造, 只在根节点时, <code>current</code>非空).</li><li>执行过程: 调用<code>updateHostRoot</code><ul><li>在<code>reconcilerChildren</code>阶段, 向下构造<code>次级子节点fiber(&lt;App/&gt;)</code>, 同时设置子节点(<code>fiber(&lt;App/&gt;)</code>)<a href="https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactChildFiber.old.js#L376-L378" target="_blank" rel="noopener noreferrer">fiber.flags |= Placement<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></li><li>执行后: 返回下级节点<code>fiber(&lt;App/&gt;)</code>, 移动<code>workInProgress</code>指针指向子节点<code>fiber(&lt;App/&gt;)</code></li></ul><img src="/notes/assets/react-illustration-series/unitofwork1.png" alt="demo"><p><code>performUnitOfWork</code>第 2 次调用(只执行<code>beginWork</code>):</p><ul><li>执行前: <code>workInProgress</code>指针指向<code>fiber(&lt;App/&gt;)</code>节点, 此时<code>current = null</code></li><li>执行过程: 调用<code>updateClassComponent</code><ul><li>本示例中, class 实例存在生命周期函数<code>componentDidMount</code>, 所以会设置<code>fiber(&lt;App/&gt;)</code>节点<a href="https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberClassComponent.old.js#L892-L894" target="_blank" rel="noopener noreferrer">workInProgress.flags |= Update<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>另外也会为了<code>React DevTools</code>能够识别状态组件的执行进度, 会设置<a href="https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberBeginWork.old.js#L379" target="_blank" rel="noopener noreferrer">workInProgress.flags |= PerformedWork<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>(在<code>commit</code>阶段会排除这个<code>flag</code>, 此处只是列出<code>workInProgress.flags</code>的设置场景, 不讨论<code>React DevTools</code>)</li><li>需要注意<code>classInstance.render()</code>在本步骤执行后, 虽然返回了<code>render</code>方法中所有的<code>ReactElement</code>对象, 但是随后<code>reconcilerChildren</code>只构造<code>次级子节点</code></li><li>在<code>reconcilerChildren</code>阶段, 向下构造<code>次级子节点div</code></li></ul></li><li>执行后: 返回下级节点<code>fiber(div)</code>, 移动<code>workInProgress</code>指针指向子节点<code>fiber(div)</code></li></ul><img src="/notes/assets/react-illustration-series/unitofwork2.png" alt="demo"><p><code>performUnitOfWork</code>第 3 次调用(只执行<code>beginWork</code>):</p><ul><li>执行前: <code>workInProgress</code>指针指向<code>fiber(div)</code>节点, 此时<code>current = null</code></li><li>执行过程: 调用<code>updateHostComponent</code><ul><li>在<code>reconcilerChildren</code>阶段, 向下构造<code>次级子节点</code>(本示例中, <code>div</code>有 2 个次级子节点)</li></ul></li><li>执行后: 返回下级节点<code>fiber(header)</code>, 移动<code>workInProgress</code>指针指向子节点<code>fiber(header)</code></li></ul><img src="/notes/assets/react-illustration-series/unitofwork3.png" alt="demo"><p><code>performUnitOfWork</code>第 4 次调用(执行<code>beginWork</code>和<code>completeUnitOfWork</code>):</p><ul><li><code>beginWork</code>执行前: <code>workInProgress</code>指针指向<code>fiber(header)</code>节点, 此时<code>current = null</code></li><li><code>beginWork</code>执行过程: 调用<code>updateHostComponent</code><ul><li>本示例中<code>header</code>的子节点是一个<a href="https://github.com/facebook/react/blob/8e5adfbd7e605bda9c5e96c10e015b3dc0df688e/packages/react-dom/src/client/ReactDOMHostConfig.js#L350-L361" target="_blank" rel="noopener noreferrer">直接文本节点<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>,设置<a href="https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberBeginWork.old.js#L1147" target="_blank" rel="noopener noreferrer">nextChildren = null<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>(直接文本节点并不会被当成具体的<code>fiber</code>节点进行处理, 而是在宿主环境(父组件)中通过属性进行设置. 所以无需创建<code>HostText</code>类型的fiber节点, 同时节省了向下遍历开销.).</li><li>由于<code>nextChildren = null</code>, 经过<code>reconcilerChildren</code>阶段处理后, 返回值也是<code>null</code></li></ul></li><li><code>beginWork</code>执行后: 由于下级节点为<code>null</code>, 所以进入<code>completeUnitOfWork(unitOfWork)</code>函数, 传入的参数<code>unitOfWork</code>实际上就是<code>workInProgress</code>(此时指向<code>fiber(header)</code>节点)</li></ul><img src="/notes/assets/react-illustration-series/unitofwork4.1.png" alt="demo"><ul><li><code>completeUnitOfWork</code>执行前: <code>workInProgress</code>指针指向<code>fiber(header)</code>节点</li><li><code>completeUnitOfWork</code>执行过程: 以<code>fiber(header)</code>为起点, 向上回溯</li></ul><p>第 1 次循环:</p><ol><li>执行<code>completeWork</code>函数 <ul><li>创建<code>fiber(header)</code>节点对应的<code>DOM</code>实例, 并<code>append</code>子节点的<code>DOM</code>实例</li><li>设置<code>DOM</code>属性, 绑定事件等(本示例中, 节点<code>fiber(header)</code>没有事件绑定)</li></ul></li><li>上移副作用队列: 由于本节点<code>fiber(header)</code>没有副作用(<code>fiber.flags = 0</code>), 所以执行之后副作用队列没有实质变化(目前为空).</li><li>向上回溯: 由于还有兄弟节点, 把<code>workInProgress</code>指针指向下一个兄弟节点<code>fiber(&lt;Content/&gt;)</code>, 退出<code>completeUnitOfWork</code>.</li></ol><img src="/notes/assets/react-illustration-series/unitofwork4.2.png" alt="demo"><p><code>performUnitOfWork</code>第 5 次调用(执行<code>beginWork</code>):</p><ul><li>执行前:<code>workInProgress</code>指针指向<code>fiber(&lt;Content/&gt;)</code>节点.</li><li>执行过程: 这是一个<code>class</code>类型的节点, 与第 2 次调用逻辑一致.</li><li>执行后: 返回下级节点<code>fiber(p)</code>, 移动<code>workInProgress</code>指针指向子节点<code>fiber(p)</code></li></ul><img src="/notes/assets/react-illustration-series/unitofwork5.png" alt="demo"><p><code>performUnitOfWork</code>第 6 次调用(执行<code>beginWork</code>和<code>completeUnitOfWork</code>):与第 4 次调用中创建<code>fiber(header)</code>节点的逻辑一致. 先后会执行<code>beginWork</code>和<code>completeUnitOfWork</code>, 最后构造 DOM 实例, 并将把<code>workInProgress</code>指针指向下一个兄弟节点<code>fiber(p)</code>.</p><img src="/notes/assets/react-illustration-series/unitofwork6.png" alt="demo"><p><code>performUnitOfWork</code>第 7 次调用(执行<code>beginWork</code>和<code>completeUnitOfWork</code>):</p><ul><li><code>beginWork</code>执行过程: 与上次调用中创建<code>fiber(p)</code>节点的逻辑一致</li><li><code>completeUnitOfWork</code>执行过程: 以<code>fiber(p)</code>为起点, 向上回溯</li></ul><p>第 1 次循环:</p><ol><li>执行<code>completeWork</code>函数: 创建<code>fiber(p)</code>节点对应的<code>DOM</code>实例, 并<code>append</code>子树节点的<code>DOM</code>实例</li><li>上移副作用队列: 由于本节点<code>fiber(p)</code>没有副作用, 所以执行之后副作用队列没有实质变化(目前为空).</li><li>向上回溯: 由于没有兄弟节点, 把<code>workInProgress</code>指针指向父节点<code>fiber(&lt;Content/&gt;)</code></li></ol><img src="/notes/assets/react-illustration-series/unitofwork7.png" alt="demo"><p>第 2 次循环:</p><ol><li>执行<code>completeWork</code>函数: class 类型的节点不做处理</li><li>上移副作用队列: <ul><li>本节点<code>fiber(&lt;Content/&gt;)</code>的<code>flags</code>标志位有改动(<code>completedWork.flags &gt; PerformedWork</code>), 将本节点添加到父节点(<code>fiber(div)</code>)的副作用队列之后(<code>firstEffect</code>和<code>lastEffect</code>属性分别指向副作用队列的首部和尾部).</li></ul></li><li>向上回溯: 把<code>workInProgress</code>指针指向父节点<code>fiber(div)</code></li></ol><img src="/notes/assets/react-illustration-series/unitofwork7.1.png" alt="demo"><p>第 3 次循环:</p><ol><li>执行<code>completeWork</code>函数: 创建<code>fiber(div)</code>节点对应的<code>DOM</code>实例, 并<code>append</code>子树节点的<code>DOM</code>实例</li><li>上移副作用队列: <ul><li>本节点<code>fiber(div)</code>的副作用队列不为空, 将其拼接到父节点<code>fiber&lt;App/&gt;</code>的副作用队列后面.</li></ul></li><li>向上回溯: 把<code>workInProgress</code>指针指向父节点<code>fiber(&lt;App/&gt;)</code></li></ol><img src="/notes/assets/react-illustration-series/unitofwork7.2.png" alt="demo"><p>第 4 次循环:</p><ol><li>执行<code>completeWork</code>函数: class 类型的节点不做处理</li><li>上移副作用队列: <ul><li>本节点<code>fiber(&lt;App/&gt;)</code>的副作用队列不为空, 将其拼接到父节点<code>fiber(HostRootFiber)</code>的副作用队列上.</li><li>本节点<code>fiber(&lt;App/&gt;)</code>的<code>flags</code>标志位有改动(<code>completedWork.flags &gt; PerformedWork</code>), 将本节点添加到父节点<code>fiber(HostRootFiber)</code>的副作用队列之后.</li><li>最后队列的顺序是<code>子节点在前, 本节点在后</code></li></ul></li><li>向上回溯: 把<code>workInProgress</code>指针指向父节点<code>fiber(HostRootFiber)</code></li></ol><img src="/notes/assets/react-illustration-series/unitofwork7.3.png" alt="demo"><p>第 5 次循环:</p><ol><li>执行<code>completeWork</code>函数: 对于<code>HostRoot</code>类型的节点, 初次构造时设置<a href="https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberCompleteWork.old.js#L693" target="_blank" rel="noopener noreferrer">workInProgress.flags |= Snapshot<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>向上回溯: 由于父节点为空, 无需进入处理副作用队列的逻辑. 最后设置<code>workInProgress=null</code>, 并退出<code>completeUnitOfWork</code></li></ol><img src="/notes/assets/react-illustration-series/unitofwork7.4.png" alt="demo"><p>到此整个<code>fiber树构造循环</code>已经执行完毕, 拥有一棵完整的<code>fiber树</code>, 并且在<code>fiber树</code>的根节点上挂载了副作用队列, 副作用队列的顺序是层级越深子节点越靠前.</p><p><code>renderRootSync</code>函数退出之前, 会重置<code>workInProgressRoot = null</code>, 表明没有正在进行中的<code>render</code>. 且把最新的<code>fiber树</code>挂载到<code>fiberRoot.finishedWork</code>上. 这时整个 fiber 树的内存结构如下(注意<code>fiberRoot.finishedWork</code>和<code>fiberRoot.current</code>指针,在<code>commitRoot</code>阶段会进行处理):</p><img src="/notes/assets/react-illustration-series/fibertree-beforecommit.png" alt="demo"><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结" aria-hidden="true">#</a> 总结</h2><p>本节演示了初次创建<code>fiber树</code>的全部过程, 跟踪了创建过程中内存引用的变化情况. <code>fiber树构造循环</code>负责构造新的<code>fiber</code>树, 构造过程中同时标记<code>fiber.flags</code>, 最终把所有被标记的<code>fiber</code>节点收集到一个副作用队列中, 这个副作用队列被挂载到根节点上(<code>HostRootFiber.alternate.firstEffect</code>). 此时的<code>fiber树</code>和与之对应的<code>DOM节点</code>都还在内存当中, 等待<code>commitRoot</code>阶段进行渲染.</p></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: suiyi19920228@qq.com">suiyi</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/notes/assets/app.013e756e.js" defer></script>
  </body>
</html>
