<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.48" />
    <meta name="theme" content="VuePress Theme Hope" />
    <title></title><meta name="description" content="">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/assets/style.daa890f8.css">
    <link rel="modulepreload" href="/assets/app.387fc4b5.js"><link rel="modulepreload" href="/assets/templateCompilation.html.aeacab41.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" href="/assets/templateCompilation.html.4c11e05d.js"><link rel="prefetch" href="/assets/index.html.6da9663e.js"><link rel="prefetch" href="/assets/README_default.html.ab8f8821.js"><link rel="prefetch" href="/assets/slide.html.39d68731.js"><link rel="prefetch" href="/assets/_sidebar.html.dba5ddc4.js"><link rel="prefetch" href="/assets/_sidebar.html.3fbbf7a3.js"><link rel="prefetch" href="/assets/base.html.2865e1dd.js"><link rel="prefetch" href="/assets/customCli.html.89961a73.js"><link rel="prefetch" href="/assets/_sidebar.html.68af8867.js"><link rel="prefetch" href="/assets/adapter.html.c7c79fcd.js"><link rel="prefetch" href="/assets/amd.html.afe5e576.js"><link rel="prefetch" href="/assets/builder.html.2749350d.js"><link rel="prefetch" href="/assets/censorJquery.html.a36d316a.js"><link rel="prefetch" href="/assets/combination.html.98760057.js"><link rel="prefetch" href="/assets/command.html.8abfa90b.js"><link rel="prefetch" href="/assets/commonJS.html.48b7af24.js"><link rel="prefetch" href="/assets/constructor.html.ab391195.js"><link rel="prefetch" href="/assets/decoration.html.5d316916.js"><link rel="prefetch" href="/assets/esHarmony.html.19945df4.js"><link rel="prefetch" href="/assets/exposed.html.5aae434a.js"><link rel="prefetch" href="/assets/exterior.html.eb438758.js"><link rel="prefetch" href="/assets/factory.html.23b96b9e.js"><link rel="prefetch" href="/assets/flyweight.html.6fca4681.js"><link rel="prefetch" href="/assets/functionalProgramming.html.f1ecdf30.js"><link rel="prefetch" href="/assets/intermediary.html.7cdb0f19.js"><link rel="prefetch" href="/assets/iterator.html.72bfa5e2.js"><link rel="prefetch" href="/assets/lazyInitial.html.e9b1ffd8.js"><link rel="prefetch" href="/assets/mixin.html.273e67f8.js"><link rel="prefetch" href="/assets/module.html.a824bdf5.js"><link rel="prefetch" href="/assets/mvc.html.0e2d482f.js"><link rel="prefetch" href="/assets/mvp.html.ccf2f5a7.js"><link rel="prefetch" href="/assets/mvvm.html.7c2dae2b.js"><link rel="prefetch" href="/assets/observer.html.d99ac27e.js"><link rel="prefetch" href="/assets/outward.html.ed11ffbb.js"><link rel="prefetch" href="/assets/overview.html.31e53a67.js"><link rel="prefetch" href="/assets/prototype.html.c5037de7.js"><link rel="prefetch" href="/assets/proxy.html.1a42cf88.js"><link rel="prefetch" href="/assets/singleton.html.f0c2f9f7.js"><link rel="prefetch" href="/assets/axios.html.9efc2f77.js"><link rel="prefetch" href="/assets/createUnderscore.html.b1c4b726.js"><link rel="prefetch" href="/assets/jquery.html.2f909e16.js"><link rel="prefetch" href="/assets/lodash.html.d2450493.js"><link rel="prefetch" href="/assets/sentry.html.53c103b1.js"><link rel="prefetch" href="/assets/underscore.html.22abed38.js"><link rel="prefetch" href="/assets/vuex.html.c83ca9ff.js"><link rel="prefetch" href="/assets/customCli.html.9406d909.js"><link rel="prefetch" href="/assets/description.html.6bf57368.js"><link rel="prefetch" href="/assets/indx.html.41fe6f25.js"><link rel="prefetch" href="/assets/rebase.html.8dccb213.js"><link rel="prefetch" href="/assets/index.html.d530c758.js"><link rel="prefetch" href="/assets/disable.html.97bc4a05.js"><link rel="prefetch" href="/assets/encrypt.html.9458dc5a.js"><link rel="prefetch" href="/assets/markdown.html.8cc2a87d.js"><link rel="prefetch" href="/assets/page.html.a599f5c6.js"><link rel="prefetch" href="/assets/_sidebar.html.52dffdb1.js"><link rel="prefetch" href="/assets/_sidebar.html.71dd5bce.js"><link rel="prefetch" href="/assets/_sidebar.html.aa99443d.js"><link rel="prefetch" href="/assets/44Questions.html.e64779af.js"><link rel="prefetch" href="/assets/asyncAwait.html.64704af9.js"><link rel="prefetch" href="/assets/babelCompile.html.d9892b9f.js"><link rel="prefetch" href="/assets/base.html.8e82529a.js"><link rel="prefetch" href="/assets/baseInterview.html.d0007b51.js"><link rel="prefetch" href="/assets/baseWebpack.html.3be7bd89.js"><link rel="prefetch" href="/assets/codeSeparation.html.78c9509f.js"><link rel="prefetch" href="/assets/cycle.html.c50b12e3.js"><link rel="prefetch" href="/assets/cycleOtherWay.html.01444f92.js"><link rel="prefetch" href="/assets/executionMechanism.html.e8b79758.js"><link rel="prefetch" href="/assets/hybrid.html.703e41e0.js"><link rel="prefetch" href="/assets/jsHandwriting.html.4c4339a6.js"><link rel="prefetch" href="/assets/jsonStringify.html.b8178034.js"><link rel="prefetch" href="/assets/largeFileResumableUpload.html.362a061c.js"><link rel="prefetch" href="/assets/performance.html.69e8667c.js"><link rel="prefetch" href="/assets/promise.html.b4acce00.js"><link rel="prefetch" href="/assets/promiseAll.html.624c206e.js"><link rel="prefetch" href="/assets/spa.html.e219eb0f.js"><link rel="prefetch" href="/assets/tsBaseInterview.html.5068b62e.js"><link rel="prefetch" href="/assets/useEs6.html.c13979f8.js"><link rel="prefetch" href="/assets/webAnimations.html.aef2801c.js"><link rel="prefetch" href="/assets/webpackInterview.html.d8d6ffd1.js"><link rel="prefetch" href="/assets/webpackLoader.html.c862eb65.js"><link rel="prefetch" href="/assets/webpackPublic.html.d67b0d7d.js"><link rel="prefetch" href="/assets/weird.html.5555426a.js"><link rel="prefetch" href="/assets/es10News.html.0c4023ce.js"><link rel="prefetch" href="/assets/es11News.html.7096c2b7.js"><link rel="prefetch" href="/assets/es6Interview1.html.65eb7a36.js"><link rel="prefetch" href="/assets/es6Interview2.html.c98c02c0.js"><link rel="prefetch" href="/assets/es6Interview3.html.ca510221.js"><link rel="prefetch" href="/assets/es6News.html.f1902b99.js"><link rel="prefetch" href="/assets/es7News.html.0298284f.js"><link rel="prefetch" href="/assets/es8News.html.a7889ead.js"><link rel="prefetch" href="/assets/es9News.html.a181616e.js"><link rel="prefetch" href="/assets/base.html.aed24c64.js"><link rel="prefetch" href="/assets/nginxComprehensiveScene.html.0d66665b.js"><link rel="prefetch" href="/assets/commonlyUsed.html.0c538b97.js"><link rel="prefetch" href="/assets/inelegantHook.html.0ea83633.js"><link rel="prefetch" href="/assets/interview1.html.7e0fdb74.js"><link rel="prefetch" href="/assets/interview2.html.8c01fe90.js"><link rel="prefetch" href="/assets/interview3.html.4504d5d4.js"><link rel="prefetch" href="/assets/interview4.html.7eadcfee.js"><link rel="prefetch" href="/assets/base.html.d306ab34.js"><link rel="prefetch" href="/assets/introduction.html.1d821542.js"><link rel="prefetch" href="/assets/base.html.6a6e2eb2.js"><link rel="prefetch" href="/assets/summarize.html.37a0ece3.js"><link rel="prefetch" href="/assets/_sidebar.html.8ddbee48.js"><link rel="prefetch" href="/assets/index.html.bb151277.js"><link rel="prefetch" href="/assets/baseInterview.html.40c3ddeb.js"><link rel="prefetch" href="/assets/baseInterview.html.aac53853.js"><link rel="prefetch" href="/assets/bigDataRender.html.ecb0d9bb.js"><link rel="prefetch" href="/assets/progress.html.37ba4c59.js"><link rel="prefetch" href="/assets/quirksStandards.html.2fd325b1.js"><link rel="prefetch" href="/assets/redrawReflow.html.972b7c54.js"><link rel="prefetch" href="/assets/storageSpace.html.fcaf4434.js"><link rel="prefetch" href="/assets/webComLink.html.4814b559.js"><link rel="prefetch" href="/assets/webUrl.html.2838c537.js"><link rel="prefetch" href="/assets/spanWidthHeight.html.2f3fabad.js"><link rel="prefetch" href="/assets/baseCss.html.024632d0.js"><link rel="prefetch" href="/assets/blockFormattingContext.html.90b52865.js"><link rel="prefetch" href="/assets/containingBlock.html.d4b737eb.js"><link rel="prefetch" href="/assets/cssBeforeAfter.html.c1755e9f.js"><link rel="prefetch" href="/assets/cssBoxModal.html.e3ad338d.js"><link rel="prefetch" href="/assets/cssCollapsing.html.75fc64ea.js"><link rel="prefetch" href="/assets/cssCompatible.html.7b19fd52.js"><link rel="prefetch" href="/assets/cssFlexDemo.html.ebc8c39a.js"><link rel="prefetch" href="/assets/cssFlexLayout.html.fe04f4cb.js"><link rel="prefetch" href="/assets/cssGridLayout.html.e9952ea5.js"><link rel="prefetch" href="/assets/cssHack.html.f8d7936f.js"><link rel="prefetch" href="/assets/cssInlineBlock.html.dd3bf69b.js"><link rel="prefetch" href="/assets/cssPriority.html.7d97ceee.js"><link rel="prefetch" href="/assets/cssPseudo.html.e060176f.js"><link rel="prefetch" href="/assets/cssPseudoClass.html.afdc6f67.js"><link rel="prefetch" href="/assets/cssSelector.html.8e02658d.js"><link rel="prefetch" href="/assets/cssTutorial.html.a35e1505.js"><link rel="prefetch" href="/assets/fieldInvalid.html.cbea1ea7.js"><link rel="prefetch" href="/assets/frame.html.6c33f98e.js"><link rel="prefetch" href="/assets/knowledgePoints.html.2f078932.js"><link rel="prefetch" href="/assets/linkImport.html.b29f7b8e.js"><link rel="prefetch" href="/assets/stackingContext.html.9c8c8c6d.js"><link rel="prefetch" href="/assets/tools.html.87e93be7.js"><link rel="prefetch" href="/assets/units.html.341bf3a0.js"><link rel="prefetch" href="/assets/transform.html.97ee8a95.js"><link rel="prefetch" href="/assets/content.html.7ec6a6af.js"><link rel="prefetch" href="/assets/plugins.html.58632c44.js"><link rel="prefetch" href="/assets/accesskey.html.be9c13e3.js"><link rel="prefetch" href="/assets/baseInterview.html.1e23c8f1.js"><link rel="prefetch" href="/assets/canvasSvg.html.0aad501f.js"><link rel="prefetch" href="/assets/deviceAPI.html.7e406f9b.js"><link rel="prefetch" href="/assets/globalAttr.html.8b3493cc.js"><link rel="prefetch" href="/assets/htmlDatalist.html.23937ec4.js"><link rel="prefetch" href="/assets/htmlElement.html.0035e5bf.js"><link rel="prefetch" href="/assets/interview10.html.652f3fa9.js"><link rel="prefetch" href="/assets/interview11.html.902cdc9a.js"><link rel="prefetch" href="/assets/interview12.html.68f54aa2.js"><link rel="prefetch" href="/assets/interview13.html.9b9b092b.js"><link rel="prefetch" href="/assets/interview14.html.1d986f0c.js"><link rel="prefetch" href="/assets/interview15.html.256675f0.js"><link rel="prefetch" href="/assets/interview16.html.f9810e76.js"><link rel="prefetch" href="/assets/interview17.html.18b84c7f.js"><link rel="prefetch" href="/assets/interview18.html.74173cd8.js"><link rel="prefetch" href="/assets/interview19.html.027475ad.js"><link rel="prefetch" href="/assets/interview20.html.edfacaad.js"><link rel="prefetch" href="/assets/interview21.html.4b852757.js"><link rel="prefetch" href="/assets/interview22.html.33866a77.js"><link rel="prefetch" href="/assets/interview23.html.3770e7a6.js"><link rel="prefetch" href="/assets/interview24.html.f750769b.js"><link rel="prefetch" href="/assets/interview25.html.e1b1432f.js"><link rel="prefetch" href="/assets/interview26.html.bfd4d87a.js"><link rel="prefetch" href="/assets/interview27.html.c1938293.js"><link rel="prefetch" href="/assets/interview28.html.5528f71f.js"><link rel="prefetch" href="/assets/interview29.html.16cdbb2e.js"><link rel="prefetch" href="/assets/interview30.html.4d1dee2c.js"><link rel="prefetch" href="/assets/interview31.html.8c08df10.js"><link rel="prefetch" href="/assets/interview32.html.627c16b3.js"><link rel="prefetch" href="/assets/interview33.html.2b9714d0.js"><link rel="prefetch" href="/assets/interview34.html.c4cbb83c.js"><link rel="prefetch" href="/assets/interview35.html.8b21bc36.js"><link rel="prefetch" href="/assets/interview36.html.ddf9b40c.js"><link rel="prefetch" href="/assets/interview37.html.05f347d4.js"><link rel="prefetch" href="/assets/interview38.html.c9094e7f.js"><link rel="prefetch" href="/assets/interview39.html.946b169b.js"><link rel="prefetch" href="/assets/interview40.html.aba94b87.js"><link rel="prefetch" href="/assets/interview41.html.4afcee90.js"><link rel="prefetch" href="/assets/interview42.html.2036bf11.js"><link rel="prefetch" href="/assets/interview43.html.c3d6c383.js"><link rel="prefetch" href="/assets/interview44.html.2245c30c.js"><link rel="prefetch" href="/assets/interview45.html.5d8b3b03.js"><link rel="prefetch" href="/assets/interview46.html.cec2a61c.js"><link rel="prefetch" href="/assets/interview47.html.d87d65bd.js"><link rel="prefetch" href="/assets/interview48.html.20c5ffcd.js"><link rel="prefetch" href="/assets/interview49.html.99232630.js"><link rel="prefetch" href="/assets/interview5.html.15cbde85.js"><link rel="prefetch" href="/assets/interview50.html.9486028c.js"><link rel="prefetch" href="/assets/interview51.html.11cd5ced.js"><link rel="prefetch" href="/assets/interview52.html.f968d2e2.js"><link rel="prefetch" href="/assets/interview53.html.8ff89d5a.js"><link rel="prefetch" href="/assets/interview54.html.73a2f73d.js"><link rel="prefetch" href="/assets/interview55.html.0a5d967d.js"><link rel="prefetch" href="/assets/interview56.html.8897a3ba.js"><link rel="prefetch" href="/assets/interview57.html.c3b73df7.js"><link rel="prefetch" href="/assets/interview58.html.520d43b8.js"><link rel="prefetch" href="/assets/interview59.html.83b170f4.js"><link rel="prefetch" href="/assets/interview6.html.b21d9e65.js"><link rel="prefetch" href="/assets/interview7.html.f7df7d1c.js"><link rel="prefetch" href="/assets/interview8.html.3277a826.js"><link rel="prefetch" href="/assets/interview9.html.8a8575a0.js"><link rel="prefetch" href="/assets/linkImport.html.f9b8df2c.js"><link rel="prefetch" href="/assets/offlineStorage.html.d6ffe5e8.js"><link rel="prefetch" href="/assets/regular.html.bc57ce4a.js"><link rel="prefetch" href="/assets/shake.html.e1be9468.js"><link rel="prefetch" href="/assets/webWorker.html.4b0855d7.js"><link rel="prefetch" href="/assets/baseInterview.html.10c8e0f8.js"><link rel="prefetch" href="/assets/cors.html.09ae3dad.js"><link rel="prefetch" href="/assets/crossDomainCookie.html.6aa89d08.js"><link rel="prefetch" href="/assets/fetch.html.2611e864.js"><link rel="prefetch" href="/assets/nestAxios.html.77b08682.js"><link rel="prefetch" href="/assets/debounce.html.e364cbee.js"><link rel="prefetch" href="/assets/lodashPrinciple.html.d856c721.js"><link rel="prefetch" href="/assets/lodashThrottleDebounce.html.5642bc2b.js"><link rel="prefetch" href="/assets/throttle.html.7efb308a.js"><link rel="prefetch" href="/assets/throttleDebounceReact.html.50f294a5.js"><link rel="prefetch" href="/assets/cloneIntroduction.html.33a28110.js"><link rel="prefetch" href="/assets/deepClone.html.a21a67bf.js"><link rel="prefetch" href="/assets/lodashDeepClone.html.71b1bf1f.js"><link rel="prefetch" href="/assets/objectAssign.html.ff06555a.js"><link rel="prefetch" href="/assets/arraySourceCode.html.7f0ca38e.js"><link rel="prefetch" href="/assets/baseHigh.html.ef8082c7.js"><link rel="prefetch" href="/assets/currying.html.5312b89b.js"><link rel="prefetch" href="/assets/baseInterview.html.563a1074.js"><link rel="prefetch" href="/assets/eventLoop.html.29865a1e.js"><link rel="prefetch" href="/assets/iife.html.7038d614.js"><link rel="prefetch" href="/assets/interview1.html.814c5830.js"><link rel="prefetch" href="/assets/jsCompatible.html.231de8e7.js"><link rel="prefetch" href="/assets/baseProyotype.html.6cf3fcb2.js"><link rel="prefetch" href="/assets/functionObjectResource.html.8ab07601.js"><link rel="prefetch" href="/assets/prototypeInherit.html.52b1d4ea.js"><link rel="prefetch" href="/assets/closureInterview.html.62990b21.js"><link rel="prefetch" href="/assets/scopeChain.html.2a16f9ed.js"><link rel="prefetch" href="/assets/understandingClosures.html.af3b5a8a.js"><link rel="prefetch" href="/assets/executionStack.html.e3a71fe0.js"><link rel="prefetch" href="/assets/memoryLeak.html.9ccf1e0b.js"><link rel="prefetch" href="/assets/memoryMechanism.html.9a3c06d1.js"><link rel="prefetch" href="/assets/memorySpace.html.8b7d7772.js"><link rel="prefetch" href="/assets/precompiled.html.46323a5b.js"><link rel="prefetch" href="/assets/variableObject.html.d5d1f07d.js"><link rel="prefetch" href="/assets/arrowFunctionThis.html.be0a2b92.js"><link rel="prefetch" href="/assets/bindSimulation.html.5d0c3c58.js"><link rel="prefetch" href="/assets/callApply.html.a8e92e7e.js"><link rel="prefetch" href="/assets/newSimulation.html.57b26050.js"><link rel="prefetch" href="/assets/thisBind.html.49b38ae3.js"><link rel="prefetch" href="/assets/interview1.html.a9b9452f.js"><link rel="prefetch" href="/assets/interview10.html.4d3ad20e.js"><link rel="prefetch" href="/assets/interview11.html.6e6cfcfa.js"><link rel="prefetch" href="/assets/interview12.html.d8724ac5.js"><link rel="prefetch" href="/assets/interview13.html.91a5e7ef.js"><link rel="prefetch" href="/assets/interview14.html.4523eb07.js"><link rel="prefetch" href="/assets/interview15.html.755eb654.js"><link rel="prefetch" href="/assets/interview16.html.f92a628c.js"><link rel="prefetch" href="/assets/interview17.html.6da1d772.js"><link rel="prefetch" href="/assets/interview18.html.a54d2396.js"><link rel="prefetch" href="/assets/interview19.html.12da8f8e.js"><link rel="prefetch" href="/assets/interview2.html.9512d043.js"><link rel="prefetch" href="/assets/interview20.html.d1ad0855.js"><link rel="prefetch" href="/assets/interview21.html.d02517ff.js"><link rel="prefetch" href="/assets/interview22.html.4b38fa06.js"><link rel="prefetch" href="/assets/interview23.html.08f3c7d9.js"><link rel="prefetch" href="/assets/interview24.html.43e8583a.js"><link rel="prefetch" href="/assets/interview25.html.1dfe0d21.js"><link rel="prefetch" href="/assets/interview26.html.9506a679.js"><link rel="prefetch" href="/assets/interview27.html.fa368fd2.js"><link rel="prefetch" href="/assets/interview28.html.e6e12623.js"><link rel="prefetch" href="/assets/interview29.html.29f77c8d.js"><link rel="prefetch" href="/assets/interview3.html.d478118a.js"><link rel="prefetch" href="/assets/interview30.html.884b6396.js"><link rel="prefetch" href="/assets/interview4.html.bd953ca0.js"><link rel="prefetch" href="/assets/interview5.html.18b2c7be.js"><link rel="prefetch" href="/assets/interview6.html.106840d6.js"><link rel="prefetch" href="/assets/interview7.html.c61e7f2c.js"><link rel="prefetch" href="/assets/interview8.html.27ceab56.js"><link rel="prefetch" href="/assets/interview9.html.ecf11e60.js"><link rel="prefetch" href="/assets/1.html.ec656381.js"><link rel="prefetch" href="/assets/2.html.36ad13e7.js"><link rel="prefetch" href="/assets/3.html.bd5ce252.js"><link rel="prefetch" href="/assets/4.html.2f288a9b.js"><link rel="prefetch" href="/assets/5.html.eb9ab81d.js"><link rel="prefetch" href="/assets/6.html.e235427e.js"><link rel="prefetch" href="/assets/adjacentSiblingCombinator.html.d5de8b06.js"><link rel="prefetch" href="/assets/attributeSelectors.html.43fb977f.js"><link rel="prefetch" href="/assets/charset.html.176466c8.js"><link rel="prefetch" href="/assets/childCombinator.html.28efa00a.js"><link rel="prefetch" href="/assets/classSelectors.html.6317c25c.js"><link rel="prefetch" href="/assets/descendantCombinator.html.68b059fd.js"><link rel="prefetch" href="/assets/generalSiblingCombinator.html.e0492086.js"><link rel="prefetch" href="/assets/iDSelectors.html.6ec6721a.js"><link rel="prefetch" href="/assets/pseudoClasses.html.e1816ef4.js"><link rel="prefetch" href="/assets/pseudoElements.html.d7a62f2b.js"><link rel="prefetch" href="/assets/selectorList.html.463a293c.js"><link rel="prefetch" href="/assets/typeSelectors.html.122aeda8.js"><link rel="prefetch" href="/assets/universalSelectors.html.cb5806ec.js"><link rel="prefetch" href="/assets/IterationProtocols.html.ff30eeb6.js"><link rel="prefetch" href="/assets/arrayFlat.html.8c3c1930.js"><link rel="prefetch" href="/assets/asyncHistory.html.406cc8a2.js"><link rel="prefetch" href="/assets/eventLoop.html.0ad3955e.js"><link rel="prefetch" href="/assets/fileReader.html.1f36c0eb.js"><link rel="prefetch" href="/assets/formData.html.406959b9.js"><link rel="prefetch" href="/assets/functionGenerator.html.6a696f4b.js"><link rel="prefetch" href="/assets/generator.html.5e3f7237.js"><link rel="prefetch" href="/assets/intersectionObserver.html.15a5ce44.js"><link rel="prefetch" href="/assets/map.html.dd472ae5.js"><link rel="prefetch" href="/assets/promise.html.ac576010.js"><link rel="prefetch" href="/assets/set.html.dcf9dbcc.js"><link rel="prefetch" href="/assets/string.html.9a77605c.js"><link rel="prefetch" href="/assets/symbol.html.20cfaa47.js"><link rel="prefetch" href="/assets/xMLHttpRequest.html.85b01b4f.js"><link rel="prefetch" href="/assets/spreadSyntax.html.2b1b8b2f.js"><link rel="prefetch" href="/assets/strictMode.html.97edc7d6.js"><link rel="prefetch" href="/assets/cache.html.122cb1fb.js"><link rel="prefetch" href="/assets/drag1.html.e3dcdc37.js"><link rel="prefetch" href="/assets/oneLineCode.html.6ebc3a26.js"><link rel="prefetch" href="/assets/oneLineCodeArray.html.c4e9b7c1.js"><link rel="prefetch" href="/assets/oneLineCodeDOM.html.f5568acc.js"><link rel="prefetch" href="/assets/oneLineCodeDateTime.html.1612cfba.js"><link rel="prefetch" href="/assets/oneLineCodeFunction.html.371f1517.js"><link rel="prefetch" href="/assets/oneLineCodeMath.html.f1a250a4.js"><link rel="prefetch" href="/assets/oneLineCodeMisc.html.eccd0d22.js"><link rel="prefetch" href="/assets/oneLineCodeNumber.html.acf3f906.js"><link rel="prefetch" href="/assets/oneLineCodeObject.html.e0ecfe92.js"><link rel="prefetch" href="/assets/oneLineCodeRandom.html.f28653d7.js"><link rel="prefetch" href="/assets/oneLineCodeString.html.24caf5ad.js"><link rel="prefetch" href="/assets/oneLineCodeValidator.html.a9ff0816.js"><link rel="prefetch" href="/assets/typeScriptCache.html.9d6b12e8.js"><link rel="prefetch" href="/assets/reactBase.html.c82e5102.js"><link rel="prefetch" href="/assets/reactTypescript.html.7aef83be.js"><link rel="prefetch" href="/assets/vue2Base.html.29cac8d4.js"><link rel="prefetch" href="/assets/vue2Table.html.47341428.js"><link rel="prefetch" href="/assets/vue2offsetTop.html.c0a9dda3.js"><link rel="prefetch" href="/assets/componentWillXXX.html.21f4cbf1.js"><link rel="prefetch" href="/assets/disrupt.html.cb9b3c3a.js"><link rel="prefetch" href="/assets/lane.html.8e2c0321.js"><link rel="prefetch" href="/assets/prepare.html.fed97446.js"><link rel="prefetch" href="/assets/redux.html.37f7ae5b.js"><link rel="prefetch" href="/assets/scheduler.html.9d26ac4a.js"><link rel="prefetch" href="/assets/multi.html.7acce4b9.js"><link rel="prefetch" href="/assets/one.html.69ed5708.js"><link rel="prefetch" href="/assets/prepare.html.82d9e608.js"><link rel="prefetch" href="/assets/create.html.e69bc474.js"><link rel="prefetch" href="/assets/prepare.html.ea451341.js"><link rel="prefetch" href="/assets/structure.html.81680720.js"><link rel="prefetch" href="/assets/useeffect.html.6168b485.js"><link rel="prefetch" href="/assets/usememo.html.b5dc7794.js"><link rel="prefetch" href="/assets/useref.html.7529ded8.js"><link rel="prefetch" href="/assets/usestate.html.ed480f16.js"><link rel="prefetch" href="/assets/file.html.f11c1f06.js"><link rel="prefetch" href="/assets/idea.html.9b53a9c4.js"><link rel="prefetch" href="/assets/jsx.html.9a525148.js"><link rel="prefetch" href="/assets/newConstructure.html.4fbd2566.js"><link rel="prefetch" href="/assets/oldConstructure.html.71cbbd1a.js"><link rel="prefetch" href="/assets/source.html.f33f14ae.js"><link rel="prefetch" href="/assets/summary.html.d7e973e4.js"><link rel="prefetch" href="/assets/basePrinciple.html.19d5734a.js"><link rel="prefetch" href="/assets/componentApi.html.cf577f32.js"><link rel="prefetch" href="/assets/domApi.html.effb2938.js"><link rel="prefetch" href="/assets/hoc.html.48916672.js"><link rel="prefetch" href="/assets/hookApi.html.0ff86593.js"><link rel="prefetch" href="/assets/hookCustom.html.254a609f.js"><link rel="prefetch" href="/assets/hookPrinciple.html.1a91b418.js"><link rel="prefetch" href="/assets/hookUse.html.1fd9a894.js"><link rel="prefetch" href="/assets/reactKeeplive.html.7ce11a1c.js"><link rel="prefetch" href="/assets/reactRedux.html.f23c823b.js"><link rel="prefetch" href="/assets/reactRouter.html.b6527db9.js"><link rel="prefetch" href="/assets/toolApi.html.0c9a1f91.js"><link rel="prefetch" href="/assets/beginWork.html.272b7af0.js"><link rel="prefetch" href="/assets/completeWork.html.e5b768f9.js"><link rel="prefetch" href="/assets/doubleBuffer.html.5a0bf2d5.js"><link rel="prefetch" href="/assets/fiber-mental.html.d4c113eb.js"><link rel="prefetch" href="/assets/fiber.html.4fcde80b.js"><link rel="prefetch" href="/assets/reconciler.html.20a1b64b.js"><link rel="prefetch" href="/assets/beforeMutation.html.71c7ae19.js"><link rel="prefetch" href="/assets/layout.html.1dee2ebb.js"><link rel="prefetch" href="/assets/mutation.html.b0260d33.js"><link rel="prefetch" href="/assets/prepare.html.bfd41f0c.js"><link rel="prefetch" href="/assets/mental.html.6eb5a45b.js"><link rel="prefetch" href="/assets/prepare.html.d22b959d.js"><link rel="prefetch" href="/assets/priority.html.26557681.js"><link rel="prefetch" href="/assets/reactdom.html.fcdba8b4.js"><link rel="prefetch" href="/assets/setstate.html.f1cd14d8.js"><link rel="prefetch" href="/assets/update.html.4eb63079.js"><link rel="prefetch" href="/assets/bitfiled.html.36b2fe8d.js"><link rel="prefetch" href="/assets/dfs.html.fd0e9080.js"><link rel="prefetch" href="/assets/diff.html.a8628ce4.js"><link rel="prefetch" href="/assets/heapsort.html.a52726e6.js"><link rel="prefetch" href="/assets/linkedlist.html.6dcad65b.js"><link rel="prefetch" href="/assets/stack.html.85521a2e.js"><link rel="prefetch" href="/assets/bootstrap.html.642e2753.js"><link rel="prefetch" href="/assets/context.html.e4d26c06.js"><link rel="prefetch" href="/assets/fibertree-commit.html.db4066ce.js"><link rel="prefetch" href="/assets/fibertree-create.html.7f4e959f.js"><link rel="prefetch" href="/assets/fibertree-prepare.html.bd5e9585.js"><link rel="prefetch" href="/assets/fibertree-update.html.2ce3db5b.js"><link rel="prefetch" href="/assets/hook-effect.html.e6253a62.js"><link rel="prefetch" href="/assets/hook-state.html.b1da962e.js"><link rel="prefetch" href="/assets/hook-summary.html.1bf5f247.js"><link rel="prefetch" href="/assets/macro-structure.html.dba58c9e.js"><link rel="prefetch" href="/assets/object-structure.html.46604d95.js"><link rel="prefetch" href="/assets/priority.html.da457934.js"><link rel="prefetch" href="/assets/reconciler-workflow.html.75312979.js"><link rel="prefetch" href="/assets/scheduler.html.bbca3f55.js"><link rel="prefetch" href="/assets/state-effects.html.50440b5c.js"><link rel="prefetch" href="/assets/synthetic-event.html.17c7c24d.js"><link rel="prefetch" href="/assets/workloop.html.cd379c07.js"><link rel="prefetch" href="/assets/ast.html.1eb620ee.js"><link rel="prefetch" href="/assets/binder.html.58323786.js"><link rel="prefetch" href="/assets/checker.html.8f1e36a2.js"><link rel="prefetch" href="/assets/emitter.html.94ed6af1.js"><link rel="prefetch" href="/assets/overview.html.276ba4e5.js"><link rel="prefetch" href="/assets/parser.html.6f2c1145.js"><link rel="prefetch" href="/assets/program.html.9a3204bb.js"><link rel="prefetch" href="/assets/scanner.html.6b47341f.js"><link rel="prefetch" href="/assets/common.html.68ca9932.js"><link rel="prefetch" href="/assets/interpreting.html.64650a3d.js"><link rel="prefetch" href="/assets/class.html.a85d7001.js"><link rel="prefetch" href="/assets/commandline-behavior.html.96b69393.js"><link rel="prefetch" href="/assets/comments.html.91db9799.js"><link rel="prefetch" href="/assets/common-bug-not-bugs.html.0c128c94.js"><link rel="prefetch" href="/assets/common-feature-request.html.fe8a3b7d.js"><link rel="prefetch" href="/assets/decorators.html.f01c0dd2.js"><link rel="prefetch" href="/assets/enums.html.01e729ee.js"><link rel="prefetch" href="/assets/function.html.94670d75.js"><link rel="prefetch" href="/assets/generics.html.baa03b76.js"><link rel="prefetch" href="/assets/glossary-and-terms.html.8a84cfce.js"><link rel="prefetch" href="/assets/jsx-and-react.html.680e365c.js"><link rel="prefetch" href="/assets/modules.html.c3b5693a.js"><link rel="prefetch" href="/assets/thing-that-dont-work.html.cc9003d8.js"><link rel="prefetch" href="/assets/tsconfig-behavior.html.8e41e428.js"><link rel="prefetch" href="/assets/type-guards.html.3d00885b.js"><link rel="prefetch" href="/assets/type-system-behavior.html.a75f9d77.js"><link rel="prefetch" href="/assets/nonReactJSX.html.43e4e104.js"><link rel="prefetch" href="/assets/reactJSX.html.e61ad595.js"><link rel="prefetch" href="/assets/support.html.aa3ff5f0.js"><link rel="prefetch" href="/assets/typescript-3.7.html.d17ecdc7.js"><link rel="prefetch" href="/assets/typescript-3.8.html.fc238de3.js"><link rel="prefetch" href="/assets/typescript-3.9.html.f2161f8a.js"><link rel="prefetch" href="/assets/compilationContext.html.bb2f8611.js"><link rel="prefetch" href="/assets/declarationspaces.html.0f7a8bc6.js"><link rel="prefetch" href="/assets/dynamicImportExpressions.html.35ff87ac.js"><link rel="prefetch" href="/assets/inDepthTs.html.885ba723.js"><link rel="prefetch" href="/assets/modules.html.77249115.js"><link rel="prefetch" href="/assets/namespaces.html.88228eba.js"><link rel="prefetch" href="/assets/unknownAny.html.fda7fa35.js"><link rel="prefetch" href="/assets/avoidExportDefault.html.becf7350.js"><link rel="prefetch" href="/assets/barrel.html.9eb3db32.js"><link rel="prefetch" href="/assets/bind.html.412d5f41.js"><link rel="prefetch" href="/assets/buildToggles.html.bde3022e.js"><link rel="prefetch" href="/assets/classAreUseful.html.90f2f12b.js"><link rel="prefetch" href="/assets/covarianceAndContravariance.html.6381b8d1.js"><link rel="prefetch" href="/assets/createArrays.html.07c7f54e.js"><link rel="prefetch" href="/assets/curry.html.93af2434.js"><link rel="prefetch" href="/assets/functionParameters.html.2bc0bce3.js"><link rel="prefetch" href="/assets/infer.html.dffcefb6.js"><link rel="prefetch" href="/assets/lazyObjectLiteralInitialization.html.48e8eb1c.js"><link rel="prefetch" href="/assets/limitPropertySetters.html.cd6bdf58.js"><link rel="prefetch" href="/assets/metadata.html.b2c4b7a4.js"><link rel="prefetch" href="/assets/nominalTyping.html.3def95ac.js"><link rel="prefetch" href="/assets/outFileCaution.html.893fb48e.js"><link rel="prefetch" href="/assets/singletonPatern.html.7f3fa874.js"><link rel="prefetch" href="/assets/statefulFunctions.html.902dc0a4.js"><link rel="prefetch" href="/assets/staticConstructors.html.c963433e.js"><link rel="prefetch" href="/assets/stringBasedEmuns.html.4d51172e.js"><link rel="prefetch" href="/assets/truthy.html.321648c2.js"><link rel="prefetch" href="/assets/typeInstantiation.html.e80e9d1f.js"><link rel="prefetch" href="/assets/typesafeEventEmitter.html.d371c45a.js"><link rel="prefetch" href="/assets/ambient.html.d3e45925.js"><link rel="prefetch" href="/assets/callable.html.78f28b2a.js"><link rel="prefetch" href="/assets/discrominatedUnion.html.dd367a6b.js"><link rel="prefetch" href="/assets/enums.html.5d99cf37.js"><link rel="prefetch" href="/assets/exceptionsHanding.html.ac63f2c7.js"><link rel="prefetch" href="/assets/freshness.html.32374e33.js"><link rel="prefetch" href="/assets/functions.html.525b6826.js"><link rel="prefetch" href="/assets/generices.html.3a6697ee.js"><link rel="prefetch" href="/assets/indexSignatures.html.070b7720.js"><link rel="prefetch" href="/assets/interfaces.html.e76e54f7.js"><link rel="prefetch" href="/assets/lib.html.f888b808.js"><link rel="prefetch" href="/assets/literals.html.38c6f557.js"><link rel="prefetch" href="/assets/migrating.html.324ecacf.js"><link rel="prefetch" href="/assets/mixins.html.aca47b2c.js"><link rel="prefetch" href="/assets/movingTypes.html.cbc057f5.js"><link rel="prefetch" href="/assets/neverType.html.91f6eb90.js"><link rel="prefetch" href="/assets/overview.html.d0a73422.js"><link rel="prefetch" href="/assets/readonly.html.409525f7.js"><link rel="prefetch" href="/assets/thisType.html.778c3245.js"><link rel="prefetch" href="/assets/typeAssertion.html.1a922521.js"><link rel="prefetch" href="/assets/typeCompatibility.html.b4c9b32d.js"><link rel="prefetch" href="/assets/typeGuard.html.1abb4717.js"><link rel="prefetch" href="/assets/typeInference.html.96ba068d.js"><link rel="prefetch" href="/assets/types.html.ddae0e41.js"><link rel="prefetch" href="/assets/pluginDva.html.17d4556f.js"><link rel="prefetch" href="/assets/pluginQiankun.html.171d739b.js"><link rel="prefetch" href="/assets/codegen.html.2ecf9b48.js"><link rel="prefetch" href="/assets/entrance.html.b14b83a2.js"><link rel="prefetch" href="/assets/optimize.html.8ea2ec71.js"><link rel="prefetch" href="/assets/outline.html.b603e1b4.js"><link rel="prefetch" href="/assets/parse.html.9b72649e.js"><link rel="prefetch" href="/assets/async-component.html.55d8c591.js"><link rel="prefetch" href="/assets/component-register.html.e4a9639b.js"><link rel="prefetch" href="/assets/create-component.html.a939b546.js"><link rel="prefetch" href="/assets/lifecycle.html.231449e9.js"><link rel="prefetch" href="/assets/merge-option.html.164a7ace.js"><link rel="prefetch" href="/assets/outline.html.0a5d05ef.js"><link rel="prefetch" href="/assets/patch.html.7d106e0f.js"><link rel="prefetch" href="/assets/_index.html.01119d10.js"><link rel="prefetch" href="/assets/create-element.html.ed89f773.js"><link rel="prefetch" href="/assets/mounted.html.2df753ca.js"><link rel="prefetch" href="/assets/new-vue.html.64477253.js"><link rel="prefetch" href="/assets/render.html.508d78e3.js"><link rel="prefetch" href="/assets/update.html.4c8c0382.js"><link rel="prefetch" href="/assets/virtual-dom.html.43e98a7e.js"><link rel="prefetch" href="/assets/event.html.90f1a87a.js"><link rel="prefetch" href="/assets/keep-alive.html.9ba68bca.js"><link rel="prefetch" href="/assets/outline.html.e958d1eb.js"><link rel="prefetch" href="/assets/slot.html.ccce385c.js"><link rel="prefetch" href="/assets/tansition-group.html.362b4be9.js"><link rel="prefetch" href="/assets/tansition.html.a273892a.js"><link rel="prefetch" href="/assets/v-model.html.f2a4db87.js"><link rel="prefetch" href="/assets/baseInterview.html.ac5b39c1.js"><link rel="prefetch" href="/assets/baseInterviewSecond.html.c2f78cac.js"><link rel="prefetch" href="/assets/componentCommunication.html.5f07f4ce.js"><link rel="prefetch" href="/assets/detailedResponsiveness.html.8a3be2c8.js"><link rel="prefetch" href="/assets/diff.html.1e413014.js"><link rel="prefetch" href="/assets/eventBinding.html.71504c25.js"><link rel="prefetch" href="/assets/eventMechanism.html.79aaccfa.js"><link rel="prefetch" href="/assets/key.html.11960915.js"><link rel="prefetch" href="/assets/knowledgeSystem.html.3a184302.js"><link rel="prefetch" href="/assets/slot.html.4f2ce75a.js"><link rel="prefetch" href="/assets/sourceCodeAsyncDomUpdateNextTick.html.05cc8d73.js"><link rel="prefetch" href="/assets/sourceCodeElementBroadcastDispatch.html.39afb075.js"><link rel="prefetch" href="/assets/sourceCodeKeepAlive.html.55519673.js"><link rel="prefetch" href="/assets/sourceCodeResponsiveness.html.f2e41947.js"><link rel="prefetch" href="/assets/sourceCodeTemplateCompilation.html.ec79caa8.js"><link rel="prefetch" href="/assets/sourceCodeTemplateDom.html.29c1437e.js"><link rel="prefetch" href="/assets/sourceCodeVuex.html.13794cf5.js"><link rel="prefetch" href="/assets/vNode.html.8e44ddf1.js"><link rel="prefetch" href="/assets/vNodeDiff.html.26db3cce.js"><link rel="prefetch" href="/assets/build.html.adf8fae3.js"><link rel="prefetch" href="/assets/directory.html.d1d71c01.js"><link rel="prefetch" href="/assets/entrance.html.b14c2908.js"><link rel="prefetch" href="/assets/flow.html.a37016e9.js"><link rel="prefetch" href="/assets/component-update.html.ec6577d6.js"><link rel="prefetch" href="/assets/computed-watcher.html.dca2392b.js"><link rel="prefetch" href="/assets/getters.html.47320890.js"><link rel="prefetch" href="/assets/next-tick.html.33230753.js"><link rel="prefetch" href="/assets/outline.html.820b50b3.js"><link rel="prefetch" href="/assets/props.html.63d3d84a.js"><link rel="prefetch" href="/assets/questions.html.c3ca478e.js"><link rel="prefetch" href="/assets/reactive-object.html.37193b3b.js"><link rel="prefetch" href="/assets/setters.html.27515d95.js"><link rel="prefetch" href="/assets/summary.html.93aa7a22.js"><link rel="prefetch" href="/assets/install.html.c5e04290.js"><link rel="prefetch" href="/assets/matcher.html.e6eff4fa.js"><link rel="prefetch" href="/assets/outline.html.949f69d4.js"><link rel="prefetch" href="/assets/router.html.1a64a657.js"><link rel="prefetch" href="/assets/transition-to.html.97158eda.js"><link rel="prefetch" href="/assets/api.html.0a0d616b.js"><link rel="prefetch" href="/assets/idex.html.19b893c9.js"><link rel="prefetch" href="/assets/init.html.7183c452.js"><link rel="prefetch" href="/assets/plugin.html.3eea99fc.js"><link rel="prefetch" href="/assets/baseInterview.html.be86515f.js"><link rel="prefetch" href="/assets/configuration.html.71b41053.js"><link rel="prefetch" href="/assets/entryPoints.html.193207b3.js"><link rel="prefetch" href="/assets/loader.html.7a5c68c0.js"><link rel="prefetch" href="/assets/output.html.abb331c1.js"><link rel="prefetch" href="/assets/plugin.html.e9b4c501.js"><link rel="prefetch" href="/assets/webpackInterview.html.e1659673.js"><link rel="prefetch" href="/assets/reactApi.html.76ebf3b4.js"><link rel="prefetch" href="/assets/reactChildren.html.9cd4ebdc.js"><link rel="prefetch" href="/assets/reactElement.html.90f82400.js"><link rel="prefetch" href="/assets/reactFiber.html.fbd5ab7c.js"><link rel="prefetch" href="/assets/commitAllHostEffects.html.316314c0.js"><link rel="prefetch" href="/assets/commitAllLifeCycles.html.41e8608c.js"><link rel="prefetch" href="/assets/commitBeforeMutationLifecycles.html.c1b73d6b.js"><link rel="prefetch" href="/assets/commitDeletion.html.b6209b4f.js"><link rel="prefetch" href="/assets/commitPlacement.html.ca659adf.js"><link rel="prefetch" href="/assets/commitRoot.html.89dddbb6.js"><link rel="prefetch" href="/assets/commitWork.html.ea092ed1.js"><link rel="prefetch" href="/assets/invokeGuardedCallback.html.61fc4977.js"><link rel="prefetch" href="/assets/expirationTime.html.a8cdfc1b.js"><link rel="prefetch" href="/assets/reactDomRender.html.c8ed4bb9.js"><link rel="prefetch" href="/assets/setStateForceUpdate.html.7a7bf259.js"><link rel="prefetch" href="/assets/context.html.2c52e1a8.js"><link rel="prefetch" href="/assets/evenInit.html.579283e3.js"><link rel="prefetch" href="/assets/eventBind.html.edc96463.js"><link rel="prefetch" href="/assets/eventCreateEventObject.html.db4f5e23.js"><link rel="prefetch" href="/assets/eventDispath.html.6adc984d.js"><link rel="prefetch" href="/assets/hydrate.html.83a4ff0e.js"><link rel="prefetch" href="/assets/ref.html.1615947c.js"><link rel="prefetch" href="/assets/suspense.html.95aeab34.js"><link rel="prefetch" href="/assets/suspenseLazy.html.b193370a.js"><link rel="prefetch" href="/assets/suspenseWork.html.0a30a3e1.js"><link rel="prefetch" href="/assets/hooksCommon.html.f773d315.js"><link rel="prefetch" href="/assets/hooksOther.html.06904418.js"><link rel="prefetch" href="/assets/start.html.6a674588.js"><link rel="prefetch" href="/assets/useEffect.html.f926152d.js"><link rel="prefetch" href="/assets/useState.html.d40f4858.js"><link rel="prefetch" href="/assets/base.html.d709cd9a.js"><link rel="prefetch" href="/assets/commpontDiff.html.e52511ce.js"><link rel="prefetch" href="/assets/componentUpdate.html.25b5e12a.js"><link rel="prefetch" href="/assets/renderProcess.html.e33d112b.js"><link rel="prefetch" href="/assets/schedulingPrinciple.html.fff2128c.js"><link rel="prefetch" href="/assets/beginWork.html.d5794311.js"><link rel="prefetch" href="/assets/globalVariable.html.3f7b0b7b.js"><link rel="prefetch" href="/assets/mountIndeterminateComponent.html.5495850d.js"><link rel="prefetch" href="/assets/mountLazyCompont.html.3859a94f.js"><link rel="prefetch" href="/assets/performUnitOfWork.html.bb4938d2.js"><link rel="prefetch" href="/assets/performWork.html.fa12153a.js"><link rel="prefetch" href="/assets/reactScheduler.html.c2e9bd54.js"><link rel="prefetch" href="/assets/reconcileChildren.html.8aac0502.js"><link rel="prefetch" href="/assets/reconcileChildrenArray.html.10e33aca.js"><link rel="prefetch" href="/assets/reconcileSingleElement.html.fc288c89.js"><link rel="prefetch" href="/assets/renderRoot.html.35b7e66d.js"><link rel="prefetch" href="/assets/scheduleWork.html.e505b7bd.js"><link rel="prefetch" href="/assets/throwException.html.a9341664.js"><link rel="prefetch" href="/assets/updateClassComponent.html.6ed38c2e.js"><link rel="prefetch" href="/assets/updateContextConsumer.html.f1690f34.js"><link rel="prefetch" href="/assets/updateContextProvider.html.cd45b275.js"><link rel="prefetch" href="/assets/updateForwardRef.html.859d4026.js"><link rel="prefetch" href="/assets/updateFragment.html.7c6ddb82.js"><link rel="prefetch" href="/assets/updateFunctionalComponent.html.50107854.js"><link rel="prefetch" href="/assets/updateHostComponent.html.b799d439.js"><link rel="prefetch" href="/assets/updateHostRoot.html.556c4f9c.js"><link rel="prefetch" href="/assets/updateHostText.html.b9662d9c.js"><link rel="prefetch" href="/assets/updateMode.html.087a95e3.js"><link rel="prefetch" href="/assets/updatePortalComponent.html.9ea65aea.js"><link rel="prefetch" href="/assets/updateProfiler.html.ad90ef72.js"><link rel="prefetch" href="/assets/updateSuspenseComponent.html.eb88de08.js"><link rel="prefetch" href="/assets/interview1.html.d37b8e66.js"><link rel="prefetch" href="/assets/interview2.html.7d34b755.js"><link rel="prefetch" href="/assets/interview3.html.3a7a41e9.js"><link rel="prefetch" href="/assets/interview51.html.df6c0ba8.js"><link rel="prefetch" href="/assets/interview52.html.775e6c08.js"><link rel="prefetch" href="/assets/interview53.html.4f956454.js"><link rel="prefetch" href="/assets/interview54.html.1afb9e13.js"><link rel="prefetch" href="/assets/interview55.html.9a7d4b4d.js"><link rel="prefetch" href="/assets/interview56.html.81d59c9a.js"><link rel="prefetch" href="/assets/interview57.html.7036f925.js"><link rel="prefetch" href="/assets/interview1.html.27eb9a6c.js"><link rel="prefetch" href="/assets/interview10.html.c6ce16f1.js"><link rel="prefetch" href="/assets/interview11.html.2e0d149f.js"><link rel="prefetch" href="/assets/interview12.html.b0685df4.js"><link rel="prefetch" href="/assets/interview13.html.ad1d9bab.js"><link rel="prefetch" href="/assets/interview14.html.b15b676e.js"><link rel="prefetch" href="/assets/interview15.html.700e68f5.js"><link rel="prefetch" href="/assets/interview16.html.2cfb181a.js"><link rel="prefetch" href="/assets/interview17.html.35175329.js"><link rel="prefetch" href="/assets/interview18.html.f3503508.js"><link rel="prefetch" href="/assets/interview19.html.8a63c151.js"><link rel="prefetch" href="/assets/interview2.html.0e9db2e5.js"><link rel="prefetch" href="/assets/interview20.html.32e68f37.js"><link rel="prefetch" href="/assets/interview21.html.f950dced.js"><link rel="prefetch" href="/assets/interview22.html.aeafc856.js"><link rel="prefetch" href="/assets/interview23.html.526dda09.js"><link rel="prefetch" href="/assets/interview24.html.9aba79d3.js"><link rel="prefetch" href="/assets/interview25.html.74afcff1.js"><link rel="prefetch" href="/assets/interview26.html.cea3e20b.js"><link rel="prefetch" href="/assets/interview27.html.834dfcf8.js"><link rel="prefetch" href="/assets/interview28.html.f6b6096f.js"><link rel="prefetch" href="/assets/interview29.html.a6b435ed.js"><link rel="prefetch" href="/assets/interview3.html.7e891a3a.js"><link rel="prefetch" href="/assets/interview30.html.09e5106f.js"><link rel="prefetch" href="/assets/interview31.html.df1beba1.js"><link rel="prefetch" href="/assets/interview32.html.444f6bff.js"><link rel="prefetch" href="/assets/interview33.html.c1eaa159.js"><link rel="prefetch" href="/assets/interview34.html.276b0c52.js"><link rel="prefetch" href="/assets/interview35.html.6b785fa7.js"><link rel="prefetch" href="/assets/interview36.html.78b6f216.js"><link rel="prefetch" href="/assets/interview37.html.59794450.js"><link rel="prefetch" href="/assets/interview38.html.b7eee4c9.js"><link rel="prefetch" href="/assets/interview39.html.93888e69.js"><link rel="prefetch" href="/assets/interview4.html.c28f1eda.js"><link rel="prefetch" href="/assets/interview40.html.94bd1562.js"><link rel="prefetch" href="/assets/interview41.html.770bd2cc.js"><link rel="prefetch" href="/assets/interview42.html.a737e711.js"><link rel="prefetch" href="/assets/interview43.html.e09bc6ea.js"><link rel="prefetch" href="/assets/interview44.html.1c8a8f9f.js"><link rel="prefetch" href="/assets/interview45.html.4a77f666.js"><link rel="prefetch" href="/assets/interview46.html.06e2c8e1.js"><link rel="prefetch" href="/assets/interview47.html.5ec6c91d.js"><link rel="prefetch" href="/assets/interview48.html.77adc2c3.js"><link rel="prefetch" href="/assets/interview49.html.0eb48b20.js"><link rel="prefetch" href="/assets/interview5.html.8c7ed953.js"><link rel="prefetch" href="/assets/interview50.html.e5e4a94c.js"><link rel="prefetch" href="/assets/interview6.html.7cfb68fc.js"><link rel="prefetch" href="/assets/interview7.html.4f25382d.js"><link rel="prefetch" href="/assets/interview8.html.665bf39c.js"><link rel="prefetch" href="/assets/interview9.html.b2663fd5.js"><link rel="prefetch" href="/assets/404.html.82bd4b1a.js"><link rel="prefetch" href="/assets/index.html.2f713335.js"><link rel="prefetch" href="/assets/index.html.1a811f74.js"><link rel="prefetch" href="/assets/index.html.79fe6d6e.js"><link rel="prefetch" href="/assets/index.html.dcd15e89.js"><link rel="prefetch" href="/assets/index.html.e8952663.js"><link rel="prefetch" href="/assets/index.html.5ad7ff00.js"><link rel="prefetch" href="/assets/index.html.92637d35.js"><link rel="prefetch" href="/assets/index.html.149d33dc.js"><link rel="prefetch" href="/assets/index.html.3babb5a0.js"><link rel="prefetch" href="/assets/index.html.0127a8d1.js"><link rel="prefetch" href="/assets/index.html.cf0b512f.js"><link rel="prefetch" href="/assets/index.html.7a2995c4.js"><link rel="prefetch" href="/assets/index.html.483f95c6.js"><link rel="prefetch" href="/assets/index.html.9d646b5f.js"><link rel="prefetch" href="/assets/README_default.html.88791772.js"><link rel="prefetch" href="/assets/slide.html.fc5868e2.js"><link rel="prefetch" href="/assets/_sidebar.html.ceb67e57.js"><link rel="prefetch" href="/assets/_sidebar.html.576d8b48.js"><link rel="prefetch" href="/assets/base.html.e487ea28.js"><link rel="prefetch" href="/assets/customCli.html.94b071f9.js"><link rel="prefetch" href="/assets/_sidebar.html.559323b5.js"><link rel="prefetch" href="/assets/adapter.html.36ff05a8.js"><link rel="prefetch" href="/assets/amd.html.7aa8cd53.js"><link rel="prefetch" href="/assets/builder.html.13056270.js"><link rel="prefetch" href="/assets/censorJquery.html.f99da9a5.js"><link rel="prefetch" href="/assets/combination.html.1c97fc14.js"><link rel="prefetch" href="/assets/command.html.2edcca34.js"><link rel="prefetch" href="/assets/commonJS.html.a9fb5ed6.js"><link rel="prefetch" href="/assets/constructor.html.91098740.js"><link rel="prefetch" href="/assets/decoration.html.e5abaffd.js"><link rel="prefetch" href="/assets/esHarmony.html.239197c4.js"><link rel="prefetch" href="/assets/exposed.html.11f6f4f7.js"><link rel="prefetch" href="/assets/exterior.html.8f2ce26f.js"><link rel="prefetch" href="/assets/factory.html.6a570521.js"><link rel="prefetch" href="/assets/flyweight.html.47807019.js"><link rel="prefetch" href="/assets/functionalProgramming.html.02d11590.js"><link rel="prefetch" href="/assets/intermediary.html.206e0a72.js"><link rel="prefetch" href="/assets/iterator.html.218d3545.js"><link rel="prefetch" href="/assets/lazyInitial.html.26039a99.js"><link rel="prefetch" href="/assets/mixin.html.8b1b2e4f.js"><link rel="prefetch" href="/assets/module.html.da373ff2.js"><link rel="prefetch" href="/assets/mvc.html.746b4703.js"><link rel="prefetch" href="/assets/mvp.html.82de3736.js"><link rel="prefetch" href="/assets/mvvm.html.503e7882.js"><link rel="prefetch" href="/assets/observer.html.be7622a9.js"><link rel="prefetch" href="/assets/outward.html.a420311a.js"><link rel="prefetch" href="/assets/overview.html.496c1932.js"><link rel="prefetch" href="/assets/prototype.html.cda23ab7.js"><link rel="prefetch" href="/assets/proxy.html.36fbd60e.js"><link rel="prefetch" href="/assets/singleton.html.900039c9.js"><link rel="prefetch" href="/assets/axios.html.297188ba.js"><link rel="prefetch" href="/assets/createUnderscore.html.1c25610b.js"><link rel="prefetch" href="/assets/jquery.html.3a7e432d.js"><link rel="prefetch" href="/assets/lodash.html.d0f34897.js"><link rel="prefetch" href="/assets/sentry.html.bc3be63f.js"><link rel="prefetch" href="/assets/underscore.html.f92feeea.js"><link rel="prefetch" href="/assets/vuex.html.bae062a9.js"><link rel="prefetch" href="/assets/customCli.html.3433d283.js"><link rel="prefetch" href="/assets/description.html.435cb5be.js"><link rel="prefetch" href="/assets/indx.html.6aa4a456.js"><link rel="prefetch" href="/assets/rebase.html.8c7b8ce6.js"><link rel="prefetch" href="/assets/index.html.564cdb07.js"><link rel="prefetch" href="/assets/disable.html.96889909.js"><link rel="prefetch" href="/assets/encrypt.html.c635b091.js"><link rel="prefetch" href="/assets/markdown.html.e40bdca2.js"><link rel="prefetch" href="/assets/page.html.1b966aa0.js"><link rel="prefetch" href="/assets/_sidebar.html.76a9475e.js"><link rel="prefetch" href="/assets/_sidebar.html.3abaa150.js"><link rel="prefetch" href="/assets/_sidebar.html.2de4adf1.js"><link rel="prefetch" href="/assets/44Questions.html.0ce8e2db.js"><link rel="prefetch" href="/assets/asyncAwait.html.35490c6d.js"><link rel="prefetch" href="/assets/babelCompile.html.2ba5cf3b.js"><link rel="prefetch" href="/assets/base.html.85bfd4e9.js"><link rel="prefetch" href="/assets/baseInterview.html.cbd464ba.js"><link rel="prefetch" href="/assets/baseWebpack.html.94d3c8c5.js"><link rel="prefetch" href="/assets/codeSeparation.html.2bcaa57c.js"><link rel="prefetch" href="/assets/cycle.html.756a66db.js"><link rel="prefetch" href="/assets/cycleOtherWay.html.6a7d1e56.js"><link rel="prefetch" href="/assets/executionMechanism.html.1782e08c.js"><link rel="prefetch" href="/assets/hybrid.html.69c5d93e.js"><link rel="prefetch" href="/assets/jsHandwriting.html.cf4d07d3.js"><link rel="prefetch" href="/assets/jsonStringify.html.3b534817.js"><link rel="prefetch" href="/assets/largeFileResumableUpload.html.1359e778.js"><link rel="prefetch" href="/assets/performance.html.5df78002.js"><link rel="prefetch" href="/assets/promise.html.dc035f58.js"><link rel="prefetch" href="/assets/promiseAll.html.dade3c31.js"><link rel="prefetch" href="/assets/spa.html.182789d3.js"><link rel="prefetch" href="/assets/tsBaseInterview.html.531f8339.js"><link rel="prefetch" href="/assets/useEs6.html.f33e66c4.js"><link rel="prefetch" href="/assets/webAnimations.html.a727c352.js"><link rel="prefetch" href="/assets/webpackInterview.html.f4f130c7.js"><link rel="prefetch" href="/assets/webpackLoader.html.5b743bdb.js"><link rel="prefetch" href="/assets/webpackPublic.html.a04384c3.js"><link rel="prefetch" href="/assets/weird.html.e762cbf6.js"><link rel="prefetch" href="/assets/es10News.html.07a7a425.js"><link rel="prefetch" href="/assets/es11News.html.ebad927a.js"><link rel="prefetch" href="/assets/es6Interview1.html.1cbbd1df.js"><link rel="prefetch" href="/assets/es6Interview2.html.68936009.js"><link rel="prefetch" href="/assets/es6Interview3.html.d0e5d013.js"><link rel="prefetch" href="/assets/es6News.html.ba3927fe.js"><link rel="prefetch" href="/assets/es7News.html.b6ba465e.js"><link rel="prefetch" href="/assets/es8News.html.5439839e.js"><link rel="prefetch" href="/assets/es9News.html.51765495.js"><link rel="prefetch" href="/assets/base.html.112ff112.js"><link rel="prefetch" href="/assets/nginxComprehensiveScene.html.48b3f8db.js"><link rel="prefetch" href="/assets/commonlyUsed.html.0c106f45.js"><link rel="prefetch" href="/assets/inelegantHook.html.c1014513.js"><link rel="prefetch" href="/assets/interview1.html.21935a78.js"><link rel="prefetch" href="/assets/interview2.html.ee39447f.js"><link rel="prefetch" href="/assets/interview3.html.5d43e661.js"><link rel="prefetch" href="/assets/interview4.html.df9fec55.js"><link rel="prefetch" href="/assets/base.html.cef78a2c.js"><link rel="prefetch" href="/assets/introduction.html.87ddb3eb.js"><link rel="prefetch" href="/assets/base.html.28becb13.js"><link rel="prefetch" href="/assets/summarize.html.41f9113e.js"><link rel="prefetch" href="/assets/_sidebar.html.f25604d5.js"><link rel="prefetch" href="/assets/index.html.cd329420.js"><link rel="prefetch" href="/assets/baseInterview.html.b429562e.js"><link rel="prefetch" href="/assets/baseInterview.html.53d9b390.js"><link rel="prefetch" href="/assets/bigDataRender.html.e1f19d0f.js"><link rel="prefetch" href="/assets/progress.html.95599bac.js"><link rel="prefetch" href="/assets/quirksStandards.html.1241febb.js"><link rel="prefetch" href="/assets/redrawReflow.html.7b65e02d.js"><link rel="prefetch" href="/assets/storageSpace.html.aad334a2.js"><link rel="prefetch" href="/assets/webComLink.html.7faca748.js"><link rel="prefetch" href="/assets/webUrl.html.418d4539.js"><link rel="prefetch" href="/assets/spanWidthHeight.html.2d4e36e1.js"><link rel="prefetch" href="/assets/baseCss.html.55767d88.js"><link rel="prefetch" href="/assets/blockFormattingContext.html.cc11959f.js"><link rel="prefetch" href="/assets/containingBlock.html.297ce2a0.js"><link rel="prefetch" href="/assets/cssBeforeAfter.html.b6c42da8.js"><link rel="prefetch" href="/assets/cssBoxModal.html.578a8a9f.js"><link rel="prefetch" href="/assets/cssCollapsing.html.c1a5dbc9.js"><link rel="prefetch" href="/assets/cssCompatible.html.77ba7b8e.js"><link rel="prefetch" href="/assets/cssFlexDemo.html.c239808b.js"><link rel="prefetch" href="/assets/cssFlexLayout.html.b0e09407.js"><link rel="prefetch" href="/assets/cssGridLayout.html.54c82244.js"><link rel="prefetch" href="/assets/cssHack.html.8149f520.js"><link rel="prefetch" href="/assets/cssInlineBlock.html.f9725841.js"><link rel="prefetch" href="/assets/cssPriority.html.2605c143.js"><link rel="prefetch" href="/assets/cssPseudo.html.b7b4f497.js"><link rel="prefetch" href="/assets/cssPseudoClass.html.8e05a832.js"><link rel="prefetch" href="/assets/cssSelector.html.22611dbf.js"><link rel="prefetch" href="/assets/cssTutorial.html.36b0f48e.js"><link rel="prefetch" href="/assets/fieldInvalid.html.5a0bb859.js"><link rel="prefetch" href="/assets/frame.html.85881bca.js"><link rel="prefetch" href="/assets/knowledgePoints.html.79a48e93.js"><link rel="prefetch" href="/assets/linkImport.html.20f6a1eb.js"><link rel="prefetch" href="/assets/stackingContext.html.7bb007b6.js"><link rel="prefetch" href="/assets/tools.html.68994b46.js"><link rel="prefetch" href="/assets/units.html.0ed920d5.js"><link rel="prefetch" href="/assets/transform.html.e9029e73.js"><link rel="prefetch" href="/assets/content.html.39b65bdb.js"><link rel="prefetch" href="/assets/plugins.html.78629d3f.js"><link rel="prefetch" href="/assets/accesskey.html.7b097fa6.js"><link rel="prefetch" href="/assets/baseInterview.html.fb1aea8f.js"><link rel="prefetch" href="/assets/canvasSvg.html.65c70cde.js"><link rel="prefetch" href="/assets/deviceAPI.html.6486175e.js"><link rel="prefetch" href="/assets/globalAttr.html.00bce5f2.js"><link rel="prefetch" href="/assets/htmlDatalist.html.92eeb95b.js"><link rel="prefetch" href="/assets/htmlElement.html.e9e3cfb8.js"><link rel="prefetch" href="/assets/interview10.html.e67cac55.js"><link rel="prefetch" href="/assets/interview11.html.8130d574.js"><link rel="prefetch" href="/assets/interview12.html.3a1e4771.js"><link rel="prefetch" href="/assets/interview13.html.62692ac9.js"><link rel="prefetch" href="/assets/interview14.html.b0c2a6a5.js"><link rel="prefetch" href="/assets/interview15.html.5a461c1c.js"><link rel="prefetch" href="/assets/interview16.html.095cb776.js"><link rel="prefetch" href="/assets/interview17.html.0310bcb7.js"><link rel="prefetch" href="/assets/interview18.html.e424570c.js"><link rel="prefetch" href="/assets/interview19.html.65f851ed.js"><link rel="prefetch" href="/assets/interview20.html.a2522183.js"><link rel="prefetch" href="/assets/interview21.html.7c2efd5a.js"><link rel="prefetch" href="/assets/interview22.html.e28c6e36.js"><link rel="prefetch" href="/assets/interview23.html.f271dacb.js"><link rel="prefetch" href="/assets/interview24.html.99d41bbb.js"><link rel="prefetch" href="/assets/interview25.html.8e52bfc1.js"><link rel="prefetch" href="/assets/interview26.html.b3e7556a.js"><link rel="prefetch" href="/assets/interview27.html.c304ca06.js"><link rel="prefetch" href="/assets/interview28.html.67c59208.js"><link rel="prefetch" href="/assets/interview29.html.0d936102.js"><link rel="prefetch" href="/assets/interview30.html.ff74a11f.js"><link rel="prefetch" href="/assets/interview31.html.0fd6a7a4.js"><link rel="prefetch" href="/assets/interview32.html.92999aac.js"><link rel="prefetch" href="/assets/interview33.html.8ff8e6f0.js"><link rel="prefetch" href="/assets/interview34.html.d41dcae9.js"><link rel="prefetch" href="/assets/interview35.html.88bcab95.js"><link rel="prefetch" href="/assets/interview36.html.6bbe0fe3.js"><link rel="prefetch" href="/assets/interview37.html.78767f74.js"><link rel="prefetch" href="/assets/interview38.html.3e3ef821.js"><link rel="prefetch" href="/assets/interview39.html.0634d1eb.js"><link rel="prefetch" href="/assets/interview40.html.86d386af.js"><link rel="prefetch" href="/assets/interview41.html.200c2298.js"><link rel="prefetch" href="/assets/interview42.html.be24467b.js"><link rel="prefetch" href="/assets/interview43.html.1b7b96eb.js"><link rel="prefetch" href="/assets/interview44.html.27e1a399.js"><link rel="prefetch" href="/assets/interview45.html.eef7288b.js"><link rel="prefetch" href="/assets/interview46.html.1fbeea4f.js"><link rel="prefetch" href="/assets/interview47.html.5c3f1ad8.js"><link rel="prefetch" href="/assets/interview48.html.d975573a.js"><link rel="prefetch" href="/assets/interview49.html.7b344b16.js"><link rel="prefetch" href="/assets/interview5.html.eef1939b.js"><link rel="prefetch" href="/assets/interview50.html.f901f00e.js"><link rel="prefetch" href="/assets/interview51.html.02c95d5c.js"><link rel="prefetch" href="/assets/interview52.html.14969192.js"><link rel="prefetch" href="/assets/interview53.html.d972a35c.js"><link rel="prefetch" href="/assets/interview54.html.70c7d254.js"><link rel="prefetch" href="/assets/interview55.html.ba505cc4.js"><link rel="prefetch" href="/assets/interview56.html.054f1348.js"><link rel="prefetch" href="/assets/interview57.html.928b74bf.js"><link rel="prefetch" href="/assets/interview58.html.41686127.js"><link rel="prefetch" href="/assets/interview59.html.59066a8a.js"><link rel="prefetch" href="/assets/interview6.html.2f15587a.js"><link rel="prefetch" href="/assets/interview7.html.c2af2549.js"><link rel="prefetch" href="/assets/interview8.html.3296a3d6.js"><link rel="prefetch" href="/assets/interview9.html.76c60416.js"><link rel="prefetch" href="/assets/linkImport.html.58687459.js"><link rel="prefetch" href="/assets/offlineStorage.html.16e78417.js"><link rel="prefetch" href="/assets/regular.html.b2f974ab.js"><link rel="prefetch" href="/assets/shake.html.8949c5a6.js"><link rel="prefetch" href="/assets/webWorker.html.7ee57f67.js"><link rel="prefetch" href="/assets/baseInterview.html.981f8975.js"><link rel="prefetch" href="/assets/cors.html.f690d0e9.js"><link rel="prefetch" href="/assets/crossDomainCookie.html.fdc965cc.js"><link rel="prefetch" href="/assets/fetch.html.43506e52.js"><link rel="prefetch" href="/assets/nestAxios.html.2ad054b4.js"><link rel="prefetch" href="/assets/debounce.html.e29fd436.js"><link rel="prefetch" href="/assets/lodashPrinciple.html.818bd345.js"><link rel="prefetch" href="/assets/lodashThrottleDebounce.html.b3b9f237.js"><link rel="prefetch" href="/assets/throttle.html.bfc647bd.js"><link rel="prefetch" href="/assets/throttleDebounceReact.html.a64ce3c5.js"><link rel="prefetch" href="/assets/cloneIntroduction.html.f7f87c9f.js"><link rel="prefetch" href="/assets/deepClone.html.c499e2ca.js"><link rel="prefetch" href="/assets/lodashDeepClone.html.85187698.js"><link rel="prefetch" href="/assets/objectAssign.html.6bd4b16a.js"><link rel="prefetch" href="/assets/arraySourceCode.html.f70964cc.js"><link rel="prefetch" href="/assets/baseHigh.html.ec1f46a9.js"><link rel="prefetch" href="/assets/currying.html.5bd68e38.js"><link rel="prefetch" href="/assets/baseInterview.html.b8eba5f9.js"><link rel="prefetch" href="/assets/eventLoop.html.03f610ec.js"><link rel="prefetch" href="/assets/iife.html.e5fa11fa.js"><link rel="prefetch" href="/assets/interview1.html.8f40cf1c.js"><link rel="prefetch" href="/assets/jsCompatible.html.5180282b.js"><link rel="prefetch" href="/assets/baseProyotype.html.b1e0b92d.js"><link rel="prefetch" href="/assets/functionObjectResource.html.684e96da.js"><link rel="prefetch" href="/assets/prototypeInherit.html.67df589f.js"><link rel="prefetch" href="/assets/closureInterview.html.43af7045.js"><link rel="prefetch" href="/assets/scopeChain.html.58eb648a.js"><link rel="prefetch" href="/assets/understandingClosures.html.aac3406b.js"><link rel="prefetch" href="/assets/executionStack.html.a3c2c4f0.js"><link rel="prefetch" href="/assets/memoryLeak.html.3c68618e.js"><link rel="prefetch" href="/assets/memoryMechanism.html.41d15458.js"><link rel="prefetch" href="/assets/memorySpace.html.792639ca.js"><link rel="prefetch" href="/assets/precompiled.html.c136c41c.js"><link rel="prefetch" href="/assets/variableObject.html.5b144d06.js"><link rel="prefetch" href="/assets/arrowFunctionThis.html.0aa84fc3.js"><link rel="prefetch" href="/assets/bindSimulation.html.47a661a7.js"><link rel="prefetch" href="/assets/callApply.html.f22c1aea.js"><link rel="prefetch" href="/assets/newSimulation.html.c0158b90.js"><link rel="prefetch" href="/assets/thisBind.html.95b4763b.js"><link rel="prefetch" href="/assets/interview1.html.9cae532f.js"><link rel="prefetch" href="/assets/interview10.html.0fa15ce5.js"><link rel="prefetch" href="/assets/interview11.html.572760f3.js"><link rel="prefetch" href="/assets/interview12.html.93060c07.js"><link rel="prefetch" href="/assets/interview13.html.16a002c1.js"><link rel="prefetch" href="/assets/interview14.html.08414f41.js"><link rel="prefetch" href="/assets/interview15.html.2839ac09.js"><link rel="prefetch" href="/assets/interview16.html.f41327b0.js"><link rel="prefetch" href="/assets/interview17.html.425bff17.js"><link rel="prefetch" href="/assets/interview18.html.1ff76152.js"><link rel="prefetch" href="/assets/interview19.html.51a67a3b.js"><link rel="prefetch" href="/assets/interview2.html.b390e2d5.js"><link rel="prefetch" href="/assets/interview20.html.fb2a5b49.js"><link rel="prefetch" href="/assets/interview21.html.1007f8d0.js"><link rel="prefetch" href="/assets/interview22.html.debc3ce3.js"><link rel="prefetch" href="/assets/interview23.html.a739938d.js"><link rel="prefetch" href="/assets/interview24.html.b05612e3.js"><link rel="prefetch" href="/assets/interview25.html.01cc5ac4.js"><link rel="prefetch" href="/assets/interview26.html.402ff8ce.js"><link rel="prefetch" href="/assets/interview27.html.c20a1e88.js"><link rel="prefetch" href="/assets/interview28.html.df2ac06e.js"><link rel="prefetch" href="/assets/interview29.html.b8dc7895.js"><link rel="prefetch" href="/assets/interview3.html.28b75dec.js"><link rel="prefetch" href="/assets/interview30.html.dc33ff1c.js"><link rel="prefetch" href="/assets/interview4.html.9e048216.js"><link rel="prefetch" href="/assets/interview5.html.f2bd6f17.js"><link rel="prefetch" href="/assets/interview6.html.2ec26540.js"><link rel="prefetch" href="/assets/interview7.html.8d44e77f.js"><link rel="prefetch" href="/assets/interview8.html.3a3be0dd.js"><link rel="prefetch" href="/assets/interview9.html.db404e19.js"><link rel="prefetch" href="/assets/1.html.22062573.js"><link rel="prefetch" href="/assets/2.html.5970f42a.js"><link rel="prefetch" href="/assets/3.html.3a47bf61.js"><link rel="prefetch" href="/assets/4.html.c7d3cacc.js"><link rel="prefetch" href="/assets/5.html.028ba674.js"><link rel="prefetch" href="/assets/6.html.5da71fa6.js"><link rel="prefetch" href="/assets/adjacentSiblingCombinator.html.0ae0ae0e.js"><link rel="prefetch" href="/assets/attributeSelectors.html.75ad3f55.js"><link rel="prefetch" href="/assets/charset.html.eea4355d.js"><link rel="prefetch" href="/assets/childCombinator.html.8f2eee6d.js"><link rel="prefetch" href="/assets/classSelectors.html.96163f01.js"><link rel="prefetch" href="/assets/descendantCombinator.html.3a611e9d.js"><link rel="prefetch" href="/assets/generalSiblingCombinator.html.b954e23f.js"><link rel="prefetch" href="/assets/iDSelectors.html.75a3b96d.js"><link rel="prefetch" href="/assets/pseudoClasses.html.a8bfb77d.js"><link rel="prefetch" href="/assets/pseudoElements.html.f15edb81.js"><link rel="prefetch" href="/assets/selectorList.html.44e6ed49.js"><link rel="prefetch" href="/assets/typeSelectors.html.0d20ca29.js"><link rel="prefetch" href="/assets/universalSelectors.html.3ed772db.js"><link rel="prefetch" href="/assets/IterationProtocols.html.bd3a74fe.js"><link rel="prefetch" href="/assets/arrayFlat.html.9e701eaf.js"><link rel="prefetch" href="/assets/asyncHistory.html.a0f17173.js"><link rel="prefetch" href="/assets/eventLoop.html.f74a6d53.js"><link rel="prefetch" href="/assets/fileReader.html.ba126349.js"><link rel="prefetch" href="/assets/formData.html.206afee8.js"><link rel="prefetch" href="/assets/functionGenerator.html.69e90ec5.js"><link rel="prefetch" href="/assets/generator.html.9bdea381.js"><link rel="prefetch" href="/assets/intersectionObserver.html.9f8568b1.js"><link rel="prefetch" href="/assets/map.html.0f601d23.js"><link rel="prefetch" href="/assets/promise.html.42128a08.js"><link rel="prefetch" href="/assets/set.html.22fd53c3.js"><link rel="prefetch" href="/assets/string.html.884653f2.js"><link rel="prefetch" href="/assets/symbol.html.e962d3b6.js"><link rel="prefetch" href="/assets/xMLHttpRequest.html.5e2f2924.js"><link rel="prefetch" href="/assets/spreadSyntax.html.c6efee8e.js"><link rel="prefetch" href="/assets/strictMode.html.0d2df301.js"><link rel="prefetch" href="/assets/cache.html.28f76207.js"><link rel="prefetch" href="/assets/drag1.html.d8f00500.js"><link rel="prefetch" href="/assets/oneLineCode.html.9e04e998.js"><link rel="prefetch" href="/assets/oneLineCodeArray.html.288c986c.js"><link rel="prefetch" href="/assets/oneLineCodeDOM.html.ecc42e96.js"><link rel="prefetch" href="/assets/oneLineCodeDateTime.html.b21607cd.js"><link rel="prefetch" href="/assets/oneLineCodeFunction.html.13146091.js"><link rel="prefetch" href="/assets/oneLineCodeMath.html.d11118c6.js"><link rel="prefetch" href="/assets/oneLineCodeMisc.html.b7fb45fb.js"><link rel="prefetch" href="/assets/oneLineCodeNumber.html.919f4739.js"><link rel="prefetch" href="/assets/oneLineCodeObject.html.ea14dc56.js"><link rel="prefetch" href="/assets/oneLineCodeRandom.html.8c512078.js"><link rel="prefetch" href="/assets/oneLineCodeString.html.4e05f7fd.js"><link rel="prefetch" href="/assets/oneLineCodeValidator.html.dad629f1.js"><link rel="prefetch" href="/assets/typeScriptCache.html.6aef5559.js"><link rel="prefetch" href="/assets/reactBase.html.bb141323.js"><link rel="prefetch" href="/assets/reactTypescript.html.94ee7f96.js"><link rel="prefetch" href="/assets/vue2Base.html.2c7f5c4d.js"><link rel="prefetch" href="/assets/vue2Table.html.6ac1b7b4.js"><link rel="prefetch" href="/assets/vue2offsetTop.html.c84a3703.js"><link rel="prefetch" href="/assets/componentWillXXX.html.e213c9f5.js"><link rel="prefetch" href="/assets/disrupt.html.b3e840b9.js"><link rel="prefetch" href="/assets/lane.html.d653558a.js"><link rel="prefetch" href="/assets/prepare.html.ece3cbb1.js"><link rel="prefetch" href="/assets/redux.html.b7c4fae1.js"><link rel="prefetch" href="/assets/scheduler.html.d57e7613.js"><link rel="prefetch" href="/assets/multi.html.53ed9d08.js"><link rel="prefetch" href="/assets/one.html.101fdd96.js"><link rel="prefetch" href="/assets/prepare.html.1614d3c2.js"><link rel="prefetch" href="/assets/create.html.62097ff9.js"><link rel="prefetch" href="/assets/prepare.html.4facb6e4.js"><link rel="prefetch" href="/assets/structure.html.2781622b.js"><link rel="prefetch" href="/assets/useeffect.html.9d720247.js"><link rel="prefetch" href="/assets/usememo.html.1216e788.js"><link rel="prefetch" href="/assets/useref.html.5104dc22.js"><link rel="prefetch" href="/assets/usestate.html.06ca9be3.js"><link rel="prefetch" href="/assets/file.html.4643a962.js"><link rel="prefetch" href="/assets/idea.html.0dfc733a.js"><link rel="prefetch" href="/assets/jsx.html.5cb17c05.js"><link rel="prefetch" href="/assets/newConstructure.html.dde94744.js"><link rel="prefetch" href="/assets/oldConstructure.html.81dd2f36.js"><link rel="prefetch" href="/assets/source.html.b7467456.js"><link rel="prefetch" href="/assets/summary.html.41053903.js"><link rel="prefetch" href="/assets/basePrinciple.html.b29fac01.js"><link rel="prefetch" href="/assets/componentApi.html.81d1a559.js"><link rel="prefetch" href="/assets/domApi.html.b251ac8a.js"><link rel="prefetch" href="/assets/hoc.html.717206f8.js"><link rel="prefetch" href="/assets/hookApi.html.2cda58c8.js"><link rel="prefetch" href="/assets/hookCustom.html.9b5c916c.js"><link rel="prefetch" href="/assets/hookPrinciple.html.c176f29b.js"><link rel="prefetch" href="/assets/hookUse.html.8830b540.js"><link rel="prefetch" href="/assets/reactKeeplive.html.b62f74b9.js"><link rel="prefetch" href="/assets/reactRedux.html.08dd557d.js"><link rel="prefetch" href="/assets/reactRouter.html.b5fd9681.js"><link rel="prefetch" href="/assets/toolApi.html.2a0b7d56.js"><link rel="prefetch" href="/assets/beginWork.html.48228daa.js"><link rel="prefetch" href="/assets/completeWork.html.8de3d840.js"><link rel="prefetch" href="/assets/doubleBuffer.html.1462ad79.js"><link rel="prefetch" href="/assets/fiber-mental.html.ae47849e.js"><link rel="prefetch" href="/assets/fiber.html.f6ceb951.js"><link rel="prefetch" href="/assets/reconciler.html.0e26b432.js"><link rel="prefetch" href="/assets/beforeMutation.html.c5b60e65.js"><link rel="prefetch" href="/assets/layout.html.840d4bc7.js"><link rel="prefetch" href="/assets/mutation.html.f0b0fa23.js"><link rel="prefetch" href="/assets/prepare.html.eb915c86.js"><link rel="prefetch" href="/assets/mental.html.38ab3445.js"><link rel="prefetch" href="/assets/prepare.html.b52069cd.js"><link rel="prefetch" href="/assets/priority.html.fe80ad86.js"><link rel="prefetch" href="/assets/reactdom.html.d1cdcc48.js"><link rel="prefetch" href="/assets/setstate.html.bdd77631.js"><link rel="prefetch" href="/assets/update.html.e79578f8.js"><link rel="prefetch" href="/assets/bitfiled.html.22fc4f5d.js"><link rel="prefetch" href="/assets/dfs.html.efd621b4.js"><link rel="prefetch" href="/assets/diff.html.2a932d63.js"><link rel="prefetch" href="/assets/heapsort.html.2871169c.js"><link rel="prefetch" href="/assets/linkedlist.html.44fe59cc.js"><link rel="prefetch" href="/assets/stack.html.4512b6b8.js"><link rel="prefetch" href="/assets/bootstrap.html.cab8c435.js"><link rel="prefetch" href="/assets/context.html.458cd643.js"><link rel="prefetch" href="/assets/fibertree-commit.html.f3e44f88.js"><link rel="prefetch" href="/assets/fibertree-create.html.b5d6955a.js"><link rel="prefetch" href="/assets/fibertree-prepare.html.2903a9b4.js"><link rel="prefetch" href="/assets/fibertree-update.html.12224855.js"><link rel="prefetch" href="/assets/hook-effect.html.c4822f99.js"><link rel="prefetch" href="/assets/hook-state.html.0581d853.js"><link rel="prefetch" href="/assets/hook-summary.html.4b39be64.js"><link rel="prefetch" href="/assets/macro-structure.html.60d79107.js"><link rel="prefetch" href="/assets/object-structure.html.9739263c.js"><link rel="prefetch" href="/assets/priority.html.f3ed58b9.js"><link rel="prefetch" href="/assets/reconciler-workflow.html.5c07ef9d.js"><link rel="prefetch" href="/assets/scheduler.html.37a76339.js"><link rel="prefetch" href="/assets/state-effects.html.20e70d1c.js"><link rel="prefetch" href="/assets/synthetic-event.html.981fa00b.js"><link rel="prefetch" href="/assets/workloop.html.b139e871.js"><link rel="prefetch" href="/assets/ast.html.d28a32ad.js"><link rel="prefetch" href="/assets/binder.html.923e6e4c.js"><link rel="prefetch" href="/assets/checker.html.a18fbba5.js"><link rel="prefetch" href="/assets/emitter.html.49c2b244.js"><link rel="prefetch" href="/assets/overview.html.0e668b39.js"><link rel="prefetch" href="/assets/parser.html.e21c5ad1.js"><link rel="prefetch" href="/assets/program.html.8e2084b4.js"><link rel="prefetch" href="/assets/scanner.html.55abb0fc.js"><link rel="prefetch" href="/assets/common.html.5ebb4e57.js"><link rel="prefetch" href="/assets/interpreting.html.09a5cb19.js"><link rel="prefetch" href="/assets/class.html.7917b894.js"><link rel="prefetch" href="/assets/commandline-behavior.html.d9f57cfa.js"><link rel="prefetch" href="/assets/comments.html.f1aa62b8.js"><link rel="prefetch" href="/assets/common-bug-not-bugs.html.558ef341.js"><link rel="prefetch" href="/assets/common-feature-request.html.df3767f4.js"><link rel="prefetch" href="/assets/decorators.html.8af1775e.js"><link rel="prefetch" href="/assets/enums.html.838562dc.js"><link rel="prefetch" href="/assets/function.html.1af4e844.js"><link rel="prefetch" href="/assets/generics.html.8661c33f.js"><link rel="prefetch" href="/assets/glossary-and-terms.html.c224c3a5.js"><link rel="prefetch" href="/assets/jsx-and-react.html.6977c825.js"><link rel="prefetch" href="/assets/modules.html.99766e51.js"><link rel="prefetch" href="/assets/thing-that-dont-work.html.d94a4f92.js"><link rel="prefetch" href="/assets/tsconfig-behavior.html.1f99a484.js"><link rel="prefetch" href="/assets/type-guards.html.1cc368b9.js"><link rel="prefetch" href="/assets/type-system-behavior.html.f98b6cb5.js"><link rel="prefetch" href="/assets/nonReactJSX.html.96322615.js"><link rel="prefetch" href="/assets/reactJSX.html.ee9b5078.js"><link rel="prefetch" href="/assets/support.html.a281bf5f.js"><link rel="prefetch" href="/assets/typescript-3.7.html.436b4808.js"><link rel="prefetch" href="/assets/typescript-3.8.html.070f14fe.js"><link rel="prefetch" href="/assets/typescript-3.9.html.dbb8a307.js"><link rel="prefetch" href="/assets/compilationContext.html.05852723.js"><link rel="prefetch" href="/assets/declarationspaces.html.1e9ab711.js"><link rel="prefetch" href="/assets/dynamicImportExpressions.html.a3c06d14.js"><link rel="prefetch" href="/assets/inDepthTs.html.a4d7830b.js"><link rel="prefetch" href="/assets/modules.html.c785f8ad.js"><link rel="prefetch" href="/assets/namespaces.html.70aaf360.js"><link rel="prefetch" href="/assets/unknownAny.html.4e612f12.js"><link rel="prefetch" href="/assets/avoidExportDefault.html.edb05fdb.js"><link rel="prefetch" href="/assets/barrel.html.920658a3.js"><link rel="prefetch" href="/assets/bind.html.220e83e2.js"><link rel="prefetch" href="/assets/buildToggles.html.825a2475.js"><link rel="prefetch" href="/assets/classAreUseful.html.ceaf6bfe.js"><link rel="prefetch" href="/assets/covarianceAndContravariance.html.fd8762e9.js"><link rel="prefetch" href="/assets/createArrays.html.08106f75.js"><link rel="prefetch" href="/assets/curry.html.4a3b07a5.js"><link rel="prefetch" href="/assets/functionParameters.html.6be5ce29.js"><link rel="prefetch" href="/assets/infer.html.38adcef9.js"><link rel="prefetch" href="/assets/lazyObjectLiteralInitialization.html.773341ec.js"><link rel="prefetch" href="/assets/limitPropertySetters.html.3f61d3ca.js"><link rel="prefetch" href="/assets/metadata.html.ebd87428.js"><link rel="prefetch" href="/assets/nominalTyping.html.e55173fb.js"><link rel="prefetch" href="/assets/outFileCaution.html.f0f94623.js"><link rel="prefetch" href="/assets/singletonPatern.html.02bf41b7.js"><link rel="prefetch" href="/assets/statefulFunctions.html.302ca51f.js"><link rel="prefetch" href="/assets/staticConstructors.html.d0cccc38.js"><link rel="prefetch" href="/assets/stringBasedEmuns.html.359a78a0.js"><link rel="prefetch" href="/assets/truthy.html.68be7dbb.js"><link rel="prefetch" href="/assets/typeInstantiation.html.736dfdc1.js"><link rel="prefetch" href="/assets/typesafeEventEmitter.html.2561772c.js"><link rel="prefetch" href="/assets/ambient.html.e3253db3.js"><link rel="prefetch" href="/assets/callable.html.3cc17e69.js"><link rel="prefetch" href="/assets/discrominatedUnion.html.477a9f2b.js"><link rel="prefetch" href="/assets/enums.html.5a3a5e3b.js"><link rel="prefetch" href="/assets/exceptionsHanding.html.2c562781.js"><link rel="prefetch" href="/assets/freshness.html.62675251.js"><link rel="prefetch" href="/assets/functions.html.519b6213.js"><link rel="prefetch" href="/assets/generices.html.6bf6a146.js"><link rel="prefetch" href="/assets/indexSignatures.html.d75e6494.js"><link rel="prefetch" href="/assets/interfaces.html.383c11a5.js"><link rel="prefetch" href="/assets/lib.html.3ebafdfc.js"><link rel="prefetch" href="/assets/literals.html.ee7776a7.js"><link rel="prefetch" href="/assets/migrating.html.5c073842.js"><link rel="prefetch" href="/assets/mixins.html.b55a9a7c.js"><link rel="prefetch" href="/assets/movingTypes.html.0251b4a1.js"><link rel="prefetch" href="/assets/neverType.html.2d983aae.js"><link rel="prefetch" href="/assets/overview.html.8ebe0722.js"><link rel="prefetch" href="/assets/readonly.html.18927093.js"><link rel="prefetch" href="/assets/thisType.html.017d6e02.js"><link rel="prefetch" href="/assets/typeAssertion.html.6d02b221.js"><link rel="prefetch" href="/assets/typeCompatibility.html.b89680d3.js"><link rel="prefetch" href="/assets/typeGuard.html.b35fba68.js"><link rel="prefetch" href="/assets/typeInference.html.f7849fa2.js"><link rel="prefetch" href="/assets/types.html.4e5f0baa.js"><link rel="prefetch" href="/assets/pluginDva.html.037fbd9f.js"><link rel="prefetch" href="/assets/pluginQiankun.html.de1faf52.js"><link rel="prefetch" href="/assets/codegen.html.9e121af3.js"><link rel="prefetch" href="/assets/entrance.html.d123b81d.js"><link rel="prefetch" href="/assets/optimize.html.4f1c8ec0.js"><link rel="prefetch" href="/assets/outline.html.a9c91296.js"><link rel="prefetch" href="/assets/parse.html.0a7c0fe3.js"><link rel="prefetch" href="/assets/async-component.html.129dd437.js"><link rel="prefetch" href="/assets/component-register.html.67a3b5ad.js"><link rel="prefetch" href="/assets/create-component.html.8df7909f.js"><link rel="prefetch" href="/assets/lifecycle.html.8f15cd50.js"><link rel="prefetch" href="/assets/merge-option.html.5ddaa80a.js"><link rel="prefetch" href="/assets/outline.html.386b365e.js"><link rel="prefetch" href="/assets/patch.html.d499fe27.js"><link rel="prefetch" href="/assets/_index.html.2261ac10.js"><link rel="prefetch" href="/assets/create-element.html.9bbbea99.js"><link rel="prefetch" href="/assets/mounted.html.f61fa3ca.js"><link rel="prefetch" href="/assets/new-vue.html.f730bdc7.js"><link rel="prefetch" href="/assets/render.html.cfe56cf2.js"><link rel="prefetch" href="/assets/update.html.8902b2e3.js"><link rel="prefetch" href="/assets/virtual-dom.html.3738a253.js"><link rel="prefetch" href="/assets/event.html.0688c5a3.js"><link rel="prefetch" href="/assets/keep-alive.html.8f641f44.js"><link rel="prefetch" href="/assets/outline.html.aed4f29e.js"><link rel="prefetch" href="/assets/slot.html.669843f0.js"><link rel="prefetch" href="/assets/tansition-group.html.d0897679.js"><link rel="prefetch" href="/assets/tansition.html.fb299e40.js"><link rel="prefetch" href="/assets/v-model.html.f2371046.js"><link rel="prefetch" href="/assets/baseInterview.html.103474d6.js"><link rel="prefetch" href="/assets/baseInterviewSecond.html.18b37c7a.js"><link rel="prefetch" href="/assets/componentCommunication.html.ce8a8452.js"><link rel="prefetch" href="/assets/detailedResponsiveness.html.2dd6e861.js"><link rel="prefetch" href="/assets/diff.html.190a248a.js"><link rel="prefetch" href="/assets/eventBinding.html.33b13240.js"><link rel="prefetch" href="/assets/eventMechanism.html.c8ff7c0d.js"><link rel="prefetch" href="/assets/key.html.932660ed.js"><link rel="prefetch" href="/assets/knowledgeSystem.html.5dcd23ee.js"><link rel="prefetch" href="/assets/slot.html.82136954.js"><link rel="prefetch" href="/assets/sourceCodeAsyncDomUpdateNextTick.html.034ca582.js"><link rel="prefetch" href="/assets/sourceCodeElementBroadcastDispatch.html.c22a533d.js"><link rel="prefetch" href="/assets/sourceCodeKeepAlive.html.4067a4a8.js"><link rel="prefetch" href="/assets/sourceCodeResponsiveness.html.6e94d782.js"><link rel="prefetch" href="/assets/sourceCodeTemplateCompilation.html.2ba4db5f.js"><link rel="prefetch" href="/assets/sourceCodeTemplateDom.html.a587ef49.js"><link rel="prefetch" href="/assets/sourceCodeVuex.html.6c23ae5d.js"><link rel="prefetch" href="/assets/vNode.html.78bbc0e4.js"><link rel="prefetch" href="/assets/vNodeDiff.html.12431974.js"><link rel="prefetch" href="/assets/build.html.46bb0a33.js"><link rel="prefetch" href="/assets/directory.html.429da0c4.js"><link rel="prefetch" href="/assets/entrance.html.133c739c.js"><link rel="prefetch" href="/assets/flow.html.3d95b2da.js"><link rel="prefetch" href="/assets/component-update.html.7680f173.js"><link rel="prefetch" href="/assets/computed-watcher.html.ac832a11.js"><link rel="prefetch" href="/assets/getters.html.1f113ebb.js"><link rel="prefetch" href="/assets/next-tick.html.f680321a.js"><link rel="prefetch" href="/assets/outline.html.4cedf236.js"><link rel="prefetch" href="/assets/props.html.ae2e6763.js"><link rel="prefetch" href="/assets/questions.html.daadbacb.js"><link rel="prefetch" href="/assets/reactive-object.html.8da6638c.js"><link rel="prefetch" href="/assets/setters.html.c2210be7.js"><link rel="prefetch" href="/assets/summary.html.c7aa4bd1.js"><link rel="prefetch" href="/assets/install.html.08270143.js"><link rel="prefetch" href="/assets/matcher.html.2a62c8e0.js"><link rel="prefetch" href="/assets/outline.html.3399cbe5.js"><link rel="prefetch" href="/assets/router.html.3f8f100f.js"><link rel="prefetch" href="/assets/transition-to.html.d4de4f91.js"><link rel="prefetch" href="/assets/api.html.ef7da876.js"><link rel="prefetch" href="/assets/idex.html.8ae17df7.js"><link rel="prefetch" href="/assets/init.html.12e89504.js"><link rel="prefetch" href="/assets/plugin.html.e2c4a6f8.js"><link rel="prefetch" href="/assets/baseInterview.html.fb044d1f.js"><link rel="prefetch" href="/assets/configuration.html.8e918106.js"><link rel="prefetch" href="/assets/entryPoints.html.f782b4a2.js"><link rel="prefetch" href="/assets/loader.html.0e71a7bc.js"><link rel="prefetch" href="/assets/output.html.126f1ed3.js"><link rel="prefetch" href="/assets/plugin.html.e0c95d42.js"><link rel="prefetch" href="/assets/webpackInterview.html.6df6c04a.js"><link rel="prefetch" href="/assets/reactApi.html.e2c93057.js"><link rel="prefetch" href="/assets/reactChildren.html.cef8fe8c.js"><link rel="prefetch" href="/assets/reactElement.html.dca74612.js"><link rel="prefetch" href="/assets/reactFiber.html.44ad71cc.js"><link rel="prefetch" href="/assets/commitAllHostEffects.html.b937bfd5.js"><link rel="prefetch" href="/assets/commitAllLifeCycles.html.3cbe6c6c.js"><link rel="prefetch" href="/assets/commitBeforeMutationLifecycles.html.8157bcbc.js"><link rel="prefetch" href="/assets/commitDeletion.html.e09db017.js"><link rel="prefetch" href="/assets/commitPlacement.html.ce89b652.js"><link rel="prefetch" href="/assets/commitRoot.html.69d8df63.js"><link rel="prefetch" href="/assets/commitWork.html.b4e38fe3.js"><link rel="prefetch" href="/assets/invokeGuardedCallback.html.f6f56fb0.js"><link rel="prefetch" href="/assets/expirationTime.html.5570fa7a.js"><link rel="prefetch" href="/assets/reactDomRender.html.4a9401e4.js"><link rel="prefetch" href="/assets/setStateForceUpdate.html.53f3814a.js"><link rel="prefetch" href="/assets/context.html.997fc2b0.js"><link rel="prefetch" href="/assets/evenInit.html.1c768e9c.js"><link rel="prefetch" href="/assets/eventBind.html.ea594b4e.js"><link rel="prefetch" href="/assets/eventCreateEventObject.html.5c32898c.js"><link rel="prefetch" href="/assets/eventDispath.html.c1a97c91.js"><link rel="prefetch" href="/assets/hydrate.html.b976d191.js"><link rel="prefetch" href="/assets/ref.html.bb474af4.js"><link rel="prefetch" href="/assets/suspense.html.b68112ac.js"><link rel="prefetch" href="/assets/suspenseLazy.html.a76acd5b.js"><link rel="prefetch" href="/assets/suspenseWork.html.2fdbbe58.js"><link rel="prefetch" href="/assets/hooksCommon.html.25fa83c2.js"><link rel="prefetch" href="/assets/hooksOther.html.c23d600c.js"><link rel="prefetch" href="/assets/start.html.63afef13.js"><link rel="prefetch" href="/assets/useEffect.html.28e5c517.js"><link rel="prefetch" href="/assets/useState.html.115a787b.js"><link rel="prefetch" href="/assets/base.html.cb1fa4e1.js"><link rel="prefetch" href="/assets/commpontDiff.html.ec9edec1.js"><link rel="prefetch" href="/assets/componentUpdate.html.4c9d6f44.js"><link rel="prefetch" href="/assets/renderProcess.html.7b3175da.js"><link rel="prefetch" href="/assets/schedulingPrinciple.html.a93f9f16.js"><link rel="prefetch" href="/assets/beginWork.html.8af90cfe.js"><link rel="prefetch" href="/assets/globalVariable.html.411ddafe.js"><link rel="prefetch" href="/assets/mountIndeterminateComponent.html.11e47c75.js"><link rel="prefetch" href="/assets/mountLazyCompont.html.cb348539.js"><link rel="prefetch" href="/assets/performUnitOfWork.html.dc11fc38.js"><link rel="prefetch" href="/assets/performWork.html.353d5d8b.js"><link rel="prefetch" href="/assets/reactScheduler.html.e819c6b9.js"><link rel="prefetch" href="/assets/reconcileChildren.html.0e848c34.js"><link rel="prefetch" href="/assets/reconcileChildrenArray.html.b45839a7.js"><link rel="prefetch" href="/assets/reconcileSingleElement.html.2505fc69.js"><link rel="prefetch" href="/assets/renderRoot.html.0214cdac.js"><link rel="prefetch" href="/assets/scheduleWork.html.1b553610.js"><link rel="prefetch" href="/assets/throwException.html.4a1ee3d3.js"><link rel="prefetch" href="/assets/updateClassComponent.html.b9dd4c1f.js"><link rel="prefetch" href="/assets/updateContextConsumer.html.304e3358.js"><link rel="prefetch" href="/assets/updateContextProvider.html.bb3e6dd0.js"><link rel="prefetch" href="/assets/updateForwardRef.html.d5c26c3d.js"><link rel="prefetch" href="/assets/updateFragment.html.21121936.js"><link rel="prefetch" href="/assets/updateFunctionalComponent.html.b5fec46a.js"><link rel="prefetch" href="/assets/updateHostComponent.html.05a70c6d.js"><link rel="prefetch" href="/assets/updateHostRoot.html.5018a4e6.js"><link rel="prefetch" href="/assets/updateHostText.html.1a25c8ee.js"><link rel="prefetch" href="/assets/updateMode.html.036040b2.js"><link rel="prefetch" href="/assets/updatePortalComponent.html.ef05e0ef.js"><link rel="prefetch" href="/assets/updateProfiler.html.5c236b8c.js"><link rel="prefetch" href="/assets/updateSuspenseComponent.html.6a81a3c8.js"><link rel="prefetch" href="/assets/interview1.html.65fb24f3.js"><link rel="prefetch" href="/assets/interview2.html.1fff57df.js"><link rel="prefetch" href="/assets/interview3.html.bc7098f5.js"><link rel="prefetch" href="/assets/interview51.html.f42d552e.js"><link rel="prefetch" href="/assets/interview52.html.67cdbcc8.js"><link rel="prefetch" href="/assets/interview53.html.a14c0887.js"><link rel="prefetch" href="/assets/interview54.html.4dad2d2c.js"><link rel="prefetch" href="/assets/interview55.html.fb2ce01d.js"><link rel="prefetch" href="/assets/interview56.html.a3b5c6ed.js"><link rel="prefetch" href="/assets/interview57.html.5ef3d295.js"><link rel="prefetch" href="/assets/interview1.html.9c9af419.js"><link rel="prefetch" href="/assets/interview10.html.a782df46.js"><link rel="prefetch" href="/assets/interview11.html.6dd34310.js"><link rel="prefetch" href="/assets/interview12.html.62b29ef7.js"><link rel="prefetch" href="/assets/interview13.html.fc6584cd.js"><link rel="prefetch" href="/assets/interview14.html.ff394d79.js"><link rel="prefetch" href="/assets/interview15.html.2aecec2f.js"><link rel="prefetch" href="/assets/interview16.html.d78fc813.js"><link rel="prefetch" href="/assets/interview17.html.59701f0c.js"><link rel="prefetch" href="/assets/interview18.html.7aad8a0b.js"><link rel="prefetch" href="/assets/interview19.html.d2171ab3.js"><link rel="prefetch" href="/assets/interview2.html.dad1b052.js"><link rel="prefetch" href="/assets/interview20.html.7f3cecce.js"><link rel="prefetch" href="/assets/interview21.html.d90613d7.js"><link rel="prefetch" href="/assets/interview22.html.13152f4b.js"><link rel="prefetch" href="/assets/interview23.html.ad6cdfea.js"><link rel="prefetch" href="/assets/interview24.html.d5266686.js"><link rel="prefetch" href="/assets/interview25.html.59b85bce.js"><link rel="prefetch" href="/assets/interview26.html.28789e5d.js"><link rel="prefetch" href="/assets/interview27.html.3a840160.js"><link rel="prefetch" href="/assets/interview28.html.77a960b3.js"><link rel="prefetch" href="/assets/interview29.html.0e76554a.js"><link rel="prefetch" href="/assets/interview3.html.89c6e281.js"><link rel="prefetch" href="/assets/interview30.html.4bc94840.js"><link rel="prefetch" href="/assets/interview31.html.67cebc2c.js"><link rel="prefetch" href="/assets/interview32.html.42ae4820.js"><link rel="prefetch" href="/assets/interview33.html.4f84e721.js"><link rel="prefetch" href="/assets/interview34.html.6cc1bb01.js"><link rel="prefetch" href="/assets/interview35.html.e94bd0d7.js"><link rel="prefetch" href="/assets/interview36.html.b143cb2b.js"><link rel="prefetch" href="/assets/interview37.html.aa46642c.js"><link rel="prefetch" href="/assets/interview38.html.5f6bfdae.js"><link rel="prefetch" href="/assets/interview39.html.7afab868.js"><link rel="prefetch" href="/assets/interview4.html.c9617c0c.js"><link rel="prefetch" href="/assets/interview40.html.6ce50551.js"><link rel="prefetch" href="/assets/interview41.html.ecdb8c88.js"><link rel="prefetch" href="/assets/interview42.html.77eacc57.js"><link rel="prefetch" href="/assets/interview43.html.ac9caa3f.js"><link rel="prefetch" href="/assets/interview44.html.ffa9b1b1.js"><link rel="prefetch" href="/assets/interview45.html.8a20ca39.js"><link rel="prefetch" href="/assets/interview46.html.ca640ed0.js"><link rel="prefetch" href="/assets/interview47.html.3d13d073.js"><link rel="prefetch" href="/assets/interview48.html.7050e917.js"><link rel="prefetch" href="/assets/interview49.html.61a08db7.js"><link rel="prefetch" href="/assets/interview5.html.219185b5.js"><link rel="prefetch" href="/assets/interview50.html.16369f4a.js"><link rel="prefetch" href="/assets/interview6.html.e9f5e8ac.js"><link rel="prefetch" href="/assets/interview7.html.a28340eb.js"><link rel="prefetch" href="/assets/interview8.html.e505daa4.js"><link rel="prefetch" href="/assets/interview9.html.8cc2e4e0.js"><link rel="prefetch" href="/assets/404.html.54bce08b.js"><link rel="prefetch" href="/assets/index.html.2f176dac.js"><link rel="prefetch" href="/assets/index.html.7b8ed996.js"><link rel="prefetch" href="/assets/index.html.2828c058.js"><link rel="prefetch" href="/assets/index.html.9cce1ab8.js"><link rel="prefetch" href="/assets/index.html.db8d6df2.js"><link rel="prefetch" href="/assets/index.html.d716d1a7.js"><link rel="prefetch" href="/assets/index.html.51f0f030.js"><link rel="prefetch" href="/assets/index.html.6c23f8a4.js"><link rel="prefetch" href="/assets/index.html.a5191b5b.js"><link rel="prefetch" href="/assets/index.html.196ba42a.js"><link rel="prefetch" href="/assets/index.html.d129280b.js"><link rel="prefetch" href="/assets/index.html.c45c34df.js"><link rel="prefetch" href="/assets/index.html.3b39a894.js"><link rel="prefetch" href="/assets/404.e394e2be.js"><link rel="prefetch" href="/assets/Layout.dc824264.js"><link rel="prefetch" href="/assets/Slide.ef8b692d.js"><link rel="prefetch" href="/assets/Blog.6478801f.js"><link rel="prefetch" href="/assets/highlight.esm.d982e650.js"><link rel="prefetch" href="/assets/markdown.esm.832a189d.js"><link rel="prefetch" href="/assets/math.esm.a3f84b6f.js"><link rel="prefetch" href="/assets/notes.esm.3c361cb7.js"><link rel="prefetch" href="/assets/reveal.esm.b96f05d8.js"><link rel="prefetch" href="/assets/search.esm.80da4a02.js"><link rel="prefetch" href="/assets/zoom.esm.8514a202.js"><link rel="prefetch" href="/assets/photoswipe.esm.092fbc15.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><a href="/" class="brand"><img class="logo" src="/logo.svg" alt><!----><!----></a><!----></div><div class="navbar-center"><!----><nav class="nav-links"><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="技术"><span class="title"><span class="icon iconfont icon-creative" style=""></span>技术</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/technology/base.html" class="nav-link" aria-label="技术前瞻"><!---->技术前瞻<!----></a></li><li class="dropdown-item"><a href="/technology/summarize.html" class="nav-link" aria-label="前端资源整理"><!---->前端资源整理<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="js"><span class="title"><!---->js</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/mozillajs/baseObject/symbol.html" class="nav-link" aria-label="mozilla：基本对象"><!---->mozilla：基本对象<!----></a></li><li class="dropdown-item"><a href="/jsInterview/baseInterview.html" class="nav-link" aria-label="基础面试"><!---->基础面试<!----></a></li><li class="dropdown-item"><a href="/js/stack/executionStack.html" class="nav-link" aria-label="js 概念"><!---->js 概念<!----></a></li><li class="dropdown-item"><a href="/ts/jsx/support.html" class="nav-link" aria-label="JSX"><!---->JSX<!----></a></li><li class="dropdown-item"><a href="/ts/project/inDepthTs.html" class="nav-link" aria-label="TypeScript 项目"><!---->TypeScript 项目<!----></a></li><li class="dropdown-item"><a href="/jsNews/es6News.html" class="nav-link" aria-label="js 新概念"><!---->js 新概念<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="css"><span class="title"><!---->css</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/mozillaCss/reference/universalSelectors.html" class="nav-link" aria-label="第 1 期：CSS API"><!---->第 1 期：CSS API<!----></a></li><li class="dropdown-item"><a href="/css/interview/baseCss.html" class="nav-link" aria-label="零散记录"><!---->零散记录<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="html"><span class="title"><!---->html</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/html/interview/linkImport.html" class="nav-link" aria-label="零散记录"><!---->零散记录<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="端"><span class="title"><!---->端</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/browser/interview/baseInterview.html" class="nav-link" aria-label="基础浏览器"><!---->基础浏览器<!----></a></li><li class="dropdown-item"><a href="/http/interview/baseInterview.html" class="nav-link" aria-label="基础http"><!---->基础http<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="工具"><span class="title"><!---->工具</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/webpack/interview/webpackInterview.html" class="nav-link" aria-label="webpack"><!---->webpack<!----></a></li><li class="dropdown-item"><a href="/esbuild/description.html" class="nav-link" aria-label="esbuild"><!---->esbuild<!----></a></li><li class="dropdown-item"><a href="/rollup/introduction.html" class="nav-link" aria-label="rollup"><!---->rollup<!----></a></li><li class="dropdown-item"><a href="/git/indx.html" class="nav-link" aria-label="git"><!---->git<!----></a></li><li class="dropdown-item"><a href="/nginx/base.html" class="nav-link" aria-label="nginx"><!---->nginx<!----></a></li><li class="dropdown-item"><a href="/cli/base.html" class="nav-link" aria-label="cli"><!---->cli<!----></a></li><li class="dropdown-item"><a href="/npm/commonlyUsed.html" class="nav-link" aria-label="npm"><!---->npm<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="react"><span class="title"><!---->react</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>react 源码阅读 代码视角</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ILoveDevelop/react/principle/base.html" class="nav-link" aria-label="概念"><!---->概念<!----></a></li><li class="dropdown-subitem"><a href="/ILoveDevelop/react/basic/reactApi.html" class="nav-link" aria-label="基础"><!---->基础<!----></a></li><li class="dropdown-subitem"><a href="/ILoveDevelop/react/createUpdate/reactDomRender.html" class="nav-link" aria-label="创建更新"><!---->创建更新<!----></a></li><li class="dropdown-subitem"><a href="/ILoveDevelop/react/taskScheduling/globalVariable.html" class="nav-link" aria-label="任务调度"><!---->任务调度<!----></a></li><li class="dropdown-subitem"><a href="/ILoveDevelop/react/commit/commitRoot.html" class="nav-link" aria-label="commit 阶段"><!---->commit 阶段<!----></a></li><li class="dropdown-subitem"><a href="/ILoveDevelop/react/features/context.html" class="nav-link" aria-label="功能"><!---->功能<!----></a></li><li class="dropdown-subitem"><a href="/ILoveDevelop/react/hooks/start.html" class="nav-link" aria-label="Hooks"><!---->Hooks<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>react 源码阅读 思想视角</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/react/preparation/idea.html" class="nav-link" aria-label="第 1 期：React理念"><!---->第 1 期：React理念<!----></a></li><li class="dropdown-subitem"><a href="/react/preparation/file.html" class="nav-link" aria-label="第 2 期：前置知识"><!---->第 2 期：前置知识<!----></a></li><li class="dropdown-subitem"><a href="/react/process/reconciler.html" class="nav-link" aria-label="第 3 期：render阶段"><!---->第 3 期：render阶段<!----></a></li><li class="dropdown-subitem"><a href="/react/renderer/prepare.html" class="nav-link" aria-label="第 4 期：commit阶段"><!---->第 4 期：commit阶段<!----></a></li><li class="dropdown-subitem"><a href="/react/diff/prepare.html" class="nav-link" aria-label="第 5 期：Diff算法"><!---->第 5 期：Diff算法<!----></a></li><li class="dropdown-subitem"><a href="/react/state/prepare.html" class="nav-link" aria-label="第 6 期：状态更新"><!---->第 6 期：状态更新<!----></a></li><li class="dropdown-subitem"><a href="/react/hooks/prepare.html" class="nav-link" aria-label="第 7 期：Hooks"><!---->第 7 期：Hooks<!----></a></li><li class="dropdown-subitem"><a href="/react/concurrent/prepare.html" class="nav-link" aria-label="第 8 期：Concurrent Mode"><!---->第 8 期：Concurrent Mode<!----></a></li><li class="dropdown-subitem"><a href="/react/principle/basePrinciple.html" class="nav-link" aria-label="第 9 期：基础概念"><!---->第 9 期：基础概念<!----></a></li><li class="dropdown-subitem"><a href="/react/interview/50/interview1.html" class="nav-link" aria-label="第 10 期：基础面试题"><!---->第 10 期：基础面试题<!----></a></li></ul></li><li class="dropdown-item"><a href="/react-illustration-series/main/macro-structure.html" class="nav-link" aria-label="图解React源码"><!---->图解React源码<!----></a></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>umi</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/umi/interview/pluginDva.html" class="nav-link" aria-label="@umijs/plugin-dva"><!---->@umijs/plugin-dva<!----></a></li><li class="dropdown-subitem"><a href="/umi/interview/pluginQiankun.html" class="nav-link" aria-label="@umijs/plugin-qiankun"><!---->@umijs/plugin-qiankun<!----></a></li></ul></li><li class="dropdown-item"><a href="/reactInterview/interview1.html" class="nav-link" aria-label="整理"><!---->整理<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="vue"><span class="title"><!---->vue</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/vue/prepare/flow.html" class="nav-link" aria-label="第 1 期：源码解读-准备工作"><!---->第 1 期：源码解读-准备工作<!----></a></li><li class="dropdown-item"><a href="/vue/data-driven/_index.html" class="nav-link" aria-label="第2期：源码解读-数据驱动"><!---->第2期：源码解读-数据驱动<!----></a></li><li class="dropdown-item"><a href="/vue/components/create-component.html" class="nav-link" aria-label="第3期：源码解读-组件化"><!---->第3期：源码解读-组件化<!----></a></li><li class="dropdown-item"><a href="/vue/reactive/reactive-object.html" class="nav-link" aria-label="第4期：源码解读-深入响应式原理"><!---->第4期：源码解读-深入响应式原理<!----></a></li><li class="dropdown-item"><a href="/vue/compile/entrance.html" class="nav-link" aria-label="第5期：源码解读-编译"><!---->第5期：源码解读-编译<!----></a></li><li class="dropdown-item"><a href="/vue/extend/event.html" class="nav-link" aria-label="第6期：源码解读-扩展"><!---->第6期：源码解读-扩展<!----></a></li><li class="dropdown-item"><a href="/vue/vue-router/install.html" class="nav-link" aria-label="第7期：源码解读-VueRouter"><!---->第7期：源码解读-VueRouter<!----></a></li><li class="dropdown-item"><a href="/vue/vuex/idex.html" class="nav-link" aria-label="第8期：源码解读-Vuex"><!---->第8期：源码解读-Vuex<!----></a></li><li class="dropdown-item"><a href="/vue/interview/baseInterview.html" class="nav-link" aria-label="第9期：基础面试题"><!---->第9期：基础面试题<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="性能优化"><span class="title"><!---->性能优化</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/performance/vue/vue2Base.html" class="nav-link" aria-label="vue-性能优化"><!---->vue-性能优化<!----></a></li><li class="dropdown-item"><a href="/performance/react/reactBase.html" class="nav-link" aria-label="react-性能优化"><!---->react-性能优化<!----></a></li><li class="dropdown-item"><a href="/performance/base/drag1.html" class="nav-link" aria-label="组件设计"><!---->组件设计<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="算法&amp;设计"><span class="title"><!---->算法&amp;设计</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/algorithm/interview/baseInterview.html" class="nav-link" aria-label="第 1 期：基础面试题"><!---->第 1 期：基础面试题<!----></a></li><li class="dropdown-item"><a href="/design/overview.html" class="nav-link" aria-label="设计模式"><!---->设计模式<!----></a></li><li class="dropdown-item"><a href="/designFrame/jquery.html" class="nav-link" aria-label="设计应用"><!---->设计应用<!----></a></li></ul></button></div></div></nav><!----></div><div class="navbar-right"><!----><!----><div class="nav-item"><a class="repo-link" href="https://github.com/sykinggg/notes" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">第 1 期：源码解读-准备工作</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">第2期：源码解读-数据驱动</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">第3期：源码解读-组件化</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">第4期：源码解读-深入响应式原理</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">第5期：源码解读-编译</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">第6期：源码解读-扩展</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">第7期：源码解读-VueRouter</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">第8期：源码解读-Vuex</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><span class="title">第9期：基础面试题</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/vue/interview/baseInterview.html" class="nav-link sidebar-link sidebar-page" aria-label="整理1"><!---->整理1<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/vue/interview/baseInterviewSecond.html" class="nav-link sidebar-link sidebar-page" aria-label="整理2"><!---->整理2<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/vue/interview/knowledgeSystem.html" class="nav-link sidebar-link sidebar-page" aria-label="知识体系"><!---->知识体系<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/vue/interview/detailedResponsiveness.html" class="nav-link sidebar-link sidebar-page" aria-label="响应式详解"><!---->响应式详解<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/vue/interview/componentCommunication.html" class="nav-link sidebar-link sidebar-page" aria-label="组件间通信"><!---->组件间通信<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/vue/interview/eventBinding.html" class="nav-link sidebar-link sidebar-page" aria-label="事件绑定"><!---->事件绑定<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/vue/interview/slot.html" class="nav-link sidebar-link sidebar-page" aria-label="slot插槽"><!---->slot插槽<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/vue/interview/templateCompilation.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="模板编译"><!---->模板编译<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/vue/interview/templateCompilation.html#vue模板渲染的原理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Vue模板渲染的原理"><!---->Vue模板渲染的原理<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/vue/interview/templateCompilation.html#vue-2-0-模板编译原理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="vue 2.0 模板编译原理"><!---->vue 2.0 模板编译原理<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/vue/interview/templateCompilation.html#概述" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="概述"><!---->概述<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/vue/interview/templateCompilation.html#解析器" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="解析器"><!---->解析器<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/vue/interview/templateCompilation.html#stack" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Stack"><!---->Stack<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/vue/interview/templateCompilation.html#开头的几种情况" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="&lt; 开头的几种情况"><!---->&lt; 开头的几种情况<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/vue/interview/templateCompilation.html#截取文本" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="截取文本"><!---->截取文本<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/vue/interview/templateCompilation.html#解析文本" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="解析文本"><!---->解析文本<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/vue/interview/templateCompilation.html#结束标签的处理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="结束标签的处理"><!---->结束标签的处理<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/vue/interview/templateCompilation.html#总结一下" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="总结一下"><!---->总结一下<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/vue/interview/templateCompilation.html#优化器" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="优化器"><!---->优化器<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/vue/interview/templateCompilation.html#代码生成器" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="代码生成器"><!---->代码生成器<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/vue/interview/templateCompilation.html#总结" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="总结"><!---->总结<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/vue/interview/templateCompilation.html#vue-3-0-模板编译原理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="vue 3.0 模板编译原理"><!---->vue 3.0 模板编译原理<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/vue/interview/templateCompilation.html#parse" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Parse"><!---->Parse<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/vue/interview/templateCompilation.html#transform" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Transform"><!---->Transform<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/vue/interview/templateCompilation.html#codegen" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Codegen"><!---->Codegen<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/vue/interview/diff.html" class="nav-link sidebar-link sidebar-page" aria-label="diff算法"><!---->diff算法<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/vue/interview/key.html" class="nav-link sidebar-link sidebar-page" aria-label="key作用"><!---->key作用<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!----></h1><div class="page-info"><!----><!----><span class="date-info" aria-label="写作日期📅" data-balloon-pos="down" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>2021年6月18日</span><meta property="datePublished" content="2021-06-18T16:01:44.000Z"></span><!----><!----><span class="reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down" localizeddate="2021年6月18日" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 33 分钟</span><meta property="timeRequired" content="PT33M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">此页内容</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/vue/interview/templateCompilation.html#vue模板渲染的原理" class="router-link-active router-link-exact-active toc-link level3">Vue模板渲染的原理</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/vue/interview/templateCompilation.html#vue-2-0-模板编译原理" class="router-link-active router-link-exact-active toc-link level2">vue 2.0 模板编译原理</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/vue/interview/templateCompilation.html#概述" class="router-link-active router-link-exact-active toc-link level2">概述</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/vue/interview/templateCompilation.html#解析器" class="router-link-active router-link-exact-active toc-link level2">解析器</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/vue/interview/templateCompilation.html#stack" class="router-link-active router-link-exact-active toc-link level2">Stack</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/vue/interview/templateCompilation.html#开头的几种情况" class="router-link-active router-link-exact-active toc-link level2">&lt; 开头的几种情况</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/vue/interview/templateCompilation.html#截取文本" class="router-link-active router-link-exact-active toc-link level2">截取文本</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/vue/interview/templateCompilation.html#解析文本" class="router-link-active router-link-exact-active toc-link level2">解析文本</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/vue/interview/templateCompilation.html#结束标签的处理" class="router-link-active router-link-exact-active toc-link level2">结束标签的处理</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/vue/interview/templateCompilation.html#总结一下" class="router-link-active router-link-exact-active toc-link level2">总结一下</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/vue/interview/templateCompilation.html#优化器" class="router-link-active router-link-exact-active toc-link level2">优化器</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/vue/interview/templateCompilation.html#代码生成器" class="router-link-active router-link-exact-active toc-link level2">代码生成器</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/vue/interview/templateCompilation.html#总结" class="router-link-active router-link-exact-active toc-link level2">总结</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/vue/interview/templateCompilation.html#vue-3-0-模板编译原理" class="router-link-active router-link-exact-active toc-link level2">vue 3.0 模板编译原理</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/vue/interview/templateCompilation.html#parse" class="router-link-active router-link-exact-active toc-link level2">Parse</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/vue/interview/templateCompilation.html#transform" class="router-link-active router-link-exact-active toc-link level2">Transform</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/vue/interview/templateCompilation.html#codegen" class="router-link-active router-link-exact-active toc-link level2">Codegen</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h3 id="vue模板渲染的原理" tabindex="-1"><a class="header-anchor" href="#vue模板渲染的原理" aria-hidden="true">#</a> Vue模板渲染的原理</h3><h2 id="vue-2-0-模板编译原理" tabindex="-1"><a class="header-anchor" href="#vue-2-0-模板编译原理" aria-hidden="true">#</a> <strong>vue 2.0 模板编译原理</strong></h2><hr><h2 id="概述" tabindex="-1"><a class="header-anchor" href="#概述" aria-hidden="true">#</a> <strong>概述</strong></h2><p>vue中的模板<code>template</code>无法被浏览器解析并渲染，因为这不属于浏览器的标准，不是正确的HTML语法，所有需要将<code>template</code>转化成一个<code>JavaScript</code>函数，这样<strong>浏览器就可以执行这一个函数并渲染出对应的HTML元素</strong>，就可以让视图跑起来了，这一个转化的过程，就成为模板编译。</p><ul><li><p><code>parse阶段</code>：使用大量的正则表达式对template字符串进行解析，将<code>标签</code>、<code>指令</code>、<code>属性</code>等转化为抽象<code>语法树AST</code>。</p><ul><li>将 <code>模板字符串</code> 转换成 <code>element ASTs（解析器）</code></li></ul></li><li><p><code>optimize阶段</code>：<code>遍历AST</code>，找到其中的一些静态节点并进行标记，方便在页面重渲染的时候进行diff比较时，直接跳过这一些静态节点，优化runtime的性能。</p><ul><li>对 <code>AST</code> 进行静态节点标记，主要用来做虚拟DOM的渲染优化（优化器）</li></ul></li><li><p><code>generate阶段</code>：将最终的<code>AST</code>转化为<code>render</code>函数字符串。</p><ul><li>使用 <code>element ASTs</code> 生成 <code>render 函数代码字符串（代码生成器）</code></li></ul></li></ul><h2 id="解析器" tabindex="-1"><a class="header-anchor" href="#解析器" aria-hidden="true">#</a> <strong>解析器</strong></h2><p>解析器主要干的事是将 <code>模板字符串</code> 转换成 <code>element ASTs</code>，例如：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面这样一个简单的 <code>模板</code> 转换成 <code>element AST</code> 后是这样的：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    <span class="token literal-property property">tag</span><span class="token operator">:</span> <span class="token string">&quot;div&quot;</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">staticRoot</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token keyword">static</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token literal-property property">plain</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">parent</span><span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
    <span class="token literal-property property">attrsList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">attrsMap</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token literal-property property">tag</span><span class="token operator">:</span> <span class="token string">&quot;p&quot;</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token literal-property property">staticRoot</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token keyword">static</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token literal-property property">plain</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token literal-property property">parent</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">tag</span><span class="token operator">:</span> <span class="token string">&quot;div&quot;</span><span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">attrsList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">attrsMap</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">&quot;{{name}}&quot;</span><span class="token punctuation">,</span>
                <span class="token keyword">static</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                <span class="token literal-property property">expression</span><span class="token operator">:</span> <span class="token string">&quot;_s(name)&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>先用这个简单的例子来说明这个解析器的内部究竟发生了什么。</p><p>这段模板字符串会扔到 <code>while</code> 中去循环，然后 <strong>一段一段</strong> 的截取，把截取到的 <strong>每一小段字符串</strong> 进行解析，直到最后截没了，也就解析完了。</p><p>上面这个简单的模板截取的过程是这样的：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>只要判断模板字符串是不是以 &lt; 开头就可以知道接下来要截取的这一小段字符串是 <code>标签</code> 还是 <code>文本</code>。</p><p><code>&lt;div&gt;&lt;/div&gt;</code> 这样的一段字符串是以 <code>&lt;</code> 开头的，那么通过正则把 <code>&lt;div&gt;</code> 这一部分 <code>match</code> 出来，就可以拿到这样的数据：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    <span class="token literal-property property">tagName</span><span class="token operator">:</span> <span class="token string">&#39;div&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">attrs</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">unarySlash</span><span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">start</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token literal-property property">end</span><span class="token operator">:</span> <span class="token number">5</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>好奇如何用正则解析出 <code>tagName</code> 和 <code>attrs</code> 等信息的同学可以看下面这个demo代码：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> ncname <span class="token operator">=</span> <span class="token string">&#39;[a-zA-Z_][\\w\\-\\.]*&#39;</span>
<span class="token keyword">const</span> qnameCapture <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">((?:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>ncname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\\:)?</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>ncname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span>
<span class="token keyword">const</span> startTagOpen <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">^&lt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>qnameCapture<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token keyword">const</span> startTagClose <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\s*(\/?)&gt;</span><span class="token regex-delimiter">/</span></span>
<span class="token keyword">let</span> html <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div&gt;&lt;/div&gt;</span><span class="token template-punctuation string">`</span></span>
<span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">const</span> start <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>startTagOpen<span class="token punctuation">)</span>

<span class="token keyword">const</span> match <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">tagName</span><span class="token operator">:</span> start<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">attrs</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">start</span><span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
html <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>start<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span>
index <span class="token operator">+=</span> start<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length
<span class="token keyword">let</span> end<span class="token punctuation">,</span> attr
<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>end <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>startTagClose<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>attr <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>attribute<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    html <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>attr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span>
    index <span class="token operator">+=</span> attr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length
    match<span class="token punctuation">.</span>attrs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>attr<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>end<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    match<span class="token punctuation">.</span>unarySlash <span class="token operator">=</span> end<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    html <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>end<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span>
    index <span class="token operator">+=</span> end<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length
    match<span class="token punctuation">.</span>end <span class="token operator">=</span> index
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>match<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="stack" tabindex="-1"><a class="header-anchor" href="#stack" aria-hidden="true">#</a> <strong>Stack</strong></h2><p>用正则把 <code>开始标签</code> 中包含的数据（<code>attrs</code>, <code>tagName</code> 等）解析出来之后还要做一个很重要的事，就是要维护一个 <code>stack</code>。</p><p>那这个 <code>stack</code> 是用来干什么的呢？</p><p><strong>这个 <code>stack</code> 是用来记录一个层级关系的，用来记录DOM的深度。</strong></p><p>更准确的说，当解析到一个 <code>开始标签</code> 或者 <code>文本</code>，无论是什么， <code>stack</code> 中的最后一项，永远是当前正在被解析的节点的 <code>parentNode</code> 父节点。</p><p>通过 <code>stack</code> 解析器就可以把当前解析到的节点 <code>push</code> 到 父节点的 <code>children</code> 中。</p><p>也可以把当前正在解析的节点的 <code>parent</code> 属性设置为 父节点。</p><p>事实上也确实是这么做的。</p><p>但并不是只要解析到一个标签的开始部分就把当前标签 <code>push</code> 到 <code>stack</code> 中。</p><p>因为在 HTML 中有一种 <code>自闭合标签</code>，比如 <code>input</code>。</p><p><code>&lt;input /&gt;</code> 这种 <code>自闭合的标签</code> 是不需要 <code>push</code> 到 <code>stack</code> 中的，因为 <code>input</code> 并不存在子节点。</p><p>所以当解析到一个标签的开始时，<strong>要判断当前被解析的标签是否是自闭合标签，如果不是自闭合标签才 <code>push</code> 到 <code>stack</code> 中</strong>。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>unary<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    currentParent <span class="token operator">=</span> element
    stack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>现在有了 DOM 的层级关系，也可以解析出DOM的 <code>开始标签</code>，这样每解析一个 <code>开始标签</code> 就生成一个 <code>ASTElement</code> (<strong>存储当前标签的attrs，tagName 等信息的object</strong>）</p><p>并且把当前的 <code>ASTElement</code> push 到 <code>parentNode</code> 的 <code>children</code> 中，同时给当前 <code>ASTElement</code> 的 <code>parent</code> 属性设置为 <code>stack</code> 中的最后一项</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>currentParent<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span>
element<span class="token punctuation">.</span>parent <span class="token operator">=</span> currentParent
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="开头的几种情况" tabindex="-1"><a class="header-anchor" href="#开头的几种情况" aria-hidden="true">#</a> <strong><code>&lt;</code> 开头的几种情况</strong></h2><p>但并不是所有以 <code>&lt;</code> 开头的字符串都是 <code>开始标签</code>，以 <code>&lt;</code> 开头的字符串有以下几种情况：</p><ul><li><p>开始标签 <code>&lt;div&gt;</code></p></li><li><p>结束标签 <code>&lt;/div&gt;</code></p></li><li><p>HTML注释 <code>&lt;!-- 是注释 --&gt;</code></p></li><li><p>Doctype <code>&lt;!DOCTYPE html&gt;</code></p></li><li><p>条件注释</p></li></ul><p>当然解析器在解析的过程中遇到的最多的是 <code>开始标签</code> <code>结束标签</code> 和 <code>注释</code></p><h2 id="截取文本" tabindex="-1"><a class="header-anchor" href="#截取文本" aria-hidden="true">#</a> <strong>截取文本</strong></h2><p>继续上面的例子解析，<code>div</code> 的 <code>开始标签</code> 解析之后剩余的模板字符串是下面的样子：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>    <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>这一次在解析发现 模板字符串 不是以 &lt; 开头了。</p><p>那么如果模板字符串不是以 &lt; 开头的怎么处理呢？？</p><p>其实如果字符串不是以 &lt; 开头可能会出现这么几种情况：</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code>是text <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

或者：

是text <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>不论是哪种情况都会将标签前面的文本部分解析出来，截取这段文本其实并不难，看下面的例子：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 可以直接将本 demo 放到浏览器 console 中去执行</span>
<span class="token keyword">const</span> html <span class="token operator">=</span> <span class="token string">&#39;是text &lt;/p&gt;&#39;</span>
<span class="token keyword">let</span> textEnd <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&#39;&lt;&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> text <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> textEnd<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当然 vue 对文本的截取不只是这么简单，vue对文本的截取做了很安全的处理，如果 <code>&lt;</code> 是文本的一部分，那上面 DEMO 中截取的内容就不是想要的，例如这样的：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>a <span class="token operator">&lt;</span> b <span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>如果是这样的文本，上面的 demo 肯定就挂了，截取出的文本就会遗漏一部分，而 vue 对这部分是进行了处理的，看下面的代码：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> textEnd <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&#39;&lt;&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> text<span class="token punctuation">,</span> rest<span class="token punctuation">,</span> next
<span class="token keyword">if</span> <span class="token punctuation">(</span>textEnd <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    rest <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>textEnd<span class="token punctuation">)</span>
    <span class="token comment">// 剩余部分的 HTML 不符合标签的格式那肯定就是文本</span>
    <span class="token comment">// 并且还是以 &lt; 开头的文本</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>
        <span class="token operator">!</span>endTag<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>rest<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
        <span class="token operator">!</span>startTagOpen<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>rest<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
        <span class="token operator">!</span>comment<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>rest<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
        <span class="token operator">!</span>conditionalComment<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>rest<span class="token punctuation">)</span>
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// &lt; in plain text, be forgiving and treat it as text</span>
        next <span class="token operator">=</span> rest<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&#39;&lt;&#39;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>next <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">break</span>
        textEnd <span class="token operator">+=</span> next
        rest <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>textEnd<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    text <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> textEnd<span class="token punctuation">)</span>
    html <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> textEnd<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这段代码的逻辑是如果文本截取完之后，剩余的 <code>模板字符串</code> 开头不符合标签的格式规则，那么肯定就是有没截取完的文本</p><p>这个时候只需要循环把 <code>textEnd</code> 累加，直到剩余的 <code>模板字符串</code> 符合标签的规则之后在一次性把 <code>text</code> 从 <code>模板字符串</code> 中截取出来就好了。</p><p>继续上面的例子，当前剩余的 <code>模板字符串</code> 是这个样子的：</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>截取之后剩余的 <code>模板字符串</code> 是这个样子的：</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>被截取出来的文本是这样的：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&quot;\n        &quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>截取之后就需要对文本进行解析，不过在解析文本之前需要进行预处理，也就是先简单加工一下文本，vue 是这样做的：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> children <span class="token operator">=</span> currentParent<span class="token punctuation">.</span>children
text <span class="token operator">=</span> inPre <span class="token operator">||</span> text<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token operator">?</span> <span class="token function">isTextTag</span><span class="token punctuation">(</span>currentParent<span class="token punctuation">)</span> <span class="token operator">?</span> text <span class="token operator">:</span> <span class="token function">decodeHTMLCached</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>
    <span class="token comment">// only preserve whitespace if its not right after a starting tag</span>
    <span class="token operator">:</span> preserveWhitespace <span class="token operator">&amp;&amp;</span> children<span class="token punctuation">.</span>length <span class="token operator">?</span> <span class="token string">&#39; &#39;</span> <span class="token operator">:</span> <span class="token string">&#39;&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这段代码的意思是：</p><ul><li><p>如果文本不为空，判断父标签是不是<code>script</code>或<code>style</code>，</p><ul><li><p>如果是则什么都不管，</p></li><li><p>如果不是需要 <code>decode</code> 一下编码，使用github上的 he 这个类库的 <code>decodeHTML</code> 方法</p></li></ul></li><li><p>如果文本为空，判断有没有兄弟节点，也就是 <code>parent.children.length</code> 是不是为 0</p><ul><li><p>如果大于0 返回 <code>&#39; &#39;</code></p></li><li><p>如果为 0 返回 <code>&#39;&#39;</code></p></li></ul></li></ul><p>结果发现这一次的 text 正好命中最后的那个 <code>&#39;&#39;</code>，所以这一次就什么都不用做继续下一轮解析就好</p><p>继续上面的例子，现在的 <code>模板字符串</code> 变是这个样子：</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>接着解析 <code>&lt;p&gt;</code>，解析流程和上面的 <code>&lt;div&gt;</code> 一样就不说了，直接继续：</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code>{{name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>通过上面写的文本的截取方式这一次截取出来的文本是这个样子的 <code>&quot;{{name}}&quot;</code></p><h2 id="解析文本" tabindex="-1"><a class="header-anchor" href="#解析文本" aria-hidden="true">#</a> <strong>解析文本</strong></h2><p>其实解析文本节点并不难，只需要将文本节点 <code>push</code> 到 <code>currentParent.children.push(ast)</code> 就行了。</p><p>但是带变量的文本和不带变量的纯文本是不同的处理方式。</p><p>带变量的文本是指 <code>Hello {{ name }}</code> 这个 <code>name</code> 就是变量。</p><p>不带变量的文本是这样的 <code>Hello Berwin</code> 这种没有访问数据的纯文本。</p><p>纯文本比较简单，直接将 文本节点的ast <code>push</code> 到 <code>parent</code> 节点的 <code>children</code> 中就行了，例如：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>children<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">&#39;是纯文本&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>而带变量的文本要多一个解析文本变量的操作：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> expression <span class="token operator">=</span> <span class="token function">parseText</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> delimiters<span class="token punctuation">)</span> <span class="token comment">// 对变量解析 {{name}} =&gt; _s(name)</span>
children<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    expression<span class="token punctuation">,</span>
    text
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面例子中 <code>&quot;{{name}}&quot;</code> 是一个带变量的文本，经过 <code>parseText</code> 解析后 <code>expression</code> 是 <code>_s(name)</code>，所以最后 <code>push</code> 到 <code>currentParent.children</code> 中的节点是这个样子的：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    <span class="token literal-property property">expression</span><span class="token operator">:</span> <span class="token string">&quot;_s(name)&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">&quot;{{name}}&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token number">2</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="结束标签的处理" tabindex="-1"><a class="header-anchor" href="#结束标签的处理" aria-hidden="true">#</a> <strong>结束标签的处理</strong></h2><p>现在文本解析完之后，剩余的 <code>模板字符串</code> 变成了这个样子：</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>这一次还是用上面说的办法，<code>html.indexOf(&#39;&lt;&#39;) === 0</code>，发现是 <code>&lt;</code> 开头的，然后用正则去 <code>match</code> 发现符合 <code>结束标签的格式</code>，把它截取出来。</p><p>并且还要做一个处理是用当前标签名在 <code>stack</code> 从后往前找，将找到的 <code>stack</code> 中的位置往后的所有标签全部删除（意思是，已经解析到当前的结束标签，那么它的子集肯定都是解析过的，试想一下<strong>当前标签都关闭</strong>了，它的<strong>子集肯定也都关闭</strong>了，所以需要把当前标签位置往后从 <code>stack</code>中都清掉）</p><p>结束标签不需要解析，只需要将 <code>stack</code> 中的当前标签删掉就好。</p><p>虽然不用解析，但 <code>vue</code> 还是做了一个优化处理，<code>children</code> 中的最后一项如果是空格 <code>&quot; &quot;</code>，则删除最后这一项：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>lastNode <span class="token operator">&amp;&amp;</span> lastNode<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token number">3</span> <span class="token operator">&amp;&amp;</span> lastNode<span class="token punctuation">.</span>text <span class="token operator">===</span> <span class="token string">&#39; &#39;</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>inPre<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    element<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>因为最后这一项空格是没有用的，举个例子：</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面例子中解析成 <code>element ASTs</code>之后 <code>ul</code> 的结束标签 <code>&lt;/ul&gt;</code> 和 <code>li</code> 的结束标签 <code>&lt;/li&gt;</code> 之间有一个空格，这个空格也属于文本节点在 <code>ul</code> 的 <code>children</code> 中，这个空格是没有用的，把这个空格删掉每次渲染dom都会少渲染一个文本节点，可以节省一定的性能开销。</p><p>现在剩余的 <code>模板字符串</code> 已经不多了，是下面的样子：</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>然后解析文本，就是一个其实就是一个空格的文本节点。</p><p>然后再一次解析结束标签 <code>&lt;/div&gt;</code></p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>解析完毕退出 <code>while</code> 循环。</p><p>解析完之后拿到的 <code>element ASTs</code> 就是文章开头写的那样。</p><h2 id="总结一下" tabindex="-1"><a class="header-anchor" href="#总结一下" aria-hidden="true">#</a> <strong>总结一下</strong></h2><p>其实这样一个模板解析器的原理不是特别难，主要就是两部分内容，一部分是 <code>截取</code> 字符串，一部分是对截取之后的字符串做 <code>解析</code></p><p>每截取一段标签的开头就 <code>push</code> 到 <code>stack</code>中，解析到标签的结束就 pop 出来，当所有的字符串都截没了也就解析完了。</p><h2 id="优化器" tabindex="-1"><a class="header-anchor" href="#优化器" aria-hidden="true">#</a> <strong>优化器</strong></h2><p>优化器的目标是找出那些静态节点并打上标记，而静态节点指的是 <code>DOM</code> 不需要发生变化的节点，例如：</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>是静态节点，不需要发生变化<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>标记静态节点有两个好处：</p><ol><li><p>每次重新渲染的时候不需要为静态节点创建新节点</p></li><li><p>在 <code>Virtual DOM</code> 中 <code>patching</code> 的过程可以被跳过</p></li></ol><p>优化器的实现原理主要分两步：</p><ul><li><p><code>第一步</code>：用递归的方式将所有节点添加 <code>static</code> 属性，标识是不是静态节点</p></li><li><p><code>第二步</code>：标记所有静态根节点</p></li></ul><p>什么是静态根节点？ 答：子节点全是静态节点的节点就是静态根节点，例如：</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>是静态节点，不需要发生变化<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>是静态节点2，不需要发生变化<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>是静态节点3，不需要发生变化<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ul 就是静态根节点。</p><p><strong>如何将所有节点标记 <code>static</code> 属性？</strong></p><p>vue 判断一个节点是不是静态节点的做法其实并不难：</p><ol><li><p>先根据自身是不是静态节点做一个标记 <code>node.static = isStatic(node)</code></p></li><li><p>然后在循环 <code>children</code>，如果 <code>children</code> 中出现了哪怕一个节点不是静态节点，在将当前节点的标记修改成 <code>false</code>： <code>node.static = false</code>。</p></li></ol><p><strong>如何判断一个节点是不是静态节点？</strong></p><p>也就是说 <code>isStatic</code> 这个函数是如何判断静态节点的？</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">isStatic</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">node</span><span class="token operator">:</span> ASTNode</span><span class="token punctuation">)</span><span class="token operator">:</span> boolean <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// expression</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// text</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token operator">!</span><span class="token operator">!</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>pre <span class="token operator">||</span> <span class="token punctuation">(</span>
        <span class="token operator">!</span>node<span class="token punctuation">.</span>hasBindings <span class="token operator">&amp;&amp;</span> <span class="token comment">// no dynamic bindings</span>
        <span class="token operator">!</span>node<span class="token punctuation">.</span>if <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>node<span class="token punctuation">.</span>for <span class="token operator">&amp;&amp;</span> <span class="token comment">// not v-if or v-for or v-else</span>
        <span class="token operator">!</span><span class="token function">isBuiltInTag</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>tag<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token comment">// not a built-in</span>
        <span class="token function">isPlatformReservedTag</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>tag<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token comment">// not a component</span>
        <span class="token operator">!</span><span class="token function">isDirectChildOfTemplateFor</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
        Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">every</span><span class="token punctuation">(</span>isStaticKey<span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>先解释一下，在上文讲的解析器中将 <code>模板字符串</code> 解析成 <code>AST</code> 的时候，会根据不同的文本类型设置一个 <code>type</code>：</p><table><thead><tr><th>type</th><th>说明</th></tr></thead><tbody><tr><td>1</td><td>元素节点</td></tr><tr><td>2</td><td>带变量的动态文本节点</td></tr><tr><td>3</td><td>不带变量的纯文本节点</td></tr></tbody></table><p>所以上面 <code>isStatic</code> 中的逻辑很明显，如果 <code>type === 2</code> 那肯定不是 <code>静态节点</code> 返回 <code>false</code>，如果 <code>type === 3</code> 那就是静态节点，返回 <code>true</code>。</p><p>那如果 <code>type === 1</code>，就有点复杂了，元素节点判断是不是静态节点的条件很多，咱们先一个个看。</p><p>首先如果 <code>node.pre</code> 为 <code>true</code> 直接认为当前节点是静态节点</p><ul><li><p>v-pre</p><ul><li><p><strong>用法</strong>： 跳过这个元素和它的子元素的编译过程。可以用来显示原始 <code>Mustache</code> 标签。跳过大量没有指令的节点会加快编译。</p></li><li><p><strong>示例</strong>：</p></li></ul><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-pre</span><span class="token punctuation">&gt;</span></span>{{ this will not be compiled }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ul><p><strong>其次 <code>node.hasBindings</code> 不能为 <code>true</code>。</strong></p><p><code>node.hasBindings</code> 属性是在解析器转换 <code>AST</code> 时设置的，如果当前节点的 <code>attrs</code> 中，有 <code>v-</code>、<code>@</code>、<code>:</code>开头的 <code>attr</code>，就会把 <code>node.hasBindings</code> 设置为 <code>true</code>。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> dirRE <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^v-|^@|^:</span><span class="token regex-delimiter">/</span></span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>dirRE<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>attr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// mark element as dynamic</span>
    el<span class="token punctuation">.</span>hasBindings <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>并且元素节点不能有 <code>if</code> 和 <code>for</code>属性。</strong></p><p><code>node.if</code> 和 <code>node.for</code> 也是在解析器转换 <code>AST</code> 时设置的。</p><p>在解析的时候发现节点使用了 <code>v-if</code>，就会在解析的时候给当前节点设置一个 <code>if</code> 属性。</p><p>就是说元素节点不能使用 <code>v-if</code> <code>v-for</code> <code>v-else</code> 等指令。</p><p><strong>并且元素节点不能是 <code>slot</code> 和 <code>component</code>。</strong></p><p><strong>并且元素节点不能是组件。</strong></p><p>例如：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">&lt;</span>List<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>List<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>不能是上面这样的自定义组件</p><p><strong>并且元素节点的父级节点不能是带 v-for 的 template</strong>不能被认定为静态节点</p><p>**并且元素节点上不能出现额外的属性。**不能被认定为静态节点</p><p>额外的属性指的是不能出现 <code>type</code> <code>tag</code> <code>attrsList</code> <code>attrsMap</code> <code>plain</code> <code>parent</code> <code>children</code> <code>attrs</code> <code>staticClass</code> <code>staticStyle</code> 这几个属性之外的其他属性，如果出现其他属性则认为当前节点不是静态节点。</p><p><strong>如何标记所有节点？</strong></p><p>上面讲如何判断单个节点是否是静态节点，<code>AST</code> 是一棵树，如何把所有的节点都打上标记（<code>static</code>）呢？</p><p>还有一个问题是，判断 <code>元素节点</code>是不是<code>静态节点</code>不能光看它自身是不是<code>静态节点</code>，如果它的<code>子节点</code>不是<code>静态节点</code>，那就算它自身符合上面讲的<code>静态节点</code>的条件，它也不是<code>静态节点</code>。</p><p>所以在 vue 中有这样一行代码：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> node<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> child <span class="token operator">=</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token function">markStatic</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>child<span class="token punctuation">.</span>static<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        node<span class="token punctuation">.</span>static <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>markStatic</code> 可以给节点标记，规则上面刚讲过，<code>vue.js</code> 通过循环 <code>children</code> 打标记，然后每个不同的子节点又会走相同的逻辑去循环它的 <code>children</code> 这样递归下来所有的节点都会被打上标记。</p><p>然后在循环中判断，如果某个子节点不是 <code>静态节点</code>，那么讲当前节点的标记改为 <code>false</code>。</p><p>这样一圈下来之后 <code>AST</code> 上的所有节点都被准确的打上了标记。</p><p><strong>如何标记静态根节点？</strong></p><p>标记静态根节点其实也是递归的过程。</p><p>vue 中的实现大概是这样的：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">markStaticRoots</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">node</span><span class="token operator">:</span> ASTNode<span class="token punctuation">,</span> <span class="token literal-property property">isInFor</span><span class="token operator">:</span> boolean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// For a node to qualify as a static root, it should have children that</span>
        <span class="token comment">// are not just static text. Otherwise the cost of hoisting out will</span>
        <span class="token comment">// outweigh the benefits and it&#39;s better off to just always render it fresh.</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>static <span class="token operator">&amp;&amp;</span> node<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token punctuation">(</span>
            node<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span>
            node<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token number">3</span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            node<span class="token punctuation">.</span>staticRoot <span class="token operator">=</span> <span class="token boolean">true</span>
            <span class="token keyword">return</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            node<span class="token punctuation">.</span>staticRoot <span class="token operator">=</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> node<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">markStaticRoots</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> isInFor <span class="token operator">||</span> <span class="token operator">!</span><span class="token operator">!</span>node<span class="token punctuation">.</span>for<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当前节点是<code>静态节点</code>，并且有<code>子节点</code>，并且<code>子节点</code>不是单个<code>静态文本节点</code>这种情况会将当前节点标记为<code>根静态节点</code>。</p><p>换句话说是文本节点的频繁和静态性不用作为根静态节点的标识</p><p>上面标记 <code>静态节点</code> 的时候有一段逻辑是只有所有 <code>子节点</code> 都是 <code>静态节点</code>，当前节点才是真正的 <code>静态节点</code>。</p><p>所以这里如果发现一个节点是 <code>静态节点</code>，那就能证明它的所有 <code>子节点</code> 也都是静态节点，而要标记的是 <code>静态根节点</code>，所以如果一个静态节点只包含了<code>一个文本节点</code>那就不会被标记为 <code>静态根节点</code>。</p><p><strong>总结</strong></p><p>整体逻辑其实就是递归 <code>AST</code> 这颗树，然后将 <code>静态节点</code> 和 <code>静态根节点</code> 找到并打上标记。</p><h2 id="代码生成器" tabindex="-1"><a class="header-anchor" href="#代码生成器" aria-hidden="true">#</a> <strong>代码生成器</strong></h2><hr><p>代码生成器的作用是使用 <code>element ASTs</code> 生成 <code>render</code> 函数代码字符串。</p><p>使用本文开头举的例子中的模板生成后的 <code>AST</code> 来生成 <code>render</code> 后是这样的：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token literal-property property">render</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">with(this){return _c(&#39;div&#39;,[_c(&#39;p&#39;,[_v(_s(name))])])}</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>格式化后是这样的：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">_c</span><span class="token punctuation">(</span>
        <span class="token string">&#39;div&#39;</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span>
        <span class="token function">_c</span><span class="token punctuation">(</span>
            <span class="token string">&#39;p&#39;</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span>
                <span class="token function">_v</span><span class="token punctuation">(</span><span class="token function">_s</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">)</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>生成后的代码字符串中看到了有几个函数调用 <code>_c</code>，<code>_v</code>，<code>_s</code>。</p><p><code>_c</code> 对应的是 <code>createElement</code>，它的作用是创建一个元素。</p><ol><li><p>第一个参数是一个HTML标签名</p></li><li><p>第二个参数是元素上使用的属性所对应的数据对象，可选项</p></li><li><p>第三个参数是 <code>children</code></p></li></ol><p>例如：</p><p>一个简单的模板：</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Berwin<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>c<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>生成后的代码字符串是：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">with(this){return _c(&#39;p&#39;,{attrs:{&quot;title&quot;:&quot;Berwin&quot;},on:{&quot;click&quot;:c}},[_v(&quot;1&quot;)])}</span><span class="token template-punctuation string">`</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>格式化后：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">_c</span><span class="token punctuation">(</span>
        <span class="token string">&#39;p&#39;</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token literal-property property">attrs</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token string-property property">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;Berwin&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">on</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token string-property property">&quot;click&quot;</span><span class="token operator">:</span>c<span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token function">_v</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>_v</code> 的意思是创建一个文本节点。</p><p><code>_s</code> 是返回参数中的字符串。</p><p>代码生成器的总体逻辑其实就是使用 <code>element ASTs</code> 去递归，然后拼出这样的 <code>_c(&#39;div&#39;,[_c(&#39;p&#39;,[_v(_s(name))])])</code> 字符串。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">genElement</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">el</span><span class="token operator">:</span> ASTElement<span class="token punctuation">,</span> <span class="token literal-property property">state</span><span class="token operator">:</span> CodegenState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> el<span class="token punctuation">.</span>plain <span class="token operator">?</span> <span class="token keyword">undefined</span> <span class="token operator">:</span> <span class="token function">genData</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> state<span class="token punctuation">)</span>
    <span class="token keyword">const</span> children <span class="token operator">=</span> el<span class="token punctuation">.</span>inlineTemplate <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> <span class="token function">genChildren</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> state<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
        
    <span class="token keyword">let</span> code <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">_c(&#39;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>el<span class="token punctuation">.</span>tag<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&#39;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>
        data <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>data<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token string">&#39;&#39;</span> <span class="token comment">// data</span>
    <span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>
        children <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>children<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token string">&#39;&#39;</span> <span class="token comment">// children</span>
    <span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span>
    
    <span class="token keyword">return</span> code
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>因为 <code>_c</code> 的参数需要 <code>tagName</code>、<code>data</code> 和 <code>children</code>。</p><p>所以上面这段代码的主要逻辑就是用 <code>genData</code> 和 <code>genChildren</code> 获取 <code>data</code> 和 <code>children</code>，然后拼到 <code>_c</code> 中去，拼完后把拼好的 <code>&quot;_c(tagName, data, children)&quot;</code> 返回。</p><p>重点的两个问题:</p><ol><li><p><code>data</code> 如何生成的（<code>genData</code> 的实现逻辑）？</p></li><li><p><code>children</code> 如何生成的（<code>genChildren</code> 的实现逻辑）？</p></li></ol><p>先看 <code>genData</code> 是怎样的实现逻辑：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">genData</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">el</span><span class="token operator">:</span> ASTElement<span class="token punctuation">,</span> <span class="token literal-property property">state</span><span class="token operator">:</span> CodegenState</span><span class="token punctuation">)</span><span class="token operator">:</span> string <span class="token punctuation">{</span>
    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token string">&#39;{&#39;</span>
    <span class="token comment">// key</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        data <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">key:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>el<span class="token punctuation">.</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ref</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>ref<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        data <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ref:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>el<span class="token punctuation">.</span>ref<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>refInFor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        data <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">refInFor:true,</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span>
    <span class="token comment">// pre</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>pre<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        data <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">pre:true,</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ... 类似的还有很多种情况</span>
    data <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">,$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;}&#39;</span>
    <span class="token keyword">return</span> data
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以看到，就是根据 <code>AST</code> 上当前节点上都有什么属性，然后针对不同的属性做一些不同的处理，最后拼出一个字符串~</p><p>然后在看看 <code>genChildren</code> 是怎样的实现的：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">genChildren</span> <span class="token punctuation">(</span>
    <span class="token parameter"><span class="token literal-property property">el</span><span class="token operator">:</span> ASTElement<span class="token punctuation">,</span>
    <span class="token literal-property property">state</span><span class="token operator">:</span> CodegenState</span>
<span class="token punctuation">)</span><span class="token operator">:</span> string <span class="token operator">|</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> children <span class="token operator">=</span> el<span class="token punctuation">.</span>children
    <span class="token keyword">if</span> <span class="token punctuation">(</span>children<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">[</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>children<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">c</span> <span class="token operator">=&gt;</span> <span class="token function">genNode</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;,&#39;</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">]</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">genNode</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">node</span><span class="token operator">:</span> ASTNode<span class="token punctuation">,</span> <span class="token literal-property property">state</span><span class="token operator">:</span> CodegenState</span><span class="token punctuation">)</span><span class="token operator">:</span> string <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">genElement</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> state<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token number">3</span> <span class="token operator">&amp;&amp;</span> node<span class="token punctuation">.</span>isComment<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">genComment</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">genText</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>从上面代码中可以看出，生成 <code>children</code> 的过程其实就是循环 <code>AST</code> 中当前节点的 <code>children</code>，然后把每一项在重新按不同的节点类型去执行 <code>genElement</code> <code>genComment</code> <code>genText</code>。如果 <code>genElement</code> 中又有 <code>children</code> 在循环生成，如此反复递归，最后一圈跑完之后能拿到一个完整的 <code>render</code> 函数代码字符串，就是类似下面这个样子。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&quot;_c(&#39;div&#39;,[_c(&#39;p&#39;,[_v(_s(name))])])&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>最后把生成的 <code>code</code> 装到 <code>with</code> 里。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">generate</span> <span class="token punctuation">(</span>
    <span class="token parameter"><span class="token literal-property property">ast</span><span class="token operator">:</span> ASTElement <span class="token operator">|</span> <span class="token keyword">void</span><span class="token punctuation">,</span>
    <span class="token literal-property property">options</span><span class="token operator">:</span> CompilerOptions</span>
<span class="token punctuation">)</span><span class="token operator">:</span> CodegenResult <span class="token punctuation">{</span>
    <span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CodegenState</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>
    <span class="token comment">// 如果ast为空，则创建一个空div</span>
    <span class="token keyword">const</span> code <span class="token operator">=</span> ast <span class="token operator">?</span> <span class="token function">genElement</span><span class="token punctuation">(</span>ast<span class="token punctuation">,</span> state<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">&#39;_c(&quot;div&quot;)&#39;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">render</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">with(this){return </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>code<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">}</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结" aria-hidden="true">#</a> <strong>总结</strong></h2><ul><li><p>解析器（parser）的作用是将 <code>模板字符串</code> 转换成 <code>element ASTs</code>。</p></li><li><p>优化器（optimizer）的作用是找出那些静态节点和静态根节点并打上标记。</p></li><li><p>代码生成器（code generator）的作用是使用 <code>element ASTs</code> 生成 render函数代码（generate render function code from element ASTs）。</p></li></ul><p><img src="https://camo.githubusercontent.com/0920aad6c6ccef524f2cbe808e85729960974f78/687474703a2f2f70332e7168696d672e636f6d2f743031393264303939313237633832396561392e706e67" alt="流程图"></p><p>解析器（parser）的原理是一小段一小段的去截取字符串，然后维护一个 <code>stack</code> 用来保存DOM深度，每截取到一段标签的开始就 <code>push</code> 到 <code>stack</code> 中，当所有字符串都截取完之后也就解析出了一个完整的 <code>AST</code>。</p><p>优化器（optimizer）的原理是用递归的方式将所有节点打标记，表示是否是一个 <code>静态节点</code>，然后再次递归一遍把 <code>静态根节点</code> 也标记出来。</p><p>代码生成器（code generator）的原理也是通过递归去拼一个函数执行代码的字符串，递归的过程根据不同的节点类型调用不同的生成方法，如果发现是一颗元素节点就拼一个 <code>_c(tagName, data, children)</code> 的函数调用字符串，然后 <code>data</code> 和 <code>children</code> 也是使用 <code>AST</code> 中的属性去拼字符串。</p><p>如果 <code>children</code> 中还有 <code>children</code> 则递归去拼。</p><p>最后拼出一个完整的 <code>render</code> 函数代码。</p><h2 id="vue-3-0-模板编译原理" tabindex="-1"><a class="header-anchor" href="#vue-3-0-模板编译原理" aria-hidden="true">#</a> <strong>vue 3.0 模板编译原理</strong></h2><hr><p>Vue 的编译模块包含 4 个目录：</p><p><code>compiler-core</code></p><p><code>compiler-dom</code> // 浏览器</p><p><code>compiler-sfc</code> // 单文件组件</p><p><code>compiler-ssr</code> // 服务端渲染</p><p>其中 <code>compiler-core</code> 模块是 Vue 编译的核心模块，并且是平台无关的。而剩下的三个都是在 <code>compiler-core</code> 的基础上针对不同的平台作了适配处理。</p><h2 id="parse" tabindex="-1"><a class="header-anchor" href="#parse" aria-hidden="true">#</a> <strong>Parse</strong></h2><p>Vue 在解析模板字符串时，可分为两种情况：以 <code>&lt;</code> 开头的字符串和不以 <code>&lt;</code> 开头的字符串。</p><p>不以 <code>&lt;</code> 开头的字符串有两种情况：它是文本节点或 <code>{{ exp }}</code> 插值表达式。</p><p>而以 &lt; 开头的字符串又分为以下几种情况：</p><ol><li><p>元素开始标签 <code>&lt;div&gt;</code></p></li><li><p>元素结束标签 <code>&lt;/div&gt;</code></p></li><li><p>注释节点 <code>&lt;!-- 123 --&gt;</code></p></li><li><p>文档声明 <code>&lt;!DOCTYPE html&gt;</code></p></li></ol><p>用伪代码表示，大概过程如下：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">while</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">startsWith</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token string">&#39;{{&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 如果以 &#39;{{&#39; 开头</span>
        node <span class="token operator">=</span> <span class="token function">parseInterpolation</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> mode<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&#39;&lt;&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 以 &lt; 标签开头</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&#39;!&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">startsWith</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token string">&#39;&lt;!--&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// 注释</span>
                node <span class="token operator">=</span> <span class="token function">parseComment</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">startsWith</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token string">&#39;&lt;!DOCTYPE&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// 文档声明，当成注释处理</span>
                node <span class="token operator">=</span> <span class="token function">parseBogusComment</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&#39;/&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 结束标签</span>
            <span class="token function">parseTag</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> TagType<span class="token punctuation">.</span>End<span class="token punctuation">,</span> parent<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[a-z]</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 开始标签</span>
            node <span class="token operator">=</span> <span class="token function">parseElement</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> ancestors<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// 普通文本节点</span>
        node <span class="token operator">=</span> <span class="token function">parseText</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> mode<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在源码中对应的几个函数分别是：</p><ol><li><p><code>parseChildren()</code>，主入口。</p></li><li><p><code>parseInterpolation()</code>，解析双花插值表达式。</p></li><li><p><code>parseComment()</code>，解析注释。</p></li><li><p><code>parseBogusComment()</code>，解析文档声明。</p></li><li><p><code>parseTag()</code>，解析标签。</p></li><li><p><code>parseElement()</code>，解析元素节点，它会在内部执行 <code>parseTag()</code>。</p></li><li><p><code>parseText()</code>，解析普通文本。</p></li><li><p><code>parseAttribute()</code>，解析属性。</p></li></ol><p>每解析完一个标签、文本、注释等节点时，Vue 就会生成对应的 AST 节点，<strong>并且会把已经解析完的字符串给截断</strong>。</p><p>对字符串进行截断使用的是 <code>advanceBy(context, numberOfCharacters)</code> 函数，<code>context</code> 是字符串的上下文对象，<code>numberOfCharacters</code> 是要截断的字符数。</p><p>用一个简单的例子来模拟一下截断操作：</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>test<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>首先解析 <code>&lt;div</code>，然后执行 <code>advanceBy(context, 4)</code> 进行截断操作（内部执行的是 <code>s = s.slice(4)</code>），变成：</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code>name=&quot;test&quot;&gt;
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>再解析属性，并截断，变成：</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

同理，后面的截断情况为：

&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 所有字符串已经解析完 --&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>AST 节点</strong></p><p>所有的 <code>AST</code> 节点定义都在 <code>compiler-core/ast.ts</code> 文件中，下面是一个元素节点的定义：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">BaseElementNode</span> <span class="token keyword">extends</span> <span class="token class-name">Node</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> NodeTypes<span class="token punctuation">.</span><span class="token constant">ELEMENT</span> <span class="token comment">// 类型</span>
    <span class="token literal-property property">ns</span><span class="token operator">:</span> Namespace <span class="token comment">// 命名空间 默认为 HTML，即 0</span>
    <span class="token literal-property property">tag</span><span class="token operator">:</span> string <span class="token comment">// 标签名</span>
    <span class="token literal-property property">tagType</span><span class="token operator">:</span> ElementTypes <span class="token comment">// 元素类型</span>
    <span class="token literal-property property">isSelfClosing</span><span class="token operator">:</span> boolean <span class="token comment">// 是否是自闭合标签 例如 &lt;br/&gt; &lt;hr/&gt;</span>
    <span class="token literal-property property">props</span><span class="token operator">:</span> Array<span class="token operator">&lt;</span>AttributeNode <span class="token operator">|</span> DirectiveNode<span class="token operator">&gt;</span> <span class="token comment">// props 属性，包含 HTML 属性和指令</span>
    <span class="token literal-property property">children</span><span class="token operator">:</span> TemplateChildNode<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// 字节点</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>一些简单的要点已经讲完了，下面再从一个比较复杂的例子来详细讲解一下 <code>parse</code> 的处理过程。</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>test<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 这是注释 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{ test }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    一个文本节点
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>good job!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面的模板字符串假设为 <code>s</code>，第一个字符 <code>s[0]</code> 是 <code>&lt;</code> 开头，那说明它只能是刚才所说的四种情况之一。</p><p>这时需要再看一下 <code>s[1]</code> 的字符是什么：</p><ol><li><p>如果是 <code>!</code>，则调用字符串原生方法 <code>startsWith()</code> 看看是以 <code>&#39;&lt;!--&#39;</code> 开头还是以 <code>&#39;&lt;!DOCTYPE&#39;</code> 开头。虽然这两者对应的处理函数不一样，但它们最终都是解析为注释节点。</p></li><li><p>如果是 <code>/</code>，则按结束标签处理。</p></li><li><p>如果不是 <code>/</code>，则按开始标签处理。</p></li></ol><p>从的示例来看，这是一个 <code>&lt;div&gt;</code> 开始标签。</p><p>这里还有一点要提一下，Vue 会用一个栈 stack 来保存解析到的元素标签。当它遇到开始标签时，会将这个标签推入栈，遇到结束标签时，将刚才的标签弹出栈。<strong>它的作用是保存当前已经解析了，但还没解析完的元素标签。这个栈还有另一个作用，在解析到某个字节点时，通过 <code>stack[stack.length - 1]</code> 可以获取它的父元素。</strong></p><p>从的示例来看，它的出入栈顺序是这样的：</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>1. [div] // div 入栈
2. [div, p] // p 入栈
3. [div] // p 出栈
4. [div, div] // div 入栈
5. [div] // div 出栈
6. [] // 最后一个 div 出栈，模板字符串已解析完，这时栈为空
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>接着上文继续分析的示例，这时已经知道是 <code>div</code> 标签了，接下来会把已经解析完的 <code>&lt;div</code> 字符串截断，然后解析它的属性。</p><p><code>Vue</code> 的属性有两种情况：</p><ol><li><p><code>HTML</code> 普通属性</p></li><li><p><code>Vue</code> 指令</p></li></ol><p>根据属性的不同生成的节点不同，HTML 普通属性节点 type 为 6，Vue 指令节点 type 为 7。</p><p>所有的节点类型值如下：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token constant">ROOT</span><span class="token punctuation">,</span>  <span class="token comment">// 根节点 0</span>
<span class="token constant">ELEMENT</span><span class="token punctuation">,</span> <span class="token comment">// 元素节点 1</span>
<span class="token constant">TEXT</span><span class="token punctuation">,</span> <span class="token comment">// 文本节点 2</span>
<span class="token constant">COMMENT</span><span class="token punctuation">,</span> <span class="token comment">// 注释节点 3</span>
<span class="token constant">SIMPLE_EXPRESSION</span><span class="token punctuation">,</span> <span class="token comment">// 表达式 4</span>
<span class="token constant">INTERPOLATION</span><span class="token punctuation">,</span> <span class="token comment">// 双花插值 {{ }} 5</span>
<span class="token constant">ATTRIBUTE</span><span class="token punctuation">,</span> <span class="token comment">// 属性 6</span>
<span class="token constant">DIRECTIVE</span><span class="token punctuation">,</span> <span class="token comment">// 指令 7</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>属性解析完后，<code>div</code> 开始标签也就解析完了，<code>&lt;div name=&quot;test&quot;&gt;</code> 这一行字符串已经被截断。现在剩下的字符串如下：</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code>    <span class="token comment">&lt;!-- 这是注释 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{ test }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    一个文本节点
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>good job!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注释文本和普通文本节点解析规则都很简单，直接截断，生成节点。注释文本调用 <code>parseComment()</code> 函数处理，文本节点调用 <code>parseText()</code> 处理。</p><p>双花插值的字符串处理逻辑稍微复杂点，例如示例中的 <code>{{ test }}</code>：</p><ol><li><p>先将双花括号中的内容提取出来，即 <code>test</code>，再对它执行 <code>trim()</code>，去除空格。</p></li><li><p>然后会生成两个节点，一个节点是 <code>INTERPOLATION</code>，type 为 5，表示它是双花插值。</p></li><li><p>第二个节点是它的内容，即 <code>test</code>，它会生成一个 <code>SIMPLE_EXPRESSION</code> 节点，type 为 4。</p></li></ol><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> NodeTypes<span class="token punctuation">.</span><span class="token constant">INTERPOLATION</span><span class="token punctuation">,</span> <span class="token comment">// 双花插值类型</span>
    <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> NodeTypes<span class="token punctuation">.</span><span class="token constant">SIMPLE_EXPRESSION</span><span class="token punctuation">,</span>
        <span class="token literal-property property">isStatic</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 非静态节点</span>
        <span class="token literal-property property">isConstant</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        content<span class="token punctuation">,</span>
        <span class="token literal-property property">loc</span><span class="token operator">:</span> <span class="token function">getSelection</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> innerStart<span class="token punctuation">,</span> innerEnd<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">loc</span><span class="token operator">:</span> <span class="token function">getSelection</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> start<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>剩下的字符串解析逻辑和上文的差不多，就不解释了，最后这个示例解析出来的 AST 如下所示：</p><p><img src="https://camo.githubusercontent.com/e7c48876b208e006024c399586e31981d92d8183/68747470733a2f2f70312d6a75656a696e2e62797465696d672e636f6d2f746f732d636e2d692d6b3375316662706663702f63343764383037663062396434333037393631306635343162316139633934637e74706c762d6b3375316662706663702d7a6f6f6d2d312e696d616765" alt="示例图"></p><p>从 AST 上，还能看到某些节点上有一些别的属性：</p><ol><li><p><code>ns</code>，<code>命名空间</code>，一般为 HTML，值为 0。</p></li><li><p><code>loc</code>，它是一个<code>位置信息</code>，表明这个节点在源 HTML 字符串中的位置，包含行，列，偏移量等信息。</p></li><li><p><code>{{ test }}</code> 解析出来的节点会有一个 <code>isStatic</code> 属性，值为 false，表示这是一个动态节点。如果是静态节点，则只会生成一次，并且在后面的阶段一直复用同一个，不用进行 <code>diff</code> 比较。</p></li></ol><p>另外还有一个 tagType 属性，它有 4 个值：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token keyword">enum</span> ElementTypes <span class="token punctuation">{</span>
    <span class="token constant">ELEMENT</span><span class="token punctuation">,</span> <span class="token comment">// 0 元素节点</span>
    <span class="token constant">COMPONENT</span><span class="token punctuation">,</span> <span class="token comment">// 1 组件</span>
    <span class="token constant">SLOT</span><span class="token punctuation">,</span> <span class="token comment">// 2 插槽</span>
    <span class="token constant">TEMPLATE</span> <span class="token comment">// 3 模板</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>主要用于区分上述四种类型节点。</p><h2 id="transform" tabindex="-1"><a class="header-anchor" href="#transform" aria-hidden="true">#</a> <strong>Transform</strong></h2><p>在 <code>transform</code> 阶段，Vue 会对 <code>AST</code> 进行一些转换操作，主要是根据不同的 <code>AST</code> 节点添加不同的选项参数，这些参数在 <code>codegen</code> 阶段会用到。下面列举一些比较重要的选项：</p><p><strong>cacheHandlers</strong></p><p>如果 <code>cacheHandlers</code> 的值为 <code>true</code>，则表示开启事件函数缓存。例如 <code>@click=&quot;foo&quot;</code> 默认编译为 <code>{ onClick: foo }</code>，如果开启了这个选项，则编译为</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span> <span class="token literal-property property">onClick</span><span class="token operator">:</span> _cache<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">(</span>_cache<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> _ctx<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>hoistStatic</strong></p><p><strong>hoistStatic 是一个标识符，表示要不要开启静态节点提升</strong>。如果值为 true，静态节点将被提升到 <code>render()</code> 函数外面生成，并被命名为 <code>_hoisted_x</code> 变量。</p><p>例如 <code>一个文本节点</code> 生成的代码为 <code>const _hoisted_2 = /*#__PURE__*/_createTextVNode(&quot; 一个文本节点 &quot;)</code>。</p><p>下面两张图，前者是 <code>hoistStatic = false</code>，后面是 <code>hoistStatic = true</code></p><p><a href="https://vue-next-template-explorer.netlify.app/#%7B%22src%22%3A%22%5Cr%5Cn%22%2C%22options%22%3A%7B%22mode%22%3A%22module%22%2C%22prefixIdentifiers%22%3Afalse%2C%22optimizeImports%22%3Afalse%2C%22hoistStatic%22%3Afalse%2C%22cacheHandlers%22%3Afalse%2C%22scopeId%22%3Anull%2C%22ssrCssVars%22%3A%22%7B%20color%20%7D%22%2C%22bindingMetadata%22%3A%7B%22TestComponent%22%3A%22setup%22%2C%22foo%22%3A%22setup%22%2C%22bar%22%3A%22props%22%7D%7D%7D" target="_blank" rel="noopener noreferrer">网站地址<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><img src="https://camo.githubusercontent.com/d81b9663a841909b491a49d5e66e41666e64f660/68747470733a2f2f70392d6a75656a696e2e62797465696d672e636f6d2f746f732d636e2d692d6b3375316662706663702f35626466386535656130643734306236393765376233653864643031316565657e74706c762d6b3375316662706663702d7a6f6f6d2d312e696d616765" alt="示例图1"></p><p><img src="https://camo.githubusercontent.com/f7bc66fd01b821fbdd718ef2036251736af996aa/68747470733a2f2f70332d6a75656a696e2e62797465696d672e636f6d2f746f732d636e2d692d6b3375316662706663702f34363137396236396338396334346334393966613062393530343963656264317e74706c762d6b3375316662706663702d7a6f6f6d2d312e696d616765" alt="示例图2"></p><p><strong>prefixIdentifiers</strong></p><p>这个参数的作用是用于代码生成。例如 <code>{{ foo }}</code> 在 module 模式下生成的代码为 <code>_ctx.foo</code>，而在 function 模式下是 <code>with (this) { ... }</code>。因为在 module 模式下，默认为严格模式，不能使用 <code>with</code> 语句。</p><p><strong>PatchFlags</strong></p><p><code>transform</code> 在对 <code>AST</code> 节点进行转换时，会打上 <code>patchflag</code> 参数，这个参数主要用于 <code>diff</code> 比较过程。当 <code>DOM</code> 节点有这个标志并且大于 0，就代表要更新，没有就跳过。</p><p>来看一下 patchflag 的取值范围：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token keyword">enum</span> PatchFlags <span class="token punctuation">{</span>
    <span class="token comment">// 动态文本节点</span>
    <span class="token constant">TEXT</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>

    <span class="token comment">// 动态 class</span>
    <span class="token constant">CLASS</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 2</span>

    <span class="token comment">// 动态 style</span>
    <span class="token constant">STYLE</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment">// 4</span>

    <span class="token comment">// 动态属性，但不包含类名和样式</span>
    <span class="token comment">// 如果是组件，则可以包含类名和样式</span>
    <span class="token constant">PROPS</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token comment">// 8</span>

    <span class="token comment">// 具有动态 key 属性，当 key 改变时，需要进行完整的 diff 比较。</span>
    <span class="token constant">FULL_PROPS</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token comment">// 16</span>

    <span class="token comment">// 带有监听事件的节点</span>
    <span class="token constant">HYDRATE_EVENTS</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token comment">// 32</span>

    <span class="token comment">// 一个不会改变子节点顺序的 fragment</span>
    <span class="token constant">STABLE_FRAGMENT</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token comment">// 64</span>

    <span class="token comment">// 带有 key 属性的 fragment 或部分子字节有 key</span>
    <span class="token constant">KEYED_FRAGMENT</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token comment">// 128</span>

    <span class="token comment">// 子节点没有 key 的 fragment</span>
    <span class="token constant">UNKEYED_FRAGMENT</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token comment">// 256</span>

    <span class="token comment">// 一个节点只会进行非 props 比较</span>
    <span class="token constant">NEED_PATCH</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token comment">// 512</span>

    <span class="token comment">// 动态 slot</span>
    <span class="token constant">DYNAMIC_SLOTS</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token comment">// 1024</span>

    <span class="token comment">// 静态节点</span>
    <span class="token constant">HOISTED</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>

    <span class="token comment">// 指示在 diff 过程应该要退出优化模式</span>
    <span class="token constant">BAIL</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>从上述代码可以看出 <code>patchflag</code> 使用一个 11 位的位图来表示不同的值，每个值都有不同的含义。Vue 在 <code>diff</code> 过程会根据不同的 <code>patchflag</code> 使用不同的 <code>patch</code> 方法。</p><p>下图是经过 <code>transform</code> 后的 <code>AST</code>：</p><p><img src="https://camo.githubusercontent.com/966c1e5e051d6afcd506c8c8cf25d14b46cd4c88/68747470733a2f2f70392d6a75656a696e2e62797465696d672e636f6d2f746f732d636e2d692d6b3375316662706663702f36626163383830323465616434636363613161396265356533323236303836617e74706c762d6b3375316662706663702d7a6f6f6d2d312e696d616765" alt="示例图"></p><p>可以看到 <code>codegenNode</code>、<code>helpers</code> 和 <code>hoists</code> 已经被填充上了相应的值。<strong><code>codegenNode</code> 是生成代码要用到的数据</strong>，<strong><code>hoists</code> 存储的是静态节点</strong>，<strong><code>helpers</code> 存储的是创建 VNode 的函数名称（其实是 Symbol）</strong>。</p><p>在正式开始 <code>transform</code> 前，需要创建一个 <code>transformContext</code>，即 <code>transform</code> 上下文。和这三个属性有关的数据和方法如下：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">helpers</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token literal-property property">hoists</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

<span class="token comment">// methods</span>
<span class="token function">helper</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    context<span class="token punctuation">.</span>helpers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
    <span class="token keyword">return</span> name
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">helperString</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>helperNameMap<span class="token punctuation">[</span>context<span class="token punctuation">.</span><span class="token function">helper</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">hoist</span><span class="token punctuation">(</span><span class="token parameter">exp</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    context<span class="token punctuation">.</span>hoists<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>exp<span class="token punctuation">)</span>
    <span class="token keyword">const</span> identifier <span class="token operator">=</span> <span class="token function">createSimpleExpression</span><span class="token punctuation">(</span>
        <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">_hoisted_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>context<span class="token punctuation">.</span>hoists<span class="token punctuation">.</span>length<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
        <span class="token boolean">false</span><span class="token punctuation">,</span>
        exp<span class="token punctuation">.</span>loc<span class="token punctuation">,</span>
        <span class="token boolean">true</span>
    <span class="token punctuation">)</span>
    identifier<span class="token punctuation">.</span>hoisted <span class="token operator">=</span> exp
    <span class="token keyword">return</span> identifier
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>来看一下具体的 <code>transform</code> 过程是怎样的，用 <code>&lt;p&gt;{{ test }}&lt;/p&gt;</code> 来做示例。</p><p>这个节点对应的是 <code>transformElement()</code> 转换函数，由于 <code>p</code> 没有绑定动态属性，没有绑定指令，所以重点不在它，而是在 <code>{{ test }}</code> 上。<code>{{ test }}</code> 是一个双花插值表达式，所以将它的 <code>patchFlag</code> 设为 1（动态文本节点），对应的执行代码是 <code>patchFlag |= 1</code>。然后再执行 <code>createVNodeCall()</code> 函数，它的返回值就是这个节点的 <code>codegenNode</code> 值。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>node<span class="token punctuation">.</span>codegenNode <span class="token operator">=</span> <span class="token function">createVNodeCall</span><span class="token punctuation">(</span>
    context<span class="token punctuation">,</span>
    vnodeTag<span class="token punctuation">,</span>
    vnodeProps<span class="token punctuation">,</span>
    vnodeChildren<span class="token punctuation">,</span>
    vnodePatchFlag<span class="token punctuation">,</span>
    vnodeDynamicProps<span class="token punctuation">,</span>
    vnodeDirectives<span class="token punctuation">,</span>
    <span class="token operator">!</span><span class="token operator">!</span>shouldUseBlock<span class="token punctuation">,</span>
    <span class="token boolean">false</span> <span class="token comment">/* disableTracking */</span><span class="token punctuation">,</span>
    node<span class="token punctuation">.</span>loc
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>createVNodeCall()</code> 根据这个节点添加了一个 <code>createVNode</code> <code>Symbol</code> 符号，它放在 <code>helpers</code> 里。其实就是要在代码生成阶段引入的帮助函数。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// createVNodeCall() 内部执行过程，已删除多余的代码</span>
context<span class="token punctuation">.</span><span class="token function">helper</span><span class="token punctuation">(</span><span class="token constant">CREATE_VNODE</span><span class="token punctuation">)</span>

<span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> NodeTypes<span class="token punctuation">.</span><span class="token constant">VNODE_CALL</span><span class="token punctuation">,</span>
    tag<span class="token punctuation">,</span>
    props<span class="token punctuation">,</span>
    children<span class="token punctuation">,</span>
    patchFlag<span class="token punctuation">,</span>
    dynamicProps<span class="token punctuation">,</span>
    directives<span class="token punctuation">,</span>
    isBlock<span class="token punctuation">,</span>
    disableTracking<span class="token punctuation">,</span>
    loc
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>hoists</strong></p><p>一个节点是否添加到 <code>hoists</code> 中，主要看它是不是静态节点，并且需要将 <code>hoistStatic</code> 设为 <code>true</code>。</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>test<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> // 属性静态节点
    <span class="token comment">&lt;!-- 这是注释 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{ test }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    一个文本节点 // 静态节点
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>good job!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span> // 静态节点
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以看到，上面有三个静态节点，所以 <code>hoists</code> 数组有 3 个值。并且无论静态节点嵌套有多深，都会被提升到 <code>hoists</code> 中。</p><p><strong>type 变化</strong></p><p>从上图可以看到，最外层的 <code>div</code> 的 <code>type</code> 原来为 1，经过 <code>transform</code> 生成的 <code>codegenNode</code> 中的 <code>type</code> 变成了 13。 这个 13 是代码生成对应的类型 <code>VNODE_CALL</code>。另外还有:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// codegen</span>
<span class="token constant">VNODE_CALL</span><span class="token punctuation">,</span> <span class="token comment">// 13</span>
<span class="token constant">JS_CALL_EXPRESSION</span><span class="token punctuation">,</span> <span class="token comment">// 14</span>
<span class="token constant">JS_OBJECT_EXPRESSION</span><span class="token punctuation">,</span> <span class="token comment">// 15</span>
<span class="token constant">JS_PROPERTY</span><span class="token punctuation">,</span> <span class="token comment">// 16</span>
<span class="token constant">JS_ARRAY_EXPRESSION</span><span class="token punctuation">,</span> <span class="token comment">// 17</span>
<span class="token constant">JS_FUNCTION_EXPRESSION</span><span class="token punctuation">,</span> <span class="token comment">// 18</span>
<span class="token constant">JS_CONDITIONAL_EXPRESSION</span><span class="token punctuation">,</span> <span class="token comment">// 19</span>
<span class="token constant">JS_CACHE_EXPRESSION</span><span class="token punctuation">,</span> <span class="token comment">// 20</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>刚才提到的例子 <code>{{ test }}</code>，它的 <code>codegenNode</code> 就是通过调用 <code>createVNodeCall()</code> 生成的：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> NodeTypes<span class="token punctuation">.</span><span class="token constant">VNODE_CALL</span><span class="token punctuation">,</span>
    tag<span class="token punctuation">,</span>
    props<span class="token punctuation">,</span>
    children<span class="token punctuation">,</span>
    patchFlag<span class="token punctuation">,</span>
    dynamicProps<span class="token punctuation">,</span>
    directives<span class="token punctuation">,</span>
    isBlock<span class="token punctuation">,</span>
    disableTracking<span class="token punctuation">,</span>
    loc
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以从上述代码看到，<code>type</code> 被设置为 <code>NodeTypes.VNODE_CALL</code>，即 13。</p><p>每个不同的节点都由不同的 <code>transform</code> 函数来处理，由于篇幅有限，具体代码请自行查阅。</p><h2 id="codegen" tabindex="-1"><a class="header-anchor" href="#codegen" aria-hidden="true">#</a> <strong>Codegen</strong></h2><p>代码生成阶段最后生成了一个字符串，把字符串的双引号去掉，看一下具体的内容是什么：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> _Vue <span class="token operator">=</span> Vue
<span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token literal-property property">createVNode</span><span class="token operator">:</span> _createVNode<span class="token punctuation">,</span> <span class="token literal-property property">createCommentVNode</span><span class="token operator">:</span> _createCommentVNode<span class="token punctuation">,</span> <span class="token literal-property property">createTextVNode</span><span class="token operator">:</span> _createTextVNode <span class="token punctuation">}</span> <span class="token operator">=</span> _Vue

<span class="token keyword">const</span> _hoisted_1 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;test&quot;</span> <span class="token punctuation">}</span>
<span class="token keyword">const</span> _hoisted_2 <span class="token operator">=</span> <span class="token comment">/*#__PURE__*/</span><span class="token function">_createTextVNode</span><span class="token punctuation">(</span><span class="token string">&quot; 一个文本节点 &quot;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> _hoisted_3 <span class="token operator">=</span> <span class="token comment">/*#__PURE__*/</span><span class="token function">_createVNode</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;good job!&quot;</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token comment">/* HOISTED */</span><span class="token punctuation">)</span>

<span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">_ctx<span class="token punctuation">,</span> _cache</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">with</span> <span class="token punctuation">(</span>_ctx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token literal-property property">createCommentVNode</span><span class="token operator">:</span> _createCommentVNode<span class="token punctuation">,</span> <span class="token literal-property property">toDisplayString</span><span class="token operator">:</span> _toDisplayString<span class="token punctuation">,</span> <span class="token literal-property property">createVNode</span><span class="token operator">:</span> _createVNode<span class="token punctuation">,</span> <span class="token literal-property property">createTextVNode</span><span class="token operator">:</span> _createTextVNode<span class="token punctuation">,</span> <span class="token literal-property property">openBlock</span><span class="token operator">:</span> _openBlock<span class="token punctuation">,</span> <span class="token literal-property property">createBlock</span><span class="token operator">:</span> _createBlock <span class="token punctuation">}</span> <span class="token operator">=</span> _Vue

        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">_openBlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">_createBlock</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">,</span> _hoisted_1<span class="token punctuation">,</span> <span class="token punctuation">[</span>
            <span class="token function">_createCommentVNode</span><span class="token punctuation">(</span><span class="token string">&quot; 这是注释 &quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">_createVNode</span><span class="token punctuation">(</span><span class="token string">&quot;p&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token function">_toDisplayString</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token comment">/* TEXT */</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            _hoisted_2<span class="token punctuation">,</span>
            _hoisted_3
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>代码生成模式</strong></p><p>可以看到上述代码最后返回一个 <code>render()</code> 函数，作用是生成对应的 <code>VNode</code>。</p><p>其实代码生成有两种模式：<code>module</code> 和 <code>function</code>，由标识符 <code>prefixIdentifiers</code> 决定使用哪种模式。</p><p><code>function</code> 模式的特点是：使用 <code>const { helpers... } = Vue</code> 的方式来引入帮助函数，也就是是 <code>createVode()</code> <code>createCommentVNode()</code> 这些函数。向外导出使用 <code>return</code> 返回整个 <code>render()</code> 函数。</p><p><code>module</code> 模式的特点是：使用 <code>es6</code> 模块来导入导出函数，也就是使用 <code>import</code> 和 <code>export</code>。</p><p><strong>静态节点</strong></p><p>另外还有三个变量是用 <code>_hoisted_</code> 命名的，后面跟着数字，代表这是第几个静态变量。</p><p>再看一下 parse 阶段的 HTML 模板字符串：</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>test<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 这是注释 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{ test }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    一个文本节点
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>good job!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这个示例只有一个动态节点，即 <code>{{ test }}</code>，剩下的全是静态节点。从生成的代码中也可以看出，生成的节点和模板中的代码是一一对应的。静态节点的作用就是只生成一次，以后直接复用。</p><p>细心的网友可能发现了 <code>_hoisted_2</code> 和 <code>_hoisted_3</code> 变量中都有一个 <code>/*#__PURE__*/</code> 注释。</p><p>这个注释的作用是表示这个函数是纯函数，没有副作用，主要用于 <code>tree-shaking</code>。压缩工具在打包时会将未被使用的代码直接删除（shaking 摇掉）。</p><p>再来看一下生成动态节点 <code>{{ test }}</code> 的代码： <code>_createVNode(&quot;p&quot;, null, _toDisplayString(test), 1 /* TEXT */)</code>。</p><p>其中 <code>_toDisplayString(test)</code> 的内部实现是：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">return</span> val <span class="token operator">==</span> <span class="token keyword">null</span>
    <span class="token operator">?</span> <span class="token string">&#39;&#39;</span>
    <span class="token operator">:</span> <span class="token function">isObject</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
        <span class="token operator">?</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> replacer<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token operator">:</span> <span class="token function">String</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>代码很简单，就是转成字符串输出。</p><p>而 <code>_createVNode(&quot;p&quot;, null, _toDisplayString(test), 1 /* TEXT */)</code> 最后一个参数 1 就是 <code>transform</code> 添加的 <code>patchflag</code> 了。</p><p><strong>帮助函数 helpers</strong></p><p>在 <code>transform</code>、<code>codegen</code> 这两个阶段，都能看到 <code>helpers</code> 的影子，到底 <code>helpers</code> 是干什么用的？</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// Name mapping for runtime helpers that need to be imported from &#39;vue&#39; in</span>
<span class="token comment">// generated code. Make sure these are correctly exported in the runtime!</span>
<span class="token comment">// Using `any` here because TS doesn&#39;t allow symbols as index type.</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token literal-property property">helperNameMap</span><span class="token operator">:</span> any <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token constant">FRAGMENT</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Fragment</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">TELEPORT</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Teleport</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">SUSPENSE</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Suspense</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">KEEP_ALIVE</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">KeepAlive</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">BASE_TRANSITION</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">BaseTransition</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">OPEN_BLOCK</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">openBlock</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">CREATE_BLOCK</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">createBlock</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">CREATE_VNODE</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">createVNode</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">CREATE_COMMENT</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">createCommentVNode</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">CREATE_TEXT</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">createTextVNode</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">CREATE_STATIC</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">createStaticVNode</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">RESOLVE_COMPONENT</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">resolveComponent</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">RESOLVE_DYNAMIC_COMPONENT</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">resolveDynamicComponent</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">RESOLVE_DIRECTIVE</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">resolveDirective</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">WITH_DIRECTIVES</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">withDirectives</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">RENDER_LIST</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">renderList</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">RENDER_SLOT</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">renderSlot</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">CREATE_SLOTS</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">createSlots</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">TO_DISPLAY_STRING</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">toDisplayString</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">MERGE_PROPS</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">mergeProps</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">TO_HANDLERS</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">toHandlers</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">CAMELIZE</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">camelize</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">CAPITALIZE</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">capitalize</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">SET_BLOCK_TRACKING</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">setBlockTracking</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">PUSH_SCOPE_ID</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">pushScopeId</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">POP_SCOPE_ID</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">popScopeId</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">WITH_SCOPE_ID</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">withScopeId</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">WITH_CTX</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">withCtx</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">registerRuntimeHelpers</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">helpers</span><span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function">getOwnPropertySymbols</span><span class="token punctuation">(</span>helpers<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">s</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        helperNameMap<span class="token punctuation">[</span>s<span class="token punctuation">]</span> <span class="token operator">=</span> helpers<span class="token punctuation">[</span>s<span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其实帮助函数就是在代码生成时从 <code>Vue</code> 引入的一些函数，以便让程序正常执行，从上面生成的代码中就可以看出来。而 <code>helperNameMap</code> 是默认的映射表名称，这些名称就是要从 <code>Vue</code> 引入的函数名称。</p><p>另外，还能看到一个注册函数 <code>registerRuntimeHelpers(helpers: any())</code>，它是干什么用的呢？</p><p>知道编译模块 <code>compiler-core</code> 是平台无关的，而 <code>compiler-dom</code> 是浏览器相关的编译模块。为了能在浏览器正常运行 <code>Vue</code> 程序，就得把浏览器相关的 <code>Vue 数据和函数导入进来</code>。 <code>registerRuntimeHelpers(helpers: any()</code> 正是用来做这件事的，从 compiler-dom 的 runtimeHelpers.ts 文件就能看出来：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">registerRuntimeHelpers</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token constant">V_MODEL_RADIO</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">vModelRadio</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">V_MODEL_CHECKBOX</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">vModelCheckbox</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">V_MODEL_TEXT</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">vModelText</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">V_MODEL_SELECT</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">vModelSelect</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">V_MODEL_DYNAMIC</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">vModelDynamic</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">V_ON_WITH_MODIFIERS</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">withModifiers</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">V_ON_WITH_KEYS</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">withKeys</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">V_SHOW</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">vShow</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">TRANSITION</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Transition</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token constant">TRANSITION_GROUP</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">TransitionGroup</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>它运行 <code>registerRuntimeHelpers(helpers: any()</code>，往映射表注入了浏览器相关的部分函数。</p><p><strong>helpers 是怎么使用的呢?</strong></p><p>在 parse 阶段，解析到不同节点时会生成对应的 type。</p><p>在 <code>transform</code> 阶段，会生成一个 <code>helpers</code>，它是一个 <code>set</code> 数据结构。每当它转换 <code>AST</code> 时，都会根据 <code>AST</code> 节点的 <code>type</code> 添加不同的 <code>helper</code> 函数。</p><p>例如，假设它现在正在转换的是一个注释节点，它会执行 <code>context.helper(CREATE_COMMENT)</code>，内部实现相当于 <code>helpers.add(&#39;createCommentVNode&#39;)</code>。然后在 <code>codegen</code> 阶段，遍历 <code>helpers</code>，将程序需要的函数从 <code>Vue</code> 里导入，代码实现如下：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 这是 module 模式</span>
<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">import { </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>ast<span class="token punctuation">.</span>helpers
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">s</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>helperNameMap<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> as _</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>helperNameMap<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;, &#39;</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> } from </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>runtimeModuleName<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\n</span><span class="token template-punctuation string">`</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>如何生成代码？</strong></p><p>从 codegen.ts 文件中，可以看到很多代码生成函数：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 代码生成入口文件</span>
<span class="token function">genFunctionExpression</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 生成函数表达式</span>
<span class="token function">genNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 生成 Vnode 节点</span>
<span class="token operator">...</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>生成代码则是根据不同的 AST 节点调用不同的代码生成函数，最终将代码字符串拼在一起，输出一个完整的代码字符串。</p><p>老规矩，还是看一个例子：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> _hoisted_1 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;test&quot;</span> <span class="token punctuation">}</span>
<span class="token keyword">const</span> _hoisted_2 <span class="token operator">=</span> <span class="token comment">/*#__PURE__*/</span><span class="token function">_createTextVNode</span><span class="token punctuation">(</span><span class="token string">&quot; 一个文本节点 &quot;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> _hoisted_3 <span class="token operator">=</span> <span class="token comment">/*#__PURE__*/</span><span class="token function">_createVNode</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;good job!&quot;</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token comment">/* HOISTED */</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>看一下这段代码是怎么生成的，首先执行 <code>genHoists(ast.hoists, context)</code>，将 <code>transform</code> 生成的静态节点数组 <code>hoists</code> 作为第一个参数。<code>genHoists()</code> 内部实现：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>hoists<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">exp<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>exp<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">push</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">const _hoisted_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> = </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">genNode</span><span class="token punctuation">(</span>exp<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">newline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>从上述代码可以看到，遍历 <code>hoists</code> 数组，调用 <code>genNode(exp, context)</code>。<code>genNode()</code> 根据不同的 <code>type</code> 执行不同的函数。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> _hoisted_1 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;test&quot;</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这一行代码中的 <code>const _hoisted_1 =</code> 由 <code>genHoists()</code> 生成，<code>{ name: &quot;test&quot; }</code> 由 <code>genObjectExpression()</code> 生成。 同理，剩下的两行代码生成过程也是如此，只是最终调用的函数不同。</p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/sykinggg/notes/edit/main/demo/src/vue/interview/templateCompilation.md" rel="noopener noreferrer" target="_blank" aria-label="编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">上次编辑于: </span><span class="info">2021/8/12 06:08:41</span></div><div class="meta-item contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: dean@57blocks.com">DeanSui</span>,<!--]--><!--[--><span class="contributor" title="email: suiyi19920228@qq.com">suiyi</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/vue/interview/slot.html" class="nav-link prev" aria-label="slot插槽"><div class="hint"><span class="arrow left"></span>上一页</div><div class="link"><!---->slot插槽</div></a><a href="/vue/interview/diff.html" class="nav-link next" aria-label="diff算法"><div class="hint">下一页<span class="arrow right"></span></div><div class="link">diff算法<!----></div></a></nav><!----><!----><!--]--></main><!--]--><!----><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app.387fc4b5.js" defer></script>
  </body>
</html>
